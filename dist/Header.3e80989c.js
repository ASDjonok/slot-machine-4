parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"vQPm":[function(require,module,exports) {
var define;
var global = arguments[3];

var e,t,r,n,i,a=arguments[3];function o(e,t,r,n,i,a){return u(k(a?e.prototype:e),t,r,n,i)}function s(e,t,r,n){return(s="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,r,n){var i,a=d(e,t);if(a){if((i=Object.getOwnPropertyDescriptor(a,t)).set)return i.set.call(n,r),!0;if(!i.writable)return!1}if(i=Object.getOwnPropertyDescriptor(n,t)){if(!i.writable)return!1;i.value=r,Object.defineProperty(n,t,i)}else l(n,t,r);return!0})(e,t,r,n)}function u(e,t,r,n,i){if(!s(e,t,r,n||e)&&i)throw new TypeError("failed to set property");return r}function l(e,t,r){return(t=I(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t,r,n){var i=h(k(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=d(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(null,arguments)}function d(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}function f(){"use strict";f=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var a=t&&t.prototype instanceof _?t:_,o=Object.create(a.prototype),s=new O(n||[]);return i(o,"_invoke",{value:w(e,r,s)}),o}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var d="suspendedStart",p="suspendedYield",v="executing",m="completed",g={};function _(){}function y(){}function x(){}var b={};l(b,o,function(){return this});var T=Object.getPrototypeOf,S=T&&T(T(C([])));S&&S!==r&&n.call(S,o)&&(b=S);var k=x.prototype=_.prototype=Object.create(b);function E(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function A(e,t){function r(i,a,o,s){var u=h(e[i],e,a);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==D(c)&&n.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,o,s)},function(e){r("throw",e,o,s)}):t.resolve(c).then(function(e){l.value=e,o(l)},function(e){return r("throw",e,o,s)})}s(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function i(){return new t(function(t,i){r(e,n,t,i)})}return a=a?a.then(i,i):i()}})}function w(t,r,n){var i=d;return function(a,o){if(i===v)throw Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:e,done:!0}}for(n.method=a,n.arg=o;;){var s=n.delegate;if(s){var u=R(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=v;var l=h(t,r,n);if("normal"===l.type){if(i=n.done?m:p,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=m,n.method="throw",n.arg=l.arg)}}}function R(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,R(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=h(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var o=a.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(D(t)+" is not iterable")}return y.prototype=x,i(k,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:y,configurable:!0}),y.displayName=l(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},E(A.prototype),l(A.prototype,s,function(){return this}),t.AsyncIterator=A,t.async=function(e,r,n,i,a){void 0===a&&(a=Promise);var o=new A(c(e,r,n,i),a);return t.isGeneratorFunction(r)?o:o.next().then(function(e){return e.done?e.value:o.next()})},E(k),l(k,u,"Generator"),l(k,o,function(){return this}),l(k,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;M(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}function v(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function o(e){p(a,n,i,o,s,"next",e)}function s(e){p(a,n,i,o,s,"throw",e)}o(void 0)})}}function m(e){return y(e)||_(e)||L(e)||g()}function g(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function y(e){if(Array.isArray(e))return N(e)}function x(e,t,r){return t=k(t),b(e,S()?Reflect.construct(t,r||[],k(e).constructor):t.apply(e,r))}function b(e,t){if(t&&("object"==D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return T(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(S=function(){return!!e})()}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}function A(e,t){return(A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(e){throw new TypeError('"'+e+'" is read-only')}function R(e,t){return O(e)||M(e,t)||L(e,t)||P()}function P(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,s=[],u=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}function O(e){if(Array.isArray(e))return e}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function B(e,t,r){return t&&G(e.prototype,t),r&&G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function I(e){var t=F(e,"string");return"symbol"==D(t)?t:t+""}function F(e,t){if("object"!=D(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=L(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function L(e,t){if(e){if("string"==typeof e)return N(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?N(e,t):void 0}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(exports,"__esModule",{value:!0}),exports.GL_WRAP_MODES=exports.GL_TYPES=exports.GL_TARGETS=exports.GL_INTERNAL_FORMAT=exports.GL_FORMATS=exports.GAUSSIAN_VALUES=exports.FontStylePromiseCache=exports.FilterSystem=exports.FilterPipe=exports.FilterEffect=exports.Filter=exports.FillPattern=exports.FillGradient=exports.FederatedWheelEvent=exports.FederatedPointerEvent=exports.FederatedMouseEvent=exports.FederatedEvent=exports.FederatedContainer=exports.FOURCC_TO_TEXTURE_FORMAT=exports.ExtractSystem=exports.ExtensionType=exports.EventsTicker=exports.EventSystem=exports.EventEmitter=exports.EventBoundary=exports.Ellipse=exports.DynamicBitmapFont=exports.DisplacementFilter=exports.DefaultShader=exports.DefaultBatcher=exports.DXGI_TO_TEXTURE_FORMAT=exports.DXGI_FORMAT=exports.DRAW_MODES=exports.DOMAdapter=exports.DEPRECATED_WRAP_MODES=exports.DEPRECATED_SCALE_MODES=exports.DEG_TO_RAD=exports.DDS=exports.DATA_URI=exports.D3DFMT=exports.D3D10_RESOURCE_DIMENSION=exports.CustomRenderPipe=exports.CullerPlugin=exports.Culler=exports.Container=exports.CompressedSource=exports.ColorMatrixFilter=exports.ColorMaskPipe=exports.ColorMask=exports.Color=exports.Circle=exports.CanvasTextSystem=exports.CanvasTextPipe=exports.CanvasTextMetrics=exports.CanvasSource=exports.CanvasPoolClass=exports.CanvasPool=exports.Cache=exports.CLEAR=exports.BufferUsage=exports.BufferResource=exports.BufferImageSource=exports.Buffer=exports.BrowserAdapter=exports.Bounds=exports.BlurFilterPass=exports.BlurFilter=exports.BlendModePipe=exports.BlendModeFilter=exports.BitmapTextPipe=exports.BitmapText=exports.BitmapFontManager=exports.BitmapFont=exports.BindGroupSystem=exports.BindGroup=exports.BigPool=exports.BatcherPipe=exports.Batcher=exports.BatchableSprite=exports.BatchableMesh=exports.BatchableGraphics=exports.BatchTextureArray=exports.BatchGeometry=exports.Batch=exports.BackgroundSystem=exports.BackgroundLoader=exports.BUFFER_TYPE=exports.BLEND_TO_NPM=exports.AssetsClass=exports.Assets=exports.ApplicationInitHook=exports.Application=exports.AnimatedSprite=exports.AlphaMaskPipe=exports.AlphaMask=exports.AlphaFilter=exports.AccessibilitySystem=exports.AbstractText=exports.AbstractRenderer=exports.AbstractBitmapFont=void 0,exports.GpuProgram=exports.GpuMipmapGenerator=exports.GpuMeshAdapter=exports.GpuGraphicsContext=exports.GpuGraphicsAdaptor=exports.GpuEncoderSystem=exports.GpuDeviceSystem=exports.GpuColorMaskSystem=exports.GpuBufferSystem=exports.GpuBlendModesToPixi=exports.GpuBatchAdaptor=exports.GlobalUniformSystem=exports.GlUniformGroupSystem=exports.GlUboSystem=exports.GlTextureSystem=exports.GlTexture=exports.GlStencilSystem=exports.GlStateSystem=exports.GlShaderSystem=exports.GlRenderTargetSystem=exports.GlRenderTargetAdaptor=exports.GlRenderTarget=exports.GlProgramData=exports.GlProgram=exports.GlMeshAdaptor=exports.GlGraphicsAdaptor=exports.GlGeometrySystem=exports.GlEncoderSystem=exports.GlContextSystem=exports.GlColorMaskSystem=exports.GlBufferSystem=exports.GlBuffer=exports.GlBatchAdaptor=exports.GlBackBufferSystem=exports.Geometry=exports.GenerateTextureSystem=void 0,exports.GpuReadBuffer=qA,exports.RenderContainer=exports.Rectangle=exports.RAD_TO_DEG=exports.QuadGeometry=exports.PrepareUpload=exports.PrepareSystem=exports.PrepareQueue=exports.PrepareBase=exports.PoolGroupClass=exports.Pool=exports.Polygon=exports.Point=exports.PlaneGeometry=exports.PipelineSystem=exports.PerspectivePlaneGeometry=exports.PerspectiveMesh=exports.PI_2=exports.ObservablePoint=exports.NoiseFilter=exports.NineSliceSpritePipe=exports.NineSliceSprite=exports.NineSlicePlane=exports.NineSliceGeometry=exports.NOOP=exports.MeshSimple=exports.MeshRope=exports.MeshPlane=exports.MeshPipe=exports.MeshGeometry=exports.Mesh=exports.Matrix=exports.MaskFilter=exports.MaskEffectManagerClass=exports.MaskEffectManager=exports.MSAA_QUALITY=exports.LoaderParserPriority=exports.Loader=exports.KTX=exports.InstructionSet=exports.ImageSource=exports.IGLUniformData=exports.HelloSystem=exports.HTMLTextSystem=exports.HTMLTextStyle=exports.HTMLTextRenderData=exports.HTMLTextPipe=exports.HTMLText=exports.GraphicsPipe=exports.GraphicsPath=exports.GraphicsContextSystem=exports.GraphicsContextRenderData=exports.GraphicsContext=exports.Graphics=exports.GpuUniformBatchPipe=exports.GpuUboSystem=exports.GpuTextureSystem=exports.GpuStencilSystem=exports.GpuStencilModesToPixi=exports.GpuStateSystem=exports.GpuShaderSystem=exports.GpuRenderTargetSystem=exports.GpuRenderTargetAdaptor=exports.GpuRenderTarget=void 0,exports.STENCIL_MODES=exports.SCALE_MODES=exports.RoundedRectangle=exports.RopeGeometry=exports.Resolver=exports.ResizePlugin=exports.RendererType=exports.RendererInitHook=exports.RenderableGCSystem=exports.RenderTexture=exports.RenderTargetSystem=exports.RenderTarget=exports.RenderGroupSystem=exports.RenderGroupPipe=exports.RenderGroup=void 0,exports.SVGParser=$c,exports.SVGToGraphicsPath=uc,exports.WorkerManager=exports.WebGPURenderer=exports.WebGLRenderer=exports.WRAP_MODES=exports.WGSL_TO_STD40_SIZE=exports.WGSL_ALIGN_SIZE_DATA=exports.ViewableBuffer=exports.ViewSystem=exports.ViewContainer=exports.VideoSource=exports.VERSION=exports.UniformGroup=exports.UboSystem=exports.UboBatch=exports.UPDATE_VISIBLE=exports.UPDATE_TRANSFORM=exports.UPDATE_PRIORITY=exports.UPDATE_COLOR=exports.UPDATE_BLEND=exports.UNIFORM_TYPES_VALUES=exports.UNIFORM_TYPES_MAP=exports.UNIFORM_TO_SINGLE_SETTERS=exports.UNIFORM_TO_ARRAY_SETTERS=exports.Triangle=exports.Transform=exports.TilingSpriteShader=exports.TilingSpritePipe=exports.TilingSprite=exports.TickerPlugin=exports.TickerListener=exports.Ticker=exports.TextureUvs=exports.TextureStyle=exports.TextureSource=exports.TexturePoolClass=exports.TexturePool=exports.TextureMatrix=exports.TextureGCSystem=exports.Texture=exports.TextStyle=exports.Text=exports.TEXTURE_FORMAT_BLOCK_SIZE=exports.SystemRunner=exports.StencilMaskPipe=exports.StencilMask=exports.State=exports.Spritesheet=exports.SpritePipe=exports.Sprite=exports.SharedSystems=exports.SharedRenderPipes=exports.ShapePath=exports.ShaderStage=exports.Shader=exports.SdfShader=exports.ScissorMask=exports.SchedulerSystem=void 0,exports._getGlobalBounds=Pt,exports._getGlobalBoundsRecursive=gp,exports.accessibilityTarget=void 0,exports.addBits=Bo,exports.addMaskBounds=Ui,exports.addMaskLocalBounds=Li,exports.addProgramDefines=ao,exports.alphaWgsl=exports.alphaFrag=void 0,exports.applyMatrix=Yf,exports.applyProjectiveTransformationToPlane=TR,exports.applyStyleParams=zk,exports.assignWithIgnore=Yt,exports.autoDetectEnvironment=Ap,exports.autoDetectRenderer=Jp,exports.autoDetectSource=la,exports.blurTemplateWgsl=exports.blockDataMap=exports.blendTemplateWgsl=exports.blendTemplateVert=exports.blendTemplateFrag=exports.bitmapFontXMLStringParser=exports.bitmapFontXMLParser=exports.bitmapFontTextParser=exports.bitmapFontCachePlugin=exports.basisTranscoderUrls=void 0,exports.browserExt=exports.boundsPool=void 0,exports.buildAdaptiveBezier=bc,exports.buildAdaptiveQuadratic=Pc,exports.buildArc=Cc,exports.buildArcTo=Gc,exports.buildArcToSvg=Nc,exports.buildCircle=void 0,exports.buildContextBatches=cl,exports.buildEllipse=void 0,exports.buildGeometryFromPath=bR,exports.buildInstructions=mT,exports.buildLine=yu,exports.buildRoundedRectangle=exports.buildRectangle=exports.buildPolygon=void 0,exports.buildSimpleUvs=Qs,exports.buildTriangle=void 0,exports.buildUvs=Zs,exports.cacheTextureArray=void 0,exports.calculateProjection=OS,exports.checkChildrenDidChange=Dt,exports.checkDataUrl=Hv,exports.checkExtension=jv,exports.checkMaxIfStatementsInShader=_a,exports.childrenHelperMixin=void 0,exports.clearList=hE,exports.closePointEps=void 0,exports.collectAllRenderables=gT,exports.collectRenderGroups=dE,exports.color32BitToUniform=Rl,exports.colorMatrixFilterWgsl=exports.colorMatrixFilterFrag=exports.colorBitGl=exports.colorBit=void 0,exports.colorToUniform=wl,exports.compareModeToGlCompare=void 0,exports.compileHighShader=Yo,exports.compileHighShaderGl=Ko,exports.compileHighShaderGlProgram=ds,exports.compileHighShaderGpuProgram=hs,exports.compileHooks=Fo,exports.compileInputs=Uo,exports.compileOutputs=Ho,exports.compileShader=rk,exports.compute2DProjection=CR,exports.convertFormatIfRequired=I_,exports.copySearchParams=exports.convertToList=void 0,exports.createIdFromString=no,exports.createLevelBuffers=Ng,exports.createLevelBuffersFromKTX=D_,exports.createStringVariations=xn,exports.createTexture=pm,exports.createUboElementsSTD40=dS,exports.createUboElementsWGSL=uw,exports.createUboSyncFunction=pS,exports.createUboSyncFunctionSTD40=RS,exports.createUboSyncFunctionWGSL=cw,exports.crossOrigin=sg,exports.defaultFilterVert=exports.curveEps=exports.cullingMixin=void 0,exports.defaultValue=ik,exports.definedProps=zn,exports.deprecation=ht,exports.detectOgv=exports.detectMp4=exports.detectDefaults=exports.detectCompressed=exports.detectBasis=exports.detectAvif=void 0,exports.detectVideoAlphaMode=Yi,exports.detectWebp=exports.detectWebm=void 0,exports.determineCrossOrigin=lg,exports.effectsMixin=exports.earcut=exports.displacementWgsl=exports.displacementVert=exports.displacementFrag=void 0,exports.ensureAttributes=NT,exports.ensureIsBuffer=Ya,exports.ensureOptions=$b,exports.ensurePrecision=oo,exports.ensureTextStyle=VP,exports.executeInstructions=lE,exports.extensions=void 0,exports.extractAttributesFromGlProgram=ck,exports.extractAttributesFromGpuProgram=Ao,exports.extractFontFamilies=of,exports.extractStructAndGroups=wo,exports.fastCopy=Aa,exports.findMixin=exports.findHooksRx=void 0,exports.fontStringFromTextStyle=qh,exports.formatShader=fT,exports.fragmentGlTemplate=exports.fragmentGPUTemplate=void 0,exports.generateArraySyncSTD40=wS,exports.generateArraySyncWGSL=lw,exports.generateBlurFragSource=Ny,exports.generateBlurGlProgram=jy,exports.generateBlurProgram=Vy,exports.generateBlurVertSource=Hy,exports.generateGPULayout=sT,exports.generateGpuLayoutGroups=Po,exports.generateLayout=uT,exports.generateLayoutHash=Mo,exports.generateProgram=vk,exports.generateShaderSyncCode=$S,exports.generateTextStyleKey=Mh,exports.generateTextureBatchBit=_s,exports.generateTextureBatchBitGl=bs,exports.generateUID=uR,exports.generateUniformsSync=xk,exports.getAdjustedBlendModeBlend=Pa,exports.getAttributeInfoFromFormat=ko,exports.getBatchSamplersUniformGroup=Fs,exports.getBitmapTextLayout=Ad,exports.getCanvasBoundingBox=Zl,exports.getCanvasFillStyle=$h,exports.getCanvasTexture=LS,exports.getDefaultUniformValue=As,exports.getFastGlobalBounds=mp,exports.getFontCss=ff,exports.getFontFamilyName=lm,exports.getGeometryBounds=Ka,exports.getGlTypeFromFormat=YT,exports.getGlobalBounds=Rt,exports.getGlobalRenderableBounds=_p,exports.getLocalBounds=Bt,exports.getMatrixRelativeToParent=Ni,exports.getMaxFragmentPrecision=io,exports.getMaxTexturesPerBatch=xa,exports.getOrientationOfPoints=mu,exports.getParent=Ft,exports.getPo2TextureFromSource=Yh,exports.getResolutionOfUrl=fm,exports.getSVGUrl=vf,exports.getSupportedCompressedTextureFormats=kg,exports.getSupportedGPUCompressedTextureFormats=Tg,exports.getSupportedGlCompressedTextureFormats=bg,exports.getSupportedTextureFormats=Rg,exports.getTemporaryCanvasFromImage=mf,exports.getTestContext=va,exports.getTextureBatchBindGroup=Ta,exports.getTextureDefaultMatrix=BP,exports.getTextureFormatFromKTXTexture=H_,exports.getUboData=hk,exports.getUniformData=dk,exports.getUrlExtension=Pn,exports.glFormatToGPUFormat=L_,exports.globalUniformsUBOBitGl=exports.globalUniformsBitGl=exports.globalUniformsBit=exports.glUploadVideoResource=exports.glUploadImageResource=exports.glUploadCompressedTextureResource=exports.glUploadBufferImageResource=void 0,exports.gpuFormatToBasisTranscoderFormat=Hg,exports.gpuFormatToKTXBasisTranscoderFormat=z_,exports.groupD8=exports.gpuUploadVideoResource=exports.gpuUploadImageResource=exports.gpuUploadCompressedTextureResource=exports.gpuUploadBufferImageResource=void 0,exports.hasCachedCanvasTexture=NS,exports.hslgpu=exports.hslgl=exports.hslWgsl=void 0,exports.injectBits=jo,exports.insertVersion=so,exports.isMobile=void 0,exports.isPow2=Hn,exports.isRenderingToScreen=XS,exports.isSafari=Hd,exports.isSingleItem=void 0,exports.isWebGLSupported=Hp,exports.isWebGPUSupported=jp,exports.loadBasis=exports.ktxTranscoderUrls=void 0,exports.loadBasisOnWorker=Ug,exports.loadDDS=exports.loadBitmapFont=void 0,exports.loadEnvironmentExtensions=kp,exports.loadFontAsBase64=sf,exports.loadFontCSS=lf,exports.loadImageBitmap=Ym,exports.loadKTX2=exports.loadKTX=exports.loadJson=void 0,exports.loadKTX2onWorker=C_,exports.loadSVGImage=gf,exports.localUniformBit=exports.loadWebFont=exports.loadVideoTextures=exports.loadTxt=exports.loadTextures=exports.loadSvg=void 0,exports.localUniformMSDFBitGl=exports.localUniformMSDFBit=exports.localUniformBitGroup2=exports.localUniformBitGl=void 0,exports.log2=jn,exports.logDebugTexture=WP,exports.logProgramError=pk,exports.logRenderGroupScene=oM,exports.logScene=aM,exports.mSDFBitGl=exports.mSDFBit=void 0,exports.mapFormatToGlFormat=Vk,exports.mapFormatToGlInternalFormat=tE,exports.mapFormatToGlType=rE,exports.mapGlToVertexFormat=lk,exports.mapSize=kk,exports.mapType=uk,exports.mapWebGLBlendModesToPixi=Ek,exports.matrixPool=exports.maskWgsl=exports.maskVert=exports.maskFrag=void 0,exports.measureHtmlText=_f,exports.measureMixin=void 0,exports.migrateFragmentFromV7toV8=Tk,exports.mipmapScaleModeToGlFilter=void 0,exports.mixColors=vE,exports.mixHexColors=fE,exports.mixStandardAnd32BitColors=mE,exports.multiplyHexColors=$s,exports.nextPow2=Xn,exports.onRenderMixin=exports.nsxhtml=exports.nssvg=exports.normalizeExtensionPriority=exports.nonCompressedFormats=exports.noiseWgsl=exports.noiseFrag=void 0,exports.parseDDS=$g,exports.parseFunctionBody=lR,exports.parseKTX=__,exports.path=void 0,exports.pointInTriangle=db,exports.preloadVideo=ug,exports.removeItems=vt,exports.removeStructAndGroupDuplicates=Oo,exports.resetUids=st,exports.resolveCharacters=gd,exports.resolveTextureUrl=exports.resolveJsonUrl=exports.resolveCompressedTextureUrl=void 0,exports.resourceToTexture=ha,exports.roundPixelsBitGl=exports.roundPixelsBit=void 0,exports.roundedShapeArc=Xc,exports.roundedShapeQuadraticCurve=Hc,exports.sayHello=hA,exports.scaleModeToGlFilter=void 0,exports.setBasisTranscoderPath=Ig,exports.setKTXTranscoderPath=P_,exports.setPositions=Wf,exports.setProgramName=co,exports.setUvs=Kf,exports.spritesheetAsset=exports.sortMixin=exports.shapeBuilders=void 0,exports.squaredDistanceToLineSegment=hc,exports.stripVersion=ho,exports.testImageFormat=bv,exports.testVideoFormat=wv,exports.textStyleToCSS=Wd,exports.textureBitGl=exports.textureBit=void 0,exports.textureFrom=da,exports.tilingBitGl=exports.tilingBit=void 0,exports.toFillStyle=gh,exports.toLocalGlobalMixin=void 0,exports.toStrokeStyle=_h,exports.transformVertices=Js,exports.triangulateWithHoles=nl,exports.uboSyncFunctionsWGSL=exports.uboSyncFunctionsSTD40=void 0,exports.uid=ot,exports.uniformParsers=void 0,exports.unpremultiplyAlpha=nE,exports.unsafeEvalSupported=Rp,exports.updateLocalTransform=_R,exports.updateQuadBounds=wi,exports.updateRenderGroupTransform=xE,exports.updateRenderGroupTransforms=yE,exports.updateTransformAndChildren=bE,exports.updateTransformBackwards=Mt,exports.updateWorldTransform=yR,exports.validFormats=exports.v8_3_4=exports.v8_0_0=void 0,exports.validateRenderables=SE,exports.vertexGlTemplate=exports.vertexGPUTemplate=void 0,exports.viewportFromFrame=eR,exports.vkFormatToGPUFormat=X_,exports.warn=Gt,exports.wrapModeToGlAddress=void 0;var X=Object.defineProperty,H=Object.defineProperties,j=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,Y=function(e,t,r){return t in e?X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},K=function(e,t){for(var r in t||(t={}))V.call(t,r)&&Y(e,r,t[r]);if(z){var n,i=U(z(t));try{for(i.s();!(n=i.n()).done;){r=n.value;W.call(t,r)&&Y(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},q=function(e,t){return H(e,j(t))},Z=exports.ExtensionType=function(e){return e.Application="application",e.WebGLPipes="webgl-pipes",e.WebGLPipesAdaptor="webgl-pipes-adaptor",e.WebGLSystem="webgl-system",e.WebGPUPipes="webgpu-pipes",e.WebGPUPipesAdaptor="webgpu-pipes-adaptor",e.WebGPUSystem="webgpu-system",e.CanvasSystem="canvas-system",e.CanvasPipesAdaptor="canvas-pipes-adaptor",e.CanvasPipes="canvas-pipes",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e.MaskEffect="mask-effect",e.BlendMode="blend-mode",e.TextureSource="texture-source",e.Environment="environment",e.ShapeBuilder="shape-builder",e.Batcher="batcher",e}(Z||{}),Q=function(e){if("function"==typeof e||"object"===D(e)&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");var t="object"!==D(e.extension)?{type:e.extension}:e.extension;e=q(K({},t),{ref:e})}if("object"!==D(e))throw new Error("Invalid extension type");return"string"==typeof(e=K({},e)).type&&(e.type=[e.type]),e},J=exports.normalizeExtensionPriority=function(e,t){var r;return null!=(r=Q(e).priority)?r:t},$=exports.extensions={_addHandlers:{},_removeHandlers:{},_queue:{},remove:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.map(Q).forEach(function(t){t.type.forEach(function(r){var n,i;return null==(i=(n=e._removeHandlers)[r])?void 0:i.call(n,t)})}),this},add:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.map(Q).forEach(function(t){t.type.forEach(function(r){var n,i,a=e._addHandlers,o=e._queue;a[r]?null==(i=a[r])||i.call(a,t):(o[r]=o[r]||[],null==(n=o[r])||n.push(t))})}),this},handle:function(e,t,r){var n,i=this._addHandlers,a=this._removeHandlers;if(i[e]||a[e])throw new Error("Extension type ".concat(e," already has a handler"));i[e]=t,a[e]=r;var o=this._queue;return o[e]&&(null==(n=o[e])||n.forEach(function(e){return t(e)}),delete o[e]),this},handleByMap:function(e,t){return this.handle(e,function(e){e.name&&(t[e.name]=e.ref)},function(e){e.name&&delete t[e.name]})},handleByNamedList:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return this.handle(e,function(e){t.findIndex(function(t){return t.name===e.name})>=0||(t.push({name:e.name,value:e.ref}),t.sort(function(e,t){return J(t.value,r)-J(e.value,r)}))},function(e){var r=t.findIndex(function(t){return t.name===e.name});-1!==r&&t.splice(r,1)})},handleByList:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return this.handle(e,function(e){t.includes(e.ref)||(t.push(e.ref),t.sort(function(e,t){return J(t,r)-J(e,r)}))},function(e){var r=t.indexOf(e.ref);-1!==r&&t.splice(r,1)})}},ee="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==a?a:"undefined"!=typeof self?self:{};function te(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function re(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ne(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")&&1===Object.keys(e).length?e.default:e}function ie(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}var ae={exports:{}},oe=ae.exports;!function(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,n,a,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,a||e,o),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=new Array(a);i<a;i++)o[i]=n[i].fn;return o},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,a,o){var s=r?r+e:e;if(!this._events[s])return!1;var u,l,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,a),!0;case 6:return c.fn.call(c.context,t,n,i,a,o),!0}for(l=1,u=new Array(h-1);l<h;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var d,f=c.length;for(l=0;l<f;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),h){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;case 4:c[l].fn.call(c[l].context,t,n,i);break;default:if(!u)for(d=1,u=new Array(h-1);d<h;d++)u[d-1]=arguments[d];c[l].fn.apply(c[l].context,u)}}return!0},s.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||o(this,a);else{for(var u=0,l=[],c=s.length;u<c;u++)(s[u].fn!==t||i&&!s[u].once||n&&s[u].context!==n)&&l.push(s[u]);l.length?this._events[a]=1===l.length?l[0]:l:o(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(ae);var se=ae.exports,ue=exports.EventEmitter=te(se),le={grad:.9,turn:360,rad:360/(2*Math.PI)},ce=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},he=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},de=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e>t?e:t},fe=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},pe=function(e){return{r:de(e.r,0,255),g:de(e.g,0,255),b:de(e.b,0,255),a:de(e.a)}},ve=function(e){return{r:he(e.r),g:he(e.g),b:he(e.b),a:he(e.a,3)}},me=/^#([0-9a-f]{3,8})$/i,ge=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},_e=function(e){var t=e.r,r=e.g,n=e.b,i=e.a,a=Math.max(t,r,n),o=a-Math.min(t,r,n),s=o?a===t?(r-n)/o:a===r?2+(n-t)/o:4+(t-r)/o:0;return{h:60*(s<0?s+6:s),s:a?o/a*100:0,v:a/255*100,a:i}},ye=function(e){var t=e.h,r=e.s,n=e.v,i=e.a;t=t/360*6,r/=100,n/=100;var a=Math.floor(t),o=n*(1-r),s=n*(1-(t-a)*r),u=n*(1-(1-t+a)*r),l=a%6;return{r:255*[n,s,o,o,u,n][l],g:255*[u,n,n,s,o,o][l],b:255*[o,o,u,n,n,s][l],a:i}},xe=function(e){return{h:fe(e.h),s:de(e.s,0,100),l:de(e.l,0,100),a:de(e.a)}},be=function(e){return{h:he(e.h),s:he(e.s),l:he(e.l),a:he(e.a,3)}},Te=function(e){return ye((r=(t=e).s,{h:t.h,s:(r*=((n=t.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:t.a}));var t,r,n},Se=function(e){return{h:(t=_e(e)).h,s:(i=(200-(r=t.s))*(n=t.v)/100)>0&&i<200?r*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,r,n,i},ke=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ee=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ae=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,we=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Re={string:[[function(e){var t=me.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?he(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?he(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=Ae.exec(e)||we.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:pe({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=ke.exec(e)||Ee.exec(e);if(!t)return null;var r,n,i=xe({h:(r=t[1],n=t[2],void 0===n&&(n="deg"),Number(r)*(le[n]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return Te(i)},"hsl"]],object:[[function(e){var t=e.r,r=e.g,n=e.b,i=e.a,a=void 0===i?1:i;return ce(t)&&ce(r)&&ce(n)?pe({r:Number(t),g:Number(r),b:Number(n),a:Number(a)}):null},"rgb"],[function(e){var t=e.h,r=e.s,n=e.l,i=e.a,a=void 0===i?1:i;if(!ce(t)||!ce(r)||!ce(n))return null;var o=xe({h:Number(t),s:Number(r),l:Number(n),a:Number(a)});return Te(o)},"hsl"],[function(e){var t=e.h,r=e.s,n=e.v,i=e.a,a=void 0===i?1:i;if(!ce(t)||!ce(r)||!ce(n))return null;var o=function(e){return{h:fe(e.h),s:de(e.s,0,100),v:de(e.v,0,100),a:de(e.a)}}({h:Number(t),s:Number(r),v:Number(n),a:Number(a)});return ye(o)},"hsv"]]},Pe=function(e,t){for(var r=0;r<t.length;r++){var n=t[r][0](e);if(n)return[n,t[r][1]]}return[null,void 0]},Me=function(e){return"string"==typeof e?Pe(e.trim(),Re.string):"object"==D(e)&&null!==e?Pe(e,Re.object):[null,void 0]},Oe=function(e){return Me(e)[1]},Ce=function(e,t){var r=Se(e);return{h:r.h,s:de(r.s+100*t,0,100),l:r.l,a:r.a}},Ge=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},Be=function(e,t){var r=Se(e);return{h:r.h,s:r.s,l:de(r.l+100*t,0,100),a:r.a}},Ie=function(){function e(e){this.parsed=Me(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return he(Ge(this.rgba),2)},e.prototype.isDark=function(){return Ge(this.rgba)<.5},e.prototype.isLight=function(){return Ge(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=ve(this.rgba)).r,r=e.g,n=e.b,a=(i=e.a)<1?ge(he(255*i)):"","#"+ge(t)+ge(r)+ge(n)+a;var e,t,r,n,i,a},e.prototype.toRgb=function(){return ve(this.rgba)},e.prototype.toRgbString=function(){return t=(e=ve(this.rgba)).r,r=e.g,n=e.b,(i=e.a)<1?"rgba("+t+", "+r+", "+n+", "+i+")":"rgb("+t+", "+r+", "+n+")";var e,t,r,n,i},e.prototype.toHsl=function(){return be(Se(this.rgba))},e.prototype.toHslString=function(){return t=(e=be(Se(this.rgba))).h,r=e.s,n=e.l,(i=e.a)<1?"hsla("+t+", "+r+"%, "+n+"%, "+i+")":"hsl("+t+", "+r+"%, "+n+"%)";var e,t,r,n,i},e.prototype.toHsv=function(){return e=_e(this.rgba),{h:he(e.h),s:he(e.s),v:he(e.v),a:he(e.a,3)};var e},e.prototype.invert=function(){return Fe({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),Fe(Ce(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),Fe(Ce(this.rgba,-e))},e.prototype.grayscale=function(){return Fe(Ce(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),Fe(Be(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),Fe(Be(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?Fe({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):he(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=Se(this.rgba);return"number"==typeof e?Fe({h:e,s:t.s,l:t.l,a:t.a}):he(t.h)},e.prototype.isEqual=function(e){return this.toHex()===Fe(e).toHex()},e}(),Fe=function(e){return e instanceof Ie?e:new Ie(e)},De=[],Ue=function(e){e.forEach(function(e){De.indexOf(e)<0&&(e(Ie,Re),De.push(e))})},Le=function(){return new Ie({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})};function Ne(e,t){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in r)n[r[i]]=i;var a={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var i,o,s=n[this.toHex()];if(s)return s;if(null==t?void 0:t.closest){var u=this.toRgb(),l=1/0,c="black";if(!a.length)for(var h in r)a[h]=new e(r[h]).toRgb();for(var d in r){var f=(i=u,o=a[d],Math.pow(i.r-o.r,2)+Math.pow(i.g-o.g,2)+Math.pow(i.b-o.b,2));f<l&&(l=f,c=d)}return c}},t.string.push([function(t){var n=t.toLowerCase(),i="transparent"===n?"#0000":r[n];return i?new e(i).toRgb():null},"name"])}var Xe=Object.defineProperty,He=Object.getOwnPropertySymbols,je=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable,Ve=function(e,t,r){return t in e?Xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},We=function(e,t){for(var r in t||(t={}))je.call(t,r)&&Ve(e,r,t[r]);if(He){var n,i=U(He(t));try{for(i.s();!(n=i.n()).done;){r=n.value;ze.call(t,r)&&Ve(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e};Ue([Ne]);var Ye=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16777215;C(this,e),this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}return B(e,[{key:"red",get:function(){return this._components[0]}},{key:"green",get:function(){return this._components[1]}},{key:"blue",get:function(){return this._components[2]}},{key:"alpha",get:function(){return this._components[3]}},{key:"setValue",value:function(e){return this.value=e,this}},{key:"value",get:function(){return this._value},set:function(t){if(t instanceof e)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(null===t)throw new Error("Cannot set Color#value to null");null!==this._value&&this._isSourceEqual(this._value,t)||(this._value=this._cloneSource(t),this._normalize(this._value))}}},{key:"_cloneSource",value:function(e){return"string"==typeof e||"number"==typeof e||e instanceof Number||null===e?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):"object"===D(e)&&null!==e?We({},e):e}},{key:"_isSourceEqual",value:function(e,t){var r=D(e);if(r!==D(t))return!1;if("number"===r||"string"===r||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length===t.length&&e.every(function(e,r){return e===t[r]});if(null!==e&&null!==t){var n=Object.keys(e),i=Object.keys(t);return n.length===i.length&&n.every(function(r){return e[r]===t[r]})}return e===t}},{key:"toRgba",value:function(){var e=R(this._components,4);return{r:e[0],g:e[1],b:e[2],a:e[3]}}},{key:"toRgb",value:function(){var e=R(this._components,3);return{r:e[0],g:e[1],b:e[2]}}},{key:"toRgbaString",value:function(){var e=R(this.toUint8RgbArray(),3),t=e[0],r=e[1],n=e[2];return"rgba(".concat(t,",").concat(r,",").concat(n,",").concat(this.alpha,")")}},{key:"toUint8RgbArray",value:function(e){var t=R(this._components,3),r=t[0],n=t[1],i=t[2];return this._arrayRgb||(this._arrayRgb=[]),(e=e||this._arrayRgb)[0]=Math.round(255*r),e[1]=Math.round(255*n),e[2]=Math.round(255*i),e}},{key:"toArray",value:function(e){this._arrayRgba||(this._arrayRgba=[]),e=e||this._arrayRgba;var t=R(this._components,4),r=t[0],n=t[1],i=t[2],a=t[3];return e[0]=r,e[1]=n,e[2]=i,e[3]=a,e}},{key:"toRgbArray",value:function(e){this._arrayRgb||(this._arrayRgb=[]),e=e||this._arrayRgb;var t=R(this._components,3),r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e}},{key:"toNumber",value:function(){return this._int}},{key:"toBgrNumber",value:function(){var e=R(this.toUint8RgbArray(),3),t=e[0],r=e[1];return(e[2]<<16)+(r<<8)+t}},{key:"toLittleEndianNumber",value:function(){var e=this._int;return(e>>16)+(65280&e)+((255&e)<<16)}},{key:"multiply",value:function(t){var r=R(e._temp.setValue(t)._components,4),n=r[0],i=r[1],a=r[2],o=r[3];return this._components[0]*=n,this._components[1]*=i,this._components[2]*=a,this._components[3]*=o,this._refreshInt(),this._value=null,this}},{key:"premultiply",value:function(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}},{key:"toPremultiplied",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(1===e)return(255<<24)+this._int;if(0===e)return t?0:this._int;var r=this._int>>16&255,n=this._int>>8&255,i=255&this._int;return t&&(r=r*e+.5|0,n=n*e+.5|0,i=i*e+.5|0),(255*e<<24)+(r<<16)+(n<<8)+i}},{key:"toHex",value:function(){var e=this._int.toString(16);return"#".concat("000000".substring(0,6-e.length)+e)}},{key:"toHexa",value:function(){var e=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}},{key:"setAlpha",value:function(e){return this._components[3]=this._clamp(e),this}},{key:"_normalize",value:function(t){var r,n,i,a;if(("number"==typeof t||t instanceof Number)&&t>=0&&t<=16777215){r=(t>>16&255)/255,n=(t>>8&255)/255,i=(255&t)/255,a=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4){var o=R(t=this._clamp(t),4);r=o[0],n=o[1],i=o[2];var s=o[3];a=void 0===s?1:s}else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4){var u=R(t=this._clamp(t,0,255),4);r=u[0],n=u[1],i=u[2];var l=u[3];a=void 0===l?255:l,r/=255,n/=255,i/=255,a/=255}else if("string"==typeof t||"object"===D(t)){if("string"==typeof t){var c=e.HEX_PATTERN.exec(t);c&&(t="#".concat(c[2]))}var h=Fe(t);if(h.isValid()){var d=h.rgba;r=d.r,n=d.g,i=d.b,a=d.a,r/=255,n/=255,i/=255}}if(void 0===r)throw new Error("Unable to convert color ".concat(t));this._components[0]=r,this._components[1]=n,this._components[2]=i,this._components[3]=a,this._refreshInt()}},{key:"_refreshInt",value:function(){this._clamp(this._components);var e=R(this._components,3),t=e[0],r=e[1],n=e[2];this._int=(255*t<<16)+(255*r<<8)+(255*n|0)}},{key:"_clamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return"number"==typeof e?Math.min(Math.max(e,t),r):(e.forEach(function(n,i){e[i]=Math.min(Math.max(n,t),r)}),e)}}],[{key:"isColorLike",value:function(t){return"number"==typeof t||"string"==typeof t||t instanceof Number||t instanceof e||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||void 0!==t.r&&void 0!==t.g&&void 0!==t.b||void 0!==t.r&&void 0!==t.g&&void 0!==t.b&&void 0!==t.a||void 0!==t.h&&void 0!==t.s&&void 0!==t.l||void 0!==t.h&&void 0!==t.s&&void 0!==t.l&&void 0!==t.a||void 0!==t.h&&void 0!==t.s&&void 0!==t.v||void 0!==t.h&&void 0!==t.s&&void 0!==t.v&&void 0!==t.a}}])}();Ye.shared=new Ye,Ye._temp=new Ye,Ye.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;var Ke=exports.Color=Ye,qe=exports.cullingMixin={cullArea:null,cullable:!1,cullableChildren:!0},Ze=exports.PI_2=2*Math.PI,Qe=exports.RAD_TO_DEG=180/Math.PI,Je=exports.DEG_TO_RAD=Math.PI/180,$e=exports.Point=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;C(this,e),this.x=0,this.y=0,this.x=t,this.y=r}return B(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"copyFrom",value:function(e){return this.set(e.x,e.y),this}},{key:"copyTo",value:function(e){return e.set(this.x,this.y),e}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.x=e,this.y=t,this}},{key:"toString",value:function(){return"[pixi.js/math:Point x=".concat(this.x," y=").concat(this.y,"]")}}],[{key:"shared",get:function(){return et.x=0,et.y=0,et}}])}(),et=new $e,tt=exports.Matrix=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;C(this,e),this.array=null,this.a=t,this.b=r,this.c=n,this.d=i,this.tx=a,this.ty=o}return B(e,[{key:"fromArray",value:function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}},{key:"set",value:function(e,t,r,n,i,a){return this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=a,this}},{key:"toArray",value:function(e,t){this.array||(this.array=new Float32Array(9));var r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}},{key:"apply",value:function(e,t){t=t||new $e;var r=e.x,n=e.y;return t.x=this.a*r+this.c*n+this.tx,t.y=this.b*r+this.d*n+this.ty,t}},{key:"applyInverse",value:function(e,t){t=t||new $e;var r=this.a,n=this.b,i=this.c,a=this.d,o=this.tx,s=this.ty,u=1/(r*a+i*-n),l=e.x,c=e.y;return t.x=a*u*l+-i*u*c+(s*i-o*a)*u,t.y=r*u*c+-n*u*l+(-s*r+o*n)*u,t}},{key:"translate",value:function(e,t){return this.tx+=e,this.ty+=t,this}},{key:"scale",value:function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),r=Math.sin(e),n=this.a,i=this.c,a=this.tx;return this.a=n*t-this.b*r,this.b=n*r+this.b*t,this.c=i*t-this.d*r,this.d=i*r+this.d*t,this.tx=a*t-this.ty*r,this.ty=a*r+this.ty*t,this}},{key:"append",value:function(e){var t=this.a,r=this.b,n=this.c,i=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*r+e.b*i,this.c=e.c*t+e.d*n,this.d=e.c*r+e.d*i,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*r+e.ty*i+this.ty,this}},{key:"appendFrom",value:function(e,t){var r=e.a,n=e.b,i=e.c,a=e.d,o=e.tx,s=e.ty,u=t.a,l=t.b,c=t.c,h=t.d;return this.a=r*u+n*c,this.b=r*l+n*h,this.c=i*u+a*c,this.d=i*l+a*h,this.tx=o*u+s*c+t.tx,this.ty=o*l+s*h+t.ty,this}},{key:"setTransform",value:function(e,t,r,n,i,a,o,s,u){return this.a=Math.cos(o+u)*i,this.b=Math.sin(o+u)*i,this.c=-Math.sin(o-s)*a,this.d=Math.cos(o-s)*a,this.tx=e-(r*this.a+n*this.c),this.ty=t-(r*this.b+n*this.d),this}},{key:"prepend",value:function(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var r=this.a,n=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}},{key:"decompose",value:function(e){var t=this.a,r=this.b,n=this.c,i=this.d,a=e.pivot,o=-Math.atan2(-n,i),s=Math.atan2(r,t),u=Math.abs(o+s);return u<1e-5||Math.abs(Ze-u)<1e-5?(e.rotation=s,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=s),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(a.x*t+a.y*n),e.position.y=this.ty+(a.x*r+a.y*i),e}},{key:"invert",value:function(){var e=this.a,t=this.b,r=this.c,n=this.d,i=this.tx,a=e*n-t*r;return this.a=n/a,this.b=-t/a,this.c=-r/a,this.d=e/a,this.tx=(r*this.ty-n*i)/a,this.ty=-(e*this.ty-t*i)/a,this}},{key:"isIdentity",value:function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.tx&&0===this.ty}},{key:"identity",value:function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}},{key:"clone",value:function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}},{key:"copyTo",value:function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}},{key:"copyFrom",value:function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}},{key:"equals",value:function(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}},{key:"toString",value:function(){return"[pixi.js:Matrix a=".concat(this.a," b=").concat(this.b," c=").concat(this.c," d=").concat(this.d," tx=").concat(this.tx," ty=").concat(this.ty,"]")}}],[{key:"IDENTITY",get:function(){return nt.identity()}},{key:"shared",get:function(){return rt.identity()}}])}(),rt=new tt,nt=new tt,it=exports.ObservablePoint=function(){function e(t,r,n){C(this,e),this._x=r||0,this._y=n||0,this._observer=t}return B(e,[{key:"clone",value:function(t){return new e(null!=t?t:this._observer,this._x,this._y)}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this._x===e&&this._y===t||(this._x=e,this._y=t,this._observer._onUpdate(this)),this}},{key:"copyFrom",value:function(e){return this._x===e.x&&this._y===e.y||(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}},{key:"copyTo",value:function(e){return e.set(this._x,this._y),e}},{key:"equals",value:function(e){return e.x===this._x&&e.y===this._y}},{key:"toString",value:function(){return"[pixi.js/math:ObservablePoint x=".concat(0," y=",0," scope=",this._observer,"]")}},{key:"x",get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}},{key:"y",get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}])}(),at={default:-1};function ot(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return void 0===at[e]&&(at[e]=-1),++at[e]}function st(){for(var e in at)delete at[e]}var ut={},lt=exports.v8_0_0="8.0.0",ct=exports.v8_3_4="8.3.4";function ht(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(!ut[t]){var n=(new Error).stack;void 0===n?console.warn("PixiJS Deprecation Warning: ","".concat(t,"\nDeprecated since v").concat(e)):(n=n.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6","".concat(t,"\nDeprecated since v").concat(e)),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ","".concat(t,"\nDeprecated since v").concat(e)),console.warn(n))),ut[t]=!0}}var dt=exports.Pool=function(){return B(function e(t,r){C(this,e),this._pool=[],this._count=0,this._index=0,this._classType=t,r&&this.prepopulate(r)},[{key:"prepopulate",value:function(e){for(var t=0;t<e;t++)this._pool[this._index++]=new this._classType;this._count+=e}},{key:"get",value:function(e){var t,r;return null==(t=(r=this._index>0?this._pool[--this._index]:new this._classType).init)||t.call(r,e),r}},{key:"return",value:function(e){var t;null==(t=e.reset)||t.call(e),this._pool[this._index++]=e}},{key:"totalSize",get:function(){return this._count}},{key:"totalFree",get:function(){return this._index}},{key:"totalUsed",get:function(){return this._count-this._index}},{key:"clear",value:function(){this._pool.length=0,this._index=0}}])}(),ft=exports.PoolGroupClass=function(){return B(function e(){C(this,e),this._poolsByClass=new Map},[{key:"prepopulate",value:function(e,t){this.getPool(e).prepopulate(t)}},{key:"get",value:function(e,t){return this.getPool(e).get(t)}},{key:"return",value:function(e){this.getPool(e.constructor).return(e)}},{key:"getPool",value:function(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new dt(e)),this._poolsByClass.get(e)}},{key:"stats",value:function(){var e={};return this._poolsByClass.forEach(function(t){var r=e[t._classType.name]?t._classType.name+t._classType.ID:t._classType.name;e[r]={free:t.totalFree,used:t.totalUsed,size:t.totalSize}}),e}}])}(),pt=exports.BigPool=new ft;function vt(e,t,r){var n,i=e.length;if(!(t>=i||0===r)){var a=i-(r=t+r>i?i-t:r);for(n=t;n<a;++n)e[n]=e[n+r];e.length=a}}var mt=exports.childrenHelperMixin={allowChildren:!0,removeChildren:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=null!=t?t:this.children.length,n=r-e,i=[];if(n>0&&n<=r){for(var a=r-1;a>=e;a--){var o=this.children[a];o&&(i.push(o),o.parent=null)}vt(this.children,e,r);var s=this.renderGroup||this.parentRenderGroup;s&&s.removeChildren(i);for(var u=0;u<i.length;++u)this.emit("childRemoved",i[u],this,u),i[u].emit("removed",this);return i}if(0===n&&0===this.children.length)return i;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt:function(e){var t=this.getChildAt(e);return this.removeChild(t)},getChildAt:function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index (".concat(e,") does not exist."));return this.children[e]},setChildIndex:function(e,t){if(t<0||t>=this.children.length)throw new Error("The index ".concat(t," supplied is out of bounds ").concat(this.children.length));this.getChildIndex(e),this.addChildAt(e,t)},getChildIndex:function(e){var t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt:function(e,t){this.allowChildren||ht(lt,"addChildAt: Only Containers will be allowed to add children in v8.0.0");var r=this.children;if(t<0||t>r.length)throw new Error("".concat(e,"addChildAt: The index ").concat(t," supplied is out of bounds ").concat(r.length));if(e.parent){var n=e.parent.children.indexOf(e);if(e.parent===this&&n===t)return e;-1!==n&&e.parent.children.splice(n,1)}t===r.length?r.push(e):r.splice(t,0,e),e.parent=this,e.didChange=!0,e.didViewUpdate=!1,e._updateFlags=15;var i=this.renderGroup||this.parentRenderGroup;return i&&i.addChild(e),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",e,this,t),e.emit("added",this),e},swapChildren:function(e,t){if(e!==t){var r=this.getChildIndex(e),n=this.getChildIndex(t);this.children[r]=t,this.children[n]=e;var i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0),this._didContainerChangeTick++}},removeFromParent:function(){var e;null==(e=this.parent)||e.removeChild(this)},reparentChild:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return 1===r.length?this.reparentChildAt(r[0],this.children.length):(r.forEach(function(t){return e.reparentChildAt(t,e.children.length)}),r[0])},reparentChildAt:function(e,t){if(e.parent===this)return this.setChildIndex(e,t),e;var r=e.worldTransform.clone();e.removeFromParent(),this.addChildAt(e,t);var n=this.worldTransform.clone();return n.invert(),r.prepend(n),e.setFromMatrix(r),e}},gt=exports.FilterEffect=function(){return B(function e(){C(this,e),this.pipe="filter",this.priority=1},[{key:"destroy",value:function(){for(var e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}])}(),_t=exports.MaskEffectManagerClass=function(){return B(function e(){C(this,e),this._effectClasses=[],this._tests=[],this._initialized=!1},[{key:"init",value:function(){var e=this;this._initialized||(this._initialized=!0,this._effectClasses.forEach(function(t){e.add({test:t.test,maskClass:t})}))}},{key:"add",value:function(e){this._tests.push(e)}},{key:"getMaskEffect",value:function(e){this._initialized||this.init();for(var t=0;t<this._tests.length;t++){var r=this._tests[t];if(r.test(e))return pt.get(r.maskClass,e)}return e}},{key:"returnMaskEffect",value:function(e){pt.return(e)}}])}(),yt=exports.MaskEffectManager=new _t;$.handleByList(Z.MaskEffect,yt._effectClasses);var xt=exports.effectsMixin={_maskEffect:null,_filterEffect:null,effects:[],addEffect:function(e){if(-1===this.effects.indexOf(e)){this.effects.push(e),this.effects.sort(function(e,t){return e.priority-t.priority});var t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0),this._updateIsSimple()}},removeEffect:function(e){var t=this.effects.indexOf(e);-1!==t&&(this.effects.splice(t,1),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateIsSimple())},set mask(e){var t=this._maskEffect;(null==t?void 0:t.mask)!==e&&(t&&(this.removeEffect(t),yt.returnMaskEffect(t),this._maskEffect=null),null!=e&&(this._maskEffect=yt.getMaskEffect(e),this.addEffect(this._maskEffect)))},get mask(){var e;return null==(e=this._maskEffect)?void 0:e.mask},set filters(e){var t;!Array.isArray(e)&&e&&(e=[e]);var r=this._filterEffect||(this._filterEffect=new gt),n=(null==(e=e)?void 0:e.length)>0,i=n!==(null==(t=r.filters)?void 0:t.length)>0;e=Array.isArray(e)?e.slice(0):e,r.filters=Object.freeze(e),i&&(n?this.addEffect(r):(this.removeEffect(r),r.filters=null!=e?e:null))},get filters(){var e;return null==(e=this._filterEffect)?void 0:e.filters},set filterArea(e){this._filterEffect||(this._filterEffect=new gt),this._filterEffect.filterArea=e},get filterArea(){var e;return null==(e=this._filterEffect)?void 0:e.filterArea}},bt=exports.findMixin={label:null,get name(){return ht(lt,"Container.name property has been removed, use Container.label instead"),this.label},set name(e){ht(lt,"Container.name property has been removed, use Container.label instead"),this.label=e},getChildByName:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getChildByLabel(e,t)},getChildByLabel:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.children,n=0;n<r.length;n++){var i=r[n];if(i.label===e||e instanceof RegExp&&e.test(i.label))return i}if(t)for(var a=0;a<r.length;a++){var o=r[a].getChildByLabel(e,!0);if(o)return o}return null},getChildrenByLabel:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=this.children,i=0;i<n.length;i++){var a=n[i];(a.label===e||e instanceof RegExp&&e.test(a.label))&&r.push(a)}if(t)for(var o=0;o<n.length;o++)n[o].getChildrenByLabel(e,!0,r);return r}},Tt=[new $e,new $e,new $e,new $e],St=exports.Rectangle=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;C(this,e),this.type="rectangle",this.x=Number(t),this.y=Number(r),this.width=Number(n),this.height=Number(i)}return B(e,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}},{key:"isEmpty",value:function(){return this.left===this.right||this.top===this.bottom}},{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height)}},{key:"copyFromBounds",value:function(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}},{key:"copyFrom",value:function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}},{key:"copyTo",value:function(e){return e.copyFrom(this),e}},{key:"contains",value:function(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height)}},{key:"strokeContains",value:function(e,t,r){var n=this.width,i=this.height;if(n<=0||i<=0)return!1;var a=this.x,o=this.y;return e>=a-r/2&&e<=a+n+r/2&&t>=o-r/2&&t<=o+i+r/2&&!(e>a+r/2&&e<a+n-r/2&&t>o+r/2&&t<o+i-r/2)}},{key:"intersects",value:function(e,t){if(!t){var r=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=r)return!1;var n=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>n}var i=this.left,a=this.right,o=this.top,s=this.bottom;if(a<=i||s<=o)return!1;var u=Tt[0].set(e.left,e.top),l=Tt[1].set(e.left,e.bottom),c=Tt[2].set(e.right,e.top),h=Tt[3].set(e.right,e.bottom);if(c.x<=u.x||l.y<=u.y)return!1;var d=Math.sign(t.a*t.d-t.b*t.c);if(0===d)return!1;if(t.apply(u,u),t.apply(l,l),t.apply(c,c),t.apply(h,h),Math.max(u.x,l.x,c.x,h.x)<=i||Math.min(u.x,l.x,c.x,h.x)>=a||Math.max(u.y,l.y,c.y,h.y)<=o||Math.min(u.y,l.y,c.y,h.y)>=s)return!1;var f=d*(l.y-u.y),p=d*(u.x-l.x),v=f*i+p*o,m=f*a+p*o,g=f*i+p*s,_=f*a+p*s;if(Math.max(v,m,g,_)<=f*u.x+p*u.y||Math.min(v,m,g,_)>=f*h.x+p*h.y)return!1;var y=d*(u.y-c.y),x=d*(c.x-u.x),b=y*i+x*o,T=y*a+x*o,S=y*i+x*s,k=y*a+x*s;return!(Math.max(b,T,S,k)<=y*u.x+x*u.y||Math.min(b,T,S,k)>=y*h.x+x*h.y)}},{key:"pad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this}},{key:"fit",value:function(e){var t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=n,this.height=Math.max(i-n,0),this}},{key:"ceil",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.001,r=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=n-this.y,this}},{key:"enlarge",value:function(e){var t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=n,this.height=i-n,this}},{key:"getBounds",value:function(t){return(t=t||new e).copyFrom(this),t}},{key:"toString",value:function(){return"[pixi.js/math:Rectangle x=".concat(this.x," y=").concat(this.y," width=").concat(this.width," height=").concat(this.height,"]")}}],[{key:"EMPTY",get:function(){return new e(0,0,0,0)}}])}(),kt=new tt,Et=exports.Bounds=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1/0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1/0;C(this,e),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=kt,this.minX=t,this.minY=r,this.maxX=n,this.maxY=i}return B(e,[{key:"isEmpty",value:function(){return this.minX>this.maxX||this.minY>this.maxY}},{key:"rectangle",get:function(){this._rectangle||(this._rectangle=new St);var e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}},{key:"clear",value:function(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=kt,this}},{key:"set",value:function(e,t,r,n){this.minX=e,this.minY=t,this.maxX=r,this.maxY=n}},{key:"addFrame",value:function(e,t,r,n,i){i||(i=this.matrix);var a=i.a,o=i.b,s=i.c,u=i.d,l=i.tx,c=i.ty,h=this.minX,d=this.minY,f=this.maxX,p=this.maxY,v=a*e+s*t+l,m=o*e+u*t+c;v<h&&(h=v),m<d&&(d=m),v>f&&(f=v),m>p&&(p=m),(v=a*r+s*t+l)<h&&(h=v),(m=o*r+u*t+c)<d&&(d=m),v>f&&(f=v),m>p&&(p=m),(v=a*e+s*n+l)<h&&(h=v),(m=o*e+u*n+c)<d&&(d=m),v>f&&(f=v),m>p&&(p=m),(v=a*r+s*n+l)<h&&(h=v),(m=o*r+u*n+c)<d&&(d=m),v>f&&(f=v),m>p&&(p=m),this.minX=h,this.minY=d,this.maxX=f,this.maxY=p}},{key:"addRect",value:function(e,t){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,t)}},{key:"addBounds",value:function(e,t){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,t)}},{key:"addBoundsMask",value:function(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}},{key:"applyMatrix",value:function(e){var t=this.minX,r=this.minY,n=this.maxX,i=this.maxY,a=e.a,o=e.b,s=e.c,u=e.d,l=e.tx,c=e.ty,h=a*t+s*r+l,d=o*t+u*r+c;this.minX=h,this.minY=d,this.maxX=h,this.maxY=d,h=a*n+s*r+l,d=o*n+u*r+c,this.minX=h<this.minX?h:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=h>this.maxX?h:this.maxX,this.maxY=d>this.maxY?d:this.maxY,h=a*t+s*i+l,d=o*t+u*i+c,this.minX=h<this.minX?h:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=h>this.maxX?h:this.maxX,this.maxY=d>this.maxY?d:this.maxY,h=a*n+s*i+l,d=o*n+u*i+c,this.minX=h<this.minX?h:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=h>this.maxX?h:this.maxX,this.maxY=d>this.maxY?d:this.maxY}},{key:"fit",value:function(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}},{key:"fitBounds",value:function(e,t,r,n){return this.minX<e&&(this.minX=e),this.maxX>t&&(this.maxX=t),this.minY<r&&(this.minY=r),this.maxY>n&&(this.maxY=n),this}},{key:"pad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t,this}},{key:"ceil",value:function(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}},{key:"clone",value:function(){return new e(this.minX,this.minY,this.maxX,this.maxY)}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.minX*=e,this.minY*=t,this.maxX*=e,this.maxY*=t,this}},{key:"x",get:function(){return this.minX},set:function(e){var t=this.maxX-this.minX;this.minX=e,this.maxX=e+t}},{key:"y",get:function(){return this.minY},set:function(e){var t=this.maxY-this.minY;this.minY=e,this.maxY=e+t}},{key:"width",get:function(){return this.maxX-this.minX},set:function(e){this.maxX=this.minX+e}},{key:"height",get:function(){return this.maxY-this.minY},set:function(e){this.maxY=this.minY+e}},{key:"left",get:function(){return this.minX}},{key:"right",get:function(){return this.maxX}},{key:"top",get:function(){return this.minY}},{key:"bottom",get:function(){return this.maxY}},{key:"isPositive",get:function(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}},{key:"isValid",get:function(){return this.minX+this.minY!==1/0}},{key:"addVertexData",value:function(e,t,r,n){var i=this.minX,a=this.minY,o=this.maxX,s=this.maxY;n||(n=this.matrix);for(var u=n.a,l=n.b,c=n.c,h=n.d,d=n.tx,f=n.ty,p=t;p<r;p+=2){var v=e[p],m=e[p+1],g=u*v+c*m+d,_=l*v+h*m+f;i=g<i?g:i,a=_<a?_:a,o=g>o?g:o,s=_>s?_:s}this.minX=i,this.minY=a,this.maxX=o,this.maxY=s}},{key:"containsPoint",value:function(e,t){return this.minX<=e&&this.minY<=t&&this.maxX>=e&&this.maxY>=t}},{key:"toString",value:function(){return"[pixi.js:Bounds minX=".concat(this.minX," minY=").concat(this.minY," maxX=").concat(this.maxX," maxY=").concat(this.maxY," width=").concat(this.width," height=").concat(this.height,"]")}}])}(),At=exports.matrixPool=new dt(tt),wt=exports.boundsPool=new dt(Et);function Rt(e,t,r){var n;return r.clear(),Pt(e,r,e.parent?t?e.parent.worldTransform:Mt(e,n=At.get().identity()):tt.IDENTITY,t),n&&At.return(n),r.isValid||r.set(0,0,0,0),r}function Pt(e,t,r,n){var i,a;if(e.visible&&e.measurable){var o;n?o=e.worldTransform:(e.updateLocalTransform(),(o=At.get()).appendFrom(e.localTransform,r));var s=t,u=!!e.effects.length;if(u&&(t=wt.get().clear()),e.boundsArea)t.addRect(e.boundsArea,o);else{e.addBounds&&(t.matrix=o,e.addBounds(t));for(var l=0;l<e.children.length;l++)Pt(e.children[l],t,o,n)}if(u){for(var c=0;c<e.effects.length;c++)null==(a=(i=e.effects[c]).addBounds)||a.call(i,t);s.addBounds(t,tt.IDENTITY),wt.return(t)}n||At.return(o)}}function Mt(e,t){var r=e.parent;return r&&(Mt(r,t),r.updateLocalTransform(),t.append(r.localTransform)),t}var Ot=0,Ct=500;function Gt(){if(Ot!==Ct)if(++Ot===Ct)console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS.");else{for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).warn.apply(e,["PixiJS Warning: "].concat(r))}}function Bt(e,t,r){return t.clear(),r||(r=tt.IDENTITY),It(e,t,r,e,!0),t.isValid||t.set(0,0,0,0),t}function It(e,t,r,n,i){var a,o,s;if(i)s=At.get(),s=r.copyTo(s);else{if(!e.visible||!e.measurable)return;e.updateLocalTransform();var u=e.localTransform;(s=At.get()).appendFrom(u,r)}var l=t,c=!!e.effects.length;if(c&&(t=wt.get().clear()),e.boundsArea)t.addRect(e.boundsArea,s);else{e.renderPipeId&&(t.matrix=s,e.addBounds(t));for(var h=e.children,d=0;d<h.length;d++)It(h[d],t,s,n,!1)}if(c){for(var f=0;f<e.effects.length;f++)null==(o=(a=e.effects[f]).addLocalBounds)||o.call(a,t,n);l.addBounds(t,tt.IDENTITY),wt.return(t)}At.return(s)}function Ft(e,t,r){var n=e.parent;n?n!==t&&(Ft(n,t,r),n.updateLocalTransform(),r.append(n.localTransform)):Gt("Item is not inside the root container")}function Dt(e,t){for(var r=e.children,n=0;n<r.length;n++){var i=r[n],a=i.uid,o=(65535&i._didViewChangeTick)<<16|65535&i._didContainerChangeTick,s=t.index;t.data[s]===a&&t.data[s+1]===o||(t.data[t.index]=a,t.data[t.index+1]=o,t.didChange=!0),t.index=s+2,i.children.length&&Dt(i,t)}return t.didChange}var Ut=new tt,Lt=exports.measureMixin={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth:function(e,t){var r=Math.sign(this.scale.x)||1;this.scale.x=0!==t?e/t*r:r},_setHeight:function(e,t){var r=Math.sign(this.scale.y)||1;this.scale.y=0!==t?e/t*r:r},getLocalBounds:function(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Et});var e=this._localBoundsCacheData;return e.index=1,e.didChange=!1,e.data[0]!==this._didViewChangeTick&&(e.didChange=!0,e.data[0]=this._didViewChangeTick),Dt(this,e),e.didChange&&Bt(this,e.localBounds,Ut),e.localBounds},getBounds:function(e,t){return Rt(this,e,t||new Et)}},Nt=exports.onRenderMixin={_onRender:null,set onRender(e){var t=this.renderGroup||this.parentRenderGroup;if(!e)return this._onRender&&(null==t||t.removeOnRender(this)),void(this._onRender=null);this._onRender||null==t||t.addOnRender(this),this._onRender=e},get onRender(){return this._onRender}},Xt=exports.sortMixin={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.depthOfChildModified())},depthOfChildModified:function(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren:function(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Ht))}};function Ht(e,t){return e._zIndex-t._zIndex}var jt=exports.toLocalGlobalMixin={getGlobalPosition:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $e,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.parent?this.parent.toGlobal(this._position,e,t):(e.x=this._position.x,e.y=this._position.y),e},toGlobal:function(e,t){if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])){this.updateLocalTransform();var r=Mt(this,new tt);return r.append(this.localTransform),r.apply(e,t)}return this.worldTransform.apply(e,t)},toLocal:function(e,t,r,n){if(t&&(e=t.toGlobal(e,r,n)),!n){this.updateLocalTransform();var i=Mt(this,new tt);return i.append(this.localTransform),i.applyInverse(e,r)}return this.worldTransform.applyInverse(e,r)}},zt=0,Vt=exports.InstructionSet=function(){return B(function e(){C(this,e),this.uid=ot("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.tick=0},[{key:"reset",value:function(){this.instructionSize=0,this.tick=zt++}},{key:"add",value:function(e){this.instructions[this.instructionSize++]=e}},{key:"log",value:function(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}])}(),Wt=exports.RenderGroup=function(){return B(function e(){C(this,e),this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new tt,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Vt,this._onRenderContainers=[]},[{key:"init",value:function(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;for(var t=e.children,r=0;r<t.length;r++)this.addChild(t[r])}},{key:"reset",value:function(){for(var e in this.renderGroupChildren.length=0,this.childrenToUpdate){var t=this.childrenToUpdate[e];t.list.fill(null),t.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null}},{key:"localTransform",get:function(){return this.root.localTransform}},{key:"addRenderGroupChild",value:function(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}},{key:"_removeRenderGroupChild",value:function(e){var t=this.renderGroupChildren.indexOf(e);t>-1&&this.renderGroupChildren.splice(t,1),e.renderGroupParent=null}},{key:"addChild",value:function(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup)this.addRenderGroupChild(e.renderGroup);else{e._onRender&&this.addOnRender(e);for(var t=e.children,r=0;r<t.length;r++)this.addChild(t[r])}}},{key:"removeChild",value:function(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup)this._removeRenderGroupChild(e.renderGroup);else for(var t=e.children,r=0;r<t.length;r++)this.removeChild(t[r])}},{key:"removeChildren",value:function(e){for(var t=0;t<e.length;t++)this.removeChild(e[t])}},{key:"onChildUpdate",value:function(e){var t=this.childrenToUpdate[e.relativeRenderGroupDepth];t||(t=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),t.list[t.index++]=e}},{key:"updateRenderable",value:function(e){e.globalDisplayStatus<7||(e.didViewUpdate=!1,this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e))}},{key:"onChildViewUpdate",value:function(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}},{key:"isRenderable",get:function(){return 7===this.root.localDisplayStatus&&this.worldAlpha>0}},{key:"addOnRender",value:function(e){this._onRenderContainers.push(e)}},{key:"removeOnRender",value:function(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}},{key:"runOnRender",value:function(){for(var e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender()}},{key:"destroy",value:function(){this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}},{key:"getChildren",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.root.children,r=0;r<t.length;r++)this._getChildren(t[r],e);return e}},{key:"_getChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t.push(e),e.renderGroup)return t;for(var r=e.children,n=0;n<r.length;n++)this._getChildren(r[n],t);return t}}])}();function Yt(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(var n in t)r[n]||void 0===t[n]||(e[n]=t[n])}var Kt=new it(null),qt=new it(null),Zt=new it(null,1,1),Qt=exports.UPDATE_COLOR=1,Jt=exports.UPDATE_BLEND=2,$t=exports.UPDATE_VISIBLE=4,er=exports.UPDATE_TRANSFORM=8,tr=exports.Container=function(e){function t(){var e,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return C(this,t),(e=x(this,t)).uid=ot("renderable"),e._updateFlags=15,e.renderGroup=null,e.parentRenderGroup=null,e.parentRenderGroupIndex=0,e.didChange=!1,e.didViewUpdate=!1,e.relativeRenderGroupDepth=0,e.children=[],e.parent=null,e.includeInBuild=!0,e.measurable=!0,e.isSimple=!0,e.updateTick=-1,e.localTransform=new tt,e.relativeGroupTransform=new tt,e.groupTransform=e.relativeGroupTransform,e.destroyed=!1,e._position=new it(e,0,0),e._scale=Zt,e._pivot=qt,e._skew=Kt,e._cx=1,e._sx=0,e._cy=0,e._sy=1,e._rotation=0,e.localColor=16777215,e.localAlpha=1,e.groupAlpha=1,e.groupColor=16777215,e.groupColorAlpha=4294967295,e.localBlendMode="inherit",e.groupBlendMode="normal",e.localDisplayStatus=7,e.globalDisplayStatus=7,e._didContainerChangeTick=0,e._didViewChangeTick=0,e._didLocalTransformChangeId=-1,e.effects=[],Yt(e,i,{children:!0,parent:!0,effects:!0}),null==(r=i.children)||r.forEach(function(t){return e.addChild(t)}),null==(n=i.parent)||n.addChild(e),e}return E(t,ue),B(t,[{key:"_didChangeId",get:function(){return 4095&this._didContainerChangeTick|(4095&this._didViewChangeTick)<<12},set:function(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=4095&e}},{key:"addChild",value:function(){if(this.allowChildren||ht(lt,"addChild: Only Containers will be allowed to add children in v8.0.0"),arguments.length>1){for(var e=0;e<arguments.length;e++)this.addChild(e<0||arguments.length<=e?void 0:arguments[e]);return arguments.length<=0?void 0:arguments[0]}var t=arguments.length<=0?void 0:arguments[0];if(t.parent===this)return this.children.splice(this.children.indexOf(t),1),this.children.push(t),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),t;t.parent&&t.parent.removeChild(t),this.children.push(t),this.sortableChildren&&(this.sortDirty=!0),t.parent=this,t.didChange=!0,t.didViewUpdate=!1,t._updateFlags=15;var r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(t),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this),this._didViewChangeTick++,0!==t._zIndex&&t.depthOfChildModified(),t}},{key:"removeChild",value:function(){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.removeChild(e<0||arguments.length<=e?void 0:arguments[e]);return arguments.length<=0?void 0:arguments[0]}var t=arguments.length<=0?void 0:arguments[0],r=this.children.indexOf(t);return r>-1&&(this._didViewChangeTick++,this.children.splice(r,1),this.renderGroup?this.renderGroup.removeChild(t):this.parentRenderGroup&&this.parentRenderGroup.removeChild(t),t.parent=null,this.emit("childRemoved",t,this,r),t.emit("removed",this)),t}},{key:"_onUpdate",value:function(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,this.didChange||(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}},{key:"isRenderGroup",get:function(){return!!this.renderGroup},set:function(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}},{key:"enableRenderGroup",value:function(){if(!this.renderGroup){var e=this.parentRenderGroup;null==e||e.removeChild(this),this.renderGroup=pt.get(Wt,this),this.groupTransform=tt.IDENTITY,null==e||e.addChild(this),this._updateIsSimple()}}},{key:"disableRenderGroup",value:function(){if(this.renderGroup){var e=this.parentRenderGroup;null==e||e.removeChild(this),pt.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,null==e||e.addChild(this),this._updateIsSimple()}}},{key:"_updateIsSimple",value:function(){this.isSimple=!this.renderGroup&&0===this.effects.length}},{key:"worldTransform",get:function(){return this._worldTransform||(this._worldTransform=new tt),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}},{key:"x",get:function(){return this._position.x},set:function(e){this._position.x=e}},{key:"y",get:function(){return this._position.y},set:function(e){this._position.y=e}},{key:"position",get:function(){return this._position},set:function(e){this._position.copyFrom(e)}},{key:"rotation",get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}},{key:"angle",get:function(){return this.rotation*Qe},set:function(e){this.rotation=e*Je}},{key:"pivot",get:function(){return this._pivot===qt&&(this._pivot=new it(this,0,0)),this._pivot},set:function(e){this._pivot===qt&&(this._pivot=new it(this,0,0)),"number"==typeof e?this._pivot.set(e):this._pivot.copyFrom(e)}},{key:"skew",get:function(){return this._skew===Kt&&(this._skew=new it(this,0,0)),this._skew},set:function(e){this._skew===Kt&&(this._skew=new it(this,0,0)),this._skew.copyFrom(e)}},{key:"scale",get:function(){return this._scale===Zt&&(this._scale=new it(this,1,1)),this._scale},set:function(e){this._scale===Zt&&(this._scale=new it(this,0,0)),"number"==typeof e?this._scale.set(e):this._scale.copyFrom(e)}},{key:"width",get:function(){return Math.abs(this.scale.x*this.getLocalBounds().width)},set:function(e){var t=this.getLocalBounds().width;this._setWidth(e,t)}},{key:"height",get:function(){return Math.abs(this.scale.y*this.getLocalBounds().height)},set:function(e){var t=this.getLocalBounds().height;this._setHeight(e,t)}},{key:"getSize",value:function(e){e||(e={});var t=this.getLocalBounds();return e.width=Math.abs(this.scale.x*t.width),e.height=Math.abs(this.scale.y*t.height),e}},{key:"setSize",value:function(e,t){var r,n=this.getLocalBounds();"object"===D(e)?(t=null!=(r=e.height)?r:e.width,e=e.width):null!=t||(t=e),void 0!==e&&this._setWidth(e,n.width),void 0!==t&&this._setHeight(t,n.height)}},{key:"_updateSkew",value:function(){var e=this._rotation,t=this._skew;this._cx=Math.cos(e+t._y),this._sx=Math.sin(e+t._y),this._cy=-Math.sin(e-t._x),this._sy=Math.cos(e-t._x)}},{key:"updateTransform",value:function(e){return this.position.set("number"==typeof e.x?e.x:this.position.x,"number"==typeof e.y?e.y:this.position.y),this.scale.set("number"==typeof e.scaleX?e.scaleX||1:this.scale.x,"number"==typeof e.scaleY?e.scaleY||1:this.scale.y),this.rotation="number"==typeof e.rotation?e.rotation:this.rotation,this.skew.set("number"==typeof e.skewX?e.skewX:this.skew.x,"number"==typeof e.skewY?e.skewY:this.skew.y),this.pivot.set("number"==typeof e.pivotX?e.pivotX:this.pivot.x,"number"==typeof e.pivotY?e.pivotY:this.pivot.y),this}},{key:"setFromMatrix",value:function(e){e.decompose(this)}},{key:"updateLocalTransform",value:function(){var e=this._didContainerChangeTick;if(this._didLocalTransformChangeId!==e){this._didLocalTransformChangeId=e;var t=this.localTransform,r=this._scale,n=this._pivot,i=this._position,a=r._x,o=r._y,s=n._x,u=n._y;t.a=this._cx*a,t.b=this._sx*a,t.c=this._cy*o,t.d=this._sy*o,t.tx=i._x-(s*t.a+u*t.c),t.ty=i._y-(s*t.b+u*t.d)}}},{key:"alpha",get:function(){return this.localAlpha},set:function(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=Qt,this._onUpdate())}},{key:"tint",get:function(){var e=this.localColor;return((255&e)<<16)+(65280&e)+(e>>16&255)},set:function(e){var t=Ke.shared.setValue(null!=e?e:16777215).toBgrNumber();t!==this.localColor&&(this.localColor=t,this._updateFlags|=Qt,this._onUpdate())}},{key:"blendMode",get:function(){return this.localBlendMode},set:function(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Jt,this.localBlendMode=e,this._onUpdate())}},{key:"visible",get:function(){return!!(2&this.localDisplayStatus)},set:function(e){var t=e?2:0;(2&this.localDisplayStatus)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=$t,this.localDisplayStatus^=2,this._onUpdate())}},{key:"culled",get:function(){return!(4&this.localDisplayStatus)},set:function(e){var t=e?0:4;(4&this.localDisplayStatus)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=$t,this.localDisplayStatus^=4,this._onUpdate())}},{key:"renderable",get:function(){return!!(1&this.localDisplayStatus)},set:function(e){var t=e?1:0;(1&this.localDisplayStatus)!==t&&(this._updateFlags|=$t,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}},{key:"isRenderable",get:function(){return 7===this.localDisplayStatus&&this.groupAlpha>0}},{key:"destroy",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.destroyed){this.destroyed=!0;var r=this.removeChildren(0,this.children.length);if(this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),"boolean"==typeof t?t:null==t?void 0:t.children)for(var n=0;n<r.length;++n)r[n].destroy(t);null==(e=this.renderGroup)||e.destroy(),this.renderGroup=null}}}],[{key:"mixin",value:function(e){Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(e))}}])}();tr.mixin(mt),tr.mixin(jt),tr.mixin(Nt),tr.mixin(Lt),tr.mixin(xt),tr.mixin(bt),tr.mixin(Xt),tr.mixin(qe);var rr,nr=exports.FederatedEvent=function(){return B(function e(t){C(this,e),this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=e.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new $e,this.page=new $e,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t},[{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"data",get:function(){return this}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"initEvent",value:function(e,t,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}},{key:"initUIEvent",value:function(e,t,r,n,i){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])}(),ir=/iPhone/i,ar=/iPod/i,or=/iPad/i,sr=/\biOS-universal(?:.+)Mac\b/i,ur=/\bAndroid(?:.+)Mobile\b/i,lr=/Android/i,cr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,hr=/Silk/i,dr=/Windows Phone/i,fr=/\bWindows(?:.+)ARM\b/i,pr=/BlackBerry/i,vr=/BB10/i,mr=/Opera Mini/i,gr=/\b(CriOS|Chrome)(?:.+)Mobile/i,_r=/Mobile(?:.+)Firefox\b/i,yr=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};function xr(e){return function(t){return t.test(e)}}function br(e){var t={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=t.userAgent,n=r.split("[FBAN");void 0!==n[1]&&(r=n[0]),void 0!==(n=r.split("Twitter"))[1]&&(r=n[0]);var i=xr(r),a={apple:{phone:i(ir)&&!i(dr),ipod:i(ar),tablet:!i(ir)&&(i(or)||yr(t))&&!i(dr),universal:i(sr),device:(i(ir)||i(ar)||i(or)||i(sr)||yr(t))&&!i(dr)},amazon:{phone:i(cr),tablet:!i(cr)&&i(hr),device:i(cr)||i(hr)},android:{phone:!i(dr)&&i(cr)||!i(dr)&&i(ur),tablet:!i(dr)&&!i(cr)&&!i(ur)&&(i(hr)||i(lr)),device:!i(dr)&&(i(cr)||i(hr)||i(ur)||i(lr))||i(/\bokhttp\b/i)},windows:{phone:i(dr),tablet:i(fr),device:i(dr)||i(fr)},other:{blackberry:i(pr),blackberry10:i(vr),opera:i(mr),firefox:i(_r),chrome:i(gr),device:i(pr)||i(vr)||i(mr)||i(_r)||i(gr)},any:!1,phone:!1,tablet:!1};return a.any=a.apple.device||a.android.device||a.windows.device||a.other.device,a.phone=a.apple.phone||a.android.phone||a.windows.phone,a.tablet=a.apple.tablet||a.android.tablet||a.windows.tablet,a}var Tr=null!=(rr=br.default)?rr:br,Sr=exports.isMobile=Tr(globalThis.navigator),kr=9,Er=100,Ar=0,wr=0,Rr=2,Pr=1,Mr=-1e3,Or=-1e3,Cr=2,Gr=exports.AccessibilitySystem=function(){return B(function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sr;C(this,e),this._mobileInfo=r,this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this._pool=[],this._renderId=0,this._children=[],this._androidUpdateCount=0,this._androidUpdateFrequency=500,this._hookDiv=null,(r.tablet||r.phone)&&this._createTouchHook();var n=document.createElement("div");n.style.width="".concat(Er,"px"),n.style.height="".concat(Er,"px"),n.style.position="absolute",n.style.top="".concat(Ar,"px"),n.style.left="".concat(wr,"px"),n.style.zIndex=Rr.toString(),this._div=n,this._renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)},[{key:"isActive",get:function(){return this._isActive}},{key:"isMobileAccessibility",get:function(){return this._isMobileAccessibility}},{key:"hookDiv",get:function(){return this._hookDiv}},{key:"_createTouchHook",value:function(){var e=this,t=document.createElement("button");t.style.width="".concat(Pr,"px"),t.style.height="".concat(Pr,"px"),t.style.position="absolute",t.style.top="".concat(Mr,"px"),t.style.left="".concat(Or,"px"),t.style.zIndex=Cr.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",function(){e._isMobileAccessibility=!0,e._activate(),e._destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}},{key:"_destroyTouchHook",value:function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}},{key:"_activate",value:function(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this._renderer.runners.postrender.add(this),null==(e=this._renderer.view.canvas.parentNode)||e.appendChild(this._div))}},{key:"_deactivate",value:function(){var e;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this._renderer.runners.postrender.remove(this),null==(e=this._div.parentNode)||e.removeChild(this._div))}},{key:"_updateAccessibleObjects",value:function(e){if(e.visible&&e.accessibleChildren){e.accessible&&e.isInteractive()&&(e._accessibleActive||this._addChild(e),e._renderId=this._renderId);var t=e.children;if(t)for(var r=0;r<t.length;r++)this._updateAccessibleObjects(t[r])}}},{key:"init",value:function(e){var t;this.debug=null!=(t=null==e?void 0:e.debug)?t:this.debug,this._renderer.runners.postrender.remove(this)}},{key:"postrender",value:function(){var e=performance.now();if(!(this._mobileInfo.android.device&&e<this._androidUpdateCount)&&(this._androidUpdateCount=e+this._androidUpdateFrequency,this._renderer.renderingToScreen&&this._renderer.view.canvas)){this._renderer.lastObjectRendered&&this._updateAccessibleObjects(this._renderer.lastObjectRendered);var t=this._renderer.view.canvas.getBoundingClientRect(),r=t.x,n=t.y,i=t.width,a=t.height,o=this._renderer,s=o.width,u=o.height,l=o.resolution,c=i/s*l,h=a/u*l,d=this._div;d.style.left="".concat(r,"px"),d.style.top="".concat(n,"px"),d.style.width="".concat(s,"px"),d.style.height="".concat(u,"px");for(var f=0;f<this._children.length;f++){var p=this._children[f];if(p._renderId!==this._renderId)p._accessibleActive=!1,vt(this._children,f,1),this._div.removeChild(p._accessibleDiv),this._pool.push(p._accessibleDiv),p._accessibleDiv=null,f--;else{d=p._accessibleDiv;var v=p.hitArea,m=p.worldTransform;p.hitArea?(d.style.left="".concat((m.tx+v.x*m.a)*c,"px"),d.style.top="".concat((m.ty+v.y*m.d)*h,"px"),d.style.width="".concat(v.width*m.a*c,"px"),d.style.height="".concat(v.height*m.d*h,"px")):(v=p.getBounds().rectangle,this._capHitArea(v),d.style.left="".concat(v.x*c,"px"),d.style.top="".concat(v.y*h,"px"),d.style.width="".concat(v.width*c,"px"),d.style.height="".concat(v.height*h,"px"),d.title!==p.accessibleTitle&&null!==p.accessibleTitle&&(d.title=p.accessibleTitle||""),d.getAttribute("aria-label")!==p.accessibleHint&&null!==p.accessibleHint&&d.setAttribute("aria-label",p.accessibleHint||"")),p.accessibleTitle===d.title&&p.tabIndex===d.tabIndex||(d.title=p.accessibleTitle||"",d.tabIndex=p.tabIndex,this.debug&&this._updateDebugHTML(d))}}this._renderId++}}},{key:"_updateDebugHTML",value:function(e){e.innerHTML="type: ".concat(e.type,"</br> title : ").concat(e.title,"</br> tabIndex: ").concat(e.tabIndex)}},{key:"_capHitArea",value:function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);var t=this._renderer,r=t.width,n=t.height;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>n&&(e.height=n-e.y)}},{key:"_addChild",value:function(e){var t=this._pool.pop();t||((t=document.createElement("button")).style.width="".concat(Er,"px"),t.style.height="".concat(Er,"px"),t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=Rr.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:e.accessibleHint&&null!==e.accessibleHint||(t.title="container ".concat(e.tabIndex)),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this._updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.container=e,this._children.push(e),this._div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}},{key:"_dispatchEvent",value:function(e,t){var r=e.target.container,n=this._renderer.events.rootBoundary,i=Object.assign(new nr(n),{target:r});n.rootTarget=this._renderer.lastObjectRendered,t.forEach(function(e){return n.dispatchEvent(i,e)})}},{key:"_onClick",value:function(e){this._dispatchEvent(e,["click","pointertap","tap"])}},{key:"_onFocus",value:function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}},{key:"_onFocusOut",value:function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}},{key:"_onKeyDown",value:function(e){e.keyCode===kr&&this._activate()}},{key:"_onMouseMove",value:function(e){0===e.movementX&&0===e.movementY||this._deactivate()}},{key:"destroy",value:function(){this._destroyTouchHook(),this._div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this._pool=null,this._children=null,this._renderer=null}}])}();Gr.extension={type:[Z.WebGLSystem,Z.WebGPUSystem],name:"accessibility"};var Br=exports.accessibilityTarget={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,_renderId:-1};$.add(Gr),tr.mixin(Br);var Ir=exports.ResizePlugin=function(){return B(function e(){C(this,e)},null,[{key:"init",value:function(e){var t=this;Object.defineProperty(this,"resizeTo",{set:function(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){t._resizeTo&&(t._cancelResize(),t._resizeId=requestAnimationFrame(function(){return t.resize()}))},this._cancelResize=function(){t._resizeId&&(cancelAnimationFrame(t._resizeId),t._resizeId=null)},this.resize=function(){if(t._resizeTo){var e,r;if(t._cancelResize(),t._resizeTo===globalThis.window)e=globalThis.innerWidth,r=globalThis.innerHeight;else{var n=t._resizeTo;e=n.clientWidth,r=n.clientHeight}t.renderer.resize(e,r),t.render()}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}},{key:"destroy",value:function(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}])}();Ir.extension=Z.Application;var Fr=exports.UPDATE_PRIORITY=function(e){return e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e}(Fr||{}),Dr=exports.TickerListener=function(){return B(function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];C(this,e),this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=r,this.priority=n,this._once=i},[{key:"match",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fn===e&&this._context===t}},{key:"emit",value:function(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));var t=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),t}},{key:"connect",value:function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t}}])}(),Ur=function(){function e(){var t=this;C(this,e),this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Dr(null,null,1/0),this.deltaMS=1/e.targetFPMS,this.elapsedMS=1/e.targetFPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return B(e,[{key:"_requestIfNeeded",value:function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}},{key:"_cancelIfNeeded",value:function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}},{key:"_startIfPossible",value:function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}},{key:"add",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fr.NORMAL;return this._addListener(new Dr(e,t,r))}},{key:"addOnce",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fr.NORMAL;return this._addListener(new Dr(e,t,r,!0))}},{key:"_addListener",value:function(e){var t=this._head.next,r=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}else e.connect(r);return this._startIfPossible(),this}},{key:"remove",value:function(e,t){for(var r=this._head.next;r;)r=r.match(e,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this}},{key:"count",get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e}},{key:"start",value:function(){this.started||(this.started=!0,this._requestIfNeeded())}},{key:"stop",value:function(){this.started&&(this.started=!1,this._cancelIfNeeded())}},{key:"destroy",value:function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}},{key:"update",value:function(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now();if(r>this.lastTime){if((t=this.elapsedMS=r-this.lastTime)>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var n=r-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=r-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*e.targetFPMS;for(var i=this._head,a=i.next;a;)a=a.emit(this);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=r}},{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(t){var r=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,r)/1e3,e.targetFPMS);this._maxElapsedMS=1/n}},{key:"maxFPS",get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(0===e)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}}],[{key:"shared",get:function(){if(!e._shared){var t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared}},{key:"system",get:function(){if(!e._system){var t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system}}])}();Ur.targetFPMS=.06;var Lr=exports.Ticker=Ur,Nr=exports.TickerPlugin=function(){return B(function e(){C(this,e)},null,[{key:"init",value:function(e){var t=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Fr.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Lr.shared:new Lr,e.autoStart&&this.start()}},{key:"destroy",value:function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}}}])}();Nr.extension=Z.Application,$.add(Ir),$.add(Nr);var Xr=function(){return B(function e(){C(this,e),this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0},[{key:"init",value:function(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}},{key:"pauseUpdate",get:function(){return this._pauseUpdate},set:function(e){this._pauseUpdate=e}},{key:"addTickerListener",value:function(){!this._tickerAdded&&this.domElement&&(Lr.system.add(this._tickerUpdate,this,Fr.INTERACTION),this._tickerAdded=!0)}},{key:"removeTickerListener",value:function(){this._tickerAdded&&(Lr.system.remove(this._tickerUpdate,this),this._tickerAdded=!1)}},{key:"pointerMoved",value:function(){this._didMove=!0}},{key:"_update",value:function(){if(this.domElement&&!this._pauseUpdate)if(this._didMove)this._didMove=!1;else{var e=this.events._rootPointerEvent;this.events.supportsTouchEvents&&"touch"===e.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY,pointerType:e.pointerType,pointerId:e.pointerId}))}}},{key:"_tickerUpdate",value:function(e){this._deltaTime+=e.deltaTime,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this._update())}}])}(),Hr=exports.EventsTicker=new Xr,jr=exports.FederatedMouseEvent=function(e){function t(){var e;return C(this,t),(e=x(this,t,arguments)).client=new $e,e.movement=new $e,e.offset=new $e,e.global=new $e,e.screen=new $e,e}return E(t,nr),B(t,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"x",get:function(){return this.clientX}},{key:"y",get:function(){return this.clientY}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getLocalPosition",value:function(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)}},{key:"getModifierState",value:function(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}},{key:"initMouseEvent",value:function(e,t,r,n,i,a,o,s,u,l,c,h,d,f,p){throw new Error("Method not implemented.")}}])}(),zr=exports.FederatedPointerEvent=function(e){function t(){var e;return C(this,t),(e=x(this,t,arguments)).width=0,e.height=0,e.isPrimary=!1,e}return E(t,jr),B(t,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}}])}(),Vr=exports.FederatedWheelEvent=function(e){function t(){var e;return C(this,t),(e=x(this,t,arguments)).DOM_DELTA_PIXEL=0,e.DOM_DELTA_LINE=1,e.DOM_DELTA_PAGE=2,e}return E(t,jr),B(t)}();Vr.DOM_DELTA_PIXEL=0,Vr.DOM_DELTA_LINE=1,Vr.DOM_DELTA_PAGE=2;var Wr=2048,Yr=new $e,Kr=new $e,qr=exports.EventBoundary=function(){return B(function e(t){C(this,e),this.dispatch=new ue,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)},[{key:"addEventMapping",value:function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(e,t){return e.priority-t.priority})}},{key:"dispatchEvent",value:function(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}},{key:"mapEvent",value:function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var r=0,n=t.length;r<n;r++)t[r].fn(e);else Gt("[EventBoundary]: Event mapping not defined for ".concat(e.type))}}},{key:"hitTest",value:function(e,t){Hr.pauseUpdate=!0;var r=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,Yr.set(e,t),this.hitTestFn,this.hitPruneFn);return r&&r[0]}},{key:"propagate",value:function(e,t){if(e.target){var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var n=0,i=r.length-1;n<i;n++)if(e.currentTarget=r[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){e.eventPhase=e.BUBBLING_PHASE;for(var a=r.length-2;a>=0;a--)if(e.currentTarget=r[a],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}}},{key:"all",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._allInteractiveElements;if(0!==n.length){e.eventPhase=e.BUBBLING_PHASE;for(var i=Array.isArray(t)?t:[t],a=function(t){i.forEach(function(i){e.currentTarget=n[t],r.notifyTarget(e,i)})},o=n.length-1;o>=0;o--)a(o)}}},{key:"propagationPath",value:function(e){for(var t=[e],r=0;r<Wr&&e!==this.rootTarget&&e.parent;r++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}},{key:"hitTestMoveRecursive",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=!1;if(this._interactivePrune(e))return null;if("dynamic"!==e.eventMode&&"dynamic"!==t||(Hr.pauseUpdate=!1),e.interactiveChildren&&e.children)for(var s=e.children,u=s.length-1;u>=0;u--){var l=s[u],c=this.hitTestMoveRecursive(l,this._isInteractive(t)?t:l.eventMode,r,n,i,a||i(e,r));if(c){if(c.length>0&&!c[c.length-1].parent)continue;var h=e.isInteractive();(c.length>0||h)&&(h&&this._allInteractiveElements.push(e),c.push(e)),0===this._hitElements.length&&(this._hitElements=c),o=!0}}var d=this._isInteractive(t),f=e.isInteractive();return f&&f&&this._allInteractiveElements.push(e),a||this._hitElements.length>0?null:o?this._hitElements:d&&!i(e,r)&&n(e,r)?f?[e]:[]:null}},{key:"hitTestRecursive",value:function(e,t,r,n,i){if(this._interactivePrune(e)||i(e,r))return null;if("dynamic"!==e.eventMode&&"dynamic"!==t||(Hr.pauseUpdate=!1),e.interactiveChildren&&e.children)for(var a=e.children,o=r,s=a.length-1;s>=0;s--){var u=a[s],l=this.hitTestRecursive(u,this._isInteractive(t)?t:u.eventMode,o,n,i);if(l){if(l.length>0&&!l[l.length-1].parent)continue;var c=e.isInteractive();return(l.length>0||c)&&l.push(e),l}}var h=this._isInteractive(t),d=e.isInteractive();return h&&n(e,r)?d?[e]:[]:null}},{key:"_isInteractive",value:function(e){return"static"===e||"dynamic"===e}},{key:"_interactivePrune",value:function(e){return!(e&&e.visible&&e.renderable&&e.includeInBuild&&e.measurable)||("none"===e.eventMode||"passive"===e.eventMode&&!e.interactiveChildren)}},{key:"hitPruneFn",value:function(e,t){if(e.hitArea&&(e.worldTransform.applyInverse(t,Kr),!e.hitArea.contains(Kr.x,Kr.y)))return!0;if(e.effects&&e.effects.length)for(var r=0;r<e.effects.length;r++){var n=e.effects[r];if(n.containsPoint)if(!n.containsPoint(t,this.hitTestFn))return!0}return!1}},{key:"hitTestFn",value:function(e,t){return!!e.hitArea||!(null==e||!e.containsPoint)&&(e.worldTransform.applyInverse(t,Kr),e.containsPoint(Kr))}},{key:"notifyTarget",value:function(e,t){var r,n;if(e.currentTarget.isInteractive()){t=null!=t?t:e.type;var i="on".concat(t);null==(n=(r=e.currentTarget)[i])||n.call(r,e);var a=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this._notifyListeners(e,a),e.eventPhase===e.AT_TARGET&&this._notifyListeners(e,t)}}},{key:"mapPointerDown",value:function(e){if(e instanceof zr){var t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)this.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){var r=2===t.button;this.dispatchEvent(t,r?"rightdown":"mousedown")}this.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}else Gt("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerMove",value:function(e){var t,r,n;if(e instanceof zr){this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;var i=this.createPointerEvent(e);this._isPointerMoveEvent=!1;var a="mouse"===i.pointerType||"pen"===i.pointerType,o=this.trackingData(e.pointerId),s=this.findMountedTarget(o.overTargets);if((null==(t=o.overTargets)?void 0:t.length)>0&&s!==i.target){var u="mousemove"===e.type?"mouseout":"pointerout",l=this.createPointerEvent(e,u,s);if(this.dispatchEvent(l,"pointerout"),a&&this.dispatchEvent(l,"mouseout"),!i.composedPath().includes(s)){var c=this.createPointerEvent(e,"pointerleave",s);for(c.eventPhase=c.AT_TARGET;c.target&&!i.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),a&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(l)}if(s!==i.target){var h="mousemove"===e.type?"mouseover":"pointerover",d=this.clonePointerEvent(i,h);this.dispatchEvent(d,"pointerover"),a&&this.dispatchEvent(d,"mouseover");for(var f=null==s?void 0:s.parent;f&&f!==this.rootTarget.parent&&f!==i.target;)f=f.parent;if(!f||f===this.rootTarget.parent){var p=this.clonePointerEvent(i,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==s&&p.target!==this.rootTarget.parent;)p.currentTarget=p.target,this.notifyTarget(p),a&&this.notifyTarget(p,"mouseenter"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(d)}var v=[],m=null==(r=this.enableGlobalMoveEvents)||r;this.moveOnAll?v.push("pointermove"):this.dispatchEvent(i,"pointermove"),m&&v.push("globalpointermove"),"touch"===i.pointerType&&(this.moveOnAll?v.splice(1,0,"touchmove"):this.dispatchEvent(i,"touchmove"),m&&v.push("globaltouchmove")),a&&(this.moveOnAll?v.splice(1,0,"mousemove"):this.dispatchEvent(i,"mousemove"),m&&v.push("globalmousemove"),this.cursor=null==(n=i.target)?void 0:n.cursor),v.length>0&&this.all(i,v),this._allInteractiveElements.length=0,this._hitElements.length=0,o.overTargets=i.composedPath(),this.freeEvent(i)}else Gt("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerOver",value:function(e){var t;if(e instanceof zr){var r=this.trackingData(e.pointerId),n=this.createPointerEvent(e),i="mouse"===n.pointerType||"pen"===n.pointerType;this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(this.cursor=null==(t=n.target)?void 0:t.cursor);var a=this.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),i&&this.notifyTarget(a,"mouseenter"),a.target=a.target.parent;r.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(a)}else Gt("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerOut",value:function(e){if(e instanceof zr){var t=this.trackingData(e.pointerId);if(t.overTargets){var r="mouse"===e.pointerType||"pen"===e.pointerType,n=this.findMountedTarget(t.overTargets),i=this.createPointerEvent(e,"pointerout",n);this.dispatchEvent(i),r&&this.dispatchEvent(i,"mouseout");var a=this.createPointerEvent(e,"pointerleave",n);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),r&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;t.overTargets=null,this.freeEvent(i),this.freeEvent(a)}this.cursor=null}else Gt("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerUp",value:function(e){if(e instanceof zr){var t=performance.now(),r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerup"),"touch"===r.pointerType)this.dispatchEvent(r,"touchend");else if("mouse"===r.pointerType||"pen"===r.pointerType){var n=2===r.button;this.dispatchEvent(r,n?"rightup":"mouseup")}var i=this.trackingData(e.pointerId),a=this.findMountedTarget(i.pressTargetsByButton[e.button]),o=a;if(a&&!r.composedPath().includes(a)){for(var s=a;s&&!r.composedPath().includes(s);){if(r.currentTarget=s,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType)this.notifyTarget(r,"touchendoutside");else if("mouse"===r.pointerType||"pen"===r.pointerType){var u=2===r.button;this.notifyTarget(r,u?"rightupoutside":"mouseupoutside")}s=s.parent}delete i.pressTargetsByButton[e.button],o=s}if(o){var l=this.clonePointerEvent(r,"click");l.target=o,l.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:l.target,timeStamp:t});var c=i.clicksByButton[e.button];if(c.target===l.target&&t-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=l.target,c.timeStamp=t,l.detail=c.clickCount,"mouse"===l.pointerType){var h=2===l.button;this.dispatchEvent(l,h?"rightclick":"click")}else"touch"===l.pointerType&&this.dispatchEvent(l,"tap");this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(r)}else Gt("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerUpOutside",value:function(e){if(e instanceof zr){var t=this.trackingData(e.pointerId),r=this.findMountedTarget(t.pressTargetsByButton[e.button]),n=this.createPointerEvent(e);if(r){for(var i=r;i;)n.currentTarget=i,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.notifyTarget(n,2===n.button?"rightupoutside":"mouseupoutside"),i=i.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(n)}else Gt("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapWheel",value:function(e){if(e instanceof Vr){var t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}else Gt("EventBoundary cannot map a non-wheel event as a wheel event")}},{key:"findMountedTarget",value:function(e){if(!e)return null;for(var t=e[0],r=1;r<e.length&&e[r].parent===t;r++)t=e[r];return t}},{key:"createPointerEvent",value:function(e,t,r){var n,i=this.allocateEvent(zr);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=null!=(n=null!=r?r:this.hitTest(i.global.x,i.global.y))?n:this._hitElements[0],"string"==typeof t&&(i.type=t),i}},{key:"createWheelEvent",value:function(e){var t=this.allocateEvent(Vr);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}},{key:"clonePointerEvent",value:function(e,t){var r=this.allocateEvent(zr);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=null!=t?t:r.type,r}},{key:"copyWheelData",value:function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}},{key:"copyPointerData",value:function(e,t){e instanceof zr&&t instanceof zr&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}},{key:"copyMouseData",value:function(e,t){e instanceof jr&&t instanceof jr&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}},{key:"copyData",value:function(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}},{key:"trackingData",value:function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}},{key:"allocateEvent",value:function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}},{key:"freeEvent",value:function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}},{key:"_notifyListeners",value:function(e,t){var r=e.currentTarget._events[t];if(r)if("fn"in r)r.once&&e.currentTarget.removeListener(t,r.fn,void 0,!0),r.fn.call(r.context,e);else for(var n=0,i=r.length;n<i&&!e.propagationImmediatelyStopped;n++)r[n].once&&e.currentTarget.removeListener(t,r[n].fn,void 0,!0),r[n].fn.call(r[n].context,e)}}])}(),Zr=Object.defineProperty,Qr=Object.getOwnPropertySymbols,Jr=Object.prototype.hasOwnProperty,$r=Object.prototype.propertyIsEnumerable,en=function(e,t,r){return t in e?Zr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},tn=function(e,t){for(var r in t||(t={}))Jr.call(t,r)&&en(e,r,t[r]);if(Qr){var n,i=U(Qr(t));try{for(i.s();!(n=i.n()).done;){r=n.value;$r.call(t,r)&&en(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},rn=1,nn={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},an=function(){function e(t){var r=this;C(this,e),this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new qr(null),Hr.init(this),this.autoPreventDefault=!0,this._eventsAdded=!1,this._rootPointerEvent=new zr(null),this._rootWheelEvent=new Vr(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy(tn({},e.defaultEventFeatures),{set:function(e,t,n){return"globalMove"===t&&(r.rootBoundary.enableGlobalMoveEvents=n),e[t]=n,!0}}),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerUp=this._onPointerUp.bind(this),this._onPointerOverOut=this._onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}return B(e,[{key:"init",value:function(t){var r,n,i=this.renderer,a=i.canvas,o=i.resolution;this.setTargetElement(a),this.resolution=o,e._defaultEventMode=null!=(r=t.eventMode)?r:"passive",Object.assign(this.features,null!=(n=t.eventFeatures)?n:{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}},{key:"resolutionChange",value:function(e){this.resolution=e}},{key:"destroy",value:function(){this.setTargetElement(null),this.renderer=null,this._currentCursor=null}},{key:"setCursor",value:function(e){e=e||"default";var t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this._currentCursor!==e){this._currentCursor=e;var r=this.cursorStyles[e];if(r)switch(D(r)){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r)}else t&&"string"==typeof e&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}}},{key:"pointer",get:function(){return this._rootPointerEvent}},{key:"_onPointerDown",value:function(e){if(this.features.click){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;var t=this._normalizeToPointerData(e);if(this.autoPreventDefault&&t[0].isNormalized)(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(var r=0,n=t.length;r<n;r++){var i=t[r],a=this._bootstrapEvent(this._rootPointerEvent,i);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}}},{key:"_onPointerMove",value:function(e){if(this.features.move){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Hr.pointerMoved();for(var t=this._normalizeToPointerData(e),r=0,n=t.length;r<n;r++){var i=this._bootstrapEvent(this._rootPointerEvent,t[r]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}}},{key:"_onPointerUp",value:function(e){if(this.features.click){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;var t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);for(var r=t!==this.domElement?"outside":"",n=this._normalizeToPointerData(e),i=0,a=n.length;i<a;i++){var o=this._bootstrapEvent(this._rootPointerEvent,n[i]);o.type+=r,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}}},{key:"_onPointerOverOut",value:function(e){if(this.features.click){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;for(var t=this._normalizeToPointerData(e),r=0,n=t.length;r<n;r++){var i=this._bootstrapEvent(this._rootPointerEvent,t[r]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}}},{key:"onWheel",value:function(e){if(this.features.wheel){var t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}}},{key:"setTargetElement",value:function(e){this._removeEvents(),this.domElement=e,Hr.domElement=e,this._addEvents()}},{key:"_addEvents",value:function(){if(!this._eventsAdded&&this.domElement){Hr.addTickerListener();var e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this._onPointerMove,!0),this.domElement.addEventListener("pointerdown",this._onPointerDown,!0),this.domElement.addEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this._onPointerOverOut,!0),globalThis.addEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this._onPointerMove,!0),this.domElement.addEventListener("mousedown",this._onPointerDown,!0),this.domElement.addEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this._onPointerOverOut,!0),globalThis.addEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this._onPointerDown,!0),this.domElement.addEventListener("touchend",this._onPointerUp,!0),this.domElement.addEventListener("touchmove",this._onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this._eventsAdded=!0}}},{key:"_removeEvents",value:function(){if(this._eventsAdded&&this.domElement){Hr.removeTickerListener();var e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction="")),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this._onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this._onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this._onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this._onPointerMove,!0),this.domElement.removeEventListener("mousedown",this._onPointerDown,!0),this.domElement.removeEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this._onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this._onPointerDown,!0),this.domElement.removeEventListener("touchend",this._onPointerUp,!0),this.domElement.removeEventListener("touchmove",this._onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this._eventsAdded=!1}}},{key:"mapPositionToPoint",value:function(e,t,r){var n=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},i=1/this.resolution;e.x=(t-n.left)*(this.domElement.width/n.width)*i,e.y=(r-n.top)*(this.domElement.height/n.height)*i}},{key:"_normalizeToPointerData",value:function(e){var t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var r=0,n=e.changedTouches.length;r<n;r++){var i=e.changedTouches[r];void 0===i.button&&(i.button=0),void 0===i.buttons&&(i.buttons=1),void 0===i.isPrimary&&(i.isPrimary=1===e.touches.length&&"touchstart"===e.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=e.type,t.push(i)}else if(globalThis.MouseEvent&&(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof globalThis.PointerEvent))t.push(e);else{var a=e;void 0===a.isPrimary&&(a.isPrimary=!0),void 0===a.width&&(a.width=1),void 0===a.height&&(a.height=1),void 0===a.tiltX&&(a.tiltX=0),void 0===a.tiltY&&(a.tiltY=0),void 0===a.pointerType&&(a.pointerType="mouse"),void 0===a.pointerId&&(a.pointerId=rn),void 0===a.pressure&&(a.pressure=.5),void 0===a.twist&&(a.twist=0),void 0===a.tangentialPressure&&(a.tangentialPressure=0),a.isNormalized=!0,t.push(a)}return t}},{key:"normalizeWheelEvent",value:function(e){var t=this._rootWheelEvent;return this._transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}},{key:"_bootstrapEvent",value:function(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this._transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=nn[e.type]||e.type),e}},{key:"_transferMouseData",value:function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}}],[{key:"defaultEventMode",get:function(){return this._defaultEventMode}}])}();an.extension={name:"events",type:[Z.WebGLSystem,Z.CanvasSystem,Z.WebGPUSystem],priority:-1},an.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};var on=exports.EventSystem=an,sn=exports.FederatedContainer={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,get interactive(){return"dynamic"===this.eventMode||"static"===this.eventMode},set interactive(e){this.eventMode=e?"static":"passive"},_internalEventMode:void 0,get eventMode(){var e;return null!=(e=this._internalEventMode)?e:on.defaultEventMode},set eventMode(e){this._internalEventMode=e},isInteractive:function(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener:function(e,t,r){var n="boolean"==typeof r&&r||"object"===D(r)&&r.capture,i="object"===D(r)?r.signal:void 0,a="object"===D(r)&&!0===r.once,o="function"==typeof t?void 0:t;e=n?"".concat(e,"capture"):e;var s="function"==typeof t?t:t.handleEvent,u=this;i&&i.addEventListener("abort",function(){u.off(e,s,o)}),a?u.once(e,s,o):u.on(e,s,o)},removeEventListener:function(e,t,r){var n="function"==typeof t?void 0:t;e="boolean"==typeof r&&r||"object"===D(r)&&r.capture?"".concat(e,"capture"):e,t="function"==typeof t?t:t.handleEvent,this.off(e,t,n)},dispatchEvent:function(e){if(!(e instanceof nr))throw new Error("Container cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};$.add(on),tr.mixin(sn);var un=exports.LoaderParserPriority=function(e){return e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e}(un||{}),ln=exports.BrowserAdapter={createCanvas:function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:function(){return CanvasRenderingContext2D},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var e;return null!=(e=document.baseURI)?e:window.location.href},getFontFaceSet:function(){return document.fonts},fetch:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){return fetch(e,t)}),parseXML:function(e){return(new DOMParser).parseFromString(e,"text/xml")}},cn=ln,hn=exports.DOMAdapter={get:function(){return cn},set:function(e){cn=e}};function dn(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received ".concat(JSON.stringify(e)))}function fn(e){return e.split("?")[0].split("#")[0]}function pn(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function vn(e,t,r){return e.replace(new RegExp(pn(t),"g"),r)}function mn(e,t){for(var r="",n=0,i=-1,a=0,o=-1,s=0;s<=e.length;++s){if(s<e.length)o=e.charCodeAt(s);else{if(47===o)break;o=47}if(47===o){if(i===s-1||1===a);else if(i!==s-1&&2===a){if(r.length<2||2!==n||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){-1===u?(r="",n=0):n=(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),i=s,a=0;continue}}else if(2===r.length||1===r.length){r="",n=0,i=s,a=0;continue}t&&(r.length>0?r+="/..":r="..",n=2)}else r.length>0?r+="/".concat(e.slice(i+1,s)):r=e.slice(i+1,s),n=s-i-1;i=s,a=0}else 46===o&&-1!==a?++a:a=-1}return r}var gn=exports.path={toPosix:function(e){return vn(e,"\\","/")},isUrl:function(e){return/^https?:/.test(this.toPosix(e))},isDataUrl:function(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},isBlobUrl:function(e){return e.startsWith("blob:")},hasProtocol:function(e){return/^[^/:]+:/.test(this.toPosix(e))},getProtocol:function(e){dn(e),e=this.toPosix(e);var t=/^file:\/\/\//.exec(e);if(t)return t[0];var r=/^[^/:]+:\/{0,2}/.exec(e);return r?r[0]:""},toAbsolute:function(e,t,r){if(dn(e),this.isDataUrl(e)||this.isBlobUrl(e))return e;var n=fn(this.toPosix(null!=t?t:hn.get().getBaseUrl())),i=fn(this.toPosix(null!=r?r:this.rootname(n)));return(e=this.toPosix(e)).startsWith("/")?gn.join(i,e.slice(1)):this.isAbsolute(e)?e:this.join(n,e)},normalize:function(e){if(dn(e),0===e.length)return".";if(this.isDataUrl(e)||this.isBlobUrl(e))return e;var t="",r=(e=this.toPosix(e)).startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));var n=e.endsWith("/");return(e=mn(e,!1)).length>0&&n&&(e+="/"),r?"/".concat(e):t+e},isAbsolute:function(e){return dn(e),e=this.toPosix(e),!!this.hasProtocol(e)||e.startsWith("/")},join:function(){var e,t;if(0===arguments.length)return".";for(var r=0;r<arguments.length;++r){var n=r<0||arguments.length<=r?void 0:arguments[r];if(dn(n),n.length>0)if(void 0===t)t=n;else{var i=null!=(e=r-1<0||arguments.length<=r-1?void 0:arguments[r-1])?e:"";this.joinExtensions.includes(this.extname(i).toLowerCase())?t+="/../".concat(n):t+="/".concat(n)}}return void 0===t?".":this.normalize(t)},dirname:function(e){if(dn(e),0===e.length)return".";for(var t=(e=this.toPosix(e)).charCodeAt(0),r=47===t,n=-1,i=!0,a=this.getProtocol(e),o=e,s=(e=e.slice(a.length)).length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!i){n=s;break}}else i=!1;return-1===n?r?"/":this.isUrl(o)?a+e:a:r&&1===n?"//":a+e.slice(0,n)},rootname:function(e){dn(e);var t="";if(t=(e=this.toPosix(e)).startsWith("/")?"/":this.getProtocol(e),this.isUrl(e)){var r=e.indexOf("/",t.length);(t=-1!==r?e.slice(0,r):e).endsWith("/")||(t+="/")}return t},basename:function(e,t){dn(e),t&&dn(t),e=fn(this.toPosix(e));var r,n=0,i=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var o=t.length-1,s=-1;for(r=e.length-1;r>=0;--r){var u=e.charCodeAt(r);if(47===u){if(!a){n=r+1;break}}else-1===s&&(a=!1,s=r+1),o>=0&&(u===t.charCodeAt(o)?-1==--o&&(i=r):(o=-1,i=s))}return n===i?i=s:-1===i&&(i=e.length),e.slice(n,i)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!a){n=r+1;break}}else-1===i&&(a=!1,i=r+1);return-1===i?"":e.slice(n,i)},extname:function(e){dn(e);for(var t=-1,r=0,n=-1,i=!0,a=0,o=(e=fn(this.toPosix(e))).length-1;o>=0;--o){var s=e.charCodeAt(o);if(47!==s)-1===n&&(i=!1,n=o+1),46===s?-1===t?t=o:1!==a&&(a=1):-1!==t&&(a=-1);else if(!i){r=o+1;break}}return-1===t||-1===n||0===a||1===a&&t===n-1&&t===r+1?"":e.slice(t,n)},parse:function(e){dn(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var r,n=(e=fn(this.toPosix(e))).charCodeAt(0),i=this.isAbsolute(e);t.root=this.rootname(e),r=i||this.hasProtocol(e)?1:0;for(var a=-1,o=0,s=-1,u=!0,l=e.length-1,c=0;l>=r;--l)if(47!==(n=e.charCodeAt(l)))-1===s&&(u=!1,s=l+1),46===n?-1===a?a=l:1!==c&&(c=1):-1!==a&&(c=-1);else if(!u){o=l+1;break}return-1===a||-1===s||0===c||1===c&&a===s-1&&a===o+1?-1!==s&&(t.base=t.name=0===o&&i?e.slice(1,s):e.slice(o,s)):(0===o&&i?(t.name=e.slice(1,a),t.base=e.slice(1,s)):(t.name=e.slice(o,a),t.base=e.slice(o,s)),t.ext=e.slice(a,s)),t.dir=this.dirname(e),t},sep:"/",delimiter:":",joinExtensions:[".html"]},_n=exports.convertToList=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Array.isArray(e)||(e=[e]),t?e.map(function(e){return"string"==typeof e||r?t(e):e}):e};function yn(e,t,r,n,i){for(var a=t[r],o=0;o<a.length;o++){var s=a[o];r<t.length-1?yn(e.replace(n[r],s),t,r+1,n,i):i.push(e.replace(n[r],s))}}function xn(e){var t=e.match(/\{(.*?)\}/g),r=[];if(t){var n=[];t.forEach(function(e){var t=e.substring(1,e.length-1).split(",");n.push(t)}),yn(e,n,0,t,r)}else r.push(e);return r}var bn=exports.isSingleItem=function(e){return!Array.isArray(e)},Tn=Object.defineProperty,Sn=Object.getOwnPropertySymbols,kn=Object.prototype.hasOwnProperty,En=Object.prototype.propertyIsEnumerable,An=function(e,t,r){return t in e?Tn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},wn=function(e,t){for(var r in t||(t={}))kn.call(t,r)&&An(e,r,t[r]);if(Sn){var n,i=U(Sn(t));try{for(i.s();!(n=i.n()).done;){r=n.value;En.call(t,r)&&An(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Rn=exports.Resolver=function(){return B(function e(){var t=this;C(this,e),this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:function(e,r){return"".concat(e).concat(t._bundleIdConnector).concat(r)},extractAssetIdFromBundle:function(e,r){return r.replace("".concat(e).concat(t._bundleIdConnector),"")}},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}},[{key:"setBundleIdentifier",value:function(e){var t,r,n;if(this._bundleIdConnector=null!=(t=e.connector)?t:this._bundleIdConnector,this._createBundleAssetId=null!=(r=e.createBundleAssetId)?r:this._createBundleAssetId,this._extractAssetIdFromBundle=null!=(n=e.extractAssetIdFromBundle)?n:this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}},{key:"prefer",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach(function(t){e._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}},{key:"basePath",get:function(){return this._basePath},set:function(e){this._basePath=e}},{key:"rootPath",get:function(){return this._rootPath},set:function(e){this._rootPath=e}},{key:"parsers",get:function(){return this._parsers}},{key:"reset",value:function(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}},{key:"setDefaultSearchParams",value:function(e){if("string"==typeof e)this._defaultSearchParams=e;else{var t=e;this._defaultSearchParams=Object.keys(t).map(function(e){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t[e]))}).join("&")}}},{key:"getAlias",value:function(e){var t=e.alias,r=e.src;return _n(t||r,function(e){return"string"==typeof e?e:Array.isArray(e)?e.map(function(e){var t;return null!=(t=null==e?void 0:e.src)?t:e}):(null==e?void 0:e.src)?e.src:e},!0)}},{key:"addManifest",value:function(e){var t=this;this._manifest&&Gt("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(function(e){t.addBundle(e.name,e.assets)})}},{key:"addBundle",value:function(e,t){var r=this,n=[],i=t;Array.isArray(t)||(i=Object.entries(t).map(function(e){var t=R(e,2),r=t[0],n=t[1];return"string"==typeof n||Array.isArray(n)?{alias:r,src:n}:wn({alias:r},n)})),i.forEach(function(t){var i,a=t.src,o=t.alias;if("string"==typeof o){var s=r._createBundleAssetId(e,o);n.push(s),i=[o,s]}else{var u=o.map(function(t){return r._createBundleAssetId(e,t)});n.push.apply(n,m(u)),i=[].concat(m(o),m(u))}r.add(wn(wn({},t),{alias:i,src:a}))}),this._bundles[e]=n}},{key:"add",value:function(e){var t,r=this,n=[];Array.isArray(e)?n.push.apply(n,m(e)):n.push(e),t=function(e){r.hasKey(e)&&Gt("[Resolver] already has key: ".concat(e," overwriting"))},_n(n).forEach(function(e){var n=e.src,i=e.data,a=e.format,o=e.loadParser,s=_n(n).map(function(e){return"string"==typeof e?xn(e):Array.isArray(e)?e:[e]}),u=r.getAlias(e);Array.isArray(u)?u.forEach(t):t(u);var l=[];s.forEach(function(e){e.forEach(function(e){var t,n,s,c={};if("object"!==D(e)){c.src=e;for(var h=0;h<r._parsers.length;h++){var d=r._parsers[h];if(d.test(e)){c=d.parse(e);break}}}else i=null!=(t=e.data)?t:i,a=null!=(n=e.format)?n:a,o=null!=(s=e.loadParser)?s:o,c=wn(wn({},c),e);if(!u)throw new Error("[Resolver] alias is undefined for this asset: ".concat(c.src));c=r._buildResolvedAsset(c,{aliases:u,data:i,format:a,loadParser:o}),l.push(c)})}),u.forEach(function(e){r._assetMap[e]=l})})}},{key:"resolveBundle",value:function(e){var t=this,r=bn(e);e=_n(e);var n={};return e.forEach(function(e){var r=t._bundles[e];if(r){var i=t.resolve(r),a={};for(var o in i){var s=i[o];a[t._extractAssetIdFromBundle(e,o)]=s}n[e]=a}}),r?n[e[0]]:n}},{key:"resolveUrl",value:function(e){var t=this.resolve(e);if("string"!=typeof e){var r={};for(var n in t)r[n]=t[n].src;return r}return t.src}},{key:"resolve",value:function(e){var t=this,r=bn(e);e=_n(e);var n={};return e.forEach(function(e){if(!t._resolverHash[e])if(t._assetMap[e]){var r=t._assetMap[e],i=t._getPreferredOrder(r);null==i||i.priority.forEach(function(e){i.params[e].forEach(function(t){var n=r.filter(function(r){return!!r[e]&&r[e]===t});n.length&&(r=n)})}),t._resolverHash[e]=r[0]}else t._resolverHash[e]=t._buildResolvedAsset({alias:[e],src:e},{});n[e]=t._resolverHash[e]}),r?n[e[0]]:n}},{key:"hasKey",value:function(e){return!!this._assetMap[e]}},{key:"hasBundle",value:function(e){return!!this._bundles[e]}},{key:"_getPreferredOrder",value:function(e){for(var t,r=this,n=function(){var t=e[0],n=r._preferredOrder.find(function(e){return e.params.format.includes(t.format)});if(n)return{v:n}},i=0;i<e.length;i++)if(t=n())return t.v;return this._preferredOrder[0]}},{key:"_appendDefaultSearchParams",value:function(e){if(!this._defaultSearchParams)return e;var t=/\?/.test(e)?"&":"?";return"".concat(e).concat(t).concat(this._defaultSearchParams)}},{key:"_buildResolvedAsset",value:function(e,t){var r,n,i=t.aliases,a=t.data,o=t.loadParser,s=t.format;return(this._basePath||this._rootPath)&&(e.src=gn.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=null!=(r=null!=i?i:e.alias)?r:[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data=wn(wn({},a||{}),e.data),e.loadParser=null!=o?o:e.loadParser,e.format=null!=(n=null!=s?s:e.format)?n:Pn(e.src),e}}])}();function Pn(e){return e.split(".").pop().split("?").shift().split("#").shift()}Rn.RETINA_PREFIX=/@([0-9\.]+)x/;var Mn=exports.copySearchParams=function(e,t){var r=t.split("?")[1];return r&&(e+="?".concat(r)),e},On=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Cn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Gn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Bn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],In=[],Fn=[],Dn=Math.sign;function Un(){for(var e=0;e<16;e++){var t=[];In.push(t);for(var r=0;r<16;r++)for(var n=Dn(On[e]*On[r]+Gn[e]*Cn[r]),i=Dn(Cn[e]*On[r]+Bn[e]*Cn[r]),a=Dn(On[e]*Gn[r]+Gn[e]*Bn[r]),o=Dn(Cn[e]*Gn[r]+Bn[e]*Bn[r]),s=0;s<16;s++)if(On[s]===n&&Cn[s]===i&&Gn[s]===a&&Bn[s]===o){t.push(s);break}}for(var u=0;u<16;u++){var l=new tt;l.set(On[u],Cn[u],Gn[u],Bn[u],0,0),Fn.push(l)}}Un();var Ln=exports.groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(e){return On[e]},uY:function(e){return Cn[e]},vX:function(e){return Gn[e]},vY:function(e){return Bn[e]},inv:function(e){return 8&e?15&e:7&-e},add:function(e,t){return In[e][t]},sub:function(e,t){return In[e][Ln.inv(t)]},rotate180:function(e){return 4^e},isVertical:function(e){return 2==(3&e)},byDirection:function(e,t){return 2*Math.abs(e)<=Math.abs(t)?t>=0?Ln.S:Ln.N:2*Math.abs(t)<=Math.abs(e)?e>0?Ln.E:Ln.W:t>0?e>0?Ln.SE:Ln.SW:e>0?Ln.NE:Ln.NW},matrixAppendRotationInv:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=Fn[Ln.inv(t)];i.tx=r,i.ty=n,e.append(i)}},Nn=exports.NOOP=function(){};function Xn(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1}function Hn(e){return!(e&e-1||!e)}function jn(e){var t=(e>65535?1:0)<<4,r=((e>>>=t)>255?1:0)<<3;return t|=r,t|=r=((e>>>=r)>15?1:0)<<2,(t|=r=((e>>>=r)>3?1:0)<<1)|(e>>>=r)>>1}function zn(e){var t={};for(var r in e)void 0!==e[r]&&(t[r]=e[r]);return t}var Vn=Object.defineProperty,Wn=Object.getOwnPropertySymbols,Yn=Object.prototype.hasOwnProperty,Kn=Object.prototype.propertyIsEnumerable,qn=function(e,t,r){return t in e?Vn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Zn=function(e,t){for(var r in t||(t={}))Yn.call(t,r)&&qn(e,r,t[r]);if(Wn){var n,i=U(Wn(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Kn.call(t,r)&&qn(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Qn=Object.create(null);function Jn(e){var t=Qn[e];return void 0===t&&(Qn[e]=ot("resource")),t}var $n=function(e){function t(){var e,r,n,i,a,o,s,u,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return C(this,t),(e=x(this,t))._resourceType="textureSampler",e._touched=0,e._maxAnisotropy=1,e.destroyed=!1,l=Zn(Zn({},t.defaultOptions),l),e.addressMode=l.addressMode,e.addressModeU=null!=(r=l.addressModeU)?r:e.addressModeU,e.addressModeV=null!=(n=l.addressModeV)?n:e.addressModeV,e.addressModeW=null!=(i=l.addressModeW)?i:e.addressModeW,e.scaleMode=l.scaleMode,e.magFilter=null!=(a=l.magFilter)?a:e.magFilter,e.minFilter=null!=(o=l.minFilter)?o:e.minFilter,e.mipmapFilter=null!=(s=l.mipmapFilter)?s:e.mipmapFilter,e.lodMinClamp=l.lodMinClamp,e.lodMaxClamp=l.lodMaxClamp,e.compare=l.compare,e.maxAnisotropy=null!=(u=l.maxAnisotropy)?u:1,e}return E(t,ue),B(t,[{key:"addressMode",get:function(){return this.addressModeU},set:function(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}},{key:"wrapMode",get:function(){return this.addressMode},set:function(e){ht(lt,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}},{key:"scaleMode",get:function(){return this.magFilter},set:function(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}},{key:"maxAnisotropy",get:function(){return this._maxAnisotropy},set:function(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}},{key:"_resourceId",get:function(){return this._sharedResourceId||this._generateResourceId()}},{key:"update",value:function(){this.emit("change",this),this._sharedResourceId=null}},{key:"_generateResourceId",value:function(){var e="".concat(this.addressModeU,"-").concat(this.addressModeV,"-").concat(this.addressModeW,"-").concat(this.magFilter,"-").concat(this.minFilter,"-").concat(this.mipmapFilter,"-").concat(this.lodMinClamp,"-").concat(this.lodMaxClamp,"-").concat(this.compare,"-").concat(this._maxAnisotropy);return this._sharedResourceId=Jn(e),this._resourceId}},{key:"destroy",value:function(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}}])}();$n.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};var ei=exports.TextureStyle=$n,ti=Object.defineProperty,ri=Object.getOwnPropertySymbols,ni=Object.prototype.hasOwnProperty,ii=Object.prototype.propertyIsEnumerable,ai=function(e,t,r){return t in e?ti(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},oi=function(e,t){for(var r in t||(t={}))ni.call(t,r)&&ai(e,r,t[r]);if(ri){var n,i=U(ri(t));try{for(i.s();!(n=i.n()).done;){r=n.value;ii.call(t,r)&&ai(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},si=function(e){function t(){var e,r,n,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return C(this,t),(e=x(this,t)).options=a,e.uid=ot("textureSource"),e._resourceType="textureSource",e._resourceId=ot("resource"),e.uploadMethodId="unknown",e._resolution=1,e.pixelWidth=1,e.pixelHeight=1,e.width=1,e.height=1,e.sampleCount=1,e.mipLevelCount=1,e.autoGenerateMipmaps=!1,e.format="rgba8unorm",e.dimension="2d",e.antialias=!1,e._touched=0,e._batchTick=-1,e._textureBindLocation=-1,a=oi(oi({},t.defaultOptions),a),e.label=null!=(r=a.label)?r:"",e.resource=a.resource,e.autoGarbageCollect=a.autoGarbageCollect,e._resolution=a.resolution,a.width?e.pixelWidth=a.width*e._resolution:e.pixelWidth=e.resource&&null!=(n=e.resourceWidth)?n:1,a.height?e.pixelHeight=a.height*e._resolution:e.pixelHeight=e.resource&&null!=(i=e.resourceHeight)?i:1,e.width=e.pixelWidth/e._resolution,e.height=e.pixelHeight/e._resolution,e.format=a.format,e.dimension=a.dimensions,e.mipLevelCount=a.mipLevelCount,e.autoGenerateMipmaps=a.autoGenerateMipmaps,e.sampleCount=a.sampleCount,e.antialias=a.antialias,e.alphaMode=a.alphaMode,e.style=new ei(zn(a)),e.destroyed=!1,e._refreshPOT(),e}return E(t,ue),B(t,[{key:"source",get:function(){return this}},{key:"style",get:function(){return this._style},set:function(e){var t,r;this.style!==e&&(null==(t=this._style)||t.off("change",this._onStyleChange,this),this._style=e,null==(r=this._style)||r.on("change",this._onStyleChange,this),this._onStyleChange())}},{key:"addressMode",get:function(){return this._style.addressMode},set:function(e){this._style.addressMode=e}},{key:"repeatMode",get:function(){return this._style.addressMode},set:function(e){this._style.addressMode=e}},{key:"magFilter",get:function(){return this._style.magFilter},set:function(e){this._style.magFilter=e}},{key:"minFilter",get:function(){return this._style.minFilter},set:function(e){this._style.minFilter=e}},{key:"mipmapFilter",get:function(){return this._style.mipmapFilter},set:function(e){this._style.mipmapFilter=e}},{key:"lodMinClamp",get:function(){return this._style.lodMinClamp},set:function(e){this._style.lodMinClamp=e}},{key:"lodMaxClamp",get:function(){return this._style.lodMaxClamp},set:function(e){this._style.lodMaxClamp=e}},{key:"_onStyleChange",value:function(){this.emit("styleChange",this)}},{key:"update",value:function(){if(this.resource){var e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}},{key:"destroy",value:function(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}},{key:"unload",value:function(){this._resourceId=ot("resource"),this.emit("change",this),this.emit("unload",this)}},{key:"resourceWidth",get:function(){var e=this.resource;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}},{key:"resourceHeight",get:function(){var e=this.resource;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}},{key:"resolution",get:function(){return this._resolution},set:function(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}},{key:"resize",value:function(e,t,r){r=r||this._resolution,e=e||this.width,t=t||this.height;var n=Math.round(e*r),i=Math.round(t*r);return this.width=n/r,this.height=i/r,this._resolution=r,(this.pixelWidth!==n||this.pixelHeight!==i)&&(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=i,this.emit("resize",this),this._resourceId=ot("resource"),this.emit("change",this),!0)}},{key:"updateMipmaps",value:function(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}},{key:"wrapMode",get:function(){return this._style.wrapMode},set:function(e){this._style.wrapMode=e}},{key:"scaleMode",get:function(){return this._style.scaleMode},set:function(e){this._style.scaleMode=e}},{key:"_refreshPOT",value:function(){this.isPowerOfTwo=Hn(this.pixelWidth)&&Hn(this.pixelHeight)}}],[{key:"test",value:function(e){throw new Error("Unimplemented")}}])}();si.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};var ui=exports.TextureSource=si,li=Object.defineProperty,ci=Object.defineProperties,hi=Object.getOwnPropertyDescriptors,di=Object.getOwnPropertySymbols,fi=Object.prototype.hasOwnProperty,pi=Object.prototype.propertyIsEnumerable,vi=function(e,t,r){return t in e?li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},mi=function(e,t){for(var r in t||(t={}))fi.call(t,r)&&vi(e,r,t[r]);if(di){var n,i=U(di(t));try{for(i.s();!(n=i.n()).done;){r=n.value;pi.call(t,r)&&vi(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},gi=function(e,t){return ci(e,hi(t))},_i=exports.BufferImageSource=function(e){function t(e){var r;C(this,t);var n=e.resource||new Float32Array(e.width*e.height*4),i=e.format;return i||(i=n instanceof Float32Array?"rgba32float":n instanceof Int32Array?"rgba32uint":n instanceof Uint32Array?"rgba32uint":n instanceof Int16Array?"rgba16uint":n instanceof Uint16Array?"rgba16uint":(Int8Array,"bgra8unorm")),(r=x(this,t,[gi(mi({},e),{resource:n,format:i})])).uploadMethodId="buffer",r}return E(t,ui),B(t,null,[{key:"test",value:function(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}])}();_i.extension=Z.TextureSource;var yi=new tt,xi=exports.TextureMatrix=function(){return B(function e(t,r){C(this,e),this.mapCoord=new tt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===r?t.width<10?0:.5:r,this.isSimple=!1,this.texture=t},[{key:"texture",get:function(){return this._texture},set:function(e){var t;this.texture!==e&&(null==(t=this._texture)||t.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}},{key:"multiplyUvs",value:function(e,t){void 0===t&&(t=e);for(var r=this.mapCoord,n=0;n<e.length;n+=2){var i=e[n],a=e[n+1];t[n]=i*r.a+a*r.c+r.tx,t[n+1]=i*r.b+a*r.d+r.ty}return t}},{key:"update",value:function(){var e=this._texture;this._updateID++;var t=e.uvs;this.mapCoord.set(t.x1-t.x0,t.y1-t.y0,t.x3-t.x0,t.y3-t.y0,t.x0,t.y0);var r=e.orig,n=e.trim;n&&(yi.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(yi));var i=e.source,a=this.uClampFrame,o=this.clampMargin/i._resolution,s=this.clampOffset/i._resolution;return a[0]=(e.frame.x+o+s)/i.width,a[1]=(e.frame.y+o+s)/i.height,a[2]=(e.frame.x+e.frame.width-o+s)/i.width,a[3]=(e.frame.y+e.frame.height-o+s)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=e.frame.width===i.width&&e.frame.height===i.height&&0===e.rotate,!0}}])}(),bi=exports.Texture=function(e){function t(){var e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.source,a=n.label,o=n.frame,s=n.orig,u=n.trim,l=n.defaultAnchor,c=n.defaultBorders,h=n.rotate,d=n.dynamic;if(C(this,t),(e=x(this,t)).uid=ot("texture"),e.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},e.frame=new St,e.noFrame=!1,e.dynamic=!1,e.isTexture=!0,e.label=a,e.source=null!=(r=null==i?void 0:i.source)?r:new ui,e.noFrame=!o,o)e.frame.copyFrom(o);else{var f=e._source,p=f.width,v=f.height;e.frame.width=p,e.frame.height=v}return e.orig=s||e.frame,e.trim=u,e.rotate=null!=h?h:0,e.defaultAnchor=l,e.defaultBorders=c,e.destroyed=!1,e.dynamic=d||!1,e.updateUvs(),e}return E(t,ue),B(t,[{key:"source",get:function(){return this._source},set:function(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}},{key:"textureMatrix",get:function(){return this._textureMatrix||(this._textureMatrix=new xi(this)),this._textureMatrix}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}},{key:"updateUvs",value:function(){var e=this.uvs,t=this.frame,r=this._source,n=r.width,i=r.height,a=t.x/n,o=t.y/i,s=t.width/n,u=t.height/i,l=this.rotate;if(l){var c=s/2,h=u/2,d=a+c,f=o+h;l=Ln.add(l,Ln.NW),e.x0=d+c*Ln.uX(l),e.y0=f+h*Ln.uY(l),l=Ln.add(l,2),e.x1=d+c*Ln.uX(l),e.y1=f+h*Ln.uY(l),l=Ln.add(l,2),e.x2=d+c*Ln.uX(l),e.y2=f+h*Ln.uY(l),l=Ln.add(l,2),e.x3=d+c*Ln.uX(l),e.y3=f+h*Ln.uY(l)}else e.x0=a,e.y0=o,e.x1=a+s,e.y1=o,e.x2=a+s,e.y2=o+u,e.x3=a,e.y3=o+u}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}},{key:"update",value:function(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}},{key:"baseTexture",get:function(){return ht(lt,"Texture.baseTexture is now Texture.source"),this._source}}])}();bi.EMPTY=new bi({label:"EMPTY",source:new ui({label:"EMPTY"})}),bi.EMPTY.destroy=Nn,bi.WHITE=new bi({source:new _i({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"}),bi.WHITE.destroy=Nn;var Ti=function(){function e(t,r){C(this,e),this.linkedSheets=[],this._texture=t instanceof bi?t:null,this.textureSource=t.source,this.textures={},this.animations={},this.data=r;var n=parseFloat(r.meta.scale);n?(this.resolution=n,t.source.resolution=this.resolution):this.resolution=t.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return B(e,[{key:"parse",value:function(){var t=this;return new Promise(function(r){t._callback=r,t._batchIndex=0,t._frameKeys.length<=e.BATCH_SIZE?(t._processFrames(0),t._processAnimations(),t._parseComplete()):t._nextBatch()})}},{key:"_processFrames",value:function(t){for(var r=t,n=e.BATCH_SIZE;r-t<n&&r<this._frameKeys.length;){var i=this._frameKeys[r],a=this._frames[i],o=a.frame;if(o){var s=null,u=null,l=!1!==a.trimmed&&a.sourceSize?a.sourceSize:a.frame,c=new St(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);s=a.rotated?new St(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):new St(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),!1!==a.trimmed&&a.spriteSourceSize&&(u=new St(Math.floor(a.spriteSourceSize.x)/this.resolution,Math.floor(a.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new bi({source:this.textureSource,frame:s,orig:c,trim:u,rotate:a.rotated?2:0,defaultAnchor:a.anchor,defaultBorders:a.borders,label:i.toString()})}r++}}},{key:"_processAnimations",value:function(){var e=this.data.animations||{};for(var t in e){this.animations[t]=[];for(var r=0;r<e[t].length;r++){var n=e[t][r];this.animations[t].push(this.textures[n])}}}},{key:"_parseComplete",value:function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}},{key:"_nextBatch",value:function(){var t=this;this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*e.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)}},{key:"destroy",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null==(e=this._texture)||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}}])}();Ti.BATCH_SIZE=1e3;var Si=exports.Spritesheet=Ti,ki=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Ei(e,t,r){var n={};if(e.forEach(function(e){n[e]=t}),Object.keys(t.textures).forEach(function(e){n[e]=t.textures[e]}),!r){var i=gn.dirname(e[0]);t.linkedSheets.forEach(function(e,r){var a=Ei(["".concat(i,"/").concat(t.data.meta.related_multi_packs[r])],e,!0);Object.assign(n,a)})}return n}var Ai=exports.spritesheetAsset={extension:Z.Asset,cache:{test:function(e){return e instanceof Si},getCacheableAssets:function(e,t){return Ei(e,t,!1)}},resolver:{extension:{type:Z.ResolveParser,name:"resolveSpritesheet"},test:function(e){var t=e.split("?")[0].split("."),r=t.pop(),n=t.pop();return"json"===r&&ki.includes(n)},parse:function(e){var t,r,n=e.split(".");return{resolution:parseFloat(null!=(r=null==(t=Rn.RETINA_PREFIX.exec(e))?void 0:t[1])?r:"1"),format:n[n.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:Z.LoadParser,priority:un.Normal,name:"spritesheetLoader"},testParse:function(e,t){return v(f().mark(function r(){return f().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",".json"===gn.extname(t.src).toLowerCase()&&!!e.frames);case 1:case"end":return r.stop()}},r)}))()},parse:function(e,t,r){return v(f().mark(function n(){var i,a,o,s,u,l,c,h,d,p,v,m,g,_,y,x,b,T;return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(s=null!=(i=null==t?void 0:t.data)?i:{},u=s.texture,l=s.imageFilename,(c=gn.dirname(t.src))&&c.lastIndexOf("/")!==c.length-1&&(c+="/"),!(u instanceof bi)){n.next=7;break}h=u,n.next=12;break;case 7:return d=Mn(c+(null!=l?l:e.meta.image),t.src),n.next=10,r.load([d]);case 10:p=n.sent,h=p[d];case 12:return v=new Si(h.source,e),n.next=15,v.parse();case 15:if(m=null==(a=null==e?void 0:e.meta)?void 0:a.related_multi_packs,!Array.isArray(m)){n.next=45;break}g=[],_=U(m),n.prev=19,_.s();case 21:if((y=_.n()).done){n.next=32;break}if("string"==typeof(x=y.value)){n.next=25;break}return n.abrupt("continue",30);case 25:if(b=c+x,!(null==(o=t.data)?void 0:o.ignoreMultiPack)){n.next=28;break}return n.abrupt("continue",30);case 28:b=Mn(b,t.src),g.push(r.load({src:b,data:{ignoreMultiPack:!0}}));case 30:n.next=21;break;case 32:n.next=37;break;case 34:n.prev=34,n.t0=n.catch(19),_.e(n.t0);case 37:return n.prev=37,_.f(),n.finish(37);case 40:return n.next=42,Promise.all(g);case 42:T=n.sent,v.linkedSheets=T,T.forEach(function(e){e.linkedSheets=[v].concat(v.linkedSheets.filter(function(t){return t!==e}))});case 45:return n.abrupt("return",v);case 46:case"end":return n.stop()}},n,null,[[19,34,37,40]])}))()},unload:function(e,t,r){return v(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.unload(e.textureSource._sourceOrigin);case 2:e.destroy(!1);case 3:case"end":return t.stop()}},t)}))()}}};function wi(e,t,r,n){var i=r.orig,a=i.width,o=i.height,s=r.trim;if(s){var u=s.width,l=s.height;e.minX=s.x-t._x*a-n,e.maxX=e.minX+u,e.minY=s.y-t._y*o-n,e.maxY=e.minY+l}else e.minX=-t._x*a-n,e.maxX=e.minX+a,e.minY=-t._y*o-n,e.maxY=e.minY+o}$.add(Ai);var Ri=exports.ViewContainer=function(e){function t(){var e;return C(this,t),(e=x(this,t,arguments)).canBundle=!0,e.allowChildren=!1,e._roundPixels=0,e._lastUsed=0,e._lastInstructionTick=-1,e._bounds=new Et(0,1,0,0),e._boundsDirty=!0,e}return E(t,tr),B(t,[{key:"_updateBounds",value:function(){}},{key:"roundPixels",get:function(){return!!this._roundPixels},set:function(e){this._roundPixels=e?1:0}},{key:"containsPoint",value:function(e){var t=this.bounds,r=e.x,n=e.y;return r>=t.minX&&r<=t.maxX&&n>=t.minY&&n<=t.maxY}},{key:"destroy",value:function(e){c(t,"destroy",this,3)([e]),this._bounds=null}}])}(),Pi=Object.defineProperty,Mi=Object.getOwnPropertySymbols,Oi=Object.prototype.hasOwnProperty,Ci=Object.prototype.propertyIsEnumerable,Gi=function(e,t,r){return t in e?Pi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Bi=function(e,t){for(var r in t||(t={}))Oi.call(t,r)&&Gi(e,r,t[r]);if(Mi){var n,i=U(Mi(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Ci.call(t,r)&&Gi(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Ii=function(e,t){var r={};for(var n in e)Oi.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Mi){var i,a=U(Mi(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&Ci.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},Fi=exports.Sprite=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bi.EMPTY;C(this,t),r instanceof bi&&(r={texture:r});var n=r,i=n.texture,a=void 0===i?bi.EMPTY:i,o=n.anchor,s=n.roundPixels,u=n.width,l=n.height,c=Ii(n,["texture","anchor","roundPixels","width","height"]);return(e=x(this,t,[Bi({label:"Sprite"},c)])).renderPipeId="sprite",e.batched=!0,e._didSpriteUpdate=!1,e._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},e._sourceBoundsDirty=!0,e._anchor=new it({_onUpdate:function(){e.onViewUpdate()}}),o?e.anchor=o:a.defaultAnchor&&(e.anchor=a.defaultAnchor),e.texture=a,e.allowChildren=!1,e.roundPixels=null!=s&&s,void 0!==u&&(e.width=u),void 0!==l&&(e.height=l),e}return E(t,Ri),B(t,[{key:"texture",get:function(){return this._texture},set:function(e){e||(e=bi.EMPTY);var t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}},{key:"bounds",get:function(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}},{key:"sourceBounds",get:function(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}},{key:"containsPoint",value:function(e){var t=this.sourceBounds;return e.x>=t.maxX&&e.x<=t.minX&&e.y>=t.maxY&&e.y<=t.minY}},{key:"addBounds",value:function(e){var t=this._texture.trim?this.sourceBounds:this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}},{key:"onViewUpdate",value:function(){if(this._didViewChangeTick++,this._didSpriteUpdate=!0,this._sourceBoundsDirty=this._boundsDirty=!0,!this.didViewUpdate){this.didViewUpdate=!0;var e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}}},{key:"_updateBounds",value:function(){wi(this._bounds,this._anchor,this._texture,0)}},{key:"_updateSourceBounds",value:function(){var e=this._anchor,t=this._texture,r=this._sourceBounds,n=t.orig,i=n.width,a=n.height;r.maxX=-e._x*i,r.minX=r.maxX+i,r.maxY=-e._y*a,r.minY=r.maxY+a}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(c(t,"destroy",this,3)([e]),"boolean"==typeof e?e:null==e?void 0:e.texture){var r="boolean"==typeof e?e:null==e?void 0:e.textureSource;this._texture.destroy(r)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}},{key:"anchor",get:function(){return this._anchor},set:function(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)}},{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this._setWidth(e,this._texture.orig.width),this._width=e}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this._setHeight(e,this._texture.orig.height),this._height=e}},{key:"getSize",value:function(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}},{key:"setSize",value:function(e,t){var r;"object"===D(e)?(t=null!=(r=e.height)?r:e.width,e=e.width):null!=t||(t=e),void 0!==e&&this._setWidth(e,this._texture.orig.width),void 0!==t&&this._setHeight(t,this._texture.orig.height)}}],[{key:"from",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new t(e instanceof bi?e:bi.from(e,r))}}])}(),Di=new Et;function Ui(e,t,r){var n=Di;e.measurable=!0,Rt(e,r,n),t.addBoundsMask(n),e.measurable=!1}function Li(e,t,r){var n=wt.get();e.measurable=!0;var i=At.get().identity();Bt(e,n,Ni(e,r,i)),e.measurable=!1,t.addBoundsMask(n),At.return(i),wt.return(n)}function Ni(e,t,r){return e?(e!==t&&(Ni(e.parent,t,r),e.updateLocalTransform(),r.append(e.localTransform)),r):(Gt("Mask bounds, renderable is not inside the root container"),r)}var Xi=exports.AlphaMask=function(){return B(function e(t){C(this,e),this.priority=0,this.pipe="alphaMask",(null==t?void 0:t.mask)&&this.init(t.mask)},[{key:"init",value:function(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Fi),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}},{key:"reset",value:function(){this.mask.measurable=!0,this.mask=null}},{key:"addBounds",value:function(e,t){Ui(this.mask,e,t)}},{key:"addLocalBounds",value:function(e,t){Li(this.mask,e,t)}},{key:"containsPoint",value:function(e,t){return t(this.mask,e)}},{key:"destroy",value:function(){this.reset()}}],[{key:"test",value:function(e){return e instanceof Fi}}])}();Xi.extension=Z.MaskEffect;var Hi=exports.ColorMask=function(){return B(function e(t){C(this,e),this.priority=0,this.pipe="colorMask",(null==t?void 0:t.mask)&&this.init(t.mask)},[{key:"init",value:function(e){this.mask=e}},{key:"destroy",value:function(){}}],[{key:"test",value:function(e){return"number"==typeof e}}])}();Hi.extension=Z.MaskEffect;var ji=exports.StencilMask=function(){return B(function e(t){C(this,e),this.priority=0,this.pipe="stencilMask",(null==t?void 0:t.mask)&&this.init(t.mask)},[{key:"init",value:function(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}},{key:"reset",value:function(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}},{key:"addBounds",value:function(e,t){Ui(this.mask,e,t)}},{key:"addLocalBounds",value:function(e,t){Li(this.mask,e,t)}},{key:"containsPoint",value:function(e,t){return t(this.mask,e)}},{key:"destroy",value:function(){this.reset()}}],[{key:"test",value:function(e){return e instanceof tr}}])}();ji.extension=Z.MaskEffect;var zi=exports.CanvasSource=function(e){function t(e){var r;C(this,t),e.resource||(e.resource=hn.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),(r=x(this,t,[e])).uploadMethodId="image",r.autoDensity=e.autoDensity;var n=e.resource;return r.pixelWidth===n.width&&r.pixelWidth===n.height||r.resizeCanvas(),r.transparent=!!e.transparent,r}return E(t,ui),B(t,[{key:"resizeCanvas",value:function(){this.autoDensity&&(this.resource.style.width="".concat(this.width,"px"),this.resource.style.height="".concat(this.height,"px")),this.resource.width===this.pixelWidth&&this.resource.height===this.pixelHeight||(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.width,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.height,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._resolution,i=c(t,"resize",this,3)([e,r,n]);return i&&this.resizeCanvas(),i}},{key:"context2D",get:function(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}],[{key:"test",value:function(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}}])}();zi.extension=Z.TextureSource;var Vi,Wi=exports.ImageSource=function(e){function t(e){var r;if(C(this,t),e.resource&&globalThis.HTMLImageElement&&e.resource instanceof HTMLImageElement){var n=hn.get().createCanvas(e.resource.width,e.resource.height);n.getContext("2d").drawImage(e.resource,0,0,e.resource.width,e.resource.height),e.resource=n,Gt("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}return(r=x(this,t,[e])).uploadMethodId="image",r.autoGarbageCollect=!0,r}return E(t,ui),B(t,null,[{key:"test",value:function(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}])}();function Yi(){return Ki.apply(this,arguments)}function Ki(){return(Ki=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null!=Vi||(Vi=v(f().mark(function e(){var t,r,n,i,a,o,s;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=document.createElement("canvas"),n=r.getContext("webgl")){e.next=4;break}return e.abrupt("return","premultiply-alpha-on-upload");case 4:return e.next=6,new Promise(function(e){var t=document.createElement("video");t.onloadeddata=function(){return e(t)},t.onerror=function(){return e(null)},t.autoplay=!1,t.crossOrigin="anonymous",t.preload="auto",t.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",t.load()});case 6:if(i=e.sent){e.next=9;break}return e.abrupt("return","premultiply-alpha-on-upload");case 9:return a=n.createTexture(),n.bindTexture(n.TEXTURE_2D,a),o=n.createFramebuffer(),n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,a,0),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i),s=new Uint8Array(4),n.readPixels(0,0,1,1,n.RGBA,n.UNSIGNED_BYTE,s),n.deleteFramebuffer(o),n.deleteTexture(a),null==(t=n.getExtension("WEBGL_lose_context"))||t.loseContext(),e.abrupt("return",s[0]<=s[3]?"premultiplied-alpha":"premultiply-alpha-on-upload");case 23:case"end":return e.stop()}},e)}))()),e.abrupt("return",Vi);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}Wi.extension=Z.TextureSource;var qi=Object.defineProperty,Zi=Object.defineProperties,Qi=Object.getOwnPropertyDescriptors,Ji=Object.getOwnPropertySymbols,$i=Object.prototype.hasOwnProperty,ea=Object.prototype.propertyIsEnumerable,ta=function(e,t,r){return t in e?qi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ra=function(e,t){for(var r in t||(t={}))$i.call(t,r)&&ta(e,r,t[r]);if(Ji){var n,i=U(Ji(t));try{for(i.s();!(n=i.n()).done;){r=n.value;ea.call(t,r)&&ta(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},na=function(e,t){return Zi(e,Qi(t))},ia=function(e){function t(e){var r,n;return C(this,t),(r=x(this,t,[e])).isReady=!1,r.uploadMethodId="video",e=ra(ra({},t.defaultOptions),e),r._autoUpdate=!0,r._isConnectedToTicker=!1,r._updateFPS=e.updateFPS||0,r._msToNextUpdate=0,r.autoPlay=!1!==e.autoPlay,r.alphaMode=null!=(n=e.alphaMode)?n:"premultiply-alpha-on-upload",r._videoFrameRequestCallback=r._videoFrameRequestCallback.bind(r),r._videoFrameRequestCallbackHandle=null,r._load=null,r._resolve=null,r._reject=null,r._onCanPlay=r._onCanPlay.bind(r),r._onCanPlayThrough=r._onCanPlayThrough.bind(r),r._onError=r._onError.bind(r),r._onPlayStart=r._onPlayStart.bind(r),r._onPlayStop=r._onPlayStop.bind(r),r._onSeeked=r._onSeeked.bind(r),!1!==e.autoLoad&&r.load(),r}return E(t,ui),B(t,[{key:"updateFrame",value:function(){if(!this.destroyed){if(this._updateFPS){var e=Lr.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}},{key:"_videoFrameRequestCallback",value:function(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}},{key:"isValid",get:function(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}},{key:"load",value:function(){var e=v(f().mark(function e(){var t,r,n=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._load){e.next=2;break}return e.abrupt("return",this._load);case 2:return t=this.resource,r=this.options,(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(r.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),e.next=11,Yi();case 11:return this.alphaMode=e.sent,this._load=new Promise(function(e,i){n.isValid?e(n):(n._resolve=e,n._reject=i,void 0!==r.preloadTimeoutMs&&(n._preloadTimeout=setTimeout(function(){n._onError(new ErrorEvent("Preload exceeded timeout of ".concat(r.preloadTimeoutMs,"ms")))})),t.load())}),e.abrupt("return",this._load);case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_onError",value:function(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}},{key:"_isSourcePlaying",value:function(){var e=this.resource;return!e.paused&&!e.ended}},{key:"_isSourceReady",value:function(){return this.resource.readyState>2}},{key:"_onPlayStart",value:function(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}},{key:"_onPlayStop",value:function(){this._configureAutoUpdate()}},{key:"_onSeeked",value:function(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}},{key:"_onCanPlay",value:function(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}},{key:"_onCanPlayThrough",value:function(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}},{key:"_mediaReady",value:function(){var e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}},{key:"destroy",value:function(){this._configureAutoUpdate();var e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),c(t,"destroy",this,3)([])}},{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}},{key:"updateFPS",get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}},{key:"_configureAutoUpdate",value:function(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Lr.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Lr.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Lr.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}}],[{key:"test",value:function(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}}])}();ia.extension=Z.TextureSource,ia.defaultOptions=na(ra({},ui.defaultOptions),{autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1}),ia.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};var aa=exports.VideoSource=ia,oa=function(){return B(function e(){C(this,e),this._parsers=[],this._cache=new Map,this._cacheMap=new Map},[{key:"reset",value:function(){this._cacheMap.clear(),this._cache.clear()}},{key:"has",value:function(e){return this._cache.has(e)}},{key:"get",value:function(e){var t=this._cache.get(e);return t||Gt("[Assets] Asset id ".concat(e," was not found in the Cache")),t}},{key:"set",value:function(e,t){for(var r,n=this,i=_n(e),a=0;a<this.parsers.length;a++){var o=this.parsers[a];if(o.test(t)){r=o.getCacheableAssets(i,t);break}}var s=new Map(Object.entries(r||{}));r||i.forEach(function(e){s.set(e,t)});var u=m(s.keys()),l={cacheKeys:u,keys:i};i.forEach(function(e){n._cacheMap.set(e,l)}),u.forEach(function(e){var i=r?r[e]:t;n._cache.has(e)&&n._cache.get(e)!==i&&Gt("[Cache] already has key:",e),n._cache.set(e,s.get(e))})}},{key:"remove",value:function(e){var t=this;if(this._cacheMap.has(e)){var r=this._cacheMap.get(e);r.cacheKeys.forEach(function(e){t._cache.delete(e)}),r.keys.forEach(function(e){t._cacheMap.delete(e)})}else Gt("[Assets] Asset id ".concat(e," was not found in the Cache"))}},{key:"parsers",get:function(){return this._parsers}}])}(),sa=exports.Cache=new oa,ua=[];function la(){return ca(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function ca(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e&&e.resource,r=t?e.resource:e,n=t?e:{resource:e},i=0;i<ua.length;i++){var a=ua[i];if(a.test(r))return new a(n)}throw new Error("Could not find a source type for resource: ".concat(n.resource))}function ha(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e&&e.resource,n=r?e.resource:e,i=r?e:{resource:e};if(!t&&sa.has(n))return sa.get(n);var a=new bi({source:ca(i)});return a.on("destroy",function(){sa.has(n)&&sa.remove(n)}),t||sa.set(n,a),a}function da(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"string"==typeof e?sa.get(e):e instanceof ui?new bi({source:e}):ha(e,t)}$.handleByList(Z.TextureSource,ua),bi.from=da,ui.from=ca,$.add(Xi,Hi,ji,aa,Wi,zi,_i);var fa,pa=exports.BindGroup=function(){return B(function e(t){C(this,e),this.resources=Object.create(null),this._dirty=!0;var r=0;for(var n in t){var i=t[n];this.setResource(i,r++)}this._updateKey()},[{key:"_updateKey",value:function(){if(this._dirty){this._dirty=!1;var e=[],t=0;for(var r in this.resources)e[t++]=this.resources[r]._resourceId;this._key=e.join("|")}}},{key:"setResource",value:function(e,t){var r,n,i=this.resources[t];e!==i&&(i&&(null==(r=e.off)||r.call(e,"change",this.onResourceChange,this)),null==(n=e.on)||n.call(e,"change",this.onResourceChange,this),this.resources[t]=e,this._dirty=!0)}},{key:"getResource",value:function(e){return this.resources[e]}},{key:"_touch",value:function(e){var t=this.resources;for(var r in t)t[r]._touched=e}},{key:"destroy",value:function(){var e,t=this.resources;for(var r in t){var n=t[r];null==(e=n.off)||e.call(n,"change",this.onResourceChange,this)}this.resources=null}},{key:"onResourceChange",value:function(e){if(this._dirty=!0,e.destroyed){var t=this.resources;for(var r in t)t[r]===e&&(t[r]=null)}else this._updateKey()}}])}();function va(){if(!fa||(null==fa?void 0:fa.isContextLost())){var e=hn.get().createCanvas();fa=e.getContext("webgl",{})}return fa}var ma=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function ga(e){for(var t="",r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+="if(test == ".concat(r,".0){}"));return t}function _a(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");var r=t.createShader(t.FRAGMENT_SHADER);try{for(;;){var n=ma.replace(/%forloop%/gi,ga(e));if(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}}finally{t.deleteShader(r)}return e}var ya=null;function xa(){var e;if(ya)return ya;var t=va();return ya=_a(ya=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),t),null==(e=t.getExtension("WEBGL_lose_context"))||e.loseContext(),ya}var ba={};function Ta(e,t){for(var r=2166136261,n=0;n<t;n++)r^=e[n].uid,r=Math.imul(r,16777619),r>>>=0;return ba[r]||ka(e,t,r)}var Sa=0;function ka(e,t,r){var n={},i=0;Sa||(Sa=xa());for(var a=0;a<Sa;a++){var o=a<t?e[a]:bi.EMPTY.source;n[i++]=o.source,n[i++]=o.style}var s=new pa(n);return ba[r]=s,s}var Ea=exports.ViewableBuffer=function(){return B(function e(t){C(this,e),"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength},[{key:"int8View",get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}},{key:"uint8View",get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}},{key:"int16View",get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}},{key:"int32View",get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}},{key:"float64View",get:function(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}},{key:"bigUint64View",get:function(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}},{key:"view",value:function(e){return this["".concat(e,"View")]}},{key:"destroy",value:function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}}],[{key:"sizeOf",value:function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error("".concat(e," isn't a valid view type"))}}}])}();function Aa(e,t){var r=e.byteLength/8|0,n=new Float64Array(e,0,r);new Float64Array(t,0,r).set(n);var i=e.byteLength-8*r;if(i>0){var a=new Uint8Array(e,8*r,i);new Uint8Array(t,8*r,i).set(a)}}var wa=exports.BLEND_TO_NPM={normal:"normal-npm",add:"add-npm",screen:"screen-npm"},Ra=exports.STENCIL_MODES=function(e){return e[e.DISABLED=0]="DISABLED",e[e.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",e[e.MASK_ACTIVE=2]="MASK_ACTIVE",e[e.RENDERING_MASK_REMOVE=3]="RENDERING_MASK_REMOVE",e[e.NONE=4]="NONE",e}(Ra||{});function Pa(e,t){return"no-premultiply-alpha"===t.alphaMode&&wa[e]||e}var Ma=exports.BatchTextureArray=function(){return B(function e(){C(this,e),this.ids=Object.create(null),this.textures=[],this.count=0},[{key:"clear",value:function(){for(var e=0;e<this.count;e++){var t=this.textures[e];this.textures[e]=null,this.ids[t.uid]=null}this.count=0}}])}(),Oa=Object.defineProperty,Ca=Object.getOwnPropertySymbols,Ga=Object.prototype.hasOwnProperty,Ba=Object.prototype.propertyIsEnumerable,Ia=function(e,t,r){return t in e?Oa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Fa=function(e,t){for(var r in t||(t={}))Ga.call(t,r)&&Ia(e,r,t[r]);if(Ca){var n,i=U(Ca(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Ba.call(t,r)&&Ia(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Da=exports.Batch=function(){return B(function e(){C(this,e),this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new Ma,this.blendMode="normal",this.canBundle=!0},[{key:"destroy",value:function(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}])}(),Ua=[],La=0;function Na(){return La>0?Ua[--La]:new Da}function Xa(e){Ua[La++]=e}var Ha=0,ja=function(){return B(function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};C(this,e),this.uid=ot("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],e.defaultOptions.maxTextures=null!=(t=e.defaultOptions.maxTextures)?t:xa();var n=r=Fa(Fa({},e.defaultOptions),r),i=n.maxTextures,a=n.attributesInitialSize,o=n.indicesInitialSize;this.attributeBuffer=new Ea(4*a),this.indexBuffer=new Uint16Array(o),this.maxTextures=i},[{key:"begin",value:function(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(var e=0;e<this.batchIndex;e++)Xa(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}},{key:"add",value:function(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}},{key:"checkAndUpdateTexture",value:function(e,t){var r=e._batch.textures.ids[t._source.uid];return!(!r&&0!==r)&&(e._textureId=r,e.texture=t,!0)}},{key:"updateElement",value:function(e){this.dirty=!0;var t=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId)}},{key:"break",value:function(e){var t=this._elements;if(t[this.elementStart]){var r=Na(),n=r.textures;n.clear();var i=t[this.elementStart],a=Pa(i.blendMode,i.texture._source);4*this.attributeSize>this.attributeBuffer.size&&this._resizeAttributeBuffer(4*this.attributeSize),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);for(var o=this.attributeBuffer.float32View,s=this.attributeBuffer.uint32View,u=this.indexBuffer,l=this._batchIndexSize,c=this._batchIndexStart,h="startBatch",d=this.maxTextures,f=this.elementStart;f<this.elementSize;++f){var p=t[f];t[f]=null;var v=p.texture._source,m=Pa(p.blendMode,v),g=a!==m;v._batchTick!==Ha||g?(v._batchTick=Ha,(n.count>=d||g)&&(this._finishBatch(r,c,l-c,n,a,e,h),h="renderBatch",c=l,a=m,(n=(r=Na()).textures).clear(),++Ha),p._textureId=v._textureBindLocation=n.count,n.ids[v.uid]=n.count,n.textures[n.count++]=v,p._batch=r,l+=p.indexSize,p.packAsQuad?(this.packQuadAttributes(p,o,s,p._attributeStart,p._textureId),this.packQuadIndex(u,p._indexStart,p._attributeStart/this.vertexSize)):(this.packAttributes(p,o,s,p._attributeStart,p._textureId),this.packIndex(p,u,p._indexStart,p._attributeStart/this.vertexSize))):(p._textureId=v._textureBindLocation,l+=p.indexSize,p.packAsQuad?(this.packQuadAttributes(p,o,s,p._attributeStart,p._textureId),this.packQuadIndex(u,p._indexStart,p._attributeStart/this.vertexSize)):(this.packAttributes(p,o,s,p._attributeStart,p._textureId),this.packIndex(p,u,p._indexStart,p._attributeStart/this.vertexSize)),p._batch=r)}n.count>0&&(this._finishBatch(r,c,l-c,n,a,e,h),c=l,++Ha),this.elementStart=this.elementSize,this._batchIndexStart=c,this._batchIndexSize=l}}},{key:"_finishBatch",value:function(e,t,r,n,i,a,o){e.gpuBindGroup=null,e.bindGroup=null,e.action=o,e.batcher=this,e.textures=n,e.blendMode=i,e.start=t,e.size=r,++Ha,this.batches[this.batchIndex++]=e,a.add(e)}},{key:"finish",value:function(e){this.break(e)}},{key:"ensureAttributeBuffer",value:function(e){4*e<=this.attributeBuffer.size||this._resizeAttributeBuffer(4*e)}},{key:"ensureIndexBuffer",value:function(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}},{key:"_resizeAttributeBuffer",value:function(e){var t=Math.max(e,2*this.attributeBuffer.size),r=new Ea(t);Aa(this.attributeBuffer.rawBinaryData,r.rawBinaryData),this.attributeBuffer=r}},{key:"_resizeIndexBuffer",value:function(e){var t=this.indexBuffer,r=Math.max(e,1.5*t.length),n=(r+=r%2)>65535?new Uint32Array(r):new Uint16Array(r);if(n.BYTES_PER_ELEMENT!==t.BYTES_PER_ELEMENT)for(var i=0;i<t.length;i++)n[i]=t[i];else Aa(t.buffer,n.buffer);this.indexBuffer=n}},{key:"packQuadIndex",value:function(e,t,r){e[t]=r+0,e[t+1]=r+1,e[t+2]=r+2,e[t+3]=r+0,e[t+4]=r+2,e[t+5]=r+3}},{key:"packIndex",value:function(e,t,r,n){for(var i=e.indices,a=e.indexSize,o=e.indexOffset,s=e.attributeOffset,u=0;u<a;u++)t[r++]=n+i[u+o]-s}},{key:"destroy",value:function(){for(var e=0;e<this.batches.length;e++)Xa(this.batches[e]);this.batches=null;for(var t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}])}();ja.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};var za=exports.Batcher=ja,Va=exports.BufferUsage=function(e){return e[e.MAP_READ=1]="MAP_READ",e[e.MAP_WRITE=2]="MAP_WRITE",e[e.COPY_SRC=4]="COPY_SRC",e[e.COPY_DST=8]="COPY_DST",e[e.INDEX=16]="INDEX",e[e.VERTEX=32]="VERTEX",e[e.UNIFORM=64]="UNIFORM",e[e.STORAGE=128]="STORAGE",e[e.INDIRECT=256]="INDIRECT",e[e.QUERY_RESOLVE=512]="QUERY_RESOLVE",e[e.STATIC=1024]="STATIC",e}(Va||{}),Wa=exports.Buffer=function(e){function t(e){var r;C(this,t);var n=e.data,i=e.size,a=e.usage,o=e.label,s=e.shrinkToFit;(r=x(this,t)).uid=ot("buffer"),r._resourceType="buffer",r._resourceId=ot("resource"),r._touched=0,r._updateID=1,r.shrinkToFit=!0,r.destroyed=!1,n instanceof Array&&(n=new Float32Array(n)),r._data=n,i=null!=i?i:null==n?void 0:n.byteLength;var u=!!n;return r.descriptor={size:i,usage:a,mappedAtCreation:u,label:o},r.shrinkToFit=null==s||s,r}return E(t,ue),B(t,[{key:"data",get:function(){return this._data},set:function(e){this.setDataWithSize(e,e.length,!0)}},{key:"static",get:function(){return!!(this.descriptor.usage&Va.STATIC)},set:function(e){e?this.descriptor.usage|=Va.STATIC:this.descriptor.usage&=~Va.STATIC}},{key:"setDataWithSize",value:function(e,t,r){if(this._updateID++,this._updateSize=t*e.BYTES_PER_ELEMENT,this._data!==e){var n=this._data;this._data=e,n.length===e.length?r&&this.emit("update",this):!this.shrinkToFit&&e.byteLength<n.byteLength?r&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=ot("resource"),this.emit("change",this))}else r&&this.emit("update",this)}},{key:"update",value:function(e){this._updateSize=null!=e?e:this._updateSize,this._updateID++,this.emit("update",this)}},{key:"destroy",value:function(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}])}();function Ya(e,t){if(!(e instanceof Wa)){var r=t?Va.INDEX:Va.VERTEX;e instanceof Array&&(t?(e=new Uint32Array(e),r=Va.INDEX|Va.COPY_DST):(e=new Float32Array(e),r=Va.VERTEX|Va.COPY_DST)),e=new Wa({data:e,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:r})}return e}function Ka(e,t,r){var n=e.getAttribute(t);if(!n)return r.minX=0,r.minY=0,r.maxX=0,r.maxY=0,r;for(var i=n.buffer.data,a=1/0,o=1/0,s=-1/0,u=-1/0,l=i.BYTES_PER_ELEMENT,c=(n.offset||0)/l,h=(n.stride||8)/l,d=c;d<i.length;d+=h){var f=i[d],p=i[d+1];f>s&&(s=f),p>u&&(u=p),f<a&&(a=f),p<o&&(o=p)}return r.minX=a,r.minY=o,r.maxX=s,r.maxY=u,r}function qa(e){return(e instanceof Wa||Array.isArray(e)||e.BYTES_PER_ELEMENT)&&(e={buffer:e}),e.buffer=Ya(e.buffer,!1),e}var Za,Qa=exports.Geometry=function(e){function t(e){var r;C(this,t);var n=e.attributes,i=e.indexBuffer,a=e.topology;for(var o in(r=x(this,t)).uid=ot("geometry"),r._layoutKey=0,r.instanceCount=1,r._bounds=new Et,r._boundsDirty=!0,r.attributes=n,r.buffers=[],r.instanceCount=e.instanceCount||1,n){var s=n[o]=qa(n[o]);-1===r.buffers.indexOf(s.buffer)&&(r.buffers.push(s.buffer),s.buffer.on("update",r.onBufferUpdate,r),s.buffer.on("change",r.onBufferUpdate,r))}return i&&(r.indexBuffer=Ya(i,!0),r.buffers.push(r.indexBuffer)),r.topology=a||"triangle-list",r}return E(t,ue),B(t,[{key:"onBufferUpdate",value:function(){this._boundsDirty=!0,this.emit("update",this)}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"getIndex",value:function(){return this.indexBuffer}},{key:"getBuffer",value:function(e){return this.getAttribute(e).buffer}},{key:"getSize",value:function(){for(var e in this.attributes){var t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}},{key:"bounds",get:function(){return this._boundsDirty?(this._boundsDirty=!1,Ka(this,"aPosition",this._bounds)):this._bounds}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(function(e){return e.destroy()}),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}])}(),Ja=new Float32Array(1),$a=new Uint32Array(1),eo=exports.BatchGeometry=function(e){function t(){C(this,t);var e=new Wa({data:Ja,label:"attribute-batch-buffer",usage:Va.VERTEX|Va.COPY_DST,shrinkToFit:!1});return x(this,t,[{attributes:{aPosition:{buffer:e,format:"float32x2",stride:24,offset:0},aUV:{buffer:e,format:"float32x2",stride:24,offset:8},aColor:{buffer:e,format:"unorm8x4",stride:24,offset:16},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:24,offset:20}},indexBuffer:new Wa({data:$a,label:"index-batch-buffer",usage:Va.INDEX|Va.COPY_DST,shrinkToFit:!1})}])}return E(t,Qa),B(t)}(),to=Object.create(null),ro=Object.create(null);function no(e,t){var r=ro[e];return void 0===r&&(void 0===to[t]&&(to[t]=1),ro[e]=r=to[t]++),r}function io(){if(!Za){Za="mediump";var e=va();if(e&&e.getShaderPrecisionFormat){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);Za=t.precision?"highp":"mediump"}}return Za}function ao(e,t,r){return t?e:r?(e=e.replace("out vec4 finalColor;",""),"\n        \n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in varying\n        #define finalColor gl_FragColor\n        #define texture texture2D\n        #endif\n        ".concat(e,"\n        ")):"\n        \n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in attribute\n        #define out varying\n        #endif\n        ".concat(e,"\n        ")}function oo(e,t,r){var n=r?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if("precision"!==e.substring(0,9)){var i=r?t.requestedFragmentPrecision:t.requestedVertexPrecision;return"highp"===i&&"highp"!==n&&(i="mediump"),"precision ".concat(i," float;\n").concat(e)}return"highp"!==n&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}function so(e,t){return t?"#version 300 es\n".concat(e):e}var uo={},lo={};function co(e,t){var r=t.name,n=void 0===r?"pixi-program":r,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n=n.replace(/\s+/g,"-");var a=i?uo:lo;if(a[n+=i?"-fragment":"-vertex"]?(a[n]++,n+="-".concat(a[n])):a[n]=1,-1!==e.indexOf("#define SHADER_NAME"))return e;var o="#define SHADER_NAME ".concat(n);return"".concat(o,"\n").concat(e)}function ho(e,t){return t?e.replace("#version 300 es",""):e}var fo=Object.defineProperty,po=Object.getOwnPropertySymbols,vo=Object.prototype.hasOwnProperty,mo=Object.prototype.propertyIsEnumerable,go=function(e,t,r){return t in e?fo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},_o=function(e,t){for(var r in t||(t={}))vo.call(t,r)&&go(e,r,t[r]);if(po){var n,i=U(po(t));try{for(i.s();!(n=i.n()).done;){r=n.value;mo.call(t,r)&&go(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},yo={stripVersion:ho,ensurePrecision:oo,addProgramDefines:ao,setProgramName:co,insertVersion:so},xo=Object.create(null),bo=function(){function e(t){C(this,e);var r=-1!==(t=_o(_o({},e.defaultOptions),t)).fragment.indexOf("#version 300 es"),n={stripVersion:r,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:io()},setProgramName:{name:t.name},addProgramDefines:r,insertVersion:r},i=t.fragment,a=t.vertex;Object.keys(yo).forEach(function(e){var t=n[e];i=yo[e](i,t,!0),a=yo[e](a,t,!1)}),this.fragment=i,this.vertex=a,this._key=no("".concat(this.vertex,":").concat(this.fragment),"gl-program")}return B(e,[{key:"destroy",value:function(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}}],[{key:"from",value:function(t){var r="".concat(t.vertex,":").concat(t.fragment);return xo[r]||(xo[r]=new e(t)),xo[r]}}])}();bo.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};var To=exports.GlProgram=bo,So={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function ko(e){var t;return null!=(t=So[e])?t:So.float32}var Eo={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function Ao(e){var t,r=e.source,n=e.entryPoint,i={},a=r.indexOf("fn ".concat(n));if(-1!==a){var o=r.indexOf("->",a);if(-1!==o)for(var s,u=r.substring(a,o),l=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;null!==(s=l.exec(u));){var c=null!=(t=Eo[s[3]])?t:"float32";i[s[2]]={location:parseInt(s[1],10),format:c,stride:ko(c).stride,offset:0,instance:!1,start:0}}}return i}function wo(e){var t,r,n,i=/@group\((\d+)\)/,a=/@binding\((\d+)\)/,o=/var(<[^>]+>)? (\w+)/,s=/:\s*(\w+)/,u=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,c=null==(t=e.match(/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g))?void 0:t.map(function(e){return{group:parseInt(e.match(i)[1],10),binding:parseInt(e.match(a)[1],10),name:e.match(o)[2],isUniform:"<uniform>"===e.match(o)[1],type:e.match(s)[1]}});if(!c)return{groups:[],structs:[]};var h=null!=(n=null==(r=e.match(/struct\s+(\w+)\s*{([^}]+)}/g))?void 0:r.map(function(e){var t=e.match(l)[1],r=e.match(u).reduce(function(e,t){var r=R(t.split(":"),2),n=r[0],i=r[1];return e[n.trim()]=i.trim(),e},{});return r?{name:t,members:r}:null}).filter(function(e){var t=e.name;return c.some(function(e){return e.type===t})}))?n:[];return{groups:c,structs:h}}var Ro=exports.ShaderStage=function(e){return e[e.VERTEX=1]="VERTEX",e[e.FRAGMENT=2]="FRAGMENT",e[e.COMPUTE=4]="COMPUTE",e}(Ro||{});function Po(e){for(var t=e.groups,r=[],n=0;n<t.length;n++){var i=t[n];r[i.group]||(r[i.group]=[]),i.isUniform?r[i.group].push({binding:i.binding,visibility:Ro.VERTEX|Ro.FRAGMENT,buffer:{type:"uniform"}}):"sampler"===i.type?r[i.group].push({binding:i.binding,visibility:Ro.FRAGMENT,sampler:{type:"filtering"}}):"texture_2d"===i.type&&r[i.group].push({binding:i.binding,visibility:Ro.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return r}function Mo(e){for(var t=e.groups,r=[],n=0;n<t.length;n++){var i=t[n];r[i.group]||(r[i.group]={}),r[i.group][i.name]=i.binding}return r}function Oo(e,t){var r=new Set,n=new Set;return{structs:[].concat(m(e.structs),m(t.structs)).filter(function(e){return!r.has(e.name)&&(r.add(e.name),!0)}),groups:[].concat(m(e.groups),m(t.groups)).filter(function(e){var t="".concat(e.name,"-").concat(e.binding);return!n.has(t)&&(n.add(t),!0)})}}var Co=Object.create(null),Go=exports.GpuProgram=function(){function e(t){var r,n;C(this,e),this._layoutKey=0,this._attributeLocationsKey=0;var i=t.fragment,a=t.vertex,o=t.layout,s=t.gpuLayout,u=t.name;if(this.name=u,this.fragment=i,this.vertex=a,i.source===a.source){var l=wo(i.source);this.structsAndGroups=l}else{var c=wo(a.source),h=wo(i.source);this.structsAndGroups=Oo(c,h)}this.layout=null!=o?o:Mo(this.structsAndGroups),this.gpuLayout=null!=s?s:Po(this.structsAndGroups),this.autoAssignGlobalUniforms=!(void 0===(null==(r=this.layout[0])?void 0:r.globalUniforms)),this.autoAssignLocalUniforms=!(void 0===(null==(n=this.layout[1])?void 0:n.localUniforms)),this._generateProgramKey()}return B(e,[{key:"_generateProgramKey",value:function(){var e=this.vertex,t=this.fragment,r=e.source+t.source+e.entryPoint+t.entryPoint;this._layoutKey=no(r,"program")}},{key:"attributeData",get:function(){return null!=this._attributeData||(this._attributeData=Ao(this.vertex)),this._attributeData}},{key:"destroy",value:function(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}}],[{key:"from",value:function(t){var r="".concat(t.vertex.source,":").concat(t.fragment.source,":").concat(t.fragment.entryPoint,":").concat(t.vertex.entryPoint);return Co[r]||(Co[r]=new e(t)),Co[r]}}])}();function Bo(e,t,r){if(e)for(var n in e){var i=t[n.toLocaleLowerCase()];if(i){var a=e[n];"header"===n&&(a=a.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),r&&i.push("//----".concat(r,"----//")),i.push(a)}else Gt("".concat(n," placement hook does not exist in shader"))}}var Io=exports.findHooksRx=/\{\{(.*?)\}\}/g;function Fo(e){var t,r,n={};return(null!=(r=null==(t=e.match(Io))?void 0:t.map(function(e){return e.replace(/[{()}]/g,"")}))?r:[]).forEach(function(e){n[e]=[]}),n}function Do(e,t){for(var r,n=/@in\s+([^;]+);/g;null!==(r=n.exec(e));)t.push(r[1])}function Uo(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];Do(t,n),e.forEach(function(e){e.header&&Do(e.header,n)});var i=n;r&&i.sort();var a=i.map(function(e,t){return"       @location(".concat(t,") ").concat(e,",")}).join("\n"),o=t.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}","\n".concat(a,"\n"))}function Lo(e,t){for(var r,n=/@out\s+([^;]+);/g;null!==(r=n.exec(e));)t.push(r[1])}function No(e){var t=/\b(\w+)\s*:/g.exec(e);return t?t[1]:""}function Xo(e){return e.replace(/@.*?\s+/g,"")}function Ho(e,t){var r=[];Lo(t,r),e.forEach(function(e){e.header&&Lo(e.header,r)});var n=0,i=r.sort().map(function(e){return e.indexOf("builtin")>-1?e:"@location(".concat(n++,") ").concat(e)}).join(",\n"),a=r.sort().map(function(e){return"       var ".concat(Xo(e),";")}).join("\n"),o="return VSOutput(\n                ".concat(r.sort().map(function(e){return" ".concat(No(e))}).join(",\n"),");"),s=t.replace(/@out\s+[^;]+;\s*/g,"");return s=(s=(s=s.replace("{{struct}}","\n".concat(i,"\n"))).replace("{{start}}","\n".concat(a,"\n"))).replace("{{return}}","\n".concat(o,"\n"))}function jo(e,t){var r=e;for(var n in t){var i=t[n];r=i.join("\n").length?r.replace("{{".concat(n,"}}"),"//-----".concat(n," START-----//\n").concat(i.join("\n"),"\n//----").concat(n," FINISH----//")):r.replace("{{".concat(n,"}}"),"")}return r}var zo=Object.create(null),Vo=new Map,Wo=0;function Yo(e){var t=e.template,r=e.bits,n=Zo(t,r);if(zo[n])return zo[n];var i=qo(t,r),a=i.vertex,o=i.fragment;return zo[n]=Qo(a,o,r),zo[n]}function Ko(e){var t=e.template,r=e.bits,n=Zo(t,r);return zo[n]?zo[n]:(zo[n]=Qo(t.vertex,t.fragment,r),zo[n])}function qo(e,t){var r=t.map(function(e){return e.vertex}).filter(function(e){return!!e}),n=t.map(function(e){return e.fragment}).filter(function(e){return!!e}),i=Uo(r,e.vertex,!0);return{vertex:i=Ho(r,i),fragment:Uo(n,e.fragment,!0)}}function Zo(e,t){return t.map(function(e){return Vo.has(e)||Vo.set(e,Wo++),Vo.get(e)}).sort(function(e,t){return e-t}).join("-")+e.vertex+e.fragment}function Qo(e,t,r){var n=Fo(e),i=Fo(t);return r.forEach(function(e){Bo(e.vertex,n,e.name),Bo(e.fragment,i,e.name)}),{vertex:jo(e,n),fragment:jo(t,i)}}var Jo=exports.vertexGPUTemplate="\n    @in aPosition: vec2<f32>;\n    @in aUV: vec2<f32>;\n\n    @out @builtin(position) vPosition: vec4<f32>;\n    @out vUV : vec2<f32>;\n    @out vColor : vec4<f32>;\n\n    {{header}}\n\n    struct VSOutput {\n        {{struct}}\n    };\n\n    @vertex\n    fn main( {{in}} ) -> VSOutput {\n\n        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;\n        var modelMatrix = mat3x3<f32>(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        var position = aPosition;\n        var uv = aUV;\n\n        {{start}}\n        \n        vColor = vec4<f32>(1., 1., 1., 1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);\n       \n        vColor *= globalUniforms.uWorldColorAlpha;\n\n        {{end}}\n\n        {{return}}\n    };\n",$o=exports.fragmentGPUTemplate="\n    @in vUV : vec2<f32>;\n    @in vColor : vec4<f32>;\n   \n    {{header}}\n\n    @fragment\n    fn main(\n        {{in}}\n      ) -> @location(0) vec4<f32> {\n        \n        {{start}}\n\n        var outColor:vec4<f32>;\n      \n        {{main}}\n        \n        var finalColor:vec4<f32> = outColor * vColor;\n\n        {{end}}\n\n        return finalColor;\n      };\n",es=exports.vertexGlTemplate="\n    in vec2 aPosition;\n    in vec2 aUV;\n\n    out vec4 vColor;\n    out vec2 vUV;\n\n    {{header}}\n\n    void main(void){\n\n        mat3 worldTransformMatrix = uWorldTransformMatrix;\n        mat3 modelMatrix = mat3(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        vec2 position = aPosition;\n        vec2 uv = aUV;\n        \n        {{start}}\n        \n        vColor = vec4(1.);\n        \n        {{main}}\n        \n        vUV = uv;\n        \n        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= uWorldColorAlpha;\n\n        {{end}}\n    }\n",ts=exports.fragmentGlTemplate="\n   \n    in vec4 vColor;\n    in vec2 vUV;\n\n    out vec4 finalColor;\n\n    {{header}}\n\n    void main(void) {\n        \n        {{start}}\n\n        vec4 outColor;\n      \n        {{main}}\n        \n        finalColor = outColor * vColor;\n        \n        {{end}}\n    }\n",rs=exports.globalUniformsBit={name:"global-uniforms-bit",vertex:{header:"\n        struct GlobalUniforms {\n            uProjectionMatrix:mat3x3<f32>,\n            uWorldTransformMatrix:mat3x3<f32>,\n            uWorldColorAlpha: vec4<f32>,\n            uResolution: vec2<f32>,\n        }\n\n        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;\n        "}},ns=exports.globalUniformsUBOBitGl={name:"global-uniforms-ubo-bit",vertex:{header:"\n          uniform globalUniforms {\n            mat3 uProjectionMatrix;\n            mat3 uWorldTransformMatrix;\n            vec4 uWorldColorAlpha;\n            vec2 uResolution;\n          };\n        "}},is=exports.globalUniformsBitGl={name:"global-uniforms-bit",vertex:{header:"\n          uniform mat3 uProjectionMatrix;\n          uniform mat3 uWorldTransformMatrix;\n          uniform vec4 uWorldColorAlpha;\n          uniform vec2 uResolution;\n        "}},as=Object.defineProperty,os=Object.getOwnPropertySymbols,ss=Object.prototype.hasOwnProperty,us=Object.prototype.propertyIsEnumerable,ls=function(e,t,r){return t in e?as(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},cs=function(e,t){for(var r in t||(t={}))ss.call(t,r)&&ls(e,r,t[r]);if(os){var n,i=U(os(t));try{for(i.s();!(n=i.n()).done;){r=n.value;us.call(t,r)&&ls(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e};function hs(e){var t=e.bits,r=e.name,n=Yo({template:{fragment:$o,vertex:Jo},bits:[rs].concat(m(t))});return Go.from({name:r,vertex:{source:n.vertex,entryPoint:"main"},fragment:{source:n.fragment,entryPoint:"main"}})}function ds(e){var t=e.bits,r=e.name;return new To(cs({name:r},Ko({template:{vertex:es,fragment:ts},bits:[is].concat(m(t))})))}var fs=exports.colorBit={name:"color-bit",vertex:{header:"\n            @in aColor: vec4<f32>;\n        ",main:"\n            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);\n        "}},ps=exports.colorBitGl={name:"color-bit",vertex:{header:"\n            in vec4 aColor;\n        ",main:"\n            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);\n        "}},vs={};function ms(e){var t=[];if(1===e)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else for(var r=0,n=0;n<e;n++)t.push("@group(1) @binding(".concat(r++,") var textureSource").concat(n+1,": texture_2d<f32>;")),t.push("@group(1) @binding(".concat(r++,") var textureSampler").concat(n+1,": sampler;"));return t.join("\n")}function gs(e){var t=[];if(1===e)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(var r=0;r<e;r++)r===e-1?t.push("  default:{"):t.push("  case ".concat(r,":{")),t.push("      outColor = textureSampleGrad(textureSource".concat(r+1,", textureSampler").concat(r+1,", vUV, uvDx, uvDy);")),t.push("      break;}");t.push("}")}return t.join("\n")}function _s(e){return vs[e]||(vs[e]={name:"texture-batch-bit",vertex:{header:"\n                @in aTextureIdAndRound: vec2<u32>;\n                @out @interpolate(flat) vTextureId : u32;\n            ",main:"\n                vTextureId = aTextureIdAndRound.y;\n            ",end:"\n                if(aTextureIdAndRound.x == 1)\n                {\n                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n                }\n            "},fragment:{header:"\n                @in @interpolate(flat) vTextureId: u32;\n\n                ".concat(ms(e),"\n            "),main:"\n                var uvDx = dpdx(vUV);\n                var uvDy = dpdy(vUV);\n\n                ".concat(gs(e),"\n            ")}}),vs[e]}var ys={};function xs(e){for(var t=[],r=0;r<e;r++)r>0&&t.push("else"),r<e-1&&t.push("if(vTextureId < ".concat(r,".5)")),t.push("{"),t.push("\toutColor = texture(uTextures[".concat(r,"], vUV);")),t.push("}");return t.join("\n")}function bs(e){return ys[e]||(ys[e]={name:"texture-batch-bit",vertex:{header:"\n                in vec2 aTextureIdAndRound;\n                out float vTextureId;\n\n            ",main:"\n                vTextureId = aTextureIdAndRound.y;\n            ",end:"\n                if(aTextureIdAndRound.x == 1.)\n                {\n                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n                }\n            "},fragment:{header:"\n                in float vTextureId;\n\n                uniform sampler2D uTextures[".concat(e,"];\n\n            "),main:"\n\n                ".concat(xs(e),"\n            ")}}),ys[e]}var Ts=exports.roundPixelsBit={name:"round-pixels-bit",vertex:{header:"\n            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> \n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        "}},Ss=exports.roundPixelsBitGl={name:"round-pixels-bit",vertex:{header:"   \n            vec2 roundPixels(vec2 position, vec2 targetSize)\n            {       \n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        "}},ks=exports.UNIFORM_TYPES_VALUES=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>"],Es=exports.UNIFORM_TYPES_MAP=ks.reduce(function(e,t){return e[t]=!0,e},{});function As(e,t){switch(e){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var ws=Object.defineProperty,Rs=Object.getOwnPropertySymbols,Ps=Object.prototype.hasOwnProperty,Ms=Object.prototype.propertyIsEnumerable,Os=function(e,t,r){return t in e?ws(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Cs=function(e,t){for(var r in t||(t={}))Ps.call(t,r)&&Os(e,r,t[r]);if(Rs){var n,i=U(Rs(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Ms.call(t,r)&&Os(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Gs=function(){return B(function e(t,r){var n;C(this,e),this._touched=0,this.uid=ot("uniform"),this._resourceType="uniformGroup",this._resourceId=ot("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,r=Cs(Cs({},e.defaultOptions),r),this.uniformStructures=t;var i={};for(var a in t){var o=t[a];if(o.name=a,o.size=null!=(n=o.size)?n:1,!Es[o.type])throw new Error("Uniform type ".concat(o.type," is not supported. Supported uniform types are: ").concat(ks.join(", ")));null!=o.value||(o.value=As(o.type,o.size)),i[a]=o.value}this.uniforms=i,this._dirtyId=1,this.ubo=r.ubo,this.isStatic=r.isStatic,this._signature=no(Object.keys(i).map(function(e){return"".concat(e,"-").concat(t[e].type)}).join("-"),"uniform-group")},[{key:"update",value:function(){this._dirtyId++}}])}();Gs.defaultOptions={ubo:!1,isStatic:!1};var Bs=exports.UniformGroup=Gs,Is={};function Fs(e){var t=Is[e];if(t)return t;for(var r=new Int32Array(e),n=0;n<e;n++)r[n]=n;return t=Is[e]=new Bs({uTextures:{value:r,type:"i32",size:e}},{isStatic:!0})}var Ds=exports.RendererType=function(e){return e[e.WEBGL=1]="WEBGL",e[e.WEBGPU=2]="WEBGPU",e[e.BOTH=3]="BOTH",e}(Ds||{}),Us=Object.defineProperty,Ls=Object.getOwnPropertySymbols,Ns=Object.prototype.hasOwnProperty,Xs=Object.prototype.propertyIsEnumerable,Hs=function(e,t,r){return t in e?Us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},js=function(e,t){for(var r in t||(t={}))Ns.call(t,r)&&Hs(e,r,t[r]);if(Ls){var n,i=U(Ls(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Xs.call(t,r)&&Hs(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},zs=function(e,t){var r={};for(var n in e)Ns.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Ls){var i,a=U(Ls(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&Xs.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},Vs=exports.Shader=function(e){function t(e){var r;C(this,t),(r=x(this,t))._uniformBindMap=Object.create(null),r._ownedBindGroups=[];var n=e.gpuProgram,i=e.glProgram,a=e.groups,o=e.resources,s=e.compatibleRenderers,u=e.groupMap;r.gpuProgram=n,r.glProgram=i,void 0===s&&(s=0,n&&(s|=Ds.WEBGPU),i&&(s|=Ds.WEBGL)),r.compatibleRenderers=s;var l={};if(o||a||(o={}),o&&a)throw new Error("[Shader] Cannot have both resources and groups");if(!n&&a&&!u)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!n&&a&&u)for(var c in u)for(var h in u[c]){var d=u[c][h];l[d]={group:c,binding:h,name:d}}else if(n&&a&&!u){var f=n.structsAndGroups.groups;u={},f.forEach(function(e){u[e.group]=u[e.group]||{},u[e.group][e.binding]=e.name,l[e.name]=e})}else if(o){if(a={},u={},n)n.structsAndGroups.groups.forEach(function(e){u[e.group]=u[e.group]||{},u[e.group][e.binding]=e.name,l[e.name]=e});var p=0;for(var v in o)l[v]||(a[99]||(a[99]=new pa,r._ownedBindGroups.push(a[99])),l[v]={group:99,binding:p,name:v},u[99]=u[99]||{},u[99][p]=v,p++);for(var m in o){var g=m,_=o[m];_.source||_._resourceType||(_=new Bs(_));var y=l[g];y&&(a[y.group]||(a[y.group]=new pa,r._ownedBindGroups.push(a[y.group])),a[y.group].setResource(_,y.binding))}}return r.groups=a,r._uniformBindMap=u,r.resources=r._buildResourceAccessor(a,l),r}return E(t,ue),B(t,[{key:"addResource",value:function(e,t,r){var n,i;(n=this._uniformBindMap)[t]||(n[t]={}),(i=this._uniformBindMap[t])[r]||(i[r]=e),this.groups[t]||(this.groups[t]=new pa,this._ownedBindGroups.push(this.groups[t]))}},{key:"_buildResourceAccessor",value:function(e,t){var r={},n=function(){var n=t[i];Object.defineProperty(r,n.name,{get:function(){return e[n.group].getResource(n.binding)},set:function(t){e[n.group].setResource(t,n.binding)}})};for(var i in t)n();return r}},{key:"destroy",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.emit("destroy",this),r&&(null==(e=this.gpuProgram)||e.destroy(),null==(t=this.glProgram)||t.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(function(e){e.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}}],[{key:"from",value:function(e){var r,n,i=e,a=i.gpu,o=i.gl,s=zs(i,["gpu","gl"]);return a&&(r=Go.from(a)),o&&(n=To.from(o)),new t(js({gpuProgram:r,glProgram:n},s))}}])}(),Ws=exports.DefaultShader=function(e){function t(e){return C(this,t),x(this,t,[{glProgram:ds({name:"batch",bits:[ps,bs(e),Ss]}),gpuProgram:hs({name:"batch",bits:[fs,_s(e),Ts]}),resources:{batchSamplers:Fs(e)}}])}return E(t,Vs),B(t)}(),Ys=null,Ks=function(e){function t(){var e;return C(this,t),(e=x(this,t,arguments)).geometry=new eo,e.shader=Ys||(Ys=new Ws(e.maxTextures)),e.name=t.extension.name,e.vertexSize=6,e}return E(t,za),B(t,[{key:"packAttributes",value:function(e,t,r,n,i){for(var a=i<<16|65535&e.roundPixels,o=e.transform,s=o.a,u=o.b,l=o.c,c=o.d,h=o.tx,d=o.ty,f=e.positions,p=e.uvs,v=e.color,m=e.attributeOffset,g=m+e.attributeSize,_=m;_<g;_++){var y=2*_,x=f[y],b=f[y+1];t[n++]=s*x+l*b+h,t[n++]=c*b+u*x+d,t[n++]=p[y],t[n++]=p[y+1],r[n++]=v,r[n++]=a}}},{key:"packQuadAttributes",value:function(e,t,r,n,i){var a=e.texture,o=e.transform,s=o.a,u=o.b,l=o.c,c=o.d,h=o.tx,d=o.ty,f=e.bounds,p=f.maxX,v=f.minX,m=f.maxY,g=f.minY,_=a.uvs,y=e.color,x=i<<16|65535&e.roundPixels;t[n+0]=s*v+l*g+h,t[n+1]=c*g+u*v+d,t[n+2]=_.x0,t[n+3]=_.y0,r[n+4]=y,r[n+5]=x,t[n+6]=s*p+l*g+h,t[n+7]=c*g+u*p+d,t[n+8]=_.x1,t[n+9]=_.y1,r[n+10]=y,r[n+11]=x,t[n+12]=s*p+l*m+h,t[n+13]=c*m+u*p+d,t[n+14]=_.x2,t[n+15]=_.y2,r[n+16]=y,r[n+17]=x,t[n+18]=s*v+l*m+h,t[n+19]=c*m+u*v+d,t[n+20]=_.x3,t[n+21]=_.y3,r[n+22]=y,r[n+23]=x}}])}();Ks.extension={type:[Z.Batcher],name:"default"};var qs=exports.DefaultBatcher=Ks;function Zs(e,t,r,n,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=0;r*=t,i*=a;for(var l=s.a,c=s.b,h=s.c,d=s.d,f=s.tx,p=s.ty;u<o;){var v=e[r],m=e[r+1];n[i]=l*v+h*m+f,n[i+1]=c*v+d*m+p,i+=a,r+=t,u++}}function Qs(e,t,r,n){var i=0;for(t*=r;i<n;)e[t]=0,e[t+1]=0,t+=r,i++}function Js(e,t,r,n,i){var a=t.a,o=t.b,s=t.c,u=t.d,l=t.tx,c=t.ty;r=r||0,n=n||2,i=i||e.length/n-r;for(var h=r*n,d=0;d<i;d++){var f=e[h],p=e[h+1];e[h]=a*f+s*p+l,e[h+1]=o*f+u*p+c,h+=n}}function $s(e,t){return 16777215!==e&&t?16777215!==t&&e?((e>>16&255)*(t>>16&255)/255<<16)+((e>>8&255)*(t>>8&255)/255<<8)+(255&e)*(255&t)/255:e:t}var eu=new tt,tu=exports.BatchableGraphics=function(){return B(function e(){C(this,e),this.packAsQuad=!1,this.batcherName="default",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null},[{key:"uvs",get:function(){return this.geometryData.uvs}},{key:"positions",get:function(){return this.geometryData.vertices}},{key:"indices",get:function(){return this.geometryData.indices}},{key:"blendMode",get:function(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}},{key:"color",get:function(){var e=this.baseColor,t=e>>16|65280&e|(255&e)<<16,r=this.renderable;return r?$s(t,r.groupColor)+(this.alpha*r.groupAlpha*255<<24):t+(255*this.alpha<<24)}},{key:"transform",get:function(){var e;return(null==(e=this.renderable)?void 0:e.groupTransform)||eu}},{key:"copyTo",value:function(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData}},{key:"reset",value:function(){this.applyTransform=!0,this.renderable=null}}])}(),ru=Object.defineProperty,nu=Object.defineProperties,iu=Object.getOwnPropertyDescriptors,au=Object.getOwnPropertySymbols,ou=Object.prototype.hasOwnProperty,su=Object.prototype.propertyIsEnumerable,uu=function(e,t,r){return t in e?ru(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},lu=function(e,t){for(var r in t||(t={}))ou.call(t,r)&&uu(e,r,t[r]);if(au){var n,i=U(au(t));try{for(i.s();!(n=i.n()).done;){r=n.value;su.call(t,r)&&uu(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},cu=function(e,t){return nu(e,iu(t))},hu=exports.buildCircle={extension:{type:Z.ShapeBuilder,name:"circle"},build:function(e,t){var r,n,i,a,o,s;if("circle"===e.type){var u=e;r=u.x,n=u.y,o=s=u.radius,i=a=0}else if("ellipse"===e.type){var l=e;r=l.x,n=l.y,o=l.halfWidth,s=l.halfHeight,i=a=0}else{var c=e,h=c.width/2,d=c.height/2;r=c.x+h,n=c.y+d,i=h-(o=s=Math.max(0,Math.min(c.radius,Math.min(h,d)))),a=d-s}if(!(o>=0&&s>=0&&i>=0&&a>=0))return t;var f=Math.ceil(2.3*Math.sqrt(o+s)),p=8*f+(i?4:0)+(a?4:0);if(0===p)return t;if(0===f)return t[0]=t[6]=r+i,t[1]=t[3]=n+a,t[2]=t[4]=r-i,t[5]=t[7]=n-a,t;var v=0,m=4*f+(i?2:0)+2,g=m,_=p,y=i+o,x=a,b=r+y,T=r-y,S=n+x;if(t[v++]=b,t[v++]=S,t[--m]=S,t[--m]=T,a){var k=n-x;t[g++]=T,t[g++]=k,t[--_]=k,t[--_]=b}for(var E=1;E<f;E++){var A=Math.PI/2*(E/f),w=i+Math.cos(A)*o,R=a+Math.sin(A)*s,P=r+w,M=r-w,O=n+R,C=n-R;t[v++]=P,t[v++]=O,t[--m]=O,t[--m]=M,t[g++]=M,t[g++]=C,t[--_]=C,t[--_]=P}b=r+(y=i),T=r-y,S=n+(x=a+s);var G=n-x;return t[v++]=b,t[v++]=S,t[--_]=G,t[--_]=b,i&&(t[v++]=T,t[v++]=S,t[--_]=G,t[--_]=T),t},triangulate:function(e,t,r,n,i,a){if(0!==e.length){for(var o=0,s=0,u=0;u<e.length;u+=2)o+=e[u],s+=e[u+1];o/=e.length/2,s/=e.length/2;var l=n;t[l*r]=o,t[l*r+1]=s;for(var c=l++,h=0;h<e.length;h+=2)t[l*r]=e[h],t[l*r+1]=e[h+1],h>0&&(i[a++]=l,i[a++]=c,i[a++]=l-1),l++;i[a++]=c+1,i[a++]=c,i[a++]=l-1}}},du=exports.buildEllipse=cu(lu({},hu),{extension:cu(lu({},hu.extension),{name:"ellipse"})}),fu=exports.buildRoundedRectangle=cu(lu({},hu),{extension:cu(lu({},hu.extension),{name:"roundedRectangle"})}),pu=exports.closePointEps=1e-4,vu=exports.curveEps=1e-4;function mu(e){var t=e.length;if(t<6)return 1;for(var r=0,n=0,i=e[t-2],a=e[t-1];n<t;n+=2){var o=e[n],s=e[n+1];r+=(o-i)*(s+a),i=o,a=s}return r<0?-1:1}function gu(e,t,r,n,i,a,o,s){var u,l;o?(u=n,l=-r):(u=-n,l=r);var c=e-r*i+u,h=t-n*i+l,d=e+r*a+u,f=t+n*a+l;return s.push(c,h),s.push(d,f),2}function _u(e,t,r,n,i,a,o,s){var u=r-e,l=n-t,c=Math.atan2(u,l),h=Math.atan2(i-e,a-t);s&&c<h?c+=2*Math.PI:!s&&c>h&&(h+=2*Math.PI);var d=c,f=h-c,p=Math.abs(f),v=Math.sqrt(u*u+l*l),m=1+(15*p*Math.sqrt(v)/Math.PI>>0),g=f/m;if(d+=g,s){o.push(e,t),o.push(r,n);for(var _=1,y=d;_<m;_++,y+=g)o.push(e,t),o.push(e+Math.sin(y)*v,t+Math.cos(y)*v);o.push(e,t),o.push(i,a)}else{o.push(r,n),o.push(e,t);for(var x=1,b=d;x<m;x++,b+=g)o.push(e+Math.sin(b)*v,t+Math.cos(b)*v),o.push(e,t);o.push(i,a),o.push(e,t)}return 2*m}function yu(e,t,r,n,i,a,o,s,u){var l=pu;if(0!==e.length){var c=t,h=c.alignment;if(.5!==t.alignment){var d=mu(e);r&&(d*=-1),h=(h-.5)*d+.5}var f=new $e(e[0],e[1]),p=new $e(e[e.length-2],e[e.length-1]),v=n,m=Math.abs(f.x-p.x)<l&&Math.abs(f.y-p.y)<l;if(v){e=e.slice(),m&&(e.pop(),e.pop(),p.set(e[e.length-2],e[e.length-1]));var g=.5*(f.x+p.x),_=.5*(p.y+f.y);e.unshift(g,_),e.push(g,_)}var y=i,x=e.length/2,b=e.length,T=y.length/2,S=c.width/2,k=S*S,E=c.miterLimit*c.miterLimit,A=e[0],w=e[1],R=e[2],P=e[3],M=0,O=0,C=-(w-P),G=A-R,B=0,I=0,F=Math.sqrt(C*C+G*G);C/=F,G/=F,C*=S,G*=S;var D=2*(1-h),U=2*h;v||("round"===c.cap?b+=_u(A-C*(D-U)*.5,w-G*(D-U)*.5,A-C*D,w-G*D,A+C*U,w+G*U,y,!0)+2:"square"===c.cap&&(b+=gu(A,w,C,G,D,U,!0,y))),y.push(A-C*D,w-G*D),y.push(A+C*U,w+G*U);for(var L=1;L<x-1;++L){A=e[2*(L-1)],w=e[2*(L-1)+1],R=e[2*L],P=e[2*L+1],M=e[2*(L+1)],O=e[2*(L+1)+1],C=-(w-P),G=A-R,C/=F=Math.sqrt(C*C+G*G),G/=F,C*=S,G*=S,B=-(P-O),I=R-M,B/=F=Math.sqrt(B*B+I*I),I/=F,B*=S,I*=S;var N=R-A,X=w-P,H=R-M,j=O-P,z=N*H+X*j,V=X*H-j*N,W=V<0;if(Math.abs(V)<.001*Math.abs(z))y.push(R-C*D,P-G*D),y.push(R+C*U,P+G*U),z>=0&&("round"===c.join?b+=_u(R,P,R-C*D,P-G*D,R-B*D,P-I*D,y,!1)+4:b+=2,y.push(R-B*U,P-I*U),y.push(R+B*D,P+I*D));else{var Y=(-C+A)*(-G+P)-(-C+R)*(-G+w),K=(-B+M)*(-I+P)-(-B+R)*(-I+O),q=(N*K-H*Y)/V,Z=(j*Y-X*K)/V,Q=(q-R)*(q-R)+(Z-P)*(Z-P),J=R+(q-R)*D,$=P+(Z-P)*D,ee=R-(q-R)*U,te=P-(Z-P)*U,re=W?D:U;Q<=Math.min(N*N+X*X,H*H+j*j)+re*re*k?"bevel"===c.join||Q/k>E?(W?(y.push(J,$),y.push(R+C*U,P+G*U),y.push(J,$),y.push(R+B*U,P+I*U)):(y.push(R-C*D,P-G*D),y.push(ee,te),y.push(R-B*D,P-I*D),y.push(ee,te)),b+=2):"round"===c.join?W?(y.push(J,$),y.push(R+C*U,P+G*U),b+=_u(R,P,R+C*U,P+G*U,R+B*U,P+I*U,y,!0)+4,y.push(J,$),y.push(R+B*U,P+I*U)):(y.push(R-C*D,P-G*D),y.push(ee,te),b+=_u(R,P,R-C*D,P-G*D,R-B*D,P-I*D,y,!1)+4,y.push(R-B*D,P-I*D),y.push(ee,te)):(y.push(J,$),y.push(ee,te)):(y.push(R-C*D,P-G*D),y.push(R+C*U,P+G*U),"round"===c.join?b+=W?_u(R,P,R+C*U,P+G*U,R+B*U,P+I*U,y,!0)+2:_u(R,P,R-C*D,P-G*D,R-B*D,P-I*D,y,!1)+2:"miter"===c.join&&Q/k<=E&&(W?(y.push(ee,te),y.push(ee,te)):(y.push(J,$),y.push(J,$)),b+=2),y.push(R-B*D,P-I*D),y.push(R+B*U,P+I*U),b+=2)}}A=e[2*(x-2)],w=e[2*(x-2)+1],R=e[2*(x-1)],C=-(w-(P=e[2*(x-1)+1])),G=A-R,C/=F=Math.sqrt(C*C+G*G),G/=F,C*=S,G*=S,y.push(R-C*D,P-G*D),y.push(R+C*U,P+G*U),v||("round"===c.cap?b+=_u(R-C*(D-U)*.5,P-G*(D-U)*.5,R-C*D,P-G*D,R+C*U,P+G*U,y,!1)+2:"square"===c.cap&&(b+=gu(R,P,C,G,D,U,!1,y)));for(var ne=vu*vu,ie=T;ie<b+T-2;++ie)A=y[2*ie],w=y[2*ie+1],R=y[2*(ie+1)],P=y[2*(ie+1)+1],M=y[2*(ie+2)],O=y[2*(ie+2)+1],Math.abs(A*(P-O)+R*(O-w)+M*(w-P))<ne||s.push(ie,ie+1,ie+2)}}var xu={exports:{}},bu=xu.exports;xu.exports=Su;var Tu=xu.exports.default=Su;function Su(e,t,r){r=r||2;var n,i,a,o,s,u,l,c=t&&t.length,h=c?t[0]*r:e.length,d=ku(e,0,h,r,!0),f=[];if(!d||d.next===d.prev)return f;if(c&&(d=Ou(e,t,d,r)),e.length>80*r){n=a=e[0],i=o=e[1];for(var p=r;p<h;p+=r)(s=e[p])<n&&(n=s),(u=e[p+1])<i&&(i=u),s>a&&(a=s),u>o&&(o=u);l=0!==(l=Math.max(a-n,o-i))?32767/l:0}return Au(d,f,r,n,i,l,0),f}function ku(e,t,r,n,i){var a,o;if(i===el(e,t,r,n)>0)for(a=t;a<r;a+=n)o=Qu(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=Qu(a,e[a],e[a+1],o);return o&&ju(o,o.next)&&(Ju(o),o=o.next),o}function Eu(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!ju(n,n.next)&&0!==Hu(n.prev,n,n.next))n=n.next;else{if(Ju(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function Au(e,t,r,n,i,a,o){if(e){!o&&a&&Fu(e,n,i,a);for(var s,u,l=e;e.prev!==e.next;)if(s=e.prev,u=e.next,a?Ru(e,n,i,a):wu(e))t.push(s.i/r|0),t.push(e.i/r|0),t.push(u.i/r|0),Ju(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?Au(e=Pu(Eu(e),t,r),t,r,n,i,a,2):2===o&&Mu(e,t,r,n,i,a):Au(Eu(e),t,r,n,i,a,1);break}}}function wu(e){var t=e.prev,r=e,n=e.next;if(Hu(t,r,n)>=0)return!1;for(var i=t.x,a=r.x,o=n.x,s=t.y,u=r.y,l=n.y,c=i<a?i<o?i:o:a<o?a:o,h=s<u?s<l?s:l:u<l?u:l,d=i>a?i>o?i:o:a>o?a:o,f=s>u?s>l?s:l:u>l?u:l,p=n.next;p!==t;){if(p.x>=c&&p.x<=d&&p.y>=h&&p.y<=f&&Nu(i,s,a,u,o,l,p.x,p.y)&&Hu(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Ru(e,t,r,n){var i=e.prev,a=e,o=e.next;if(Hu(i,a,o)>=0)return!1;for(var s=i.x,u=a.x,l=o.x,c=i.y,h=a.y,d=o.y,f=s<u?s<l?s:l:u<l?u:l,p=c<h?c<d?c:d:h<d?h:d,v=s>u?s>l?s:l:u>l?u:l,m=c>h?c>d?c:d:h>d?h:d,g=Uu(f,p,t,r,n),_=Uu(v,m,t,r,n),y=e.prevZ,x=e.nextZ;y&&y.z>=g&&x&&x.z<=_;){if(y.x>=f&&y.x<=v&&y.y>=p&&y.y<=m&&y!==i&&y!==o&&Nu(s,c,u,h,l,d,y.x,y.y)&&Hu(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,x.x>=f&&x.x<=v&&x.y>=p&&x.y<=m&&x!==i&&x!==o&&Nu(s,c,u,h,l,d,x.x,x.y)&&Hu(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;y&&y.z>=g;){if(y.x>=f&&y.x<=v&&y.y>=p&&y.y<=m&&y!==i&&y!==o&&Nu(s,c,u,h,l,d,y.x,y.y)&&Hu(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;x&&x.z<=_;){if(x.x>=f&&x.x<=v&&x.y>=p&&x.y<=m&&x!==i&&x!==o&&Nu(s,c,u,h,l,d,x.x,x.y)&&Hu(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Pu(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!ju(i,a)&&zu(i,n,n.next,a)&&Ku(i,a)&&Ku(a,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(a.i/r|0),Ju(n),Ju(n.next),n=e=a),n=n.next}while(n!==e);return Eu(n)}function Mu(e,t,r,n,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Xu(o,s)){var u=Zu(o,s);return o=Eu(o,o.next),u=Eu(u,u.next),Au(o,t,r,n,i,a,0),void Au(u,t,r,n,i,a,0)}s=s.next}o=o.next}while(o!==e)}function Ou(e,t,r,n){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=ku(e,t[i]*n,i<a-1?t[i+1]*n:e.length,n,!1))===o.next&&(o.steiner=!0),s.push(Lu(o));for(s.sort(Cu),i=0;i<s.length;i++)r=Gu(s[i],r);return r}function Cu(e,t){return e.x-t.x}function Gu(e,t){var r=Bu(e,t);if(!r)return t;var n=Zu(r,e);return Eu(n,n.next),Eu(r,r.next)}function Bu(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o&&(o=s,r=n.x<n.next.x?n:n.next,s===i))return r}n=n.next}while(n!==t);if(!r)return null;var u,l=r,c=r.x,h=r.y,d=1/0;n=r;do{i>=n.x&&n.x>=c&&i!==n.x&&Nu(a<h?i:o,a,c,h,a<h?o:i,a,n.x,n.y)&&(u=Math.abs(a-n.y)/(i-n.x),Ku(n,e)&&(u<d||u===d&&(n.x>r.x||n.x===r.x&&Iu(r,n)))&&(r=n,d=u)),n=n.next}while(n!==l);return r}function Iu(e,t){return Hu(e.prev,e,t.prev)<0&&Hu(t.next,e,e.next)<0}function Fu(e,t,r,n){var i=e;do{0===i.z&&(i.z=Uu(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,Du(i)}function Du(e){var t,r,n,i,a,o,s,u,l=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(u=l;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,l*=2}while(o>1);return e}function Uu(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Lu(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Nu(e,t,r,n,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(n-s)>=(r-o)*(t-s)&&(r-o)*(a-s)>=(i-o)*(n-s)}function Xu(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Yu(e,t)&&(Ku(e,t)&&Ku(t,e)&&qu(e,t)&&(Hu(e.prev,e,t.prev)||Hu(e,t.prev,t))||ju(e,t)&&Hu(e.prev,e,e.next)>0&&Hu(t.prev,t,t.next)>0)}function Hu(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function ju(e,t){return e.x===t.x&&e.y===t.y}function zu(e,t,r,n){var i=Wu(Hu(e,t,r)),a=Wu(Hu(e,t,n)),o=Wu(Hu(r,n,e)),s=Wu(Hu(r,n,t));return i!==a&&o!==s||(!(0!==i||!Vu(e,r,t))||(!(0!==a||!Vu(e,n,t))||(!(0!==o||!Vu(r,e,n))||!(0!==s||!Vu(r,t,n)))))}function Vu(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Wu(e){return e>0?1:e<0?-1:0}function Yu(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&zu(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Ku(e,t){return Hu(e.prev,e,e.next)<0?Hu(e,t,e.next)>=0&&Hu(e,e.prev,t)>=0:Hu(e,t,e.prev)<0||Hu(e,e.next,t)<0}function qu(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}function Zu(e,t){var r=new $u(e.i,e.x,e.y),n=new $u(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function Qu(e,t,r,n){var i=new $u(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Ju(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function $u(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function el(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}Su.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,o=Math.abs(el(e,0,a,r));if(i)for(var s=0,u=t.length;s<u;s++){var l=t[s]*r,c=s<u-1?t[s+1]*r:e.length;o-=Math.abs(el(e,l,c,r))}var h=0;for(s=0;s<n.length;s+=3){var d=n[s]*r,f=n[s+1]*r,p=n[s+2]*r;h+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},Su.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[i][a][o]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r};var tl=xu.exports,rl=exports.earcut=te(tl);function nl(e,t,r,n,i,a,o){var s=rl(e,t,2);if(s){for(var u=0;u<s.length;u+=3)a[o++]=s[u]+i,a[o++]=s[u+1]+i,a[o++]=s[u+2]+i;for(var l=i*n,c=0;c<e.length;c+=2)r[l]=e[c],r[l+1]=e[c+1],l+=n}}var il=[],al=exports.buildPolygon={extension:{type:Z.ShapeBuilder,name:"polygon"},build:function(e,t){for(var r=0;r<e.points.length;r++)t[r]=e.points[r];return t},triangulate:function(e,t,r,n,i,a){nl(e,il,t,r,n,i,a)}},ol=exports.buildRectangle={extension:{type:Z.ShapeBuilder,name:"rectangle"},build:function(e,t){var r=e,n=r.x,i=r.y,a=r.width,o=r.height;return a>=0&&o>=0?(t[0]=n,t[1]=i,t[2]=n+a,t[3]=i,t[4]=n+a,t[5]=i+o,t[6]=n,t[7]=i+o,t):t},triangulate:function(e,t,r,n,i,a){var o=0;t[(n*=r)+o]=e[0],t[n+o+1]=e[1],t[n+(o+=r)]=e[2],t[n+o+1]=e[3],t[n+(o+=r)]=e[6],t[n+o+1]=e[7],t[n+(o+=r)]=e[4],t[n+o+1]=e[5],o+=r;var s=n/r;i[a++]=s,i[a++]=s+1,i[a++]=s+2,i[a++]=s+1,i[a++]=s+3,i[a++]=s+2}},sl=exports.buildTriangle={extension:{type:Z.ShapeBuilder,name:"triangle"},build:function(e,t){return t[0]=e.x,t[1]=e.y,t[2]=e.x2,t[3]=e.y2,t[4]=e.x3,t[5]=e.y3,t},triangulate:function(e,t,r,n,i,a){var o=0;t[(n*=r)+o]=e[0],t[n+o+1]=e[1],t[n+(o+=r)]=e[2],t[n+o+1]=e[3],t[n+(o+=r)]=e[4],t[n+o+1]=e[5];var s=n/r;i[a++]=s,i[a++]=s+1,i[a++]=s+2}},ul=exports.shapeBuilders={};$.handleByMap(Z.ShapeBuilder,ul),$.add(ol,al,sl,hu,du,fu);var ll=new St;function cl(e,t){var r=t.geometryData,n=t.batches;n.length=0,r.indices.length=0,r.vertices.length=0,r.uvs.length=0;for(var i=0;i<e.instructions.length;i++){var a=e.instructions[i];if("texture"===a.action)hl(a.data,n,r);else if("fill"===a.action||"stroke"===a.action){var o="stroke"===a.action,s=a.data.path.shapePath,u=a.data.style,l=a.data.hole;o&&l&&dl(l.shapePath,u,null,!0,n,r),dl(s,u,l,o,n,r)}}}function hl(e,t,r){var n=r.vertices,i=r.uvs,a=r.indices,o=a.length,s=n.length/2,u=[],l=ul.rectangle,c=ll,h=e.image;c.x=e.dx,c.y=e.dy,c.width=e.dw,c.height=e.dh;var d=e.transform;l.build(c,u),d&&Js(u,d),l.triangulate(u,n,2,s,a,o);var f=h.uvs;i.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);var p=pt.get(tu);p.indexOffset=o,p.indexSize=a.length-o,p.attributeOffset=s,p.attributeSize=n.length/2-s,p.baseColor=e.style,p.alpha=e.alpha,p.texture=h,p.geometryData=r,t.push(p)}function dl(e,t,r,n,i,a){var o=a.vertices,s=a.uvs,u=a.indices,l=e.shapePrimitives.length-1;e.shapePrimitives.forEach(function(e,c){var h,d=e.shape,f=e.transform,p=u.length,v=o.length/2,g=[],_=ul[d.type];if(_.build(d,g),f&&Js(g,f),n){var y=null==(h=d.closePath)||h;yu(g,t,!1,y,o,2,v,u,p)}else if(r&&l===c){0!==l&&console.warn("[Pixi Graphics] only the last shape have be cut out");var x=[],b=g.slice();fl(r.shapePath).forEach(function(e){x.push(b.length/2),b.push.apply(b,m(e))}),nl(b,x,o,2,v,u,p)}else _.triangulate(g,o,2,v,u,p);var T=s.length/2,S=t.texture;if(S!==bi.WHITE){var k=t.matrix;k&&(f&&k.append(f.clone().invert()),Zs(o,2,v,s,T,2,o.length/2-v,k))}else Qs(s,T,2,o.length/2-v);var E=pt.get(tu);E.indexOffset=p,E.indexSize=u.length-p,E.attributeOffset=v,E.attributeSize=o.length/2-v,E.baseColor=t.color,E.alpha=t.alpha,E.texture=S,E.geometryData=a,i.push(E)})}function fl(e){if(!e)return[];for(var t=e.shapePrimitives,r=[],n=0;n<t.length;n++){var i=t[n].shape,a=[];ul[i.type].build(i,a),r.push(a)}return r}var pl=exports.GpuGraphicsContext=B(function e(){C(this,e),this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}),vl=exports.GraphicsContextRenderData=function(){return B(function e(){C(this,e),this.batcher=new qs,this.instructions=new Vt},[{key:"init",value:function(){this.instructions.reset()}},{key:"geometry",get:function(){return ht(ct,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}])}(),ml=function(){function e(){C(this,e),this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null)}return B(e,[{key:"init",value:function(t){var r;e.defaultOptions.bezierSmoothness=null!=(r=null==t?void 0:t.bezierSmoothness)?r:e.defaultOptions.bezierSmoothness}},{key:"getContextRenderData",value:function(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}},{key:"updateGpuContext",value:function(e){var t=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){t?this._cleanGraphicsContextData(e):t=this._initContext(e),cl(e,t);var r=e.batchMode;e.customShader||"no-batch"===r?t.isBatchable=!1:"auto"===r&&(t.isBatchable=t.geometryData.vertices.length<400),e.dirty=!1}return t}},{key:"getGpuContext",value:function(e){return this._gpuContextHash[e.uid]||this._initContext(e)}},{key:"_initContextRenderData",value:function(e){for(var t=pt.get(vl),r=this._gpuContextHash[e.uid],n=r.batches,i=r.geometryData,a=i.vertices.length,o=i.indices.length,s=0;s<n.length;s++)n[s].applyTransform=!1;var u=t.batcher;u.ensureAttributeBuffer(a),u.ensureIndexBuffer(o),u.begin();for(var l=0;l<n.length;l++){var c=n[l];u.add(c)}u.finish(t.instructions);var h=u.geometry;h.indexBuffer.setDataWithSize(u.indexBuffer,u.indexSize,!0),h.buffers[0].setDataWithSize(u.attributeBuffer.float32View,u.attributeSize,!0);for(var d=u.batches,f=0;f<d.length;f++){var p=d[f];p.bindGroup=Ta(p.textures.textures,p.textures.count)}return this._graphicsDataContextHash[e.uid]=t,t}},{key:"_initContext",value:function(e){var t=new pl;return t.context=e,this._gpuContextHash[e.uid]=t,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}},{key:"onGraphicsContextDestroy",value:function(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}},{key:"_cleanGraphicsContextData",value:function(e){var t=this._gpuContextHash[e.uid];t.isBatchable||this._graphicsDataContextHash[e.uid]&&(pt.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),t.batches&&t.batches.forEach(function(e){pt.return(e)})}},{key:"destroy",value:function(){for(var e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}}])}();ml.extension={type:[Z.WebGLSystem,Z.WebGPUSystem,Z.CanvasSystem],name:"graphicsContext"},ml.defaultOptions={bezierSmoothness:.5};var gl=exports.GraphicsContextSystem=ml,_l={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},yl=0,xl=1,bl=2,Tl=3,Sl=4,kl=5,El=function(){function e(){C(this,e),this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return B(e,[{key:"blend",get:function(){return!!(this.data&1<<yl)},set:function(e){!!(this.data&1<<yl)!==e&&(this.data^=1<<yl)}},{key:"offsets",get:function(){return!!(this.data&1<<xl)},set:function(e){!!(this.data&1<<xl)!==e&&(this.data^=1<<xl)}},{key:"cullMode",get:function(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"},set:function(e){"none"!==e?(this.culling=!0,this.clockwiseFrontFace="front"===e):this.culling=!1}},{key:"culling",get:function(){return!!(this.data&1<<bl)},set:function(e){!!(this.data&1<<bl)!==e&&(this.data^=1<<bl)}},{key:"depthTest",get:function(){return!!(this.data&1<<Tl)},set:function(e){!!(this.data&1<<Tl)!==e&&(this.data^=1<<Tl)}},{key:"depthMask",get:function(){return!!(this.data&1<<kl)},set:function(e){!!(this.data&1<<kl)!==e&&(this.data^=1<<kl)}},{key:"clockwiseFrontFace",get:function(){return!!(this.data&1<<Sl)},set:function(e){!!(this.data&1<<Sl)!==e&&(this.data^=1<<Sl)}},{key:"blendMode",get:function(){return this._blendMode},set:function(e){this.blend="none"!==e,this._blendMode=e,this._blendModeId=_l[e]||0}},{key:"polygonOffset",get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e}},{key:"toString",value:function(){return"[pixi.js/core:State blendMode=".concat(this.blendMode," clockwiseFrontFace=").concat(this.clockwiseFrontFace," culling=").concat(this.culling," depthMask=").concat(this.depthMask," polygonOffset=").concat(this.polygonOffset,"]")}}],[{key:"for2d",value:function(){var t=new e;return t.depthTest=!1,t.blend=!0,t}}])}();El.default2d=El.for2d();var Al=exports.State=El;function wl(e,t,r,n){r[n++]=(e>>16&255)/255,r[n++]=(e>>8&255)/255,r[n++]=(255&e)/255,r[n++]=t}function Rl(e,t,r){var n=(e>>24&255)/255;t[r++]=(255&e)/255*n,t[r++]=(e>>8&255)/255*n,t[r++]=(e>>16&255)/255*n,t[r++]=n}var Pl=exports.GraphicsPipe=function(){return B(function e(t,r){C(this,e),this.state=Al.for2d(),this._graphicsBatchesHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this.renderer=t,this._adaptor=r,this._adaptor.init()},[{key:"validateRenderable",value:function(e){var t=e.context,r=!!this._graphicsBatchesHash[e.uid],n=this.renderer.graphicsContext.updateGpuContext(t);return!(!n.isBatchable&&r===n.isBatchable)}},{key:"addRenderable",value:function(e,t){var r=this.renderer.graphicsContext.updateGpuContext(e.context);e._didGraphicsUpdate&&(e._didGraphicsUpdate=!1,this._rebuild(e)),r.isBatchable?this._addToBatcher(e,t):(this.renderer.renderPipes.batch.break(t),t.add(e))}},{key:"updateRenderable",value:function(e){var t=this._graphicsBatchesHash[e.uid];if(t)for(var r=0;r<t.length;r++){var n=t[r];n._batcher.updateElement(n)}}},{key:"destroyRenderable",value:function(e){this._graphicsBatchesHash[e.uid]&&this._removeBatchForRenderable(e.uid),e.off("destroyed",this._destroyRenderableBound)}},{key:"execute",value:function(e){if(e.isRenderable){var t=this.renderer,r=e.context;if(t.graphicsContext.getGpuContext(r).batches.length){var n=r.customShader||this._adaptor.shader;this.state.blendMode=e.groupBlendMode;var i=n.resources.localUniforms.uniforms;i.uTransformMatrix=e.groupTransform,i.uRound=t._roundPixels|e._roundPixels,Rl(e.groupColorAlpha,i.uColor,0),this._adaptor.execute(this,e)}}}},{key:"_rebuild",value:function(e){var t=!!this._graphicsBatchesHash[e.uid],r=this.renderer.graphicsContext.updateGpuContext(e.context);t&&this._removeBatchForRenderable(e.uid),r.isBatchable&&this._initBatchesForRenderable(e),e.batched=r.isBatchable}},{key:"_addToBatcher",value:function(e,t){for(var r=this.renderer.renderPipes.batch,n=this._getBatchesForRenderable(e),i=0;i<n.length;i++){var a=n[i];r.addToBatch(a,t)}}},{key:"_getBatchesForRenderable",value:function(e){return this._graphicsBatchesHash[e.uid]||this._initBatchesForRenderable(e)}},{key:"_initBatchesForRenderable",value:function(e){var t=e.context,r=this.renderer.graphicsContext.getGpuContext(t),n=this.renderer._roundPixels|e._roundPixels,i=r.batches.map(function(t){var r=pt.get(tu);return t.copyTo(r),r.renderable=e,r.roundPixels=n,r});return void 0===this._graphicsBatchesHash[e.uid]&&e.on("destroyed",this._destroyRenderableBound),this._graphicsBatchesHash[e.uid]=i,i}},{key:"_removeBatchForRenderable",value:function(e){this._graphicsBatchesHash[e].forEach(function(e){pt.return(e)}),this._graphicsBatchesHash[e]=null}},{key:"destroy",value:function(){for(var e in this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null,this._graphicsBatchesHash)this._removeBatchForRenderable(e);this._graphicsBatchesHash=null}}])}();Pl.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"graphics"},$.add(Pl),$.add(gl);var Ml=exports.BatchableMesh=function(){return B(function e(){C(this,e),this.batcherName="default",this.packAsQuad=!1,this.indexOffset=0,this.attributeOffset=0,this.roundPixels=0,this._batcher=null,this._batch=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1},[{key:"blendMode",get:function(){return this.renderable.groupBlendMode}},{key:"reset",value:function(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.geometry=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}},{key:"uvs",get:function(){var e=this.geometry.getBuffer("aUV"),t=e.data,r=t,n=this.texture.textureMatrix;return n.isSimple||(r=this._transformedUvs,this._textureMatrixUpdateId===n._updateID&&this._uvUpdateId===e._updateID||((!r||r.length<t.length)&&(r=this._transformedUvs=new Float32Array(t.length)),this._textureMatrixUpdateId=n._updateID,this._uvUpdateId=e._updateID,n.multiplyUvs(t,r))),r}},{key:"positions",get:function(){return this.geometry.positions}},{key:"indices",get:function(){return this.geometry.indices}},{key:"color",get:function(){return this.renderable.groupColorAlpha}},{key:"groupTransform",get:function(){return this.renderable.groupTransform}},{key:"attributeSize",get:function(){return this.geometry.positions.length/2}},{key:"indexSize",get:function(){return this.geometry.indices.length}}])}(),Ol=exports.MeshPipe=function(){return B(function e(t,r){C(this,e),this.localUniforms=new Bs({uTransformMatrix:{value:new tt,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),this.localUniformsBindGroup=new pa({0:this.localUniforms}),this._meshDataHash=Object.create(null),this._gpuBatchableMeshHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this.renderer=t,this._adaptor=r,this._adaptor.init()},[{key:"validateRenderable",value:function(e){var t=this._getMeshData(e),r=t.batched,n=e.batched;if(t.batched=n,r!==n)return!0;if(n){var i=e._geometry;if(i.indices.length!==t.indexSize||i.positions.length!==t.vertexSize)return t.indexSize=i.indices.length,t.vertexSize=i.positions.length,!0;var a=this._getBatchableMesh(e),o=e.texture;if(a.texture._source!==o._source&&a.texture._source!==o._source)return!a._batcher.checkAndUpdateTexture(a,o)}return!1}},{key:"addRenderable",value:function(e,t){var r=this.renderer.renderPipes.batch;if(this._getMeshData(e).batched){var n=this._getBatchableMesh(e);n.texture=e._texture,n.geometry=e._geometry,r.addToBatch(n,t)}else r.break(t),t.add(e)}},{key:"updateRenderable",value:function(e){if(e.batched){var t=this._gpuBatchableMeshHash[e.uid];t.texture=e._texture,t.geometry=e._geometry,t._batcher.updateElement(t)}}},{key:"destroyRenderable",value:function(e){this._meshDataHash[e.uid]=null;var t=this._gpuBatchableMeshHash[e.uid];t&&(pt.return(t),this._gpuBatchableMeshHash[e.uid]=null),e.off("destroyed",this._destroyRenderableBound)}},{key:"execute",value:function(e){if(e.isRenderable){e.state.blendMode=Pa(e.groupBlendMode,e.texture._source);var t=this.localUniforms;t.uniforms.uTransformMatrix=e.groupTransform,t.uniforms.uRound=this.renderer._roundPixels|e._roundPixels,t.update(),Rl(e.groupColorAlpha,t.uniforms.uColor,0),this._adaptor.execute(this,e)}}},{key:"_getMeshData",value:function(e){return this._meshDataHash[e.uid]||this._initMeshData(e)}},{key:"_initMeshData",value:function(e){var t,r;return this._meshDataHash[e.uid]={batched:e.batched,indexSize:null==(t=e._geometry.indices)?void 0:t.length,vertexSize:null==(r=e._geometry.positions)?void 0:r.length},e.on("destroyed",this._destroyRenderableBound),this._meshDataHash[e.uid]}},{key:"_getBatchableMesh",value:function(e){return this._gpuBatchableMeshHash[e.uid]||this._initBatchableMesh(e)}},{key:"_initBatchableMesh",value:function(e){var t=pt.get(Ml);return t.renderable=e,t.texture=e._texture,t.transform=e.groupTransform,t.roundPixels=this.renderer._roundPixels|e._roundPixels,this._gpuBatchableMeshHash[e.uid]=t,t}},{key:"destroy",value:function(){for(var e in this._gpuBatchableMeshHash)this._gpuBatchableMeshHash[e]&&pt.return(this._gpuBatchableMeshHash[e]);this._gpuBatchableMeshHash=null,this._meshDataHash=null,this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}}])}();Ol.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"mesh"},$.add(Ol);var Cl=exports.BatchableSprite=function(){return B(function e(){C(this,e),this.batcherName="default",this.attributeSize=4,this.indexSize=6,this.packAsQuad=!0,this.roundPixels=0,this._attributeStart=0,this._batcher=null,this._batch=null},[{key:"blendMode",get:function(){return this.renderable.groupBlendMode}},{key:"color",get:function(){return this.renderable.groupColorAlpha}},{key:"reset",value:function(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.bounds=null}}])}(),Gl=exports.CanvasTextPipe=function(){return B(function e(t){C(this,e),this._gpuText=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=t,this._renderer.runners.resolutionChange.add(this)},[{key:"resolutionChange",value:function(){for(var e in this._gpuText){var t=this._gpuText[e];if(t){var r=t.batchableSprite.renderable;r._autoResolution&&(r._resolution=this._renderer.resolution,r.onViewUpdate())}}}},{key:"validateRenderable",value:function(e){var t=this._getGpuText(e),r=e._getKey();if(t.currentKey!==r){var n=this._renderer.canvasText.getTextureSize(e.text,e.resolution,e._style),i=n.width,a=n.height;return 1!==this._renderer.canvasText.getReferenceCount(t.currentKey)||i!==t.texture._source.width||a!==t.texture._source.height}return!1}},{key:"addRenderable",value:function(e,t){var r=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),this._renderer.renderPipes.batch.addToBatch(r,t)}},{key:"updateRenderable",value:function(e){var t=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),t._batcher.updateElement(t)}},{key:"destroyRenderable",value:function(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableById(e.uid)}},{key:"_destroyRenderableById",value:function(e){var t=this._gpuText[e];this._renderer.canvasText.decreaseReferenceCount(t.currentKey),pt.return(t.batchableSprite),this._gpuText[e]=null}},{key:"_updateText",value:function(e){var t=e._getKey(),r=this._getGpuText(e),n=r.batchableSprite;r.currentKey!==t&&this._updateGpuText(e),e._didTextUpdate=!1;var i=e._style.padding;wi(n.bounds,e._anchor,n.texture,i)}},{key:"_updateGpuText",value:function(e){var t=this._getGpuText(e),r=t.batchableSprite;t.texture&&this._renderer.canvasText.decreaseReferenceCount(t.currentKey),t.texture=r.texture=this._renderer.canvasText.getManagedTexture(e),t.currentKey=e._getKey(),r.texture=t.texture}},{key:"_getGpuText",value:function(e){return this._gpuText[e.uid]||this.initGpuText(e)}},{key:"initGpuText",value:function(e){var t={texture:null,currentKey:"--",batchableSprite:pt.get(Cl)};return t.batchableSprite.renderable=e,t.batchableSprite.transform=e.groupTransform,t.batchableSprite.bounds={minX:0,maxX:1,minY:0,maxY:0},t.batchableSprite.roundPixels=this._renderer._roundPixels|e._roundPixels,this._gpuText[e.uid]=t,e._resolution=e._autoResolution?this._renderer.resolution:e.resolution,this._updateText(e),e.on("destroyed",this._destroyRenderableBound),t}},{key:"destroy",value:function(){for(var e in this._gpuText)this._destroyRenderableById(e);this._gpuText=null,this._renderer=null}}])}();Gl.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"text"};var Bl=exports.CanvasPoolClass=function(){return B(function e(t){C(this,e),this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1},[{key:"_createCanvasAndContext",value:function(e,t){var r=hn.get().createCanvas();r.width=e,r.height=t;var n=r.getContext("2d");return{canvas:r,context:n}}},{key:"getOptimalCanvasAndContext",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e=Math.ceil(e*r-1e-6),t=Math.ceil(t*r-1e-6);var n=((e=Xn(e))<<17)+((t=Xn(t))<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);var i=this._canvasPool[n].pop();return i||(i=this._createCanvasAndContext(e,t)),i}},{key:"returnCanvasAndContext",value:function(e){var t=e.canvas,r=(t.width<<17)+(t.height<<1);this._canvasPool[r].push(e)}},{key:"clear",value:function(){this._canvasPool={}}}])}(),Il=exports.CanvasPool=new Bl,Fl=Object.defineProperty,Dl=Object.defineProperties,Ul=Object.getOwnPropertyDescriptors,Ll=Object.getOwnPropertySymbols,Nl=Object.prototype.hasOwnProperty,Xl=Object.prototype.propertyIsEnumerable,Hl=function(e,t,r){return t in e?Fl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},jl=function(e,t){for(var r in t||(t={}))Nl.call(t,r)&&Hl(e,r,t[r]);if(Ll){var n,i=U(Ll(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Xl.call(t,r)&&Hl(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},zl=function(e,t){return Dl(e,Ul(t))},Vl=0,Wl=exports.TexturePoolClass=function(){return B(function e(t){C(this,e),this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1},[{key:"createTexture",value:function(e,t,r){var n=new ui(zl(jl({},this.textureOptions),{width:e,height:t,resolution:1,antialias:r,autoGarbageCollect:!0}));return new bi({source:n,label:"texturePool_".concat(Vl++)})}},{key:"getOptimalTexture",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,i=Math.ceil(e*r-1e-6),a=Math.ceil(t*r-1e-6),o=((i=Xn(i))<<17)+((a=Xn(a))<<1)+(n?1:0);this._texturePool[o]||(this._texturePool[o]=[]);var s=this._texturePool[o].pop();return s||(s=this.createTexture(i,a,n)),s.source._resolution=r,s.source.width=i/r,s.source.height=a/r,s.source.pixelWidth=i,s.source.pixelHeight=a,s.frame.x=0,s.frame.y=0,s.frame.width=e,s.frame.height=t,s.updateUvs(),this._poolKeyHash[s.uid]=o,s}},{key:"getSameSizeTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.source;return this.getOptimalTexture(e.width,e.height,r._resolution,t)}},{key:"returnTexture",value:function(e){var t=this._poolKeyHash[e.uid];this._texturePool[t].push(e)}},{key:"clear",value:function(e){if(e=!1!==e)for(var t in this._texturePool){var r=this._texturePool[t];if(r)for(var n=0;n<r.length;n++)r[n].destroy(!0)}this._texturePool={}}}])}(),Yl=exports.TexturePool=new Wl;function Kl(e,t,r){for(var n=0,i=4*r*t;n<t;++n,i+=4)if(0!==e[i+3])return!1;return!0}function ql(e,t,r,n,i){for(var a=4*t,o=n,s=n*a+4*r;o<=i;++o,s+=a)if(0!==e[s+3])return!1;return!0}function Zl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.width,n=e.height,i=e.getContext("2d",{willReadFrequently:!0});if(null===i)throw new TypeError("Failed to get canvas 2D context");for(var a=i.getImageData(0,0,r,n).data,o=0,s=0,u=r-1,l=n-1;s<n&&Kl(a,r,s);)++s;if(s===n)return St.EMPTY;for(;Kl(a,r,l);)--l;for(;ql(a,r,o,s,l);)++o;for(;ql(a,r,u,s,l);)--u;return new St(o/t,s/t,(++u-o)/t,(++l-s)/t)}var Ql=function(){function e(t,r,n,i){C(this,e),this.uid=ot("fillGradient"),this.type="linear",this.gradientStops=[],this._styleKey=null,this.x0=t,this.y0=r,this.x1=n,this.y1=i}return B(e,[{key:"addColorStop",value:function(e,t){return this.gradientStops.push({offset:e,color:Ke.shared.setValue(t).toHexa()}),this._styleKey=null,this}},{key:"buildLinearGradient",value:function(){var t=e.defaultTextureSize,r=this.gradientStops,n=hn.get().createCanvas();n.width=t,n.height=t;for(var i=n.getContext("2d"),a=i.createLinearGradient(0,0,e.defaultTextureSize,1),o=0;o<r.length;o++){var s=r[o];a.addColorStop(s.offset,s.color)}i.fillStyle=a,i.fillRect(0,0,t,t),this.texture=new bi({source:new Wi({resource:n,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});var u=this.x0,l=this.y0,c=this.x1,h=this.y1,d=new tt,f=c-u,p=h-l,v=Math.sqrt(f*f+p*p),m=Math.atan2(p,f);d.translate(-u,-l),d.scale(1/t,1/t),d.rotate(-m),d.scale(256/v,1),this.transform=d,this._styleKey=null}},{key:"styleKey",get:function(){if(this._styleKey)return this._styleKey;var e=this.gradientStops.map(function(e){return"".concat(e.offset,"-").concat(e.color)}).join("-"),t=this.texture.uid,r=this.transform.toArray().join("-");return"fill-gradient-".concat(this.uid,"-").concat(e,"-").concat(t,"-").concat(r,"-").concat(this.x0,"-").concat(this.y0,"-").concat(this.x1,"-").concat(this.y1)}}])}();Ql.defaultTextureSize=256;var Jl=exports.FillGradient=Ql,$l={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}},ec=exports.FillPattern=function(){return B(function e(t,r){C(this,e),this.uid=ot("fillPattern"),this.transform=new tt,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),r&&(t.source.style.addressModeU=$l[r].addressModeU,t.source.style.addressModeV=$l[r].addressModeV)},[{key:"setTransform",value:function(e){var t=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/t.frame.width,1/t.frame.height),this._styleKey=null}},{key:"styleKey",get:function(){return this._styleKey?this._styleKey:(this._styleKey="fill-pattern-".concat(this.uid,"-").concat(this.texture.uid,"-").concat(this.transform.toArray().join("-")),this._styleKey)}}])}(),tc=ic,rc={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},nc=/([astvzqmhlc])([^astvzqmhlc]*)/gi;function ic(e){var t=[];return e.replace(nc,function(e,r,n){var i=r.toLowerCase();for(n=oc(n),"m"==i&&n.length>2&&(t.push([r].concat(n.splice(0,2))),i="l",r="m"==r?"l":"L");;){if(n.length==rc[i])return n.unshift(r),t.push(n);if(n.length<rc[i])throw new Error("malformed path data");t.push([r].concat(n.splice(0,rc[i])))}}),t}var ac=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function oc(e){var t=e.match(ac);return t?t.map(Number):[]}var sc=te(tc);function uc(e,t){for(var r=sc(e),n=[],i=null,a=0,o=0,s=0;s<r.length;s++){var u=r[s],l=u[0],c=u;switch(l){case"M":a=c[1],o=c[2],t.moveTo(a,o);break;case"m":a+=c[1],o+=c[2],t.moveTo(a,o);break;case"H":a=c[1],t.lineTo(a,o);break;case"h":a+=c[1],t.lineTo(a,o);break;case"V":o=c[1],t.lineTo(a,o);break;case"v":o+=c[1],t.lineTo(a,o);break;case"L":a=c[1],o=c[2],t.lineTo(a,o);break;case"l":a+=c[1],o+=c[2],t.lineTo(a,o);break;case"C":a=c[5],o=c[6],t.bezierCurveTo(c[1],c[2],c[3],c[4],a,o);break;case"c":t.bezierCurveTo(a+c[1],o+c[2],a+c[3],o+c[4],a+c[5],o+c[6]),a+=c[5],o+=c[6];break;case"S":a=c[3],o=c[4],t.bezierCurveToShort(c[1],c[2],a,o);break;case"s":t.bezierCurveToShort(a+c[1],o+c[2],a+c[3],o+c[4]),a+=c[3],o+=c[4];break;case"Q":a=c[3],o=c[4],t.quadraticCurveTo(c[1],c[2],a,o);break;case"q":t.quadraticCurveTo(a+c[1],o+c[2],a+c[3],o+c[4]),a+=c[3],o+=c[4];break;case"T":a=c[1],o=c[2],t.quadraticCurveToShort(a,o);break;case"t":a+=c[1],o+=c[2],t.quadraticCurveToShort(a,o);break;case"A":a=c[6],o=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],a,o);break;case"a":a+=c[6],o+=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],a,o);break;case"Z":case"z":t.closePath(),n.length>0&&((i=n.pop())?(a=i.startX,o=i.startY):(a=0,o=0)),i=null;break;default:Gt("Unknown SVG path command: ".concat(l))}"Z"!==l&&"z"!==l&&null===i&&(i={startX:a,startY:o},n.push(i))}return t}var lc=exports.Circle=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;C(this,e),this.type="circle",this.x=t,this.y=r,this.radius=n}return B(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.radius)}},{key:"contains",value:function(e,t){if(this.radius<=0)return!1;var r=this.radius*this.radius,n=this.x-e,i=this.y-t;return(n*=n)+(i*=i)<=r}},{key:"strokeContains",value:function(e,t,r){if(0===this.radius)return!1;var n=this.x-e,i=this.y-t,a=this.radius,o=r/2,s=Math.sqrt(n*n+i*i);return s<a+o&&s>a-o}},{key:"getBounds",value:function(e){return(e=e||new St).x=this.x-this.radius,e.y=this.y-this.radius,e.width=2*this.radius,e.height=2*this.radius,e}},{key:"copyFrom",value:function(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}},{key:"copyTo",value:function(e){return e.copyFrom(this),e}},{key:"toString",value:function(){return"[pixi.js/math:Circle x=".concat(this.x," y=").concat(this.y," radius=").concat(this.radius,"]")}}])}(),cc=exports.Ellipse=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;C(this,e),this.type="ellipse",this.x=t,this.y=r,this.halfWidth=n,this.halfHeight=i}return B(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.halfWidth,this.halfHeight)}},{key:"contains",value:function(e,t){if(this.halfWidth<=0||this.halfHeight<=0)return!1;var r=(e-this.x)/this.halfWidth,n=(t-this.y)/this.halfHeight;return(r*=r)+(n*=n)<=1}},{key:"strokeContains",value:function(e,t,r){var n=this.halfWidth,i=this.halfHeight;if(n<=0||i<=0)return!1;var a=r/2,o=n-a,s=i-a,u=n+a,l=i+a,c=e-this.x,h=t-this.y;return c*c/(o*o)+h*h/(s*s)>1&&c*c/(u*u)+h*h/(l*l)<=1}},{key:"getBounds",value:function(e){return(e=e||new St).x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=2*this.halfWidth,e.height=2*this.halfHeight,e}},{key:"copyFrom",value:function(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}},{key:"copyTo",value:function(e){return e.copyFrom(this),e}},{key:"toString",value:function(){return"[pixi.js/math:Ellipse x=".concat(this.x," y=").concat(this.y," halfWidth=").concat(this.halfWidth," halfHeight=").concat(this.halfHeight,"]")}}])}();function hc(e,t,r,n,i,a){var o,s,u=i-r,l=a-n,c=u*u+l*l,h=-1;0!==c&&(h=((e-r)*u+(t-n)*l)/c),h<0?(o=r,s=n):h>1?(o=i,s=a):(o=r+h*u,s=n+h*l);var d=e-o,f=t-s;return d*d+f*f}var dc=exports.Polygon=function(){function e(){C(this,e),this.type="polygon";for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=Array.isArray(r[0])?r[0]:r;if("number"!=typeof i[0]){for(var a=[],o=0,s=i.length;o<s;o++)a.push(i[o].x,i[o].y);i=a}this.points=i,this.closePath=!0}return B(e,[{key:"clone",value:function(){var t=new e(this.points.slice());return t.closePath=this.closePath,t}},{key:"contains",value:function(e,t){for(var r=!1,n=this.points.length/2,i=0,a=n-1;i<n;a=i++){var o=this.points[2*i],s=this.points[2*i+1],u=this.points[2*a],l=this.points[2*a+1];s>t!=l>t&&e<(t-s)/(l-s)*(u-o)+o&&(r=!r)}return r}},{key:"strokeContains",value:function(e,t,r){for(var n=r/2,i=n*n,a=this.points,o=a.length-(this.closePath?0:2),s=0;s<o;s+=2){if(hc(e,t,a[s],a[s+1],a[(s+2)%a.length],a[(s+3)%a.length])<=i)return!0}return!1}},{key:"getBounds",value:function(e){e=e||new St;for(var t=this.points,r=1/0,n=-1/0,i=1/0,a=-1/0,o=0,s=t.length;o<s;o+=2){var u=t[o],l=t[o+1];r=u<r?u:r,n=u>n?u:n,i=l<i?l:i,a=l>a?l:a}return e.x=r,e.width=n-r,e.y=i,e.height=a-i,e}},{key:"copyFrom",value:function(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}},{key:"copyTo",value:function(e){return e.copyFrom(this),e}},{key:"toString",value:function(){return"[pixi.js/math:PolygoncloseStroke=".concat(this.closePath,"points=").concat(this.points.reduce(function(e,t){return"".concat(e,", ").concat(t)},""),"]")}},{key:"lastX",get:function(){return this.points[this.points.length-2]}},{key:"lastY",get:function(){return this.points[this.points.length-1]}},{key:"x",get:function(){return this.points[this.points.length-2]}},{key:"y",get:function(){return this.points[this.points.length-1]}}])}(),fc=function(e,t,r,n,i,a){var o=e-r,s=t-n,u=Math.sqrt(o*o+s*s);return u>=i-a&&u<=i+a},pc=exports.RoundedRectangle=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;C(this,e),this.type="roundedRectangle",this.x=t,this.y=r,this.width=n,this.height=i,this.radius=a}return B(e,[{key:"getBounds",value:function(e){return(e=e||new St).x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}},{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height,this.radius)}},{key:"copyFrom",value:function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}},{key:"copyTo",value:function(e){return e.copyFrom(this),e}},{key:"contains",value:function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){var r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+r&&t<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;var n=e-(this.x+r),i=t-(this.y+r),a=r*r;if(n*n+i*i<=a)return!0;if((n=e-(this.x+this.width-r))*n+i*i<=a)return!0;if(n*n+(i=t-(this.y+this.height-r))*i<=a)return!0;if((n=e-(this.x+r))*n+i*i<=a)return!0}return!1}},{key:"strokeContains",value:function(e,t,r){var n=this.x,i=this.y,a=this.width,o=this.height,s=this.radius,u=r/2,l=n+s,c=i+s,h=n+a,d=i+o;return(e>=n-u&&e<=n+u||e>=h-u&&e<=h+u)&&t>=c&&t<=c+(o-2*s)||((t>=i-u&&t<=i+u||t>=d-u&&t<=d+u)&&e>=l&&e<=l+(a-2*s)||(e<l&&t<c&&fc(e,t,l,c,s,u)||e>h-s&&t<c&&fc(e,t,h-s,c,s,u)||e>h-s&&t>d-s&&fc(e,t,h-s,d-s,s,u)||e<l&&t>d-s&&fc(e,t,l,d-s,s,u)))}},{key:"toString",value:function(){return"[pixi.js/math:RoundedRectangle x=".concat(this.x," y=").concat(this.y,"width=").concat(this.width," height=").concat(this.height," radius=").concat(this.radius,"]")}}])}(),vc=8,mc=1.1920929e-7,gc=1,_c=.01,yc=0,xc=0;function bc(e,t,r,n,i,a,o,s,u,l){var c=Math.min(.99,Math.max(0,null!=l?l:gl.defaultOptions.bezierSmoothness)),h=(gc-c)/1;return Tc(t,r,n,i,a,o,s,u,e,h*=h),e}function Tc(e,t,r,n,i,a,o,s,u,l){Sc(e,t,r,n,i,a,o,s,u,l,0),u.push(o,s)}function Sc(e,t,r,n,i,a,o,s,u,l,c){if(!(c>vc)){var h=Math.PI,d=(e+r)/2,f=(t+n)/2,p=(r+i)/2,v=(n+a)/2,m=(i+o)/2,g=(a+s)/2,_=(d+p)/2,y=(f+v)/2,x=(p+m)/2,b=(v+g)/2,T=(_+x)/2,S=(y+b)/2;if(c>0){var k,E,A=o-e,w=s-t,R=Math.abs((r-o)*w-(n-s)*A),P=Math.abs((i-o)*w-(a-s)*A);if(R>mc&&P>mc){if((R+P)*(R+P)<=l*(A*A+w*w)){if(yc<_c)return void u.push(T,S);var M=Math.atan2(a-n,i-r);if((k=Math.abs(M-Math.atan2(n-t,r-e)))>=h&&(k=2*h-k),(E=Math.abs(Math.atan2(s-a,o-i)-M))>=h&&(E=2*h-E),k+E<yc)return void u.push(T,S);if(0!==xc){if(k>xc)return void u.push(r,n);if(E>xc)return void u.push(i,a)}}}else if(R>mc){if(R*R<=l*(A*A+w*w)){if(yc<_c)return void u.push(T,S);if((k=Math.abs(Math.atan2(a-n,i-r)-Math.atan2(n-t,r-e)))>=h&&(k=2*h-k),k<yc)return u.push(r,n),void u.push(i,a);if(0!==xc&&k>xc)return void u.push(r,n)}}else if(P>mc){if(P*P<=l*(A*A+w*w)){if(yc<_c)return void u.push(T,S);if((k=Math.abs(Math.atan2(s-a,o-i)-Math.atan2(a-n,i-r)))>=h&&(k=2*h-k),k<yc)return u.push(r,n),void u.push(i,a);if(0!==xc&&k>xc)return void u.push(i,a)}}else if((A=T-(e+o)/2)*A+(w=S-(t+s)/2)*w<=l)return void u.push(T,S)}Sc(e,t,d,f,_,y,T,S,u,l,c+1),Sc(T,S,x,b,m,g,o,s,u,l,c+1)}}var kc=8,Ec=1.1920929e-7,Ac=1,wc=.01,Rc=0;function Pc(e,t,r,n,i,a,o,s){var u=Math.min(.99,Math.max(0,null!=s?s:gl.defaultOptions.bezierSmoothness)),l=(Ac-u)/1;return Mc(t,r,n,i,a,o,e,l*=l),e}function Mc(e,t,r,n,i,a,o,s){Oc(o,e,t,r,n,i,a,s,0),o.push(i,a)}function Oc(e,t,r,n,i,a,o,s,u){if(!(u>kc)){var l=Math.PI,c=(t+n)/2,h=(r+i)/2,d=(n+a)/2,f=(i+o)/2,p=(c+d)/2,v=(h+f)/2,m=a-t,g=o-r,_=Math.abs((n-a)*g-(i-o)*m);if(_>Ec){if(_*_<=s*(m*m+g*g)){if(Rc<wc)return void e.push(p,v);var y=Math.abs(Math.atan2(o-i,a-n)-Math.atan2(i-r,n-t));if(y>=l&&(y=2*l-y),y<Rc)return void e.push(p,v)}}else if((m=p-(t+a)/2)*m+(g=v-(r+o)/2)*g<=s)return void e.push(p,v);Oc(e,t,r,c,h,p,v,s,u+1),Oc(e,p,v,d,f,a,o,s,u+1)}}function Cc(e,t,r,n,i,a,o,s){var u=Math.abs(i-a);!o&&i>a?u=2*Math.PI-u:o&&a>i&&(u=2*Math.PI-u),s=s||Math.max(6,Math.floor(6*Math.pow(n,1/3)*(u/Math.PI)));var l=u/(s=Math.max(s,3)),c=i;l*=o?-1:1;for(var h=0;h<s+1;h++){var d=t+Math.cos(c)*n,f=r+Math.sin(c)*n;e.push(d,f),c+=l}}function Gc(e,t,r,n,i,a){var o=e[e.length-2],s=e[e.length-1]-r,u=o-t,l=i-r,c=n-t,h=Math.abs(s*c-u*l);if(h<1e-8||0===a)e[e.length-2]===t&&e[e.length-1]===r||e.push(t,r);else{var d=s*s+u*u,f=l*l+c*c,p=s*l+u*c,v=a*Math.sqrt(d)/h,m=a*Math.sqrt(f)/h,g=v*p/d,_=m*p/f,y=v*c+m*u,x=v*l+m*s,b=u*(m+g),T=s*(m+g),S=c*(v+_),k=l*(v+_);Cc(e,y+t,x+r,a,Math.atan2(T-x,b-y),Math.atan2(k-x,S-y),u*l>c*s)}}var Bc=2*Math.PI,Ic={centerX:0,centerY:0,ang1:0,ang2:0},Fc=function(e,t,r,n,i,a,o,s){var u=e.x,l=e.y,c=n*(u*=t)-i*(l*=r),h=i*u+n*l;return s.x=c+a,s.y=h+o,s};function Dc(e,t){var r=-1.5707963267948966===t?-.551915024494:4/3*Math.tan(t/4),n=1.5707963267948966===t?.551915024494:r,i=Math.cos(e),a=Math.sin(e),o=Math.cos(e+t),s=Math.sin(e+t);return[{x:i-a*n,y:a+i*n},{x:o+s*n,y:s-o*n},{x:o,y:s}]}var Uc=function(e,t,r,n){var i=e*r+t*n;return i>1&&(i=1),i<-1&&(i=-1),(e*n-t*r<0?-1:1)*Math.acos(i)},Lc=function(e,t,r,n,i,a,o,s,u,l,c,h,d){var f=Math.pow(i,2),p=Math.pow(a,2),v=Math.pow(c,2),m=Math.pow(h,2),g=f*p-f*m-p*v;g<0&&(g=0),g/=f*m+p*v;var _=(g=Math.sqrt(g)*(o===s?-1:1))*i/a*h,y=g*-a/i*c,x=l*_-u*y+(e+r)/2,b=u*_+l*y+(t+n)/2,T=(c-_)/i,S=(h-y)/a,k=(-c-_)/i,E=(-h-y)/a,A=Uc(1,0,T,S),w=Uc(T,S,k,E);0===s&&w>0&&(w-=Bc),1===s&&w<0&&(w+=Bc),d.centerX=x,d.centerY=b,d.ang1=A,d.ang2=w};function Nc(e,t,r,n,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;if(0!==a&&0!==o){var c=Math.sin(s*Bc/360),h=Math.cos(s*Bc/360),d=h*(t-n)/2+c*(r-i)/2,f=-c*(t-n)/2+h*(r-i)/2;if(0!==d||0!==f){a=Math.abs(a),o=Math.abs(o);var p=Math.pow(d,2)/Math.pow(a,2)+Math.pow(f,2)/Math.pow(o,2);p>1&&(a*=Math.sqrt(p),o*=Math.sqrt(p)),Lc(t,r,n,i,a,o,u,l,c,h,d,f,Ic);var v=Ic.ang1,m=Ic.ang2,g=Ic.centerX,_=Ic.centerY,y=Math.abs(m)/(Bc/4);Math.abs(1-y)<1e-7&&(y=1);var x=Math.max(Math.ceil(y),1);m/=x;for(var b=e[e.length-2],T=e[e.length-1],S={x:0,y:0},k=0;k<x;k++){var E=Dc(v,m),A=Fc(E[0],a,o,h,c,g,_,S),w=A.x,R=A.y,P=Fc(E[1],a,o,h,c,g,_,S),M=P.x,O=P.y,C=Fc(E[2],a,o,h,c,g,_,S),G=C.x,B=C.y;bc(e,b,T,w,R,M,O,G,B),b=G,T=B,v+=m}}}}function Xc(e,t,r){for(var n,i=function(e,t){var r=t.x-e.x,n=t.y-e.y,i=Math.sqrt(r*r+n*n);return{len:i,nx:r/i,ny:n/i}},a=function(t,r){0===t?e.moveTo(r.x,r.y):e.lineTo(r.x,r.y)},o=t[t.length-1],s=0;s<t.length;s++){var u=t[s%t.length],l=null!=(n=u.radius)?n:r;if(l<=0)a(s,u),o=u;else{var c=t[(s+1)%t.length],h=i(u,o),d=i(u,c);if(h.len<1e-4||d.len<1e-4)a(s,u),o=u;else{var f=Math.asin(h.nx*d.ny-h.ny*d.nx),p=1,v=!1;h.nx*d.nx-h.ny*-d.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,p=-1,v=!0):f>0&&(p=-1,v=!0);var m=f/2,g=void 0,_=Math.abs(Math.cos(m)*l/Math.sin(m));_>Math.min(h.len/2,d.len/2)?(_=Math.min(h.len/2,d.len/2),g=Math.abs(_*Math.sin(m)/Math.cos(m))):g=l;var y=u.x+d.nx*_+-d.ny*g*p,x=u.y+d.ny*_+d.nx*g*p,b=Math.atan2(h.ny,h.nx)+Math.PI/2*p,T=Math.atan2(d.ny,d.nx)-Math.PI/2*p;0===s&&e.moveTo(y+Math.cos(b)*g,x+Math.sin(b)*g),e.arc(y,x,g,b,T,v),o=u}}}}function Hc(e,t,r,n){for(var i,a=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},o=function(e,t,r){return{x:e.x+(t.x-e.x)*r,y:e.y+(t.y-e.y)*r}},s=t.length,u=0;u<s;u++){var l=t[(u+1)%s],c=null!=(i=l.radius)?i:r;if(c<=0)0===u?e.moveTo(l.x,l.y):e.lineTo(l.x,l.y);else{var h=t[u],d=t[(u+2)%s],f=a(h,l),p=void 0;if(f<1e-4)p=l;else p=o(l,h,Math.min(f/2,c)/f);var v=a(d,l),m=void 0;if(v<1e-4)m=l;else m=o(l,d,Math.min(v/2,c)/v);0===u?e.moveTo(p.x,p.y):e.lineTo(p.x,p.y),e.quadraticCurveTo(l.x,l.y,m.x,m.y,n)}}}var jc=new St,zc=exports.ShapePath=function(){return B(function e(t){C(this,e),this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Et,this._graphicsPath2D=t},[{key:"moveTo",value:function(e,t){return this.startPoly(e,t),this}},{key:"lineTo",value:function(e,t){this._ensurePoly();var r=this._currentPoly.points,n=r[r.length-2],i=r[r.length-1];return n===e&&i===t||r.push(e,t),this}},{key:"arc",value:function(e,t,r,n,i,a){return this._ensurePoly(!1),Cc(this._currentPoly.points,e,t,r,n,i,a),this}},{key:"arcTo",value:function(e,t,r,n,i){return this._ensurePoly(),Gc(this._currentPoly.points,e,t,r,n,i),this}},{key:"arcToSvg",value:function(e,t,r,n,i,a,o){return Nc(this._currentPoly.points,this._currentPoly.lastX,this._currentPoly.lastY,a,o,e,t,r,n,i),this}},{key:"bezierCurveTo",value:function(e,t,r,n,i,a,o){this._ensurePoly();var s=this._currentPoly;return bc(this._currentPoly.points,s.lastX,s.lastY,e,t,r,n,i,a,o),this}},{key:"quadraticCurveTo",value:function(e,t,r,n,i){this._ensurePoly();var a=this._currentPoly;return Pc(this._currentPoly.points,a.lastX,a.lastY,e,t,r,n,i),this}},{key:"closePath",value:function(){return this.endPoly(!0),this}},{key:"addPath",value:function(e,t){this.endPoly(),t&&!t.isIdentity()&&(e=e.clone(!0)).transform(t);for(var r=0;r<e.instructions.length;r++){var n=e.instructions[r];this[n.action].apply(this,m(n.data))}return this}},{key:"finish",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.endPoly(e)}},{key:"rect",value:function(e,t,r,n,i){return this.drawShape(new St(e,t,r,n),i),this}},{key:"circle",value:function(e,t,r,n){return this.drawShape(new lc(e,t,r),n),this}},{key:"poly",value:function(e,t,r){var n=new dc(e);return n.closePath=t,this.drawShape(n,r),this}},{key:"regularPoly",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0;n=Math.max(0|n,3);for(var o=-1*Math.PI/2+i,s=2*Math.PI/n,u=[],l=0;l<n;l++){var c=l*s+o;u.push(e+r*Math.cos(c),t+r*Math.sin(c))}return this.poly(u,!0,a),this}},{key:"roundPoly",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;if(n=Math.max(0|n,3),i<=0)return this.regularPoly(e,t,r,n,a);var s=r*Math.sin(Math.PI/n)-.001;i=Math.min(i,s);for(var u=-1*Math.PI/2+a,l=2*Math.PI/n,c=(n-2)*Math.PI/n/2,h=0;h<n;h++){var d=h*l+u,f=e+r*Math.cos(d),p=t+r*Math.sin(d),v=d+Math.PI+c,m=d-Math.PI-c,g=f+i*Math.cos(v),_=p+i*Math.sin(v),y=f+i*Math.cos(m),x=p+i*Math.sin(m);0===h?this.moveTo(g,_):this.lineTo(g,_),this.quadraticCurveTo(f,p,y,x,o)}return this.closePath()}},{key:"roundShape",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;return e.length<3?this:(r?Hc(this,e,t,n):Xc(this,e,t),this.closePath())}},{key:"filletRect",value:function(e,t,r,n,i){if(0===i)return this.rect(e,t,r,n);var a=Math.min(r,n)/2,o=Math.min(a,Math.max(-a,i)),s=e+r,u=t+n,l=o<0?-o:0,c=Math.abs(o);return this.moveTo(e,t+c).arcTo(e+l,t+l,e+c,t,c).lineTo(s-c,t).arcTo(s-l,t+l,s,t+c,c).lineTo(s,u-c).arcTo(s-l,u-l,e+r-c,u,c).lineTo(e+c,u).arcTo(e+l,u-l,e,u-c,c).closePath()}},{key:"chamferRect",value:function(e,t,r,n,i,a){if(i<=0)return this.rect(e,t,r,n);for(var o=Math.min(i,Math.min(r,n)/2),s=e+r,u=t+n,l=[e+o,t,s-o,t,s,t+o,s,u-o,s-o,u,e+o,u,e,u-o,e,t+o],c=l.length-1;c>=2;c-=2)l[c]===l[c-2]&&l[c-1]===l[c-3]&&l.splice(c-1,2);return this.poly(l,!0,a)}},{key:"ellipse",value:function(e,t,r,n,i){return this.drawShape(new cc(e,t,r,n),i),this}},{key:"roundRect",value:function(e,t,r,n,i,a){return this.drawShape(new pc(e,t,r,n,i),a),this}},{key:"drawShape",value:function(e,t){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:t}),this}},{key:"startPoly",value:function(e,t){var r=this._currentPoly;return r&&this.endPoly(),(r=new dc).points.push(e,t),this._currentPoly=r,this}},{key:"endPoly",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._currentPoly;return t&&t.points.length>2&&(t.closePath=e,this.shapePrimitives.push({shape:t})),this._currentPoly=null,this}},{key:"_ensurePoly",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this._currentPoly&&(this._currentPoly=new dc,e)){var t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){var r=t.shape.x,n=t.shape.y;if(t.transform&&!t.transform.isIdentity()){var i=t.transform,a=r;r=i.a*r+i.c*n+i.tx,n=i.b*a+i.d*n+i.ty}this._currentPoly.points.push(r,n)}else this._currentPoly.points.push(0,0)}}},{key:"buildPath",value:function(){var e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(var t=0;t<e.instructions.length;t++){var r=e.instructions[t];this[r.action].apply(this,m(r.data))}this.finish()}},{key:"bounds",get:function(){var e=this._bounds;e.clear();for(var t=this.shapePrimitives,r=0;r<t.length;r++){var n=t[r],i=n.shape.getBounds(jc);n.transform?e.addRect(i,n.transform):e.addRect(i)}return e}}])}(),Vc=exports.GraphicsPath=function(){function e(t){var r;C(this,e),this.instructions=[],this.uid=ot("graphicsPath"),this._dirty=!0,"string"==typeof t?uc(t,this):this.instructions=null!=(r=null==t?void 0:t.slice())?r:[]}return B(e,[{key:"shapePath",get:function(){return this._shapePath||(this._shapePath=new zc(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}},{key:"addPath",value:function(e,t){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,t]}),this._dirty=!0,this}},{key:"arc",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}},{key:"arcTo",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}},{key:"arcToSvg",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}},{key:"bezierCurveTo",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}},{key:"bezierCurveToShort",value:function(e,t,r,n,i){var a=this.instructions[this.instructions.length-1],o=this.getLastPoint($e.shared),s=0,u=0;if(a&&"bezierCurveTo"===a.action){s=a.data[2],u=a.data[3];var l=o.x,c=o.y;s=l+(l-s),u=c+(c-u)}else s=o.x,u=o.y;return this.instructions.push({action:"bezierCurveTo",data:[s,u,e,t,r,n,i]}),this._dirty=!0,this}},{key:"closePath",value:function(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}},{key:"ellipse",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}},{key:"lineTo",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}},{key:"moveTo",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"moveTo",data:t}),this}},{key:"quadraticCurveTo",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}},{key:"quadraticCurveToShort",value:function(e,t,r){var n=this.instructions[this.instructions.length-1],i=this.getLastPoint($e.shared),a=0,o=0;if(n&&"quadraticCurveTo"===n.action){a=n.data[0],o=n.data[1];var s=i.x,u=i.y;a=s+(s-a),o=u+(u-o)}else a=i.x,o=i.y;return this.instructions.push({action:"quadraticCurveTo",data:[a,o,e,t,r]}),this._dirty=!0,this}},{key:"rect",value:function(e,t,r,n,i){return this.instructions.push({action:"rect",data:[e,t,r,n,i]}),this._dirty=!0,this}},{key:"circle",value:function(e,t,r,n){return this.instructions.push({action:"circle",data:[e,t,r,n]}),this._dirty=!0,this}},{key:"roundRect",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}},{key:"poly",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}},{key:"regularPoly",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}},{key:"roundPoly",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}},{key:"roundShape",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}},{key:"filletRect",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}},{key:"chamferRect",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}},{key:"star",value:function(e,t,r,n,i,a,o){i=i||n/2;for(var s=-1*Math.PI/2+a,u=2*r,l=2*Math.PI/u,c=[],h=0;h<u;h++){var d=h%2?i:n,f=h*l+s;c.push(e+d*Math.cos(f),t+d*Math.sin(f))}return this.poly(c,!0,o),this}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=new e;if(t)for(var n=0;n<this.instructions.length;n++){var i=this.instructions[n];r.instructions.push({action:i.action,data:i.data.slice()})}else r.instructions=this.instructions.slice();return r}},{key:"clear",value:function(){return this.instructions.length=0,this._dirty=!0,this}},{key:"transform",value:function(e){if(e.isIdentity())return this;for(var t=e.a,r=e.b,n=e.c,i=e.d,a=e.tx,o=e.ty,s=0,u=0,l=0,c=0,h=0,d=0,f=0,p=0,v=0;v<this.instructions.length;v++){var m=this.instructions[v],g=m.data;switch(m.action){case"moveTo":case"lineTo":s=g[0],u=g[1],g[0]=t*s+n*u+a,g[1]=r*s+i*u+o;break;case"bezierCurveTo":l=g[0],c=g[1],h=g[2],d=g[3],s=g[4],u=g[5],g[0]=t*l+n*c+a,g[1]=r*l+i*c+o,g[2]=t*h+n*d+a,g[3]=r*h+i*d+o,g[4]=t*s+n*u+a,g[5]=r*s+i*u+o;break;case"quadraticCurveTo":l=g[0],c=g[1],s=g[2],u=g[3],g[0]=t*l+n*c+a,g[1]=r*l+i*c+o,g[2]=t*s+n*u+a,g[3]=r*s+i*u+o;break;case"arcToSvg":s=g[5],u=g[6],f=g[0],p=g[1],g[0]=t*f+n*p,g[1]=r*f+i*p,g[5]=t*s+n*u+a,g[6]=r*s+i*u+o;break;case"circle":g[4]=Wc(g[3],e);break;case"rect":g[4]=Wc(g[4],e);break;case"ellipse":g[8]=Wc(g[8],e);break;case"roundRect":g[5]=Wc(g[5],e);break;case"addPath":g[0].transform(e);break;case"poly":g[2]=Wc(g[2],e);break;default:Gt("unknown transform action",m.action)}}return this._dirty=!0,this}},{key:"bounds",get:function(){return this.shapePath.bounds}},{key:"getLastPoint",value:function(e){var t=this.instructions.length-1,r=this.instructions[t];if(!r)return e.x=0,e.y=0,e;for(;"closePath"===r.action;){if(--t<0)return e.x=0,e.y=0,e;r=this.instructions[t]}switch(r.action){case"moveTo":case"lineTo":e.x=r.data[0],e.y=r.data[1];break;case"quadraticCurveTo":e.x=r.data[2],e.y=r.data[3];break;case"bezierCurveTo":e.x=r.data[4],e.y=r.data[5];break;case"arc":case"arcToSvg":e.x=r.data[5],e.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(e)}return e}}])}();function Wc(e,t){return e?e.prepend(t):t.clone()}var Yc=Object.defineProperty,Kc=Object.getOwnPropertySymbols,qc=Object.prototype.hasOwnProperty,Zc=Object.prototype.propertyIsEnumerable,Qc=function(e,t,r){return t in e?Yc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Jc=function(e,t){for(var r in t||(t={}))qc.call(t,r)&&Qc(e,r,t[r]);if(Kc){var n,i=U(Kc(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Zc.call(t,r)&&Qc(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e};function $c(e,t){if("string"==typeof e){var r=document.createElement("div");r.innerHTML=e.trim(),e=r.querySelector("svg")}return eh(e,{context:t,path:new Vc},null,null),t}function eh(e,t,r,n){var i,a,o,s,u,l,c,h,d,f,p,v,m,g,_,y,x=e.children,b=rh(e),T=b.fillStyle,S=b.strokeStyle;switch(T&&r?r=Jc(Jc({},r),T):T&&(r=T),S&&n?n=Jc(Jc({},n),S):S&&(n=S),t.context.fillStyle=r,t.context.strokeStyle=n,e.nodeName.toLowerCase()){case"path":m=e.getAttribute("d"),g=new Vc(m),t.context.path(g),r&&t.context.fill(),n&&t.context.stroke();break;case"circle":c=th(e,"cx",0),h=th(e,"cy",0),d=th(e,"r",0),t.context.ellipse(c,h,d,d),r&&t.context.fill(),n&&t.context.stroke();break;case"rect":i=th(e,"x",0),a=th(e,"y",0),_=th(e,"width",0),y=th(e,"height",0),f=th(e,"rx",0),p=th(e,"ry",0),f||p?t.context.roundRect(i,a,_,y,f||p):t.context.rect(i,a,_,y),r&&t.context.fill(),n&&t.context.stroke();break;case"ellipse":c=th(e,"cx",0),h=th(e,"cy",0),f=th(e,"rx",0),p=th(e,"ry",0),t.context.beginPath(),t.context.ellipse(c,h,f,p),r&&t.context.fill(),n&&t.context.stroke();break;case"line":o=th(e,"x1",0),s=th(e,"y1",0),u=th(e,"x2",0),l=th(e,"y2",0),t.context.beginPath(),t.context.moveTo(o,s),t.context.lineTo(u,l),n&&t.context.stroke();break;case"polygon":v=e.getAttribute("points").match(/\d+/g).map(function(e){return parseInt(e,10)}),t.context.poly(v,!0),r&&t.context.fill(),n&&t.context.stroke();break;case"polyline":v=e.getAttribute("points").match(/\d+/g).map(function(e){return parseInt(e,10)}),t.context.poly(v,!1),n&&t.context.stroke();break;case"g":case"svg":break;default:console.info("[SVG parser] <".concat(e.nodeName,"> elements unsupported"))}for(var k=0;k<x.length;k++)eh(x[k],t,r,n)}function th(e,t,r){var n=e.getAttribute(t);return n?Number(n):r}function rh(e){var t=e.getAttribute("style"),r={},n={},i=!1,a=!1;if(t)for(var o=t.split(";"),s=0;s<o.length;s++){var u=R(o[s].split(":"),2),l=u[0],c=u[1];switch(l){case"stroke":"none"!==c&&(r.color=Ke.shared.setValue(c).toNumber(),a=!0);break;case"stroke-width":r.width=Number(c);break;case"fill":"none"!==c&&(i=!0,n.color=Ke.shared.setValue(c).toNumber());break;case"fill-opacity":n.alpha=Number(c);break;case"stroke-opacity":r.alpha=Number(c);break;case"opacity":n.alpha=Number(c),r.alpha=Number(c)}}else{var h=e.getAttribute("stroke");h&&"none"!==h&&(a=!0,r.color=Ke.shared.setValue(h).toNumber(),r.width=th(e,"stroke-width",1));var d=e.getAttribute("fill");d&&"none"!==d&&(i=!0,n.color=Ke.shared.setValue(d).toNumber())}return{strokeStyle:a?r:null,fillStyle:i?n:null}}var nh=Object.defineProperty,ih=Object.getOwnPropertySymbols,ah=Object.prototype.hasOwnProperty,oh=Object.prototype.propertyIsEnumerable,sh=function(e,t,r){return t in e?nh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},uh=function(e,t){for(var r in t||(t={}))ah.call(t,r)&&sh(e,r,t[r]);if(ih){var n,i=U(ih(t));try{for(i.s();!(n=i.n()).done;){r=n.value;oh.call(t,r)&&sh(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},lh=function(e,t){var r={};for(var n in e)ah.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&ih){var i,a=U(ih(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&oh.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r};function ch(e){return Ke.isColorLike(e)}function hh(e){return e instanceof ec}function dh(e){return e instanceof Jl}function fh(e,t,r){var n=Ke.shared.setValue(null!=t?t:0);return e.color=n.toNumber(),e.alpha=1===n.alpha?r.alpha:n.alpha,e.texture=bi.WHITE,uh(uh({},r),e)}function ph(e,t,r){return e.fill=t,e.color=16777215,e.texture=t.texture,e.matrix=t.transform,uh(uh({},r),e)}function vh(e,t,r){return t.buildLinearGradient(),e.fill=t,e.color=16777215,e.texture=t.texture,e.matrix=t.transform,uh(uh({},r),e)}function mh(e,t){var r,n=uh(uh({},t),e);if(n.texture){if(n.texture!==bi.WHITE){var i=(null==(r=n.matrix)?void 0:r.invert())||new tt;i.translate(n.texture.frame.x,n.texture.frame.y),i.scale(1/n.texture.source.width,1/n.texture.source.height),n.matrix=i}var a=n.texture.source.style;"clamp-to-edge"===a.addressMode&&(a.addressMode="repeat",a.update())}var o=Ke.shared.setValue(n.color);return n.alpha*=o.alpha,n.color=o.toNumber(),n.matrix=n.matrix?n.matrix.clone():null,n}function gh(e,t){if(null==e)return null;var r={},n=e;return ch(e)?fh(r,e,t):hh(e)?ph(r,e,t):dh(e)?vh(r,e,t):n.fill&&hh(n.fill)?ph(n,n.fill,t):n.fill&&dh(n.fill)?vh(n,n.fill,t):mh(n,t)}function _h(e,t){var r=t,n=r.width,i=r.alignment,a=r.miterLimit,o=r.cap,s=r.join,u=gh(e,lh(r,["width","alignment","miterLimit","cap","join"]));return u?uh({width:n,alignment:i,miterLimit:a,cap:o,join:s},u):null}var yh=Object.defineProperty,xh=Object.getOwnPropertySymbols,bh=Object.prototype.hasOwnProperty,Th=Object.prototype.propertyIsEnumerable,Sh=function(e,t,r){return t in e?yh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},kh=function(e,t){for(var r in t||(t={}))bh.call(t,r)&&Sh(e,r,t[r]);if(xh){var n,i=U(xh(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Th.call(t,r)&&Sh(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Eh=new $e,Ah=new tt,wh=function(e){function t(){var e;return C(this,t),(e=x(this,t,arguments)).uid=ot("graphicsContext"),e.dirty=!0,e.batchMode="auto",e.instructions=[],e._activePath=new Vc,e._transform=new tt,e._fillStyle=kh({},t.defaultFillStyle),e._strokeStyle=kh({},t.defaultStrokeStyle),e._stateStack=[],e._tick=0,e._bounds=new Et,e._boundsDirty=!0,e}return E(t,ue),B(t,[{key:"clone",value:function(){var e=new t;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle=kh({},this._fillStyle),e._strokeStyle=kh({},this._strokeStyle),e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}},{key:"fillStyle",get:function(){return this._fillStyle},set:function(e){this._fillStyle=gh(e,t.defaultFillStyle)}},{key:"strokeStyle",get:function(){return this._strokeStyle},set:function(e){this._strokeStyle=_h(e,t.defaultStrokeStyle)}},{key:"setFillStyle",value:function(e){return this._fillStyle=gh(e,t.defaultFillStyle),this}},{key:"setStrokeStyle",value:function(e){return this._strokeStyle=gh(e,t.defaultStrokeStyle),this}},{key:"texture",value:function(e,t,r,n,i,a){return this.instructions.push({action:"texture",data:{image:e,dx:r||0,dy:n||0,dw:i||e.frame.width,dh:a||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t?Ke.shared.setValue(t).toNumber():16777215}}),this.onUpdate(),this}},{key:"beginPath",value:function(){return this._activePath=new Vc,this}},{key:"fill",value:function(e,r){var n,i=this.instructions[this.instructions.length-1];return(n=0===this._tick&&i&&"stroke"===i.action?i.data.path:this._activePath.clone())?(null!=e&&(void 0!==r&&"number"==typeof e&&(ht(lt,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:r}),this._fillStyle=gh(e,t.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}},{key:"_initNextPathLocation",value:function(){var e=this._activePath.getLastPoint($e.shared),t=e.x,r=e.y;this._activePath.clear(),this._activePath.moveTo(t,r)}},{key:"stroke",value:function(e){var r,n=this.instructions[this.instructions.length-1];return(r=0===this._tick&&n&&"fill"===n.action?n.data.path:this._activePath.clone())?(null!=e&&(this._strokeStyle=_h(e,t.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}},{key:"cut",value:function(){for(var e=0;e<2;e++){var t=this.instructions[this.instructions.length-1-e],r=this._activePath.clone();if(t&&("stroke"===t.action||"fill"===t.action)){if(!t.data.hole){t.data.hole=r;break}t.data.hole.addPath(r)}}return this._initNextPathLocation(),this}},{key:"arc",value:function(e,t,r,n,i,a){this._tick++;var o=this._transform;return this._activePath.arc(o.a*e+o.c*t+o.tx,o.b*e+o.d*t+o.ty,r,n,i,a),this}},{key:"arcTo",value:function(e,t,r,n,i){this._tick++;var a=this._transform;return this._activePath.arcTo(a.a*e+a.c*t+a.tx,a.b*e+a.d*t+a.ty,a.a*r+a.c*n+a.tx,a.b*r+a.d*n+a.ty,i),this}},{key:"arcToSvg",value:function(e,t,r,n,i,a,o){this._tick++;var s=this._transform;return this._activePath.arcToSvg(e,t,r,n,i,s.a*a+s.c*o+s.tx,s.b*a+s.d*o+s.ty),this}},{key:"bezierCurveTo",value:function(e,t,r,n,i,a,o){this._tick++;var s=this._transform;return this._activePath.bezierCurveTo(s.a*e+s.c*t+s.tx,s.b*e+s.d*t+s.ty,s.a*r+s.c*n+s.tx,s.b*r+s.d*n+s.ty,s.a*i+s.c*a+s.tx,s.b*i+s.d*a+s.ty,o),this}},{key:"closePath",value:function(){var e;return this._tick++,null==(e=this._activePath)||e.closePath(),this}},{key:"ellipse",value:function(e,t,r,n){return this._tick++,this._activePath.ellipse(e,t,r,n,this._transform.clone()),this}},{key:"circle",value:function(e,t,r){return this._tick++,this._activePath.circle(e,t,r,this._transform.clone()),this}},{key:"path",value:function(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}},{key:"lineTo",value:function(e,t){this._tick++;var r=this._transform;return this._activePath.lineTo(r.a*e+r.c*t+r.tx,r.b*e+r.d*t+r.ty),this}},{key:"moveTo",value:function(e,t){this._tick++;var r=this._transform,n=this._activePath.instructions,i=r.a*e+r.c*t+r.tx,a=r.b*e+r.d*t+r.ty;return 1===n.length&&"moveTo"===n[0].action?(n[0].data[0]=i,n[0].data[1]=a,this):(this._activePath.moveTo(i,a),this)}},{key:"quadraticCurveTo",value:function(e,t,r,n,i){this._tick++;var a=this._transform;return this._activePath.quadraticCurveTo(a.a*e+a.c*t+a.tx,a.b*e+a.d*t+a.ty,a.a*r+a.c*n+a.tx,a.b*r+a.d*n+a.ty,i),this}},{key:"rect",value:function(e,t,r,n){return this._tick++,this._activePath.rect(e,t,r,n,this._transform.clone()),this}},{key:"roundRect",value:function(e,t,r,n,i){return this._tick++,this._activePath.roundRect(e,t,r,n,i,this._transform.clone()),this}},{key:"poly",value:function(e,t){return this._tick++,this._activePath.poly(e,t,this._transform.clone()),this}},{key:"regularPoly",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0;return this._tick++,this._activePath.regularPoly(e,t,r,n,i,a),this}},{key:"roundPoly",value:function(e,t,r,n,i,a){return this._tick++,this._activePath.roundPoly(e,t,r,n,i,a),this}},{key:"roundShape",value:function(e,t,r,n){return this._tick++,this._activePath.roundShape(e,t,r,n),this}},{key:"filletRect",value:function(e,t,r,n,i){return this._tick++,this._activePath.filletRect(e,t,r,n,i),this}},{key:"chamferRect",value:function(e,t,r,n,i,a){return this._tick++,this._activePath.chamferRect(e,t,r,n,i,a),this}},{key:"star",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return this._tick++,this._activePath.star(e,t,r,n,i,a,this._transform.clone()),this}},{key:"svg",value:function(e){return this._tick++,$c(e,this),this}},{key:"restore",value:function(){var e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}},{key:"save",value:function(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:kh({},this._fillStyle),strokeStyle:kh({},this._strokeStyle)}),this}},{key:"getTransform",value:function(){return this._transform}},{key:"resetTransform",value:function(){return this._transform.identity(),this}},{key:"rotate",value:function(e){return this._transform.rotate(e),this}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this._transform.scale(e,t),this}},{key:"setTransform",value:function(e,t,r,n,i,a){return e instanceof tt?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,t,r,n,i,a),this)}},{key:"transform",value:function(e,t,r,n,i,a){return e instanceof tt?(this._transform.append(e),this):(Ah.set(e,t,r,n,i,a),this._transform.append(Ah),this)}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this._transform.translate(e,t),this}},{key:"clear",value:function(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}},{key:"onUpdate",value:function(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}},{key:"bounds",get:function(){if(!this._boundsDirty)return this._bounds;var e=this._bounds;e.clear();for(var t=0;t<this.instructions.length;t++){var r=this.instructions[t],n=r.action;if("fill"===n){var i=r.data;e.addBounds(i.path.bounds)}else if("texture"===n){var a=r.data;e.addFrame(a.dx,a.dy,a.dx+a.dw,a.dy+a.dh,a.transform)}if("stroke"===n){var o=r.data,s=o.style.width/2,u=o.path.bounds;e.addFrame(u.minX-s,u.minY-s,u.maxX+s,u.maxY+s)}}return e}},{key:"containsPoint",value:function(e){var t;if(!this.bounds.containsPoint(e.x,e.y))return!1;for(var r=this.instructions,n=!1,i=0;i<r.length;i++){var a=r[i],o=a.data,s=o.path;if(a.action&&s)for(var u=o.style,l=s.shapePath.shapePrimitives,c=0;c<l.length;c++){var h=l[c].shape;if(u&&h){var d=l[c].transform,f=d?d.applyInverse(e,Eh):e;n="fill"===a.action?h.contains(f.x,f.y):h.strokeContains(f.x,f.y,u.width);var p=o.hole;if(p){var v=null==(t=p.shapePath)?void 0:t.shapePrimitives;if(v)for(var m=0;m<v.length;m++)v[m].shape.contains(f.x,f.y)&&(n=!1)}if(n)return!0}}}return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),"boolean"==typeof e?e:null==e?void 0:e.texture){var t="boolean"==typeof e?e:null==e?void 0:e.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(t),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(t)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}}])}();wh.defaultFillStyle={color:16777215,alpha:1,texture:bi.WHITE,matrix:null,fill:null},wh.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:bi.WHITE,matrix:null,fill:null};var Rh=exports.GraphicsContext=wh,Ph=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function Mh(e){for(var t=[],r=0,n=0;n<Ph.length;n++){var i="_".concat(Ph[n]);t[r++]=e[i]}return r=Oh(e._fill,t,r),r=Ch(e._stroke,t,r),r=Gh(e.dropShadow,t,r),t.join("-")}function Oh(e,t,r){var n;return e?(t[r++]=e.color,t[r++]=e.alpha,t[r++]=null==(n=e.fill)?void 0:n.styleKey,r):r}function Ch(e,t,r){return e?(r=Oh(e,t,r),t[r++]=e.width,t[r++]=e.alignment,t[r++]=e.cap,t[r++]=e.join,t[r++]=e.miterLimit,r):r}function Gh(e,t,r){return e?(t[r++]=e.alpha,t[r++]=e.angle,t[r++]=e.blur,t[r++]=e.distance,t[r++]=Ke.shared.setValue(e.color).toNumber(),r):r}var Bh=Object.defineProperty,Ih=Object.defineProperties,Fh=Object.getOwnPropertyDescriptors,Dh=Object.getOwnPropertySymbols,Uh=Object.prototype.hasOwnProperty,Lh=Object.prototype.propertyIsEnumerable,Nh=function(e,t,r){return t in e?Bh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Xh=function(e,t){for(var r in t||(t={}))Uh.call(t,r)&&Nh(e,r,t[r]);if(Dh){var n,i=U(Dh(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Lh.call(t,r)&&Nh(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Hh=function(e,t){return Ih(e,Fh(t))},jh=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};C(this,t),e=x(this,t),Vh(r);var n=Xh(Xh({},t.defaultTextStyle),r);for(var i in n){e[i]=n[i]}return e.update(),e}return E(t,ue),B(t,[{key:"align",get:function(){return this._align},set:function(e){this._align=e,this.update()}},{key:"breakWords",get:function(){return this._breakWords},set:function(e){this._breakWords=e,this.update()}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(e){null!==e&&"object"===D(e)?this._dropShadow=this._createProxy(Xh(Xh({},t.defaultDropShadow),e)):this._dropShadow=e?this._createProxy(Xh({},t.defaultDropShadow)):null,this.update()}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(e){this._fontFamily=e,this.update()}},{key:"fontSize",get:function(){return this._fontSize},set:function(e){this._fontSize="string"==typeof e?parseInt(e,10):e,this.update()}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(e){this._fontStyle=e,this.update()}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(e){this._fontVariant=e,this.update()}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(e){this._fontWeight=e,this.update()}},{key:"leading",get:function(){return this._leading},set:function(e){this._leading=e,this.update()}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(e){this._letterSpacing=e,this.update()}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(e){this._lineHeight=e,this.update()}},{key:"padding",get:function(){return this._padding},set:function(e){this._padding=e,this.update()}},{key:"trim",get:function(){return this._trim},set:function(e){this._trim=e,this.update()}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(e){this._textBaseline=e,this.update()}},{key:"whiteSpace",get:function(){return this._whiteSpace},set:function(e){this._whiteSpace=e,this.update()}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(e){this._wordWrap=e,this.update()}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth=e,this.update()}},{key:"fill",get:function(){return this._originalFill},set:function(e){var t=this;e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy(Xh(Xh({},Rh.defaultFillStyle),e),function(){t._fill=gh(Xh({},t._originalFill),Rh.defaultFillStyle)})),this._fill=gh(0===e?"black":e,Rh.defaultFillStyle),this.update())}},{key:"stroke",get:function(){return this._originalStroke},set:function(e){var t=this;e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy(Xh(Xh({},Rh.defaultStrokeStyle),e),function(){t._stroke=_h(Xh({},t._originalStroke),Rh.defaultStrokeStyle)})),this._stroke=_h(e,Rh.defaultStrokeStyle),this.update())}},{key:"_generateKey",value:function(){return this._styleKey=Mh(this),this._styleKey}},{key:"update",value:function(){this._styleKey=null,this.emit("update",this)}},{key:"reset",value:function(){var e=t.defaultTextStyle;for(var r in e)this[r]=e[r]}},{key:"styleKey",get:function(){return this._styleKey||this._generateKey()}},{key:"clone",value:function(){return new t({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?Xh({},this._dropShadow):null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}},{key:"destroy",value:function(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.removeAllListeners(),"boolean"==typeof i?i:null==i?void 0:i.texture){var a="boolean"==typeof i?i:null==i?void 0:i.textureSource;(null==(e=this._fill)?void 0:e.texture)&&this._fill.texture.destroy(a),(null==(t=this._originalFill)?void 0:t.texture)&&this._originalFill.texture.destroy(a),(null==(r=this._stroke)?void 0:r.texture)&&this._stroke.texture.destroy(a),(null==(n=this._originalStroke)?void 0:n.texture)&&this._originalStroke.texture.destroy(a)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}},{key:"_createProxy",value:function(e,t){var r=this;return new Proxy(e,{set:function(e,n,i){return e[n]=i,null==t||t(n,i),r.update(),!0}})}},{key:"_isFillStyle",value:function(e){return null!==(null!=e?e:null)&&!(Ke.isColorLike(e)||e instanceof Jl||e instanceof ec)}}])}();jh.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},jh.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};var zh=exports.TextStyle=jh;function Vh(e){var t,r,n,i,a,o=e;if("boolean"==typeof o.dropShadow&&o.dropShadow){var s=zh.defaultDropShadow;e.dropShadow={alpha:null!=(t=o.dropShadowAlpha)?t:s.alpha,angle:null!=(r=o.dropShadowAngle)?r:s.angle,blur:null!=(n=o.dropShadowBlur)?n:s.blur,color:null!=(i=o.dropShadowColor)?i:s.color,distance:null!=(a=o.dropShadowDistance)?a:s.distance}}if(void 0!==o.strokeThickness){ht(lt,"strokeThickness is now a part of stroke");var u=o.stroke,l={};if(Ke.isColorLike(u))l.color=u;else if(u instanceof Jl||u instanceof ec)l.fill=u;else{if(!Object.hasOwnProperty.call(u,"color")&&!Object.hasOwnProperty.call(u,"fill"))throw new Error("Invalid stroke value.");l=u}e.stroke=Hh(Xh({},l),{width:o.strokeThickness})}if(Array.isArray(o.fillGradientStops)){var c;ht(lt,"gradient fill is now a fill pattern: `new FillGradient(...)`"),null==e.fontSize?e.fontSize=zh.defaultTextStyle.fontSize:c="string"==typeof e.fontSize?parseInt(e.fontSize,10):e.fontSize;var h=new Jl(0,0,0,1.7*c),d=o.fillGradientStops.map(function(e){return Ke.shared.setValue(e).toNumber()});d.forEach(function(e,t){var r=t/(d.length-1);h.addColorStop(r,e)}),e.fill={fill:h}}}var Wh=new Et;function Yh(e,t,r,n){var i=Wh;i.minX=0,i.minY=0,i.maxX=e.width/n|0,i.maxY=e.height/n|0;var a=Yl.getOptimalTexture(i.width,i.height,n,!1);return a.source.uploadMethodId="image",a.source.resource=e,a.source.alphaMode="premultiply-alpha-on-upload",a.frame.width=t/n,a.frame.height=r/n,a.source.emit("update",a.source),a.updateUvs(),a}var Kh=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function qh(e){var t="number"==typeof e.fontSize?"".concat(e.fontSize,"px"):e.fontSize,r=e.fontFamily;Array.isArray(e.fontFamily)||(r=e.fontFamily.split(","));for(var n=r.length-1;n>=0;n--){var i=r[n].trim();/([\"\'])[^\'\"]+\1/.test(i)||Kh.includes(i)||(i='"'.concat(i,'"')),r[n]=i}return"".concat(e.fontStyle," ").concat(e.fontVariant," ").concat(e.fontWeight," ").concat(t," ").concat(r.join(","))}var Zh={willReadFrequently:!0},Qh=function(){function e(t,r,n,i,a,o,s,u,l){C(this,e),this.text=t,this.style=r,this.width=n,this.height=i,this.lines=a,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=u,this.fontProperties=l}return B(e,null,[{key:"experimentalLetterSpacingSupported",get:function(){var t=e._experimentalLetterSpacingSupported;if(void 0!==t){var r=hn.get().getCanvasRenderingContext2D().prototype;t=e._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return t}},{key:"measureText",value:function(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ",n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e._canvas,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.wordWrap,o="".concat(r,":").concat(n.styleKey);if(e._measurementCache[o])return e._measurementCache[o];var s=qh(n),u=e.measureFont(s);0===u.fontSize&&(u.fontSize=n.fontSize,u.ascent=n.fontSize);var l=e.__context;l.font=s;for(var c=(a?e._wordWrap(r,n,i):r).split(/(?:\r\n|\r|\n)/),h=new Array(c.length),d=0,f=0;f<c.length;f++){var p=e._measureText(c[f],n.letterSpacing,l);h[f]=p,d=Math.max(d,p)}var v=(null==(t=n._stroke)?void 0:t.width)||0,m=d+v;n.dropShadow&&(m+=n.dropShadow.distance);var g=n.lineHeight||u.fontSize,_=Math.max(g,u.fontSize+v)+(c.length-1)*(g+n.leading);return n.dropShadow&&(_+=n.dropShadow.distance),new e(r,n,m,_,c,h,g+n.leading,d,u)}},{key:"_measureText",value:function(t,r,n){var i=!1;e.experimentalLetterSpacingSupported&&(e.experimentalLetterSpacing?(n.letterSpacing="".concat(r,"px"),n.textLetterSpacing="".concat(r,"px"),i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));var a=n.measureText(t).width;return a>0&&(i?a-=r:a+=(e.graphemeSegmenter(t).length-1)*r),a}},{key:"_wordWrap",value:function(t,r){for(var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:e._canvas).getContext("2d",Zh),i=0,a="",o="",s=Object.create(null),u=r.letterSpacing,l=r.whiteSpace,c=e._collapseSpaces(l),h=e._collapseNewlines(l),d=!c,f=r.wordWrapWidth+u,p=e._tokenize(t),v=0;v<p.length;v++){var m=p[v];if(e._isNewline(m)){if(!h){o+=e._addLine(a),d=!c,a="",i=0;continue}m=" "}if(c){var g=e.isBreakingSpace(m),_=e.isBreakingSpace(a[a.length-1]);if(g&&_)continue}var y=e._getFromCache(m,u,s,n);if(y>f)if(""!==a&&(o+=e._addLine(a),a="",i=0),e.canBreakWords(m,r.breakWords))for(var x=e.wordWrapSplit(m),b=0;b<x.length;b++){for(var T=x[b],S=T,k=1;x[b+k];){var E=x[b+k];if(e.canBreakChars(S,E,m,b,r.breakWords))break;T+=E,S=E,k++}b+=k-1;var A=e._getFromCache(T,u,s,n);A+i>f&&(o+=e._addLine(a),d=!1,a="",i=0),a+=T,i+=A}else{a.length>0&&(o+=e._addLine(a),a="",i=0);var w=v===p.length-1;o+=e._addLine(m,!w),d=!1,a="",i=0}else y+i>f&&(d=!1,o+=e._addLine(a),a="",i=0),(a.length>0||!e.isBreakingSpace(m)||d)&&(a+=m,i+=y)}return o+=e._addLine(a,!1)}},{key:"_addLine",value:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t=e._trimRight(t),t=r?"".concat(t,"\n"):t}},{key:"_getFromCache",value:function(t,r,n,i){var a=n[t];return"number"!=typeof a&&(a=e._measureText(t,r,i)+r,n[t]=a),a}},{key:"_collapseSpaces",value:function(e){return"normal"===e||"pre-line"===e}},{key:"_collapseNewlines",value:function(e){return"normal"===e}},{key:"_trimRight",value:function(t){if("string"!=typeof t)return"";for(var r=t.length-1;r>=0;r--){var n=t[r];if(!e.isBreakingSpace(n))break;t=t.slice(0,-1)}return t}},{key:"_isNewline",value:function(t){return"string"==typeof t&&e._newlines.includes(t.charCodeAt(0))}},{key:"isBreakingSpace",value:function(t,r){return"string"==typeof t&&e._breakingSpaces.includes(t.charCodeAt(0))}},{key:"_tokenize",value:function(t){var r=[],n="";if("string"!=typeof t)return r;for(var i=0;i<t.length;i++){var a=t[i],o=t[i+1];e.isBreakingSpace(a,o)||e._isNewline(a)?(""!==n&&(r.push(n),n=""),r.push(a)):n+=a}return""!==n&&r.push(n),r}},{key:"canBreakWords",value:function(e,t){return t}},{key:"canBreakChars",value:function(e,t,r,n,i){return!0}},{key:"wordWrapSplit",value:function(t){return e.graphemeSegmenter(t)}},{key:"measureFont",value:function(t){if(e._fonts[t])return e._fonts[t];var r=e._context;r.font=t;var n=r.measureText(e.METRICS_STRING+e.BASELINE_SYMBOL),i={ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,fontSize:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent};return e._fonts[t]=i,i}},{key:"clearMetrics",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t?delete e._fonts[t]:e._fonts={}}},{key:"_canvas",get:function(){if(!e.__canvas){var t;try{var r=new OffscreenCanvas(0,0),n=r.getContext("2d",Zh);if(null==n?void 0:n.measureText)return e.__canvas=r,r;t=hn.get().createCanvas()}catch(i){t=hn.get().createCanvas()}t.width=t.height=10,e.__canvas=t}return e.__canvas}},{key:"_context",get:function(){return e.__context||(e.__context=e._canvas.getContext("2d",Zh)),e.__context}}])}();Qh.METRICS_STRING="|q",Qh.BASELINE_SYMBOL="M",Qh.BASELINE_MULTIPLIER=1.4,Qh.HEIGHT_MULTIPLIER=2,Qh.graphemeSegmenter=function(){if("function"==typeof(null==Intl?void 0:Intl.Segmenter)){var e=new Intl.Segmenter;return function(t){return m(e.segment(t)).map(function(e){return e.segment})}}return function(e){return m(e)}}(),Qh.experimentalLetterSpacing=!1,Qh._fonts={},Qh._newlines=[10,13],Qh._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],Qh._measurementCache={};var Jh=exports.CanvasTextMetrics=Qh;function $h(e,t){var r;if(e.texture===bi.WHITE&&!e.fill)return Ke.shared.setValue(e.color).setAlpha(null!=(r=e.alpha)?r:1).toHexa();if(!e.fill){var n=t.createPattern(e.texture.source.resource,"repeat"),i=e.matrix.copyTo(tt.shared);return i.scale(e.texture.frame.width,e.texture.frame.height),n.setTransform(i),n}if(e.fill instanceof ec){var a=e.fill,o=t.createPattern(a.texture.source.resource,"repeat"),s=a.transform.copyTo(tt.shared);return s.scale(a.texture.frame.width,a.texture.frame.height),o.setTransform(s),o}if(e.fill instanceof Jl){var u=e.fill;if("linear"===u.type){var l=t.createLinearGradient(u.x0,u.y0,u.x1,u.y1);return u.gradientStops.forEach(function(e){l.addColorStop(e.offset,Ke.shared.setValue(e.color).toHex())}),l}}return Gt("FillStyle not recognised",e),"red"}var ed=exports.CanvasTextSystem=function(){return B(function e(t){C(this,e),this._activeTextures={},this._renderer=t},[{key:"getTextureSize",value:function(e,t,r){var n=Jh.measureText(e||" ",r),i=Math.ceil(Math.ceil(Math.max(1,n.width)+2*r.padding)*t),a=Math.ceil(Math.ceil(Math.max(1,n.height)+2*r.padding)*t);return i=Math.ceil(i-1e-6),a=Math.ceil(a-1e-6),{width:i=Xn(i),height:a=Xn(a)}}},{key:"getTexture",value:function(e,t,r,n){"string"==typeof e&&(ht("8.0.0","CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),e={text:e,style:r,resolution:t}),e.style instanceof zh||(e.style=new zh(e.style));var i=this.createTextureAndCanvas(e),a=i.texture,o=i.canvasAndContext;return this._renderer.texture.initSource(a._source),Il.returnCanvasAndContext(o),a}},{key:"createTextureAndCanvas",value:function(e){var t,r=e.text,n=e.style,i=null!=(t=e.resolution)?t:this._renderer.resolution,a=Jh.measureText(r||" ",n),o=Math.ceil(Math.ceil(Math.max(1,a.width)+2*n.padding)*i),s=Math.ceil(Math.ceil(Math.max(1,a.height)+2*n.padding)*i),u=Il.getOptimalCanvasAndContext(o,s),l=u.canvas;this.renderTextToCanvas(r,n,i,u);var c=Yh(l,o,s,i);if(n.trim){var h=Zl(l,i);c.frame.copyFrom(h),c.updateUvs()}return{texture:c,canvasAndContext:u}}},{key:"getManagedTexture",value:function(e){e._resolution=e._autoResolution?this._renderer.resolution:e.resolution;var t=e._getKey();if(this._activeTextures[t])return this._increaseReferenceCount(t),this._activeTextures[t].texture;var r=this.createTextureAndCanvas(e),n=r.texture,i=r.canvasAndContext;return this._activeTextures[t]={canvasAndContext:i,texture:n,usageCount:1},n}},{key:"_increaseReferenceCount",value:function(e){this._activeTextures[e].usageCount++}},{key:"decreaseReferenceCount",value:function(e){var t=this._activeTextures[e];if(t.usageCount--,0===t.usageCount){Il.returnCanvasAndContext(t.canvasAndContext),Yl.returnTexture(t.texture);var r=t.texture.source;r.resource=null,r.uploadMethodId="unknown",r.alphaMode="no-premultiply-alpha",this._activeTextures[e]=null}}},{key:"getReferenceCount",value:function(e){return this._activeTextures[e].usageCount}},{key:"renderTextToCanvas",value:function(e,t,r,n){var i,a,o,s,u,l,c,h=n.canvas,d=n.context,f=qh(t),p=Jh.measureText(e||" ",t),v=p.lines,m=p.lineHeight,g=p.lineWidths,_=p.maxLineWidth,y=p.fontProperties,x=h.height;d.resetTransform(),d.scale(r,r);var b,T,S=2*t.padding;if(d.clearRect(0,0,p.width+4+S,p.height+4+S),null==(i=t._stroke)?void 0:i.width){var k=t._stroke;d.lineWidth=k.width,d.miterLimit=k.miterLimit,d.lineJoin=k.join,d.lineCap=k.cap}d.font=f;for(var E=t.dropShadow?2:1,A=0;A<E;++A){var w=t.dropShadow&&0===A,R=w?Math.ceil(Math.max(1,x)+2*t.padding):0,P=R*r;if(w){d.fillStyle="black",d.strokeStyle="black";var M=t.dropShadow,O=M.color,C=M.alpha;d.shadowColor=Ke.shared.setValue(O).setAlpha(C).toRgbaString();var G=M.blur*r,B=M.distance*r;d.shadowBlur=G,d.shadowOffsetX=Math.cos(M.angle)*B,d.shadowOffsetY=Math.sin(M.angle)*B+P}else d.globalAlpha=null!=(o=null==(a=t._fill)?void 0:a.alpha)?o:1,d.fillStyle=t._fill?$h(t._fill,d):null,(null==(s=t._stroke)?void 0:s.width)&&(d.strokeStyle=$h(t._stroke,d)),d.shadowColor="black";var I=(m-y.fontSize)/2;m-y.fontSize<0&&(I=0);for(var F=null!=(l=null==(u=t._stroke)?void 0:u.width)?l:0,D=0;D<v.length;D++)b=F/2,T=F/2+D*m+y.ascent+I,"right"===t.align?b+=_-g[D]:"center"===t.align&&(b+=(_-g[D])/2),(null==(c=t._stroke)?void 0:c.width)&&this._drawLetterSpacing(v[D],t,n,b+t.padding,T+t.padding-R,!0),void 0!==t._fill&&this._drawLetterSpacing(v[D],t,n,b+t.padding,T+t.padding-R)}}},{key:"_drawLetterSpacing",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=r.context,s=t.letterSpacing,u=!1;if(Jh.experimentalLetterSpacingSupported&&(Jh.experimentalLetterSpacing?(o.letterSpacing="".concat(s,"px"),o.textLetterSpacing="".concat(s,"px"),u=!0):(o.letterSpacing="0px",o.textLetterSpacing="0px")),0===s||u)a?o.strokeText(e,n,i):o.fillText(e,n,i);else for(var l=n,c=Jh.graphemeSegmenter(e),h=o.measureText(e).width,d=0,f=0;f<c.length;++f){var p=c[f];a?o.strokeText(p,l,i):o.fillText(p,l,i);for(var v="",m=f+1;m<c.length;++m)v+=c[m];l+=h-(d=o.measureText(v).width)+s,h=d}}},{key:"destroy",value:function(){this._activeTextures=null}}])}();ed.extension={type:[Z.WebGLSystem,Z.WebGPUSystem,Z.CanvasSystem],name:"canvasText"},$.add(ed),$.add(Gl);var td,rd,nd=Object.defineProperty,id=Object.getOwnPropertySymbols,ad=Object.prototype.hasOwnProperty,od=Object.prototype.propertyIsEnumerable,sd=function(e,t,r){return t in e?nd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ud=function(e,t){for(var r in t||(t={}))ad.call(t,r)&&sd(e,r,t[r]);if(id){var n,i=U(id(t));try{for(i.s();!(n=i.n()).done;){r=n.value;od.call(t,r)&&sd(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},ld=function(e,t){var r={};for(var n in e)ad.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&id){var i,a=U(id(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&od.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},cd=exports.Graphics=function(e){function t(e){var r;C(this,t),e instanceof Rh&&(e={context:e});var n=e||{},i=n.context,a=n.roundPixels,o=ld(n,["context","roundPixels"]);return(r=x(this,t,[ud({label:"Graphics"},o)])).renderPipeId="graphics",r._context=i||(r._ownedContext=new Rh),r._context.on("update",r.onViewUpdate,r),r.allowChildren=!1,r.roundPixels=null!=a&&a,r}return E(t,Ri),B(t,[{key:"context",get:function(){return this._context},set:function(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}},{key:"bounds",get:function(){return this._context.bounds}},{key:"addBounds",value:function(e){e.addBounds(this._context.bounds)}},{key:"containsPoint",value:function(e){return this._context.containsPoint(e)}},{key:"onViewUpdate",value:function(){if(this._didViewChangeTick++,this._didGraphicsUpdate=!0,!this.didViewUpdate){this.didViewUpdate=!0;var e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}}},{key:"destroy",value:function(e){this._ownedContext&&!e?this._ownedContext.destroy(e):!0!==e&&!0!==(null==e?void 0:e.context)||this._context.destroy(e),this._ownedContext=null,this._context=null,c(t,"destroy",this,3)([e])}},{key:"_callContextMethod",value:function(e,t){var r;return(r=this.context)[e].apply(r,m(t)),this}},{key:"setFillStyle",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("setFillStyle",t)}},{key:"setStrokeStyle",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("setStrokeStyle",t)}},{key:"fill",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("fill",t)}},{key:"stroke",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("stroke",t)}},{key:"texture",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("texture",t)}},{key:"beginPath",value:function(){return this._callContextMethod("beginPath",[])}},{key:"cut",value:function(){return this._callContextMethod("cut",[])}},{key:"arc",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("arc",t)}},{key:"arcTo",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("arcTo",t)}},{key:"arcToSvg",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("arcToSvg",t)}},{key:"bezierCurveTo",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("bezierCurveTo",t)}},{key:"closePath",value:function(){return this._callContextMethod("closePath",[])}},{key:"ellipse",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("ellipse",t)}},{key:"circle",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("circle",t)}},{key:"path",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("path",t)}},{key:"lineTo",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("lineTo",t)}},{key:"moveTo",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("moveTo",t)}},{key:"quadraticCurveTo",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("quadraticCurveTo",t)}},{key:"rect",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("rect",t)}},{key:"roundRect",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("roundRect",t)}},{key:"poly",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("poly",t)}},{key:"regularPoly",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("regularPoly",t)}},{key:"roundPoly",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("roundPoly",t)}},{key:"roundShape",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("roundShape",t)}},{key:"filletRect",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("filletRect",t)}},{key:"chamferRect",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("chamferRect",t)}},{key:"star",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("star",t)}},{key:"svg",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("svg",t)}},{key:"restore",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("restore",t)}},{key:"save",value:function(){return this._callContextMethod("save",[])}},{key:"getTransform",value:function(){return this.context.getTransform()}},{key:"resetTransform",value:function(){return this._callContextMethod("resetTransform",[])}},{key:"rotateTransform",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("rotate",t)}},{key:"scaleTransform",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("scale",t)}},{key:"setTransform",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("setTransform",t)}},{key:"transform",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("transform",t)}},{key:"translateTransform",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("translate",t)}},{key:"clear",value:function(){return this._callContextMethod("clear",[])}},{key:"fillStyle",get:function(){return this._context.fillStyle},set:function(e){this._context.fillStyle=e}},{key:"strokeStyle",get:function(){return this._context.strokeStyle},set:function(e){this._context.strokeStyle=e}},{key:"clone",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return new t(this._context.clone());this._ownedContext=null;var e=new t(this._context);return e}},{key:"lineStyle",value:function(e,t,r){ht(lt,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");var n={};return e&&(n.width=e),t&&(n.color=t),r&&(n.alpha=r),this.context.strokeStyle=n,this}},{key:"beginFill",value:function(e,t){ht(lt,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");var r={};return e&&(r.color=e),t&&(r.alpha=t),this.context.fillStyle=r,this}},{key:"endFill",value:function(){ht(lt,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();var e=this.context.strokeStyle;return e.width===Rh.defaultStrokeStyle.width&&e.color===Rh.defaultStrokeStyle.color&&e.alpha===Rh.defaultStrokeStyle.alpha||this.context.stroke(),this}},{key:"drawCircle",value:function(){ht(lt,"Graphics#drawCircle has been renamed to Graphics#circle");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("circle",t)}},{key:"drawEllipse",value:function(){ht(lt,"Graphics#drawEllipse has been renamed to Graphics#ellipse");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("ellipse",t)}},{key:"drawPolygon",value:function(){ht(lt,"Graphics#drawPolygon has been renamed to Graphics#poly");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("poly",t)}},{key:"drawRect",value:function(){ht(lt,"Graphics#drawRect has been renamed to Graphics#rect");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("rect",t)}},{key:"drawRoundedRect",value:function(){ht(lt,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("roundRect",t)}},{key:"drawStar",value:function(){ht(lt,"Graphics#drawStar has been renamed to Graphics#star");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this._callContextMethod("star",t)}}])}(),hd=exports.localUniformMSDFBit={name:"local-uniform-msdf-bit",vertex:{header:"\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32,\n                uRound:f32,\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        ",main:"\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        ",end:"\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        "},fragment:{header:"\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n         ",main:" \n            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));\n        "}},dd=exports.localUniformMSDFBitGl={name:"local-uniform-msdf-bit",vertex:{header:"\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        ",main:"\n            vColor *= uColor;\n            modelMatrix *= uTransformMatrix;\n        ",end:"\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        "},fragment:{header:"\n            uniform float uDistance;\n         ",main:" \n            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));\n        "}},fd=exports.mSDFBit={name:"msdf-bit",fragment:{header:"\n            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {\n                \n                // MSDF\n                var median = msdfColor.r + msdfColor.g + msdfColor.b -\n                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n            \n                // SDF\n                median = min(median, msdfColor.a);\n\n                var screenPxDistance = distance * (median - 0.5);\n                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));\n                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);\n                var coverage: f32 = pow(shapeColor.a * alpha, gamma);\n\n                return coverage;\n             \n            }\n        "}},pd=exports.mSDFBitGl={name:"msdf-bit",fragment:{header:"\n            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {\n                \n                // MSDF\n                float median = msdfColor.r + msdfColor.g + msdfColor.b -\n                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n               \n                // SDF\n                median = min(median, msdfColor.a);\n            \n                float screenPxDistance = distance * (median - 0.5);\n                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n           \n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));\n                float gamma = mix(1.0, 1.0 / 2.2, luma);\n                float coverage = pow(shapeColor.a * alpha, gamma);  \n              \n                return coverage;\n            }\n        "}},vd=exports.SdfShader=function(e){function t(){C(this,t);var e=new Bs({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new tt,type:"mat3x3<f32>"},uDistance:{value:4,type:"f32"},uRound:{value:0,type:"f32"}}),r=xa();return null!=td||(td=hs({name:"sdf-shader",bits:[fs,_s(r),hd,fd,Ts]})),null!=rd||(rd=ds({name:"sdf-shader",bits:[ps,bs(r),dd,pd,Ss]})),x(this,t,[{glProgram:rd,gpuProgram:td,resources:{localUniforms:e,batchSamplers:Fs(r)}}])}return E(t,Vs),B(t)}(),md=exports.AbstractBitmapFont=function(e){function t(){var e;return C(this,t),(e=x(this,t,arguments)).chars=Object.create(null),e.lineHeight=0,e.fontFamily="",e.fontMetrics={fontSize:0,ascent:0,descent:0},e.baseLineOffset=0,e.distanceField={type:"none",range:0},e.pages=[],e.applyFillAsTint=!0,e.baseMeasurementFontSize=100,e.baseRenderedFontSize=100,e}return E(t,ue),B(t,[{key:"font",get:function(){return ht(lt,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}},{key:"pageTextures",get:function(){return ht(lt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}},{key:"size",get:function(){return ht(lt,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}},{key:"distanceFieldRange",get:function(){return ht(lt,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}},{key:"distanceFieldType",get:function(){return ht(lt,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}},{key:"destroy",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var r in this.emit("destroy",this),this.removeAllListeners(),this.chars)null==(e=this.chars[r].texture)||e.destroy();this.chars=null,t&&(this.pages.forEach(function(e){return e.texture.destroy(!0)}),this.pages=null)}}])}();function gd(e){if(""===e)return[];"string"==typeof e&&(e=[e]);for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];if(Array.isArray(i)){if(2!==i.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got ".concat(i.length,"."));if(0===i[0].length||0===i[1].length)throw new Error("[BitmapFont]: Invalid character delimiter.");var a=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<a)throw new Error("[BitmapFont]: Invalid character range.");for(var s=a,u=o;s<=u;s++)t.push(String.fromCharCode(s))}else t.push.apply(t,m(Array.from(i)))}if(0===t.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}var _d=Object.defineProperty,yd=Object.getOwnPropertySymbols,xd=Object.prototype.hasOwnProperty,bd=Object.prototype.propertyIsEnumerable,Td=function(e,t,r){return t in e?_d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Sd=function(e,t){for(var r in t||(t={}))xd.call(t,r)&&Td(e,r,t[r]);if(yd){var n,i=U(yd(t));try{for(i.s();!(n=i.n()).done;){r=n.value;bd.call(t,r)&&Td(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},kd=function(e){function t(e){var r,n,i,a;C(this,t),(r=x(this,t)).resolution=1,r.pages=[],r._padding=0,r._measureCache=Object.create(null),r._currentChars=[],r._currentX=0,r._currentY=0,r._currentPageIndex=-1,r._skipKerning=!1;var o=Sd(Sd({},t.defaultOptions),e);r._textureSize=o.textureSize,r._mipmap=o.mipmap;var s=o.style.clone();o.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=bi.WHITE,s._fill.fill=null),r.applyFillAsTint=o.overrideFill;var u=s.fontSize;s.fontSize=r.baseMeasurementFontSize;var l=qh(s);return o.overrideSize?s._stroke&&(s._stroke.width*=r.baseRenderedFontSize/u):s.fontSize=r.baseRenderedFontSize=u,r._style=s,r._skipKerning=null!=(n=o.skipKerning)&&n,r.resolution=null!=(i=o.resolution)?i:1,r._padding=null!=(a=o.padding)?a:4,r.fontMetrics=Jh.measureFont(l),r.lineHeight=s.lineHeight||r.fontMetrics.fontSize||s.fontSize,r}return E(t,md),B(t,[{key:"ensureCharacters",value:function(e){var t,r,n,i,a=this,o=gd(e).filter(function(e){return!a._currentChars.includes(e)}).filter(function(e,t,r){return r.indexOf(e)===t});if(o.length){var s;this._currentChars=[].concat(m(this._currentChars),m(o));for(var u=(s=-1===this._currentPageIndex?this._nextPage():this.pages[this._currentPageIndex]).canvasAndContext,l=u.canvas,c=u.context,h=s.texture.source,d=this._style,f=this._currentX,p=this._currentY,v=this.baseRenderedFontSize/this.baseMeasurementFontSize,g=this._padding*v,_="italic"===d.fontStyle?2:1,y=0,x=!1,b=0;b<o.length;b++){var T=o[b],S=Jh.measureText(T,d,l,!1);S.lineHeight=S.height;var k=_*S.width*v,E=k+2*g,A=S.height*v+2*g;if(x=!1,"\n"!==T&&"\r"!==T&&"\t"!==T&&" "!==T&&(x=!0,y=Math.ceil(Math.max(A,y))),f+E>this._textureSize&&(f=0,(p+=y)+(y=A)>this._textureSize)){h.update();var w=this._nextPage();l=w.canvasAndContext.canvas,c=w.canvasAndContext.context,h=w.texture.source,p=0}var R=k/v-(null!=(r=null==(t=d.dropShadow)?void 0:t.distance)?r:0)-(null!=(i=null==(n=d._stroke)?void 0:n.width)?i:0);if(this.chars[T]={id:T.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:R,kerning:{}},x){this._drawGlyph(c,S,f+g,p+g,v,d);var P=h.width*v,M=h.height*v,O=new St(f/P*h.width,p/M*h.height,E/P*h.width,A/M*h.height);this.chars[T].texture=new bi({source:h,frame:O}),f+=Math.ceil(E)}}h.update(),this._currentX=f,this._currentY=p,this._skipKerning&&this._applyKerning(o,c)}}},{key:"pageTextures",get:function(){return ht(lt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}},{key:"_applyKerning",value:function(e,t){for(var r=this._measureCache,n=0;n<e.length;n++)for(var i=e[n],a=0;a<this._currentChars.length;a++){var o=this._currentChars[a],s=r[i];s||(s=r[i]=t.measureText(i).width);var u=r[o];u||(u=r[o]=t.measureText(o).width);var l=t.measureText(i+o).width,c=l-(s+u);c&&(this.chars[i].kerning[o]=c),(c=(l=t.measureText(i+o).width)-(s+u))&&(this.chars[o].kerning[i]=c)}}},{key:"_nextPage",value:function(){this._currentPageIndex++;var e=this.resolution,t=Il.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(t.context,this._style,e);var r=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n={canvasAndContext:t,texture:new bi({source:new Wi({resource:t.canvas,resolution:r,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})})};return this.pages[this._currentPageIndex]=n,n}},{key:"_setupContext",value:function(e,t,r){var n;t.fontSize=this.baseRenderedFontSize,e.scale(r,r),e.font=qh(t),t.fontSize=this.baseMeasurementFontSize,e.textBaseline=t.textBaseline;var i=t._stroke,a=null!=(n=null==i?void 0:i.width)?n:0;if(i&&(e.lineWidth=a,e.lineJoin=i.join,e.miterLimit=i.miterLimit,e.strokeStyle=$h(i,e)),t._fill&&(e.fillStyle=$h(t._fill,e)),t.dropShadow){var o=t.dropShadow,s=Ke.shared.setValue(o.color).toArray(),u=o.blur*r,l=o.distance*r;e.shadowColor="rgba(".concat(255*s[0],",").concat(255*s[1],",").concat(255*s[2],",").concat(o.alpha,")"),e.shadowBlur=u,e.shadowOffsetX=Math.cos(o.angle)*l,e.shadowOffsetY=Math.sin(o.angle)*l}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}},{key:"_drawGlyph",value:function(e,t,r,n,i,a){var o,s=t.text,u=t.fontProperties,l=a._stroke,c=(null!=(o=null==l?void 0:l.width)?o:0)*i,h=r+c/2,d=n-c/2,f=u.descent*i,p=t.lineHeight*i;a.stroke&&c&&e.strokeText(s,h,d+p-f),a._fill&&e.fillText(s,h,d+p-f)}},{key:"destroy",value:function(){c(t,"destroy",this,3)([]);for(var e=0;e<this.pages.length;e++){var r=this.pages[e],n=r.canvasAndContext,i=r.texture;n.canvas.width=n.canvas.width,Il.returnCanvasAndContext(n),i.destroy(!0)}this.pages=null}}])}();kd.defaultOptions={textureSize:512,style:new zh,mipmap:!0};var Ed=exports.DynamicBitmapFont=kd;function Ad(e,t,r,n){var i={width:0,height:0,offsetY:0,scale:t.fontSize/r.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};i.offsetY=r.baseLineOffset;for(var a=i.lines[0],o=null,s=!0,u={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},l=function(e){for(var t=a.width,r=0;r<u.index;r++){var n=e.positions[r];a.chars.push(e.chars[r]),a.charPositions.push(n+t)}a.width+=e.width,s=!1,u.width=0,u.index=0,u.chars.length=0},c=function(){var e=a.chars.length-1;if(n)for(var t=a.chars[e];" "===t;)a.width-=r.chars[t].xAdvance,t=a.chars[--e];i.width=Math.max(i.width,a.width),a={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},s=!0,i.lines.push(a),i.height+=r.lineHeight},h=r.baseMeasurementFontSize/t.fontSize,d=t.letterSpacing*h,f=t.wordWrapWidth*h,p=0;p<e.length+1;p++){var v=void 0,m=p===e.length;m||(v=e[p]);var g=r.chars[v]||r.chars[" "];if(/(?:\s)/.test(v)||"\r"===v||"\n"===v||m){if(!s&&t.wordWrap&&a.width+u.width-d>f?(c(),l(u),m||a.charPositions.push(0)):(u.start=a.width,l(u),m||a.charPositions.push(0)),"\r"===v||"\n"===v)0!==a.width&&c();else if(!m){var _=g.xAdvance+(g.kerning[o]||0)+d;a.width+=_,a.spaceWidth=_,a.spacesIndex.push(a.charPositions.length),a.chars.push(v)}}else{var y=g.kerning[o]||0,x=g.xAdvance+y+d;u.positions[u.index++]=u.width+y,u.chars.push(v),u.width+=x}o=v}return c(),"center"===t.align?wd(i):"right"===t.align?Rd(i):"justify"===t.align&&Pd(i),i}function wd(e){for(var t=0;t<e.lines.length;t++)for(var r=e.lines[t],n=e.width/2-r.width/2,i=0;i<r.charPositions.length;i++)r.charPositions[i]+=n}function Rd(e){for(var t=0;t<e.lines.length;t++)for(var r=e.lines[t],n=e.width-r.width,i=0;i<r.charPositions.length;i++)r.charPositions[i]+=n}function Pd(e){for(var t=e.width,r=0;r<e.lines.length;r++)for(var n=e.lines[r],i=0,a=n.spacesIndex[i++],o=0,s=n.spacesIndex.length,u=(t-n.width)/s,l=0;l<n.charPositions.length;l++)l===a&&(a=n.spacesIndex[i++],o+=u),n.charPositions[l]+=o}var Md=Object.defineProperty,Od=Object.getOwnPropertySymbols,Cd=Object.prototype.hasOwnProperty,Gd=Object.prototype.propertyIsEnumerable,Bd=function(e,t,r){return t in e?Md(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Id=function(e,t){for(var r in t||(t={}))Cd.call(t,r)&&Bd(e,r,t[r]);if(Od){var n,i=U(Od(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Gd.call(t,r)&&Bd(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Fd=0,Dd=function(){return B(function e(){C(this,e),this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}},[{key:"getFont",value:function(e,t){var r,n="".concat(t.fontFamily,"-bitmap"),i=!0;if(t._fill.fill&&!t._stroke)n+=t._fill.fill.styleKey,i=!1;else if(t._stroke||t.dropShadow){var a=t.styleKey;a=a.substring(0,a.lastIndexOf("-")),n="".concat(a,"-bitmap"),i=!1}if(!sa.has(n)){var o=new Ed(Id({style:t,overrideFill:i,overrideSize:!0},this.defaultOptions));++Fd>50&&Gt("BitmapText","You have dynamically created ".concat(Fd,' bitmap fonts, this can be inefficient. Try pre installing your font styles using `BitmapFont.install({name:"style1", style})`')),o.once("destroy",function(){Fd--,sa.remove(n)}),sa.set(n,o)}var s=sa.get(n);return null==(r=s.ensureCharacters)||r.call(s,e),s}},{key:"getLayout",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getFont(e,t);return Ad(m(e),t,n,r)}},{key:"measureText",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.getLayout(e,t,r)}},{key:"install",value:function(){var e,t,r,n,i=arguments.length<=0?void 0:arguments[0];"string"==typeof i&&(i={name:i,style:arguments.length<=1?void 0:arguments[1],chars:null==(e=arguments.length<=2?void 0:arguments[2])?void 0:e.chars,resolution:null==(t=arguments.length<=2?void 0:arguments[2])?void 0:t.resolution,padding:null==(r=arguments.length<=2?void 0:arguments[2])?void 0:r.padding,skipKerning:null==(n=arguments.length<=2?void 0:arguments[2])?void 0:n.skipKerning},ht(lt,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));var a=null==i?void 0:i.name;if(!a)throw new Error("[BitmapFontManager] Property `name` is required.");var o=(i=Id(Id({},this.defaultOptions),i)).style,s=o instanceof zh?o:new zh(o),u=null!==s._fill.fill&&void 0!==s._fill.fill,l=new Ed({style:s,overrideFill:u,skipKerning:i.skipKerning,padding:i.padding,resolution:i.resolution,overrideSize:!1}),c=gd(i.chars);return l.ensureCharacters(c.join("")),sa.set("".concat(a,"-bitmap"),l),l.once("destroy",function(){return sa.remove("".concat(a,"-bitmap"))}),l}},{key:"uninstall",value:function(e){var t="".concat(e,"-bitmap"),r=sa.get(t);r&&(sa.remove(t),r.destroy())}}])}(),Ud=exports.BitmapFontManager=new Dd,Ld=exports.BitmapTextPipe=function(){return B(function e(t){C(this,e),this._gpuBitmapText={},this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=t},[{key:"validateRenderable",value:function(e){var t=this._getGpuBitmapText(e);return e._didTextUpdate&&(e._didTextUpdate=!1,this._updateContext(e,t)),this._renderer.renderPipes.graphics.validateRenderable(t)}},{key:"addRenderable",value:function(e,t){var r=this._getGpuBitmapText(e);Nd(e,r),e._didTextUpdate&&(e._didTextUpdate=!1,this._updateContext(e,r)),this._renderer.renderPipes.graphics.addRenderable(r,t),r.context.customShader&&this._updateDistanceField(e)}},{key:"destroyRenderable",value:function(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableByUid(e.uid)}},{key:"_destroyRenderableByUid",value:function(e){var t=this._gpuBitmapText[e].context;t.customShader&&(pt.return(t.customShader),t.customShader=null),pt.return(this._gpuBitmapText[e]),this._gpuBitmapText[e]=null}},{key:"updateRenderable",value:function(e){var t=this._getGpuBitmapText(e);Nd(e,t),this._renderer.renderPipes.graphics.updateRenderable(t),t.context.customShader&&this._updateDistanceField(e)}},{key:"_updateContext",value:function(e,t){var r=t.context,n=Ud.getFont(e.text,e._style);r.clear(),"none"!==n.distanceField.type&&(r.customShader||(r.customShader=pt.get(vd)));var i=Array.from(e.text),a=e._style,o=n.baseLineOffset,s=Ad(i,a,n,!0),u=0,l=a.padding,c=s.scale,h=s.width,d=s.height+s.offsetY;a._stroke&&(h+=a._stroke.width/c,d+=a._stroke.width/c),r.translate(-e._anchor._x*h-l,-e._anchor._y*d-l).scale(c,c);for(var f=n.applyFillAsTint?a._fill.color:16777215,p=0;p<s.lines.length;p++){for(var v=s.lines[p],m=0;m<v.charPositions.length;m++){var g=i[u++],_=n.chars[g];(null==_?void 0:_.texture)&&r.texture(_.texture,f||"black",Math.round(v.charPositions[m]+_.xOffset),Math.round(o+_.yOffset))}o+=n.lineHeight}}},{key:"_getGpuBitmapText",value:function(e){return this._gpuBitmapText[e.uid]||this.initGpuText(e)}},{key:"initGpuText",value:function(e){var t=pt.get(cd);return this._gpuBitmapText[e.uid]=t,this._updateContext(e,t),e.on("destroyed",this._destroyRenderableBound),this._gpuBitmapText[e.uid]}},{key:"_updateDistanceField",value:function(e){var t=this._getGpuBitmapText(e).context,r=e._style.fontFamily,n=sa.get("".concat(r,"-bitmap")),i=e.groupTransform,a=i.a,o=i.b,s=i.c,u=i.d,l=Math.sqrt(a*a+o*o),c=Math.sqrt(s*s+u*u),h=(Math.abs(l)+Math.abs(c))/2,d=n.baseRenderedFontSize/e._style.fontSize,f=h*n.distanceField.range*(1/d);t.customShader.resources.localUniforms.uniforms.uDistance=f}},{key:"destroy",value:function(){for(var e in this._gpuBitmapText)this._destroyRenderableByUid(e);this._gpuBitmapText=null,this._renderer=null}}])}();function Nd(e,t){t.groupTransform=e.groupTransform,t.groupColorAlpha=e.groupColorAlpha,t.groupColor=e.groupColor,t.groupBlendMode=e.groupBlendMode,t.globalDisplayStatus=e.globalDisplayStatus,t.groupTransform=e.groupTransform,t.localDisplayStatus=e.localDisplayStatus,t.groupAlpha=e.groupAlpha,t._roundPixels=e._roundPixels}Ld.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"bitmapText"},$.add(Ld);var Xd=exports.HTMLTextPipe=function(){return B(function e(t){C(this,e),this._gpuText=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=t,this._renderer.runners.resolutionChange.add(this)},[{key:"resolutionChange",value:function(){for(var e in this._gpuText){var t=this._gpuText[e];if(t){var r=t.batchableSprite.renderable;r._autoResolution&&(r._resolution=this._renderer.resolution,r.onViewUpdate())}}}},{key:"validateRenderable",value:function(e){var t=this._getGpuText(e),r=e._getKey();return t.textureNeedsUploading?(t.textureNeedsUploading=!1,!0):t.currentKey!==r}},{key:"addRenderable",value:function(e,t){var r=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),this._renderer.renderPipes.batch.addToBatch(r,t)}},{key:"updateRenderable",value:function(e){var t=this._getGpuText(e).batchableSprite;e._didTextUpdate&&this._updateText(e),t._batcher.updateElement(t)}},{key:"destroyRenderable",value:function(e){e.off("destroyed",this._destroyRenderableBound),this._destroyRenderableById(e.uid)}},{key:"_destroyRenderableById",value:function(e){var t=this._gpuText[e];this._renderer.htmlText.decreaseReferenceCount(t.currentKey),pt.return(t.batchableSprite),this._gpuText[e]=null}},{key:"_updateText",value:function(e){var t=e._getKey(),r=this._getGpuText(e),n=r.batchableSprite;r.currentKey!==t&&this._updateGpuText(e).catch(function(e){console.error(e)}),e._didTextUpdate=!1;var i=e._style.padding;wi(n.bounds,e._anchor,n.texture,i)}},{key:"_updateGpuText",value:function(){var e=v(f().mark(function e(t){var r,n,i,a,o,s,u;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._didTextUpdate=!1,!(n=this._getGpuText(t)).generatingTexture){e.next=4;break}return e.abrupt("return");case 4:return i=t._getKey(),this._renderer.htmlText.decreaseReferenceCount(n.currentKey),n.generatingTexture=!0,n.currentKey=i,a=null!=(r=t.resolution)?r:this._renderer.resolution,e.next=11,this._renderer.htmlText.getManagedTexture(t.text,a,t._style,t._getKey());case 11:o=e.sent,(s=n.batchableSprite).texture=n.texture=o,n.generatingTexture=!1,n.textureNeedsUploading=!0,t.onViewUpdate(),u=t._style.padding,wi(s.bounds,t._anchor,s.texture,u);case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_getGpuText",value:function(e){return this._gpuText[e.uid]||this.initGpuText(e)}},{key:"initGpuText",value:function(e){var t={texture:bi.EMPTY,currentKey:"--",batchableSprite:pt.get(Cl),textureNeedsUploading:!1,generatingTexture:!1},r=t.batchableSprite;return r.renderable=e,r.transform=e.groupTransform,r.texture=bi.EMPTY,r.bounds={minX:0,maxX:1,minY:0,maxY:0},r.roundPixels=this._renderer._roundPixels|e._roundPixels,e._resolution=e._autoResolution?this._renderer.resolution:e.resolution,this._gpuText[e.uid]=t,e.on("destroyed",this._destroyRenderableBound),t}},{key:"destroy",value:function(){for(var e in this._gpuText)this._destroyRenderableById(e);this._gpuText=null,this._renderer=null}}])}();function Hd(){var e=hn.get().getNavigator().userAgent;return/^((?!chrome|android).)*safari/i.test(e)}Xd.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"htmlText"};var jd=exports.nssvg="http://www.w3.org/2000/svg",zd=exports.nsxhtml="http://www.w3.org/1999/xhtml",Vd=exports.HTMLTextRenderData=B(function e(){C(this,e),this.svgRoot=document.createElementNS(jd,"svg"),this.foreignObject=document.createElementNS(jd,"foreignObject"),this.domElement=document.createElementNS(zd,"div"),this.styleElement=document.createElementNS(zd,"style"),this.image=new Image;var t=this.foreignObject,r=this.svgRoot,n=this.styleElement,i=this.domElement;t.setAttribute("width","10000"),t.setAttribute("height","10000"),t.style.overflow="hidden",r.appendChild(t),t.appendChild(n),t.appendChild(i)});function Wd(e){var t=e._stroke,r=e._fill,n=["color: ".concat(Ke.shared.setValue(r.color).toHex()),"font-size: ".concat(e.fontSize,"px"),"font-family: ".concat(e.fontFamily),"font-weight: ".concat(e.fontWeight),"font-style: ".concat(e.fontStyle),"font-variant: ".concat(e.fontVariant),"letter-spacing: ".concat(e.letterSpacing,"px"),"text-align: ".concat(e.align),"padding: ".concat(e.padding,"px"),"white-space: ".concat("pre"===e.whiteSpace&&e.wordWrap?"pre-wrap":e.whiteSpace)].concat(m(e.lineHeight?["line-height: ".concat(e.lineHeight,"px")]:[]),m(e.wordWrap?["word-wrap: ".concat(e.breakWords?"break-all":"break-word"),"max-width: ".concat(e.wordWrapWidth,"px")]:[]),m(t?[Kd(t)]:[]),m(e.dropShadow?[Yd(e.dropShadow)]:[]),m(e.cssOverrides)).join(";"),i=["div { ".concat(n," }")];return Qd(e.tagStyles,i),i.join(" ")}function Yd(e){var t=Ke.shared.setValue(e.color).setAlpha(e.alpha).toHexa(),r=Math.round(Math.cos(e.angle)*e.distance),n=Math.round(Math.sin(e.angle)*e.distance),i="".concat(r,"px ").concat(n,"px");return e.blur>0?"text-shadow: ".concat(i," ").concat(e.blur,"px ").concat(t):"text-shadow: ".concat(i," ").concat(t)}function Kd(e){return["-webkit-text-stroke-width: ".concat(e.width,"px"),"-webkit-text-stroke-color: ".concat(Ke.shared.setValue(e.color).toHex()),"text-stroke-width: ".concat(e.width,"px"),"text-stroke-color: ".concat(Ke.shared.setValue(e.color).toHex()),"paint-order: stroke"].join(";")}var qd={fontSize:"font-size: {{VALUE}}px",fontFamily:"font-family: {{VALUE}}",fontWeight:"font-weight: {{VALUE}}",fontStyle:"font-style: {{VALUE}}",fontVariant:"font-variant: {{VALUE}}",letterSpacing:"letter-spacing: {{VALUE}}px",align:"text-align: {{VALUE}}",padding:"padding: {{VALUE}}px",whiteSpace:"white-space: {{VALUE}}",lineHeight:"line-height: {{VALUE}}px",wordWrapWidth:"max-width: {{VALUE}}px"},Zd={fill:function(e){return"color: ".concat(Ke.shared.setValue(e).toHex())},breakWords:function(e){return"word-wrap: ".concat(e?"break-all":"break-word")},stroke:Kd,dropShadow:Yd};function Qd(e,t){for(var r in e){var n=e[r],i=[];for(var a in n)Zd[a]?i.push(Zd[a](n[a])):qd[a]&&i.push(qd[a].replace("{{VALUE}}",n[a]));t.push("".concat(r," { ").concat(i.join(";")," }"))}}var Jd=Object.defineProperty,$d=Object.getOwnPropertySymbols,ef=Object.prototype.hasOwnProperty,tf=Object.prototype.propertyIsEnumerable,rf=function(e,t,r){return t in e?Jd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},nf=function(e,t){for(var r in t||(t={}))ef.call(t,r)&&rf(e,r,t[r]);if($d){var n,i=U($d(t));try{for(i.s();!(n=i.n()).done;){r=n.value;tf.call(t,r)&&rf(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},af=exports.HTMLTextStyle=function(e){function t(){var e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return C(this,t),(e=x(this,t,[n]))._cssOverrides=[],null!=e.cssOverrides||(e.cssOverrides=n.cssOverrides),e.tagStyles=null!=(r=n.tagStyles)?r:{},e}return E(t,zh),B(t,[{key:"cssOverrides",get:function(){return this._cssOverrides},set:function(e){this._cssOverrides=e instanceof Array?e:[e],this.update()}},{key:"_generateKey",value:function(){return this._styleKey=Mh(this)+this._cssOverrides.join("-"),this._styleKey}},{key:"update",value:function(){this._cssStyle=null,c(t,"update",this,3)([])}},{key:"clone",value:function(){return new t({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow?nf({},this.dropShadow):null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,cssOverrides:this.cssOverrides})}},{key:"cssStyle",get:function(){return this._cssStyle||(this._cssStyle=Wd(this)),this._cssStyle}},{key:"addOverride",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i,a=r.filter(function(t){return!e.cssOverrides.includes(t)});a.length>0&&((i=this.cssOverrides).push.apply(i,m(a)),this.update())}},{key:"removeOverride",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.filter(function(t){return e.cssOverrides.includes(t)});i.length>0&&(this.cssOverrides=this.cssOverrides.filter(function(e){return!i.includes(e)}),this.update())}},{key:"fill",set:function(e){"string"!=typeof e&&"number"!=typeof e&&Gt("[HTMLTextStyle] only color fill is not supported by HTMLText"),o(t,"fill",e,this,1,1)}},{key:"stroke",set:function(e){e&&"string"!=typeof e&&"number"!=typeof e&&Gt("[HTMLTextStyle] only color stroke is not supported by HTMLText"),o(t,"stroke",e,this,1,1)}}])}();function of(e,t){var r=t.fontFamily,n=[],i={},a=e.match(/font-family:([^;"\s]+)/g);function o(e){i[e]||(n.push(e),i[e]=!0)}if(Array.isArray(r))for(var s=0;s<r.length;s++)o(r[s]);else o(r);for(var u in a&&a.forEach(function(e){o(e.split(":")[1].trim())}),t.tagStyles){o(t.tagStyles[u].fontFamily)}return n}function sf(e){return uf.apply(this,arguments)}function uf(){return(uf=v(f().mark(function e(t){var r,n,i,a;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.get().fetch(t);case 2:return r=e.sent,e.next=5,r.blob();case 5:return n=e.sent,i=new FileReader,e.next=9,new Promise(function(e,t){i.onloadend=function(){return e(i.result)},i.onerror=t,i.readAsDataURL(n)});case 9:return a=e.sent,e.abrupt("return",a);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function lf(e,t){return cf.apply(this,arguments)}function cf(){return(cf=v(f().mark(function e(t,r){var n;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sf(r);case 2:return n=e.sent,e.abrupt("return",'@font-face {\n        font-family: "'.concat(t.fontFamily,"\";\n        src: url('").concat(n,"');\n        font-weight: ").concat(t.fontWeight,";\n        font-style: ").concat(t.fontStyle,";\n    }"));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var hf,df=exports.FontStylePromiseCache=new Map;function ff(e,t,r){return pf.apply(this,arguments)}function pf(){return(pf=v(f().mark(function e(t,r,n){var i;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.filter(function(e){return sa.has("".concat(e,"-and-url"))}).map(function(e,t){if(!df.has(e)){var i=sa.get("".concat(e,"-and-url")).url;0===t?df.set(e,lf({fontWeight:r.fontWeight,fontStyle:r.fontStyle,fontFamily:e},i)):df.set(e,lf({fontWeight:n.fontWeight,fontStyle:n.fontStyle,fontFamily:e},i))}return df.get(e)}),e.next=3,Promise.all(i);case 3:return e.abrupt("return",e.sent.join("\n"));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function vf(e,t,r,n,i){var a=i.domElement,o=i.styleElement,s=i.svgRoot;a.innerHTML="<style>".concat(t.cssStyle,"</style><div style='padding:0;'>").concat(e,"</div>"),a.setAttribute("style","transform: scale(".concat(r,");transform-origin: top left; display: inline-block")),o.textContent=n;var u=i.image,l=u.width,c=u.height;return s.setAttribute("width",l.toString()),s.setAttribute("height",c.toString()),(new XMLSerializer).serializeToString(s)}function mf(e,t){var r=Il.getOptimalCanvasAndContext(e.width,e.height,t),n=r.context;return n.clearRect(0,0,e.width,e.height),n.drawImage(e,0,0),Il.returnCanvasAndContext(r),r.canvas}function gf(e,t,r){return new Promise(function(){var n=v(f().mark(function n(i){return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!r){n.next=3;break}return n.next=3,new Promise(function(e){return setTimeout(e,100)});case 3:e.onload=function(){i()},e.src="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(t)),e.crossOrigin="anonymous";case 6:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())}function _f(e,t,r,n){var i=n=n||hf||(hf=new Vd),a=i.domElement,o=i.styleElement,s=i.svgRoot;a.innerHTML="<style>".concat(t.cssStyle,";</style><div style='padding:0'>").concat(e,"</div>"),a.setAttribute("style","transform-origin: top left; display: inline-block"),r&&(o.textContent=r),document.body.appendChild(s);var u=a.getBoundingClientRect();s.remove();var l=Jh.measureFont(t.fontStyle).descent,c=2*t.padding;return{width:u.width-c,height:u.height+l-c}}var yf=exports.HTMLTextSystem=function(){return B(function e(t){C(this,e),this._activeTextures={},this._renderer=t,this._createCanvas=t.type===Ds.WEBGPU},[{key:"getTexture",value:function(e){return this._buildTexturePromise(e.text,e.resolution,e.style)}},{key:"getManagedTexture",value:function(e,t,r,n){var i=this;if(this._activeTextures[n])return this._increaseReferenceCount(n),this._activeTextures[n].promise;var a=this._buildTexturePromise(e,t,r).then(function(e){return i._activeTextures[n].texture=e,e});return this._activeTextures[n]={texture:null,promise:a,usageCount:1},a}},{key:"_buildTexturePromise",value:function(){var e=v(f().mark(function e(t,r,n){var i,a,o,s,u,l,c,h,d,p,v;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=pt.get(Vd),a=of(t,n),e.next=4,ff(a,n,af.defaultTextStyle);case 4:return o=e.sent,s=_f(t,n,o,i),u=Math.ceil(Math.ceil(Math.max(1,s.width)+2*n.padding)*r),l=Math.ceil(Math.ceil(Math.max(1,s.height)+2*n.padding)*r),c=i.image,h=2,c.width=(0|u)+h,c.height=(0|l)+h,d=vf(t,n,r,o,i),e.next=15,gf(c,d,Hd()&&a.length>0);case 15:return p=c,this._createCanvas&&(p=mf(c,r)),v=Yh(p,c.width-h,c.height-h,r),this._createCanvas&&this._renderer.texture.initSource(v.source),pt.return(i),e.abrupt("return",v);case 21:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_increaseReferenceCount",value:function(e){this._activeTextures[e].usageCount++}},{key:"decreaseReferenceCount",value:function(e){var t=this,r=this._activeTextures[e];r&&(r.usageCount--,0===r.usageCount&&(r.texture?this._cleanUp(r):r.promise.then(function(e){r.texture=e,t._cleanUp(r)}).catch(function(){Gt("HTMLTextSystem: Failed to clean texture")}),this._activeTextures[e]=null))}},{key:"_cleanUp",value:function(e){Yl.returnTexture(e.texture),e.texture.source.resource=null,e.texture.source.uploadMethodId="unknown"}},{key:"getReferenceCount",value:function(e){return this._activeTextures[e].usageCount}},{key:"destroy",value:function(){this._activeTextures=null}}])}();yf.extension={type:[Z.WebGLSystem,Z.WebGPUSystem,Z.CanvasSystem],name:"htmlText"},yf.defaultFontOptions={fontFamily:"Arial",fontStyle:"normal",fontWeight:"normal"},$.add(yf),$.add(Xd);var xf=Object.defineProperty,bf=Object.getOwnPropertySymbols,Tf=Object.prototype.hasOwnProperty,Sf=Object.prototype.propertyIsEnumerable,kf=function(e,t,r){return t in e?xf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Ef=function(e,t){for(var r in t||(t={}))Tf.call(t,r)&&kf(e,r,t[r]);if(bf){var n,i=U(bf(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Sf.call(t,r)&&kf(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Af=function(e){function t(){var e,r;C(this,t);var n=null!=(r=arguments.length<=0?void 0:arguments[0])?r:{};n instanceof Float32Array&&(ht(lt,"use new MeshGeometry({ positions, uvs, indices }) instead"),n={positions:n,uvs:arguments.length<=1?void 0:arguments[1],indices:arguments.length<=2?void 0:arguments[2]});var i=(n=Ef(Ef({},t.defaultOptions),n)).positions||new Float32Array([0,0,1,0,1,1,0,1]),a=n.uvs||new Float32Array([0,0,1,0,1,1,0,1]),o=n.indices||new Uint32Array([0,1,2,0,2,3]),s=n.shrinkBuffersToFit;return(e=x(this,t,[{attributes:{aPosition:{buffer:new Wa({data:i,label:"attribute-mesh-positions",shrinkToFit:s,usage:Va.VERTEX|Va.COPY_DST}),format:"float32x2",stride:8,offset:0},aUV:{buffer:new Wa({data:a,label:"attribute-mesh-uvs",shrinkToFit:s,usage:Va.VERTEX|Va.COPY_DST}),format:"float32x2",stride:8,offset:0}},indexBuffer:new Wa({data:o,label:"index-mesh-buffer",shrinkToFit:s,usage:Va.INDEX|Va.COPY_DST}),topology:n.topology}])).batchMode="auto",e}return E(t,Qa),B(t,[{key:"positions",get:function(){return this.attributes.aPosition.buffer.data},set:function(e){this.attributes.aPosition.buffer.data=e}},{key:"uvs",get:function(){return this.attributes.aUV.buffer.data},set:function(e){this.attributes.aUV.buffer.data=e}},{key:"indices",get:function(){return this.indexBuffer.data},set:function(e){this.indexBuffer.data=e}}])}();Af.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};var wf,Rf,Pf=exports.MeshGeometry=Af,Mf=Object.defineProperty,Of=Object.defineProperties,Cf=Object.getOwnPropertyDescriptors,Gf=Object.getOwnPropertySymbols,Bf=Object.prototype.hasOwnProperty,If=Object.prototype.propertyIsEnumerable,Ff=function(e,t,r){return t in e?Mf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Df=function(e,t){for(var r in t||(t={}))Bf.call(t,r)&&Ff(e,r,t[r]);if(Gf){var n,i=U(Gf(t));try{for(i.s();!(n=i.n()).done;){r=n.value;If.call(t,r)&&Ff(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Uf=function(e,t){return Of(e,Cf(t))},Lf=exports.localUniformBit={name:"local-uniform-bit",vertex:{header:"\n\n            struct LocalUniforms {\n                uTransformMatrix:mat3x3<f32>,\n                uColor:vec4<f32>,\n                uRound:f32,\n            }\n\n            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        ",main:"\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        ",end:"\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        "}},Nf=exports.localUniformBitGroup2=Uf(Df({},Lf),{vertex:Uf(Df({},Lf.vertex),{header:Lf.vertex.header.replace("group(1)","group(2)")})}),Xf=exports.localUniformBitGl={name:"local-uniform-bit",vertex:{header:"\n\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        ",main:"\n            vColor *= uColor;\n            modelMatrix = uTransformMatrix;\n        ",end:"\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        "}},Hf=exports.tilingBit={name:"tiling-bit",vertex:{header:"\n            struct TilingUniforms {\n                uMapCoord:mat3x3<f32>,\n                uClampFrame:vec4<f32>,\n                uClampOffset:vec2<f32>,\n                uTextureTransform:mat3x3<f32>,\n                uSizeAnchor:vec4<f32>\n            };\n\n            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;\n            @group(2) @binding(1) var uTexture: texture_2d<f32>;\n            @group(2) @binding(2) var uSampler: sampler;\n        ",main:"\n            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;\n\n            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;\n        "},fragment:{header:"\n            struct TilingUniforms {\n                uMapCoord:mat3x3<f32>,\n                uClampFrame:vec4<f32>,\n                uClampOffset:vec2<f32>,\n                uTextureTransform:mat3x3<f32>,\n                uSizeAnchor:vec4<f32>\n            };\n\n            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;\n            @group(2) @binding(1) var uTexture: texture_2d<f32>;\n            @group(2) @binding(2) var uSampler: sampler;\n        ",main:"\n\n            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);\n            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;\n            var unclamped = coord;\n            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);\n\n            var bias = 0.;\n\n            if(unclamped.x == coord.x && unclamped.y == coord.y)\n            {\n                bias = -32.;\n            } \n\n            outColor = textureSampleBias(uTexture, uSampler, coord, bias);\n        "}},jf=exports.tilingBitGl={name:"tiling-bit",vertex:{header:"\n            uniform mat3 uTextureTransform;\n            uniform vec4 uSizeAnchor;\n        \n        ",main:"\n            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;\n\n            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;\n        "},fragment:{header:"\n            uniform sampler2D uTexture;\n            uniform mat3 uMapCoord;\n            uniform vec4 uClampFrame;\n            uniform vec2 uClampOffset;\n        ",main:"\n\n        vec2 coord = vUV + ceil(uClampOffset - vUV);\n        coord = (uMapCoord * vec3(coord, 1.0)).xy;\n        vec2 unclamped = coord;\n        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n        \n        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0\n    \n        "}},zf=exports.TilingSpriteShader=function(e){function t(){C(this,t),null!=wf||(wf=hs({name:"tiling-sprite-shader",bits:[Lf,Hf,Ts]})),null!=Rf||(Rf=ds({name:"tiling-sprite-shader",bits:[Xf,jf,Ss]}));var e=new Bs({uMapCoord:{value:new tt,type:"mat3x3<f32>"},uClampFrame:{value:new Float32Array([0,0,1,1]),type:"vec4<f32>"},uClampOffset:{value:new Float32Array([0,0]),type:"vec2<f32>"},uTextureTransform:{value:new tt,type:"mat3x3<f32>"},uSizeAnchor:{value:new Float32Array([100,100,.5,.5]),type:"vec4<f32>"}});return x(this,t,[{glProgram:Rf,gpuProgram:wf,resources:{localUniforms:new Bs({uTransformMatrix:{value:new tt,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),tilingUniforms:e,uTexture:bi.EMPTY.source,uSampler:bi.EMPTY.source.style}}])}return E(t,Vs),B(t,[{key:"updateUniforms",value:function(e,t,r,n,i,a){var o=this.resources.tilingUniforms,s=a.width,u=a.height,l=a.textureMatrix,c=o.uniforms.uTextureTransform;c.set(r.a*s/e,r.b*s/t,r.c*u/e,r.d*u/t,r.tx/e,r.ty/t),c.invert(),o.uniforms.uMapCoord=l.mapCoord,o.uniforms.uClampFrame=l.uClampFrame,o.uniforms.uClampOffset=l.uClampOffset,o.uniforms.uTextureTransform=c,o.uniforms.uSizeAnchor[0]=e,o.uniforms.uSizeAnchor[1]=t,o.uniforms.uSizeAnchor[2]=n,o.uniforms.uSizeAnchor[3]=i,a&&(this.resources.uTexture=a.source,this.resources.uSampler=a.source.style)}}])}(),Vf=exports.QuadGeometry=function(e){function t(){return C(this,t),x(this,t,[{positions:new Float32Array([0,0,1,0,1,1,0,1]),uvs:new Float32Array([0,0,1,0,1,1,0,1]),indices:new Uint32Array([0,1,2,0,2,3])}])}return E(t,Pf),B(t)}();function Wf(e,t){var r=e.anchor.x,n=e.anchor.y;t[0]=-r*e.width,t[1]=-n*e.height,t[2]=(1-r)*e.width,t[3]=-n*e.height,t[4]=(1-r)*e.width,t[5]=(1-n)*e.height,t[6]=-r*e.width,t[7]=(1-n)*e.height}function Yf(e,t,r,n){var i=0,a=e.length/(t||2),o=n.a,s=n.b,u=n.c,l=n.d,c=n.tx,h=n.ty;for(r*=t;i<a;){var d=e[r],f=e[r+1];e[r]=o*d+u*f+c,e[r+1]=s*d+l*f+h,r+=t,i++}}function Kf(e,t){var r=e.texture,n=r.frame.width,i=r.frame.height,a=0,o=0;e._applyAnchorToTexture&&(a=e.anchor.x,o=e.anchor.y),t[0]=t[6]=-a,t[2]=t[4]=1-a,t[1]=t[3]=-o,t[5]=t[7]=1-o;var s=tt.shared;s.copyFrom(e._tileTransform.matrix),s.tx/=e.width,s.ty/=e.height,s.invert(),s.scale(e.width/n,e.height/i),Yf(t,2,0,s)}var qf=new Vf,Zf=exports.TilingSpritePipe=function(){return B(function e(t){C(this,e),this._state=Al.default2d,this._tilingSpriteDataHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=t},[{key:"validateRenderable",value:function(e){var t=this._getTilingSpriteData(e),r=t.canBatch;this._updateCanBatch(e);var n=t.canBatch;if(n&&n===r){var i=t.batchableMesh;if(i&&i.texture._source!==e.texture._source)return!i._batcher.checkAndUpdateTexture(i,e.texture)}return r!==n}},{key:"addRenderable",value:function(e,t){var r=this._renderer.renderPipes.batch;this._updateCanBatch(e);var n=this._getTilingSpriteData(e),i=n.geometry;if(n.canBatch){n.batchableMesh||(n.batchableMesh=new Ml);var a=n.batchableMesh;e._didTilingSpriteUpdate&&(e._didTilingSpriteUpdate=!1,this._updateBatchableMesh(e),a.geometry=i,a.renderable=e,a.transform=e.groupTransform,a.texture=e._texture),a.roundPixels=this._renderer._roundPixels|e._roundPixels,r.addToBatch(a,t)}else r.break(t),n.shader||(n.shader=new zf),this.updateRenderable(e),t.add(e)}},{key:"execute",value:function(e){var t=this._tilingSpriteDataHash[e.uid].shader;t.groups[0]=this._renderer.globalUniforms.bindGroup;var r=t.resources.localUniforms.uniforms;r.uTransformMatrix=e.groupTransform,r.uRound=this._renderer._roundPixels|e._roundPixels,Rl(e.groupColorAlpha,r.uColor,0),this._state.blendMode=Pa(e.groupBlendMode,e.texture._source),this._renderer.encoder.draw({geometry:qf,shader:t,state:this._state})}},{key:"updateRenderable",value:function(e){var t=this._getTilingSpriteData(e);if(t.canBatch){var r=t.batchableMesh;e._didTilingSpriteUpdate&&this._updateBatchableMesh(e),r._batcher.updateElement(r)}else if(e._didTilingSpriteUpdate){t.shader.updateUniforms(e.width,e.height,e._tileTransform.matrix,e.anchor.x,e.anchor.y,e.texture)}e._didTilingSpriteUpdate=!1}},{key:"destroyRenderable",value:function(e){var t,r=this._getTilingSpriteData(e);r.batchableMesh=null,null==(t=r.shader)||t.destroy(),this._tilingSpriteDataHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}},{key:"_getTilingSpriteData",value:function(e){return this._tilingSpriteDataHash[e.uid]||this._initTilingSpriteData(e)}},{key:"_initTilingSpriteData",value:function(e){var t=new Pf({indices:qf.indices,positions:qf.positions.slice(),uvs:qf.uvs.slice()});return this._tilingSpriteDataHash[e.uid]={canBatch:!0,renderable:e,geometry:t},e.on("destroyed",this._destroyRenderableBound),this._tilingSpriteDataHash[e.uid]}},{key:"_updateBatchableMesh",value:function(e){var t=this._getTilingSpriteData(e).geometry,r=e.texture.source.style;"repeat"!==r.addressMode&&(r.addressMode="repeat",r.update()),Kf(e,t.uvs),Wf(e,t.positions)}},{key:"destroy",value:function(){for(var e in this._tilingSpriteDataHash)this.destroyRenderable(this._tilingSpriteDataHash[e].renderable);this._tilingSpriteDataHash=null,this._renderer=null}},{key:"_updateCanBatch",value:function(e){var t=this._getTilingSpriteData(e),r=e.texture,n=!0;return this._renderer.type===Ds.WEBGL&&(n=this._renderer.context.supports.nonPowOf2wrapping),t.canBatch=r.textureMatrix.isSimple&&(n||r.source.isPowerOfTwo),t.canBatch}}])}();Zf.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"tilingSprite"},$.add(Zf);var Qf=Object.defineProperty,Jf=Object.getOwnPropertySymbols,$f=Object.prototype.hasOwnProperty,ep=Object.prototype.propertyIsEnumerable,tp=function(e,t,r){return t in e?Qf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},rp=function(e,t){for(var r in t||(t={}))$f.call(t,r)&&tp(e,r,t[r]);if(Jf){var n,i=U(Jf(t));try{for(i.s();!(n=i.n()).done;){r=n.value;ep.call(t,r)&&tp(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},np=function(e){function t(){var e,r;C(this,t),e=x(this,t,[{}]);var n=null!=(r=arguments.length<=0?void 0:arguments[0])?r:{};return"number"==typeof n&&(ht(lt,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),n={width:n,height:arguments.length<=1?void 0:arguments[1],verticesX:arguments.length<=2?void 0:arguments[2],verticesY:arguments.length<=3?void 0:arguments[3]}),e.build(n),e}return E(t,Pf),B(t,[{key:"build",value:function(e){var r,n,i,a;e=rp(rp({},t.defaultOptions),e),this.verticesX=null!=(r=this.verticesX)?r:e.verticesX,this.verticesY=null!=(n=this.verticesY)?n:e.verticesY,this.width=null!=(i=this.width)?i:e.width,this.height=null!=(a=this.height)?a:e.height;for(var o=this.verticesX*this.verticesY,s=[],u=[],l=[],c=this.verticesX-1,h=this.verticesY-1,d=this.width/c,f=this.height/h,p=0;p<o;p++){var v=p%this.verticesX,m=p/this.verticesX|0;s.push(v*d,m*f),u.push(v/c,m/h)}for(var g=c*h,_=0;_<g;_++){var y=_%c,x=_/c|0,b=x*this.verticesX+y,T=x*this.verticesX+y+1,S=(x+1)*this.verticesX+y,k=(x+1)*this.verticesX+y+1;l.push(b,T,S,T,k,S)}this.buffers[0].data=new Float32Array(s),this.buffers[1].data=new Float32Array(u),this.indexBuffer.data=new Uint32Array(l),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}])}();np.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};var ip=exports.PlaneGeometry=np,ap=Object.defineProperty,op=Object.getOwnPropertySymbols,sp=Object.prototype.hasOwnProperty,up=Object.prototype.propertyIsEnumerable,lp=function(e,t,r){return t in e?ap(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},cp=function(e,t){for(var r in t||(t={}))sp.call(t,r)&&lp(e,r,t[r]);if(op){var n,i=U(op(t));try{for(i.s();!(n=i.n()).done;){r=n.value;up.call(t,r)&&lp(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},hp=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return C(this,t),(e=x(this,t,[{width:(r=cp(cp({},t.defaultOptions),r)).width,height:r.height,verticesX:4,verticesY:4}])).update(r),e}return E(t,ip),B(t,[{key:"update",value:function(e){var t,r,n,i,a,o,s,u;this.width=null!=(t=e.width)?t:this.width,this.height=null!=(r=e.height)?r:this.height,this._originalWidth=null!=(n=e.originalWidth)?n:this._originalWidth,this._originalHeight=null!=(i=e.originalHeight)?i:this._originalHeight,this._leftWidth=null!=(a=e.leftWidth)?a:this._leftWidth,this._rightWidth=null!=(o=e.rightWidth)?o:this._rightWidth,this._topHeight=null!=(s=e.topHeight)?s:this._topHeight,this._bottomHeight=null!=(u=e.bottomHeight)?u:this._bottomHeight,this.updateUvs(),this.updatePositions()}},{key:"updatePositions",value:function(){var e=this.positions,t=this._leftWidth+this._rightWidth,r=this.width>t?1:this.width/t,n=this._topHeight+this._bottomHeight,i=this.height>n?1:this.height/n,a=Math.min(r,i);e[9]=e[11]=e[13]=e[15]=this._topHeight*a,e[17]=e[19]=e[21]=e[23]=this.height-this._bottomHeight*a,e[25]=e[27]=e[29]=e[31]=this.height,e[2]=e[10]=e[18]=e[26]=this._leftWidth*a,e[4]=e[12]=e[20]=e[28]=this.width-this._rightWidth*a,e[6]=e[14]=e[22]=e[30]=this.width,this.getBuffer("aPosition").update()}},{key:"updateUvs",value:function(){var e=this.uvs;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1;var t=1/this._originalWidth,r=1/this._originalHeight;e[2]=e[10]=e[18]=e[26]=t*this._leftWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[4]=e[12]=e[20]=e[28]=1-t*this._rightWidth,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.getBuffer("aUV").update()}}])}();hp.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};var dp=exports.NineSliceGeometry=hp,fp=exports.NineSliceSpritePipe=function(){return B(function e(t){C(this,e),this._gpuSpriteHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=t},[{key:"addRenderable",value:function(e,t){var r=this._getGpuSprite(e);e._didSpriteUpdate&&this._updateBatchableSprite(e,r),this._renderer.renderPipes.batch.addToBatch(r,t)}},{key:"updateRenderable",value:function(e){var t=this._gpuSpriteHash[e.uid];e._didSpriteUpdate&&this._updateBatchableSprite(e,t),t._batcher.updateElement(t)}},{key:"validateRenderable",value:function(e){var t=e._texture,r=this._getGpuSprite(e);return r.texture._source!==t._source&&!r._batcher.checkAndUpdateTexture(r,t)}},{key:"destroyRenderable",value:function(e){var t=this._gpuSpriteHash[e.uid];pt.return(t.geometry),pt.return(t),this._gpuSpriteHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}},{key:"_updateBatchableSprite",value:function(e,t){e._didSpriteUpdate=!1,t.geometry.update(e),t.texture=e._texture}},{key:"_getGpuSprite",value:function(e){return this._gpuSpriteHash[e.uid]||this._initGPUSprite(e)}},{key:"_initGPUSprite",value:function(e){var t=pt.get(Ml);return t.geometry=pt.get(dp),t.renderable=e,t.transform=e.groupTransform,t.texture=e._texture,t.roundPixels=this._renderer._roundPixels|e._roundPixels,e._didSpriteUpdate=!0,this._gpuSpriteHash[e.uid]=t,e.on("destroyed",this._destroyRenderableBound),t}},{key:"destroy",value:function(){for(var e in this._gpuSpriteHash){this._gpuSpriteHash[e].geometry.destroy()}this._gpuSpriteHash=null,this._renderer=null}}])}();fp.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"nineSliceSprite"},$.add(fp);var pp=exports.FilterPipe=function(){return B(function e(t){C(this,e),this._renderer=t},[{key:"push",value:function(e,t,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"filter",canBundle:!1,action:"pushFilter",container:t,filterEffect:e})}},{key:"pop",value:function(e,t,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}},{key:"execute",value:function(e){"pushFilter"===e.action?this._renderer.filter.push(e):"popFilter"===e.action&&this._renderer.filter.pop()}},{key:"destroy",value:function(){this._renderer=null}}])}();pp.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"filter"};var vp=new tt;function mp(e,t){return t.clear(),gp(e,t),t.isValid||t.set(0,0,0,0),e.renderGroup?t.applyMatrix(e.renderGroup.localTransform):t.applyMatrix(e.parentRenderGroup.worldTransform),t}function gp(e,t){if(7===e.localDisplayStatus&&e.measurable){var r=!!e.effects.length,n=t;if((e.renderGroup||r)&&(n=wt.get().clear()),e.boundsArea)t.addRect(e.boundsArea,e.worldTransform);else{if(e.renderPipeId){var i=e.bounds;n.addFrame(i.minX,i.minY,i.maxX,i.maxY,e.groupTransform)}for(var a=e.children,o=0;o<a.length;o++)gp(a[o],n)}if(r){for(var s=!1,u=0;u<e.effects.length;u++)e.effects[u].addBounds&&(s||(s=!0,n.applyMatrix(e.parentRenderGroup.worldTransform)),e.effects[u].addBounds(n,!0));s&&(n.applyMatrix(e.parentRenderGroup.worldTransform.copyTo(vp).invert()),t.addBounds(n,e.relativeGroupTransform)),t.addBounds(n),wt.return(n)}else e.renderGroup&&(t.addBounds(n,e.relativeGroupTransform),wt.return(n))}}function _p(e,t){t.clear();for(var r=t.matrix,n=0;n<e.length;n++){var i=e[n];i.globalDisplayStatus<7||(t.matrix=i.worldTransform,i.addBounds(t))}return t.matrix=r,t}var yp=new Qa({attributes:{aPosition:{buffer:new Float32Array([0,0,1,0,1,1,0,1]),format:"float32x2",stride:8,offset:0}},indexBuffer:new Uint32Array([0,1,2,0,2,3])}),xp=exports.FilterSystem=function(){return B(function e(t){C(this,e),this._filterStackIndex=0,this._filterStack=[],this._filterGlobalUniforms=new Bs({uInputSize:{value:new Float32Array(4),type:"vec4<f32>"},uInputPixel:{value:new Float32Array(4),type:"vec4<f32>"},uInputClamp:{value:new Float32Array(4),type:"vec4<f32>"},uOutputFrame:{value:new Float32Array(4),type:"vec4<f32>"},uGlobalFrame:{value:new Float32Array(4),type:"vec4<f32>"},uOutputTexture:{value:new Float32Array(4),type:"vec4<f32>"}}),this._globalFilterBindGroup=new pa({}),this.renderer=t},[{key:"activeBackTexture",get:function(){var e;return null==(e=this._activeFilterData)?void 0:e.backTexture}},{key:"push",value:function(e){var t,r,n=this.renderer,i=e.filterEffect.filters;this._filterStack[this._filterStackIndex]||(this._filterStack[this._filterStackIndex]=this._getFilterData());var a=this._filterStack[this._filterStackIndex];if(this._filterStackIndex++,0!==i.length){var o=a.bounds;e.renderables?_p(e.renderables,o):e.filterEffect.filterArea?(o.clear(),o.addRect(e.filterEffect.filterArea),o.applyMatrix(e.container.worldTransform)):mp(e.container,o);for(var s=n.renderTarget.renderTarget.colorTexture.source,u=1/0,l=0,c=!0,h=!1,d=!1,f=0;f<i.length;f++){var p=i[f];if(u=Math.min(u,"inherit"===p.resolution?s._resolution:p.resolution),l+=p.padding,"off"===p.antialias?c=!1:"inherit"===p.antialias&&c&&(c=s.antialias),!!!(p.compatibleRenderers&n.type)){d=!1;break}if(p.blendRequired&&null!=(r=null==(t=n.backBuffer)?void 0:t.useBackBuffer)&&!r){Gt("Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options."),d=!1;break}d=p.enabled||d,h=h||p.blendRequired}if(d){var v=n.renderTarget.rootViewPort;o.scale(u).fitBounds(0,v.width,0,v.height).ceil().scale(1/u).pad(0|l),o.isPositive?(a.skip=!1,a.bounds=o,a.blendRequired=h,a.container=e.container,a.filterEffect=e.filterEffect,a.previousRenderSurface=n.renderTarget.renderSurface,a.inputTexture=Yl.getOptimalTexture(o.width,o.height,u,c),n.renderTarget.bind(a.inputTexture,!0),n.globalUniforms.push({offset:o})):a.skip=!0}else a.skip=!0}else a.skip=!0}},{key:"pop",value:function(){var e=this.renderer;this._filterStackIndex--;var t=this._filterStack[this._filterStackIndex];if(!t.skip){this._activeFilterData=t;var r=t.inputTexture,n=t.bounds,i=bi.EMPTY;if(e.renderTarget.finishRenderPass(),t.blendRequired){var a=this._filterStackIndex>0?this._filterStack[this._filterStackIndex-1].bounds:null,o=e.renderTarget.getRenderTarget(t.previousRenderSurface);i=this.getBackTexture(o,n,a)}t.backTexture=i;var s=t.filterEffect.filters;if(this._globalFilterBindGroup.setResource(r.source.style,2),this._globalFilterBindGroup.setResource(i.source,3),e.globalUniforms.pop(),1===s.length)s[0].apply(this,r,t.previousRenderSurface,!1),Yl.returnTexture(r);else{var u=t.inputTexture,l=Yl.getOptimalTexture(n.width,n.height,u.source._resolution,!1),c=0;for(c=0;c<s.length-1;++c){s[c].apply(this,u,l,!0);var h=u;u=l,l=h}s[c].apply(this,u,t.previousRenderSurface,!1),Yl.returnTexture(u),Yl.returnTexture(l)}t.blendRequired&&Yl.returnTexture(i)}}},{key:"getBackTexture",value:function(e,t,r){var n=e.colorTexture.source._resolution,i=Yl.getOptimalTexture(t.width,t.height,n,!1),a=t.minX,o=t.minY;r&&(a-=r.minX,o-=r.minY),a=Math.floor(a*n),o=Math.floor(o*n);var s=Math.ceil(t.width*n),u=Math.ceil(t.height*n);return this.renderer.renderTarget.copyToTexture(e,i,{x:a,y:o},{width:s,height:u},{x:0,y:0}),i}},{key:"applyFilter",value:function(e,t,r,n){for(var i=this.renderer,a=this._filterStack[this._filterStackIndex],o=a.bounds,s=$e.shared,u=a.previousRenderSurface===r,l=this.renderer.renderTarget.rootRenderTarget.colorTexture.source._resolution,c=this._filterStackIndex-1;c>0&&this._filterStack[c].skip;)--c;c>0&&(l=this._filterStack[c].inputTexture.source._resolution);var h=this._filterGlobalUniforms,d=h.uniforms,f=d.uOutputFrame,p=d.uInputSize,v=d.uInputPixel,m=d.uInputClamp,g=d.uGlobalFrame,_=d.uOutputTexture;if(u){for(var y=this._filterStackIndex;y>0;){y--;var x=this._filterStack[this._filterStackIndex-1];if(!x.skip){s.x=x.bounds.minX,s.y=x.bounds.minY;break}}f[0]=o.minX-s.x,f[1]=o.minY-s.y}else f[0]=0,f[1]=0;f[2]=t.frame.width,f[3]=t.frame.height,p[0]=t.source.width,p[1]=t.source.height,p[2]=1/p[0],p[3]=1/p[1],v[0]=t.source.pixelWidth,v[1]=t.source.pixelHeight,v[2]=1/v[0],v[3]=1/v[1],m[0]=.5*v[2],m[1]=.5*v[3],m[2]=t.frame.width*p[2]-.5*v[2],m[3]=t.frame.height*p[3]-.5*v[3];var b=this.renderer.renderTarget.rootRenderTarget.colorTexture;g[0]=s.x*l,g[1]=s.y*l,g[2]=b.source.width*l,g[3]=b.source.height*l;var T=this.renderer.renderTarget.getRenderTarget(r);if(i.renderTarget.bind(r,!!n),r instanceof bi?(_[0]=r.frame.width,_[1]=r.frame.height):(_[0]=T.width,_[1]=T.height),_[2]=T.isRoot?-1:1,h.update(),i.renderPipes.uniformBatch){var S=i.renderPipes.uniformBatch.getUboResource(h);this._globalFilterBindGroup.setResource(S,0)}else this._globalFilterBindGroup.setResource(h,0);this._globalFilterBindGroup.setResource(t.source,1),this._globalFilterBindGroup.setResource(t.source.style,2),e.groups[0]=this._globalFilterBindGroup,i.encoder.draw({geometry:yp,shader:e,state:e._state,topology:"triangle-list"}),i.type===Ds.WEBGL&&i.renderTarget.finishRenderPass()}},{key:"_getFilterData",value:function(){return{skip:!1,inputTexture:null,bounds:new Et,container:null,filterEffect:null,blendRequired:!1,previousRenderSurface:null}}},{key:"calculateSpriteMatrix",value:function(e,t){var r=this._activeFilterData,n=e.set(r.inputTexture._source.width,0,0,r.inputTexture._source.height,r.bounds.minX,r.bounds.minY),i=t.worldTransform.copyTo(tt.shared);return i.invert(),n.prepend(i),n.scale(1/t.texture.frame.width,1/t.texture.frame.height),n.translate(t.anchor.x,t.anchor.y),n}}])}();xp.extension={type:[Z.WebGLSystem,Z.WebGPUSystem],name:"filter"},$.add(xp),$.add(pp);var bp,Tp={__proto__:null},Sp=[];function kp(e){return Ep.apply(this,arguments)}function Ep(){return(Ep=v(f().mark(function e(t){var r,n;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:r=0;case 3:if(!(r<Sp.length)){e.next=12;break}if(!(n=Sp[r]).value.test()){e.next=9;break}return e.next=8,n.value.load();case 8:return e.abrupt("return");case 9:r++,e.next=3;break;case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ap(e){return wp.apply(this,arguments)}function wp(){return(wp=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",kp(!t));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Rp(){if("boolean"==typeof bp)return bp;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");bp=!0===e({a:"b"},"a","b")}catch(de){bp=!1}return bp}$.handleByNamedList(Z.Environment,Sp);var Pp=exports.CLEAR=function(e){return e[e.NONE=0]="NONE",e[e.COLOR=16384]="COLOR",e[e.STENCIL=1024]="STENCIL",e[e.DEPTH=256]="DEPTH",e[e.COLOR_DEPTH=16640]="COLOR_DEPTH",e[e.COLOR_STENCIL=17408]="COLOR_STENCIL",e[e.DEPTH_STENCIL=1280]="DEPTH_STENCIL",e[e.ALL=17664]="ALL",e}(Pp||{}),Mp=exports.SystemRunner=function(){return B(function e(t){C(this,e),this.items=[],this._name=t},[{key:"emit",value:function(e,t,r,n,i,a,o,s){for(var u=this.name,l=this.items,c=0,h=l.length;c<h;c++)l[c][u](e,t,r,n,i,a,o,s);return this}},{key:"add",value:function(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}},{key:"remove",value:function(e){var t=this.items.indexOf(e);return-1!==t&&this.items.splice(t,1),this}},{key:"contains",value:function(e){return-1!==this.items.indexOf(e)}},{key:"removeAll",value:function(){return this.items.length=0,this}},{key:"destroy",value:function(){this.removeAll(),this.items=null,this._name=null}},{key:"empty",get:function(){return 0===this.items.length}},{key:"name",get:function(){return this._name}}])}(),Op=Object.defineProperty,Cp=Object.getOwnPropertySymbols,Gp=Object.prototype.hasOwnProperty,Bp=Object.prototype.propertyIsEnumerable,Ip=function(e,t,r){return t in e?Op(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Fp=function(e,t){for(var r in t||(t={}))Gp.call(t,r)&&Ip(e,r,t[r]);if(Cp){var n,i=U(Cp(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Bp.call(t,r)&&Ip(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Dp=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],Up=function(e){function t(e){var r,n,i;C(this,t),(n=x(this,t)).runners=Object.create(null),n.renderPipes=Object.create(null),n._initOptions={},n._systemsHash=Object.create(null),n.type=e.type,n.name=e.name,n.config=e;var a=[].concat(Dp,m(null!=(i=n.config.runners)?i:[]));return(r=n)._addRunners.apply(r,m(a)),n._unsafeEvalCheck(),n}return E(t,ue),B(t,[{key:"init",value:function(){var e=v(f().mark(function e(){var r,n,i,a,o,s,u=arguments;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>0&&void 0!==u[0]?u[0]:{},n=!0===r.skipExtensionImports||!1===r.manageImports,e.next=4,kp(n);case 4:for(i in this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors),this._systemsHash)a=this._systemsHash[i],o=a.constructor.defaultOptions,r=Fp(Fp({},o),r);r=Fp(Fp({},t.defaultOptions),r),this._roundPixels=r.roundPixels?1:0,s=0;case 10:if(!(s<this.runners.init.items.length)){e.next=16;break}return e.next=13,this.runners.init.items[s].init(r);case 13:s++,e.next=10;break;case 16:this._initOptions=r;case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(e,t){var r=e;if(r instanceof tr&&(r={container:r},t&&(ht(lt,"passing a second argument is deprecated, please use render options instead"),r.target=t.renderTexture)),r.target||(r.target=this.view.renderTarget),r.target===this.view.renderTarget&&(this._lastObjectRendered=r.container,r.clearColor=this.background.colorRgba),r.clearColor){var n=Array.isArray(r.clearColor)&&4===r.clearColor.length;r.clearColor=n?r.clearColor:Ke.shared.setValue(r.clearColor).toArray()}r.transform||(r.container.updateLocalTransform(),r.transform=r.container.localTransform),this.runners.prerender.emit(r),this.runners.renderStart.emit(r),this.runners.render.emit(r),this.runners.renderEnd.emit(r),this.runners.postrender.emit(r)}},{key:"resize",value:function(e,t,r){var n=this.view.resolution;this.view.resize(e,t,r),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),void 0!==r&&r!==n&&this.runners.resolutionChange.emit(r)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.target||(e.target=this.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),null!=e.clear||(e.clear=Pp.ALL);var t=e.clear,r=e.clearColor,n=e.target;Ke.shared.setValue(null!=r?r:this.background.colorRgba),this.renderTarget.clear(n,t,Ke.shared.toArray())}},{key:"resolution",get:function(){return this.view.resolution},set:function(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}},{key:"width",get:function(){return this.view.texture.frame.width}},{key:"height",get:function(){return this.view.texture.frame.height}},{key:"canvas",get:function(){return this.view.canvas}},{key:"lastObjectRendered",get:function(){return this._lastObjectRendered}},{key:"renderingToScreen",get:function(){return this.renderTarget.renderingToScreen}},{key:"screen",get:function(){return this.view.screen}},{key:"_addRunners",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach(function(t){e.runners[t]=new Mp(t)})}},{key:"_addSystems",value:function(e){var t;for(t in e){var r=e[t];this._addSystem(r.value,r.name)}}},{key:"_addSystem",value:function(e,t){var r=new e(this);if(this[t])throw new Error('Whoops! The name "'.concat(t,'" is already in use'));for(var n in this[t]=r,this._systemsHash[t]=r,this.runners)this.runners[n].add(r);return this}},{key:"_addPipes",value:function(e,t){var r=this,n=t.reduce(function(e,t){return e[t.name]=t.value,e},{});e.forEach(function(e){var t=e.value,i=e.name,a=n[i];r.renderPipes[i]=new t(r,a?new a:null)})}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),Object.values(this.runners).forEach(function(e){e.destroy()}),this._systemsHash=null,this.renderPipes=null}},{key:"generateTexture",value:function(e){return this.textureGenerator.generateTexture(e)}},{key:"roundPixels",get:function(){return!!this._roundPixels}},{key:"_unsafeEvalCheck",value:function(){if(!Rp())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}}])}();Up.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};var Lp,Np,Xp=exports.AbstractRenderer=Up;function Hp(e){return void 0!==Lp?Lp:Lp=function(){var t,r={stencil:!0,failIfMajorPerformanceCaveat:null!=e?e:Xp.defaultOptions.failIfMajorPerformanceCaveat};try{if(!hn.get().getWebGLRenderingContext())return!1;var n=hn.get().createCanvas().getContext("webgl",r),i=!!(null==(t=null==n?void 0:n.getContextAttributes())?void 0:t.stencil);if(n){var a=n.getExtension("WEBGL_lose_context");a&&a.loseContext()}return n=null,i}catch(de){return!1}}()}function jp(){return zp.apply(this,arguments)}function zp(){return(zp=v(f().mark(function e(){var t,r=arguments;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},void 0===Np){e.next=3;break}return e.abrupt("return",Np);case 3:return e.next=5,v(f().mark(function e(){var r,n;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=hn.get().getNavigator().gpu){e.next=3;break}return e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,r.requestAdapter(t);case 6:return n=e.sent,e.next=9,n.requestDevice();case 9:return e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(3),e.abrupt("return",!1);case 15:case"end":return e.stop()}},e,null,[[3,12]])}))();case 5:return Np=e.sent,e.abrupt("return",Np);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Vp=Object.defineProperty,Wp=Object.getOwnPropertySymbols,Yp=Object.prototype.hasOwnProperty,Kp=Object.prototype.propertyIsEnumerable,qp=function(e,t,r){return t in e?Vp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Zp=function(e,t){for(var r in t||(t={}))Yp.call(t,r)&&qp(e,r,t[r]);if(Wp){var n,i=U(Wp(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Kp.call(t,r)&&qp(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Qp=["webgl","webgpu","canvas"];function Jp(e){return $p.apply(this,arguments)}function $p(){return($p=v(f().mark(function e(t){var r,n,i,a,o,s,u,l,c,h,d;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t.preference?(n.push(t.preference),Qp.forEach(function(e){e!==t.preference&&n.push(e)})):n=Qp.slice(),a={},o=0;case 4:if(!(o<n.length)){e.next=37;break}if(s=n[o],e.t0="webgpu"===s,!e.t0){e.next=11;break}return e.next=10,jp();case 10:e.t0=e.sent;case 11:if(!e.t0){e.next=21;break}return e.next=14,Promise.resolve().then(function(){return Zw});case 14:return u=e.sent,l=u.WebGPURenderer,i=l,a=Zp(Zp({},t),t.webgpu),e.abrupt("break",37);case 21:if("webgl"!==s||!Hp(null!=(r=t.failIfMajorPerformanceCaveat)?r:Xp.defaultOptions.failIfMajorPerformanceCaveat)){e.next=31;break}return e.next=24,Promise.resolve().then(function(){return WA});case 24:return c=e.sent,h=c.WebGLRenderer,i=h,a=Zp(Zp({},t),t.webgl),e.abrupt("break",37);case 31:if("canvas"!==s){e.next=34;break}throw a=Zp({},t),new Error("CanvasRenderer is not yet implemented");case 34:o++,e.next=4;break;case 37:if(delete a.webgpu,delete a.webgl,i){e.next=41;break}throw new Error("No available renderer for the current environment");case 41:return d=new i,e.next=44,d.init(a);case 44:return e.abrupt("return",d);case 45:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ev=exports.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i,tv=exports.VERSION="8.4.1",rv=exports.ApplicationInitHook=function(){return B(function e(){C(this,e)},null,[{key:"init",value:function(){var e;null==(e=globalThis.__PIXI_APP_INIT__)||e.call(globalThis,this,tv)}},{key:"destroy",value:function(){}}])}();rv.extension=Z.Application;var nv=exports.RendererInitHook=function(){return B(function e(t){C(this,e),this._renderer=t},[{key:"init",value:function(){var e;null==(e=globalThis.__PIXI_RENDERER_INIT__)||e.call(globalThis,this._renderer,tv)}},{key:"destroy",value:function(){this._renderer=null}}])}();nv.extension={type:[Z.WebGLSystem,Z.WebGPUSystem],name:"initHook",priority:-10};var iv=Object.defineProperty,av=Object.getOwnPropertySymbols,ov=Object.prototype.hasOwnProperty,sv=Object.prototype.propertyIsEnumerable,uv=function(e,t,r){return t in e?iv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},lv=function(e,t){for(var r in t||(t={}))ov.call(t,r)&&uv(e,r,t[r]);if(av){var n,i=U(av(t));try{for(i.s();!(n=i.n()).done;){r=n.value;sv.call(t,r)&&uv(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},cv=function(){function e(){C(this,e),this.stage=new tr,void 0!==(arguments.length<=0?void 0:arguments[0])&&ht(lt,"Application constructor options are deprecated, please use Application.init() instead.")}return B(e,[{key:"init",value:function(){var t=v(f().mark(function t(r){var n=this;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=lv({},r),t.next=3,Jp(r);case 3:this.renderer=t.sent,e._plugins.forEach(function(e){e.init.call(n,r)});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){this.renderer.render({container:this.stage})}},{key:"canvas",get:function(){return this.renderer.canvas}},{key:"view",get:function(){return ht(lt,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}},{key:"screen",get:function(){return this.renderer.screen}},{key:"destroy",value:function(){var t=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e._plugins.slice(0);i.reverse(),i.forEach(function(e){e.destroy.call(t)}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(r),this.renderer=null}}])}();cv._plugins=[];var hv=exports.Application=cv;$.handleByList(Z.Application,hv._plugins),$.add(rv);var dv=exports.BitmapFont=function(e){function t(e,r){var n,i;C(this,t),n=x(this,t);var a=e.textures,o=e.data;return Object.keys(o.pages).forEach(function(e){var t=o.pages[parseInt(e,10)],r=a[t.id];n.pages.push({texture:r})}),Object.keys(o.chars).forEach(function(e){var t,r=o.chars[e],i=a[r.page],s=i.frame,u=i.source,l=new St(r.x+s.x,r.y+s.y,r.width,r.height),c=new bi({source:u,frame:l});n.chars[e]={id:e.codePointAt(0),xOffset:r.xOffset,yOffset:r.yOffset,xAdvance:r.xAdvance,kerning:null!=(t=r.kerning)?t:{},texture:c}}),n.baseRenderedFontSize=o.fontSize,n.baseMeasurementFontSize=o.fontSize,n.fontMetrics={ascent:0,descent:0,fontSize:o.fontSize},n.baseLineOffset=o.baseLineOffset,n.lineHeight=o.lineHeight,n.fontFamily=o.fontFamily,n.distanceField=null!=(i=o.distanceField)?i:{type:"none",range:0},n.url=r,n}return E(t,md),B(t,[{key:"destroy",value:function(){c(t,"destroy",this,3)([]);for(var e=0;e<this.pages.length;e++){this.pages[e].texture.destroy(!0)}this.pages=null}}],[{key:"install",value:function(e){Ud.install(e)}},{key:"uninstall",value:function(e){Ud.uninstall(e)}}])}(),fv=exports.bitmapFontTextParser={test:function(e){return"string"==typeof e&&e.startsWith("info face=")},parse:function(e){var t,r,n,i=e.match(/^[a-z]+\s+.+$/gm),a={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var o in i){var s=i[o].match(/^[a-z]+/gm)[0],u=i[o].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(var c in u){var h=u[c].split("="),d=h[0],f=h[1].replace(/"/gm,""),p=parseFloat(f),v=isNaN(p)?f:p;l[d]=v}a[s].push(l)}var m={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},g=R(a.info,1)[0],_=R(a.common,1)[0],y=R(null!=(t=a.distanceField)?t:[],1)[0];y&&(m.distanceField={range:parseInt(y.distanceRange,10),type:y.fieldType}),m.fontSize=parseInt(g.size,10),m.fontFamily=g.face,m.lineHeight=parseInt(_.lineHeight,10);for(var x=a.page,b=0;b<x.length;b++)m.pages.push({id:parseInt(x[b].id,10)||0,file:x[b].file});var T={};m.baseLineOffset=m.lineHeight-parseInt(_.base,10);for(var S=a.char,k=0;k<S.length;k++){var E=S[k],A=parseInt(E.id,10),w=null!=(n=null!=(r=E.letter)?r:E.char)?n:String.fromCharCode(A);"space"===w&&(w=" "),T[A]=w,m.chars[w]={id:A,page:parseInt(E.page,10)||0,x:parseInt(E.x,10),y:parseInt(E.y,10),width:parseInt(E.width,10),height:parseInt(E.height,10),xOffset:parseInt(E.xoffset,10),yOffset:parseInt(E.yoffset,10),xAdvance:parseInt(E.xadvance,10),kerning:{}}}for(var P=a.kerning||[],M=0;M<P.length;M++){var O=parseInt(P[M].first,10),C=parseInt(P[M].second,10),G=parseInt(P[M].amount,10);m.chars[T[C]].kerning[T[O]]=G}return m}},pv=exports.bitmapFontXMLParser={test:function(e){var t=e;return"string"!=typeof t&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},parse:function(e){var t,r,n={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},i=e.getElementsByTagName("info")[0],a=e.getElementsByTagName("common")[0],o=e.getElementsByTagName("distanceField")[0];o&&(n.distanceField={type:o.getAttribute("fieldType"),range:parseInt(o.getAttribute("distanceRange"),10)});var s=e.getElementsByTagName("page"),u=e.getElementsByTagName("char"),l=e.getElementsByTagName("kerning");n.fontSize=parseInt(i.getAttribute("size"),10),n.fontFamily=i.getAttribute("face"),n.lineHeight=parseInt(a.getAttribute("lineHeight"),10);for(var c=0;c<s.length;c++)n.pages.push({id:parseInt(s[c].getAttribute("id"),10)||0,file:s[c].getAttribute("file")});var h={};n.baseLineOffset=n.lineHeight-parseInt(a.getAttribute("base"),10);for(var d=0;d<u.length;d++){var f=u[d],p=parseInt(f.getAttribute("id"),10),v=null!=(r=null!=(t=f.getAttribute("letter"))?t:f.getAttribute("char"))?r:String.fromCharCode(p);"space"===v&&(v=" "),h[p]=v,n.chars[v]={id:p,page:parseInt(f.getAttribute("page"),10)||0,x:parseInt(f.getAttribute("x"),10),y:parseInt(f.getAttribute("y"),10),width:parseInt(f.getAttribute("width"),10),height:parseInt(f.getAttribute("height"),10),xOffset:parseInt(f.getAttribute("xoffset"),10),yOffset:parseInt(f.getAttribute("yoffset"),10),xAdvance:parseInt(f.getAttribute("xadvance"),10),kerning:{}}}for(var m=0;m<l.length;m++){var g=parseInt(l[m].getAttribute("first"),10),_=parseInt(l[m].getAttribute("second"),10),y=parseInt(l[m].getAttribute("amount"),10);n.chars[h[_]].kerning[h[g]]=y}return n}},vv=exports.bitmapFontXMLStringParser={test:function(e){return!("string"!=typeof e||!e.includes("<font>"))&&pv.test(hn.get().parseXML(e))},parse:function(e){return pv.parse(hn.get().parseXML(e))}},mv=[".xml",".fnt"],gv=exports.bitmapFontCachePlugin={extension:{type:Z.CacheParser,name:"cacheBitmapFont"},test:function(e){return e instanceof dv},getCacheableAssets:function(e,t){var r={};return e.forEach(function(e){r[e]=t,r["".concat(e,"-bitmap")]=t}),r["".concat(t.fontFamily,"-bitmap")]=t,r}},_v=exports.loadBitmapFont={extension:{type:Z.LoadParser,priority:un.Normal},name:"loadBitmapFont",test:function(e){return mv.includes(gn.extname(e).toLowerCase())},testParse:function(e){return v(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fv.test(e)||vv.test(e));case 1:case"end":return t.stop()}},t)}))()},parse:function(e,t,r){return v(f().mark(function n(){var i,a,o,s,u,l,c,h,d,p,v;return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(i=fv.test(e)?fv.parse(e):vv.parse(e),a=t.src,o=i.pages,s=[],u=i.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{},l=0;l<o.length;++l)c=o[l].file,h=gn.join(gn.dirname(a),c),h=Mn(h,a),s.push({src:h,data:u});return n.next=8,r.load(s);case 8:return d=n.sent,p=s.map(function(e){return d[e.src]}),v=new dv({data:i,textures:p},a),n.abrupt("return",v);case 12:case"end":return n.stop()}},n)}))()},load:function(e,t){return v(f().mark(function t(){var r;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,hn.get().fetch(e);case 2:return r=t.sent,t.next=5,r.text();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t)}))()},unload:function(e,t,r){return v(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.pages.map(function(e){return r.unload(e.texture.source._sourceOrigin)}));case 2:e.destroy();case 3:case"end":return t.stop()}},t)}))()}},yv=exports.BackgroundLoader=function(){return B(function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];C(this,e),this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=r},[{key:"add",value:function(e){var t=this;e.forEach(function(e){t._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}},{key:"_next",value:function(){var e=v(f().mark(function e(){var t,r,n;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._assetList.length||!this._isActive){e.next=9;break}for(this._isLoading=!0,t=[],r=Math.min(this._assetList.length,this._maxConcurrent),n=0;n<r;n++)t.push(this._assetList.pop());return e.next=7,this._loader.load(t);case 7:this._isLoading=!1,this._next();case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"active",get:function(){return this._isActive},set:function(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}])}(),xv=exports.cacheTextureArray={extension:{type:Z.CacheParser,name:"cacheTextureArray"},test:function(e){return Array.isArray(e)&&e.every(function(e){return e instanceof bi})},getCacheableAssets:function(e,t){var r={};return e.forEach(function(e){t.forEach(function(t,n){r[e+(0===n?"":n+1)]=t})}),r}};function bv(e){return Tv.apply(this,arguments)}function Tv(){return(Tv=v(f().mark(function e(t){var r;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!("Image"in globalThis)){e.next=2;break}return e.abrupt("return",new Promise(function(e){var r=new Image;r.onload=function(){e(!0)},r.onerror=function(){e(!1)},r.src=t}));case 2:if(!("createImageBitmap"in globalThis&&"fetch"in globalThis)){e.next=17;break}return e.prev=3,e.next=6,fetch(t);case 6:return e.next=8,e.sent.blob();case 8:return r=e.sent,e.next=11,createImageBitmap(r);case 11:e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(3),e.abrupt("return",!1);case 16:return e.abrupt("return",!0);case 17:return e.abrupt("return",!1);case 18:case"end":return e.stop()}},e,null,[[3,13]])}))).apply(this,arguments)}var Sv=exports.detectAvif={extension:{type:Z.DetectionParser,priority:1},test:function(){var e=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",bv("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),add:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(m(t),["avif"]));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter(function(e){return"avif"!==e}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},kv=["png","jpg","jpeg"],Ev=exports.detectDefaults={extension:{type:Z.DetectionParser,priority:-1},test:function(){return Promise.resolve(!0)},add:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(m(t),kv));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter(function(e){return!kv.includes(e)}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Av="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function wv(e){return!Av&&""!==document.createElement("video").canPlayType(e)}var Rv=exports.detectMp4={extension:{type:Z.DetectionParser,priority:0},test:function(){var e=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",wv("video/mp4"));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),add:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(m(t),["mp4","m4v"]));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter(function(e){return"mp4"!==e&&"m4v"!==e}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Pv=exports.detectOgv={extension:{type:Z.DetectionParser,priority:0},test:function(){var e=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",wv("video/ogg"));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),add:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(m(t),["ogv"]));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter(function(e){return"ogv"!==e}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Mv=exports.detectWebm={extension:{type:Z.DetectionParser,priority:0},test:function(){var e=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",wv("video/webm"));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),add:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(m(t),["webm"]));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter(function(e){return"webm"!==e}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Ov=exports.detectWebp={extension:{type:Z.DetectionParser,priority:0},test:function(){var e=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",bv("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),add:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(m(t),["webp"]));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter(function(e){return"webp"!==e}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Cv=Object.defineProperty,Gv=Object.defineProperties,Bv=Object.getOwnPropertyDescriptors,Iv=Object.getOwnPropertySymbols,Fv=Object.prototype.hasOwnProperty,Dv=Object.prototype.propertyIsEnumerable,Uv=function(e,t,r){return t in e?Cv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Lv=function(e,t){for(var r in t||(t={}))Fv.call(t,r)&&Uv(e,r,t[r]);if(Iv){var n,i=U(Iv(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Dv.call(t,r)&&Uv(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Nv=function(e,t){return Gv(e,Bv(t))},Xv=exports.Loader=function(){return B(function e(){var t=this;C(this,e),this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:function(e,r,n){return t._parsersValidated=!1,e[r]=n,!0}}),this.promiseCache={}},[{key:"reset",value:function(){this._parsersValidated=!1,this.promiseCache={}}},{key:"_getLoadPromiseAndParser",value:function(e,t){var r=this,n={promise:null,parser:null};return n.promise=v(f().mark(function i(){var a,o,s,u,l,c,h,d;return f().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(s=null,u=null,t.loadParser&&((u=r._parserHash[t.loadParser])||Gt('[Assets] specified load parser "'.concat(t.loadParser,'" not found while loading ').concat(e))),u){i.next=16;break}l=0;case 5:if(!(l<r.parsers.length)){i.next=13;break}if(!((c=r.parsers[l]).load&&(null==(a=c.test)?void 0:a.call(c,e,t,r)))){i.next=10;break}return u=c,i.abrupt("break",13);case 10:l++,i.next=5;break;case 13:if(u){i.next=16;break}return Gt("[Assets] ".concat(e," could not be loaded as we don't know how to parse it, ensure the correct parser has been added")),i.abrupt("return",null);case 16:return i.next=18,u.load(e,t,r);case 18:s=i.sent,n.parser=u,h=0;case 21:if(!(h<r.parsers.length)){i.next=40;break}if(!(d=r.parsers[h]).parse){i.next=37;break}if(i.t0=d.parse,!i.t0){i.next=29;break}return i.next=28,null==(o=d.testParse)?void 0:o.call(d,s,t,r);case 28:i.t0=i.sent;case 29:if(!i.t0){i.next=37;break}return i.next=32,d.parse(s,t,r);case 32:if(i.t1=i.sent,i.t1){i.next=35;break}i.t1=s;case 35:s=i.t1,n.parser=d;case 37:h++,i.next=21;break;case 40:return i.abrupt("return",s);case 41:case"end":return i.stop()}},i)}))(),n}},{key:"load",value:function(){var e=v(f().mark(function e(t,r){var n,i,a,o,s,u,l=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._parsersValidated||this._validateParsers(),n=0,i={},a=bn(t),o=_n(t,function(e){return{alias:[e],src:e,data:{}}}),s=o.length,u=o.map(function(){var e=v(f().mark(function e(t){var a;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=gn.toAbsolute(t.src),i[t.src]){e.next=15;break}return e.prev=2,l.promiseCache[a]||(l.promiseCache[a]=l._getLoadPromiseAndParser(a,t)),e.next=6,l.promiseCache[a].promise;case 6:i[t.src]=e.sent,r&&r(++n/s),e.next=15;break;case 10:throw e.prev=10,e.t0=e.catch(2),delete l.promiseCache[a],delete i[t.src],new Error("[Loader.load] Failed to load ".concat(a,".\n").concat(e.t0));case 15:case"end":return e.stop()}},e,null,[[2,10]])}));return function(t){return e.apply(this,arguments)}}()),e.next=9,Promise.all(u);case 9:return e.abrupt("return",a?i[o[0].src]:i);case 10:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"unload",value:function(){var e=v(f().mark(function e(t){var r,n,i=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=_n(t,function(e){return{alias:[e],src:e}}),n=r.map(function(){var e=v(f().mark(function e(t){var r,n,a,o,s;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=gn.toAbsolute(t.src),!(o=i.promiseCache[a])){e.next=9;break}return e.next=5,o.promise;case 5:return s=e.sent,delete i.promiseCache[a],e.next=9,null==(n=null==(r=o.parser)?void 0:r.unload)?void 0:n.call(r,s,t,i);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all(n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"_validateParsers",value:function(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(function(e){return e.name}).reduce(function(e,t){return t.name?e[t.name]&&Gt('[Assets] loadParser name conflict "'.concat(t.name,'"')):Gt("[Assets] loadParser should have a name"),Nv(Lv({},e),l({},t.name,t))},{})}}])}();function Hv(e,t){if(Array.isArray(t)){var r,n=U(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(e.startsWith("data:".concat(i)))return!0}}catch(a){n.e(a)}finally{n.f()}return!1}return e.startsWith("data:".concat(t))}function jv(e,t){var r=e.split("?")[0],n=gn.extname(r).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}var zv=".json",Vv="application/json",Wv=exports.loadJson={extension:{type:Z.LoadParser,priority:un.Low},name:"loadJson",test:function(e){return Hv(e,Vv)||jv(e,zv)},load:function(e){return v(f().mark(function t(){var r,n;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,hn.get().fetch(e);case 2:return r=t.sent,t.next=5,r.json();case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}},t)}))()}},Yv=".txt",Kv="text/plain",qv=exports.loadTxt={name:"loadTxt",extension:{type:Z.LoadParser,priority:un.Low,name:"loadTxt"},test:function(e){return Hv(e,Kv)||jv(e,Yv)},load:function(e){return v(f().mark(function t(){var r,n;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,hn.get().fetch(e);case 2:return r=t.sent,t.next=5,r.text();case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}},t)}))()}},Zv=Object.defineProperty,Qv=Object.defineProperties,Jv=Object.getOwnPropertyDescriptors,$v=Object.getOwnPropertySymbols,em=Object.prototype.hasOwnProperty,tm=Object.prototype.propertyIsEnumerable,rm=function(e,t,r){return t in e?Zv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},nm=function(e,t){for(var r in t||(t={}))em.call(t,r)&&rm(e,r,t[r]);if($v){var n,i=U($v(t));try{for(i.s();!(n=i.n()).done;){r=n.value;tm.call(t,r)&&rm(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},im=function(e,t){return Qv(e,Jv(t))},am=["normal","bold","100","200","300","400","500","600","700","800","900"],om=[".ttf",".otf",".woff",".woff2"],sm=["font/ttf","font/otf","font/woff","font/woff2"],um=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function lm(e){var t,r=gn.extname(e),n=gn.basename(e,r).replace(/(-|_)/g," ").toLowerCase().split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}),i=n.length>0,a=U(n);try{for(a.s();!(t=a.n()).done;){if(!t.value.match(um)){i=!1;break}}}catch(s){a.e(s)}finally{a.f()}var o=n.join(" ");return i||(o='"'.concat(o.replace(/[\\"]/g,"\\$&"),'"')),o}var cm=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function hm(e){return cm.test(e)?e:encodeURI(e)}var dm=exports.loadWebFont={extension:{type:Z.LoadParser,priority:un.Low},name:"loadWebFont",test:function(e){return Hv(e,sm)||jv(e,om)},load:function(e,t){return v(f().mark(function r(){var n,i,a,o,s,u,l,c,h,d,p,v,m,g;return f().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(l=hn.get().getFontFaceSet())){r.next=19;break}c=[],h=null!=(i=null==(n=t.data)?void 0:n.family)?i:lm(e),d=null!=(s=null==(o=null==(a=t.data)?void 0:a.weights)?void 0:o.filter(function(e){return am.includes(e)}))?s:["normal"],p=null!=(u=t.data)?u:{},v=0;case 7:if(!(v<d.length)){r.next=17;break}return m=d[v],g=new FontFace(h,"url(".concat(hm(e),")"),im(nm({},p),{weight:m})),r.next=12,g.load();case 12:l.add(g),c.push(g);case 14:v++,r.next=7;break;case 17:return sa.set("".concat(h,"-and-url"),{url:e,fontFaces:c}),r.abrupt("return",1===c.length?c[0]:c);case 19:return Gt("[loadWebFont] FontFace API is not supported. Skipping loading font"),r.abrupt("return",null);case 21:case"end":return r.stop()}},r)}))()},unload:function(e){(Array.isArray(e)?e:[e]).forEach(function(e){sa.remove(e.family),hn.get().getFontFaceSet().delete(e)})}};function fm(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=null==(t=Rn.RETINA_PREFIX)?void 0:t.exec(e);return n?parseFloat(n[1]):r}function pm(e,t,r){e.label=r,e._sourceOrigin=r;var n=new bi({source:e,label:r}),i=function(){delete t.promiseCache[r],sa.has(r)&&sa.remove(r)};return n.source.once("destroy",function(){t.promiseCache[r]&&(Gt("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),i())}),n.once("destroy",function(){e.destroyed||(Gt("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),n}var vm=Object.defineProperty,mm=Object.getOwnPropertySymbols,gm=Object.prototype.hasOwnProperty,_m=Object.prototype.propertyIsEnumerable,ym=function(e,t,r){return t in e?vm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},xm=function(e,t){for(var r in t||(t={}))gm.call(t,r)&&ym(e,r,t[r]);if(mm){var n,i=U(mm(t));try{for(i.s();!(n=i.n()).done;){r=n.value;_m.call(t,r)&&ym(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},bm=function(e,t){var r={};for(var n in e)gm.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&mm){var i,a=U(mm(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&_m.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},Tm=".svg",Sm="image/svg+xml",km=exports.loadSvg={extension:{type:Z.LoadParser,priority:un.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test:function(e){return Hv(e,Sm)||jv(e,Tm)},load:function(e,t,r){var n=this;return v(f().mark(function i(){var a;return f().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(null!=(a=t.data.parseAsGraphicsContext)?a:n.config.parseAsGraphicsContext)){i.next=2;break}return i.abrupt("return",wm(e));case 2:return i.abrupt("return",Em(e,t,r,n.config.crossOrigin));case 3:case"end":return i.stop()}},i)}))()},unload:function(e){e.destroy(!0)}};function Em(e,t,r,n){return Am.apply(this,arguments)}function Am(){return(Am=v(f().mark(function e(t,r,n,i){var a,o,s,u,l,c,h,d,p,v,m,g,_,y,x,b,T;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.get().fetch(t);case 2:return c=e.sent,e.next=5,c.blob();case 5:return h=e.sent,d=URL.createObjectURL(h),(p=new Image).src=d,p.crossOrigin=i,e.next=12,p.decode();case 12:return URL.revokeObjectURL(d),v=document.createElement("canvas"),m=v.getContext("2d"),g=(null==(a=r.data)?void 0:a.resolution)||fm(t),_=null!=(s=null==(o=r.data)?void 0:o.width)?s:p.width,y=null!=(l=null==(u=r.data)?void 0:u.height)?l:p.height,v.width=_*g,v.height=y*g,m.drawImage(p,0,0,_*g,y*g),x=r.data,x.parseAsGraphicsContext,b=bm(x,["parseAsGraphicsContext"]),T=new Wi(xm({resource:v,alphaMode:"premultiply-alpha-on-upload",resolution:g},b)),e.abrupt("return",pm(T,n,t));case 24:case"end":return e.stop()}},e)}))).apply(this,arguments)}function wm(e){return Rm.apply(this,arguments)}function Rm(){return(Rm=v(f().mark(function e(t){var r,n,i;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.get().fetch(t);case 2:return r=e.sent,e.next=5,r.text();case 5:return n=e.sent,(i=new Rh).svg(n),e.abrupt("return",i);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Pm='(function () {\n    \'use strict\';\n\n    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n    async function checkImageBitmap() {\n      try {\n        if (typeof createImageBitmap !== "function")\n          return false;\n        const response = await fetch(WHITE_PNG);\n        const imageBlob = await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n        return imageBitmap.width === 1 && imageBitmap.height === 1;\n      } catch (e) {\n        return false;\n      }\n    }\n    void checkImageBitmap().then((result) => {\n      self.postMessage(result);\n    });\n\n})();\n',Mm=null,Om=B(function e(){C(this,e),Mm||(Mm=URL.createObjectURL(new Blob([Pm],{type:"application/javascript"}))),this.worker=new Worker(Mm)});Om.revokeObjectURL=function(){Mm&&(URL.revokeObjectURL(Mm),Mm=null)};var Cm='(function () {\n    \'use strict\';\n\n    async function loadImageBitmap(url, alphaMode) {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n      }\n      const imageBlob = await response.blob();\n      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);\n    }\n    self.onmessage = async (event) => {\n      try {\n        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);\n        self.postMessage({\n          data: imageBitmap,\n          uuid: event.data.uuid,\n          id: event.data.id\n        }, [imageBitmap]);\n      } catch (e) {\n        self.postMessage({\n          error: e,\n          uuid: event.data.uuid,\n          id: event.data.id\n        });\n      }\n    };\n\n})();\n',Gm=null,Bm=B(function e(){C(this,e),Gm||(Gm=URL.createObjectURL(new Blob([Cm],{type:"application/javascript"}))),this.worker=new Worker(Gm)});Bm.revokeObjectURL=function(){Gm&&(URL.revokeObjectURL(Gm),Gm=null)};var Im,Fm=0,Dm=function(){return B(function e(){C(this,e),this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}},[{key:"isImageBitmapSupported",value:function(){return void 0!==this._isImageBitmapSupported?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(function(e){var t=(new Om).worker;t.addEventListener("message",function(r){t.terminate(),Om.revokeObjectURL(),e(r.data)})}),this._isImageBitmapSupported)}},{key:"loadImageBitmap",value:function(e,t){var r;return this._run("loadImageBitmap",[e,null==(r=null==t?void 0:t.data)?void 0:r.alphaMode])}},{key:"_initWorkers",value:function(){var e=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._initialized){e.next=2;break}return e.abrupt("return");case 2:this._initialized=!0;case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_getWorker",value:function(){var e=this;void 0===Im&&(Im=navigator.hardwareConcurrency||4);var t=this._workerPool.pop();return!t&&this._createdWorkers<Im&&(this._createdWorkers++,(t=(new Bm).worker).addEventListener("message",function(t){e._complete(t.data),e._returnWorker(t.target),e._next()})),t}},{key:"_returnWorker",value:function(e){this._workerPool.push(e)}},{key:"_complete",value:function(e){void 0!==e.error?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}},{key:"_run",value:function(){var e=v(f().mark(function e(t,r){var n,i=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initWorkers();case 2:return n=new Promise(function(e,n){i._queue.push({id:t,arguments:r,resolve:e,reject:n})}),this._next(),e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"_next",value:function(){if(this._queue.length){var e=this._getWorker();if(e){var t=this._queue.pop(),r=t.id;this._resolveHash[Fm]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:Fm++,id:r})}}}}])}(),Um=exports.WorkerManager=new Dm,Lm=Object.defineProperty,Nm=Object.getOwnPropertySymbols,Xm=Object.prototype.hasOwnProperty,Hm=Object.prototype.propertyIsEnumerable,jm=function(e,t,r){return t in e?Lm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},zm=function(e,t){for(var r in t||(t={}))Xm.call(t,r)&&jm(e,r,t[r]);if(Nm){var n,i=U(Nm(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Hm.call(t,r)&&jm(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Vm=[".jpeg",".jpg",".png",".webp",".avif"],Wm=["image/jpeg","image/png","image/webp","image/avif"];function Ym(e,t){return Km.apply(this,arguments)}function Km(){return(Km=v(f().mark(function e(t,r){var n,i,a;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.get().fetch(t);case 2:if((i=e.sent).ok){e.next=5;break}throw new Error("[loadImageBitmap] Failed to fetch ".concat(t,": ").concat(i.status," ").concat(i.statusText));case 5:return e.next=7,i.blob();case 7:return a=e.sent,e.abrupt("return","premultiplied-alpha"===(null==(n=null==r?void 0:r.data)?void 0:n.alphaMode)?createImageBitmap(a,{premultiplyAlpha:"none"}):createImageBitmap(a));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var qm=exports.loadTextures={name:"loadTextures",extension:{type:Z.LoadParser,priority:un.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:function(e){return Hv(e,Wm)||jv(e,Vm)},load:function(e,t,r){var n=this;return v(f().mark(function i(){var a,o,s;return f().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(o=null,!globalThis.createImageBitmap||!n.config.preferCreateImageBitmap){i.next=18;break}if(i.t0=n.config.preferWorkers,!i.t0){i.next=7;break}return i.next=6,Um.isImageBitmapSupported();case 6:i.t0=i.sent;case 7:if(!i.t0){i.next=13;break}return i.next=10,Um.loadImageBitmap(e,t);case 10:o=i.sent,i.next=16;break;case 13:return i.next=15,Ym(e,t);case 15:o=i.sent;case 16:i.next=21;break;case 18:return i.next=20,new Promise(function(t){(o=new Image).crossOrigin=n.config.crossOrigin,o.src=e,o.complete?t(o):o.onload=function(){t(o)}});case 20:o=i.sent;case 21:return s=new Wi(zm({resource:o,alphaMode:"premultiply-alpha-on-upload",resolution:(null==(a=t.data)?void 0:a.resolution)||fm(e)},t.data)),i.abrupt("return",pm(s,r,e));case 23:case"end":return i.stop()}},i)}))()},unload:function(e){e.destroy(!0)}},Zm=Object.defineProperty,Qm=Object.defineProperties,Jm=Object.getOwnPropertyDescriptors,$m=Object.getOwnPropertySymbols,eg=Object.prototype.hasOwnProperty,tg=Object.prototype.propertyIsEnumerable,rg=function(e,t,r){return t in e?Zm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},ng=function(e,t){for(var r in t||(t={}))eg.call(t,r)&&rg(e,r,t[r]);if($m){var n,i=U($m(t));try{for(i.s();!(n=i.n()).done;){r=n.value;tg.call(t,r)&&rg(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},ig=function(e,t){return Qm(e,Jm(t))},ag=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],og=ag.map(function(e){return"video/".concat(e.substring(1))});function sg(e,t,r){void 0!==r||t.startsWith("data:")?!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous"):e.crossOrigin=lg(t)}function ug(e){return new Promise(function(t,r){function n(){a(),t()}function i(e){a(),r(e)}function a(){e.removeEventListener("canplaythrough",n),e.removeEventListener("error",i)}e.addEventListener("canplaythrough",n),e.addEventListener("error",i),e.load()})}function lg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:globalThis.location;if(e.startsWith("data:"))return"";t=t||globalThis.location;var r=new URL(e,document.baseURI);return r.hostname!==t.hostname||r.port!==t.port||r.protocol!==t.protocol?"anonymous":""}var cg=exports.loadVideoTextures={name:"loadVideo",extension:{type:Z.LoadParser,name:"loadVideo"},test:function(e){var t=Hv(e,og),r=jv(e,ag);return t||r},load:function(e,t,r){return v(f().mark(function n(){var i,a,o,s,u,l,c,h;return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=ng,n.t1=ig,n.t2=ng({},aa.defaultOptions),n.t3=(null==(i=t.data)?void 0:i.resolution)||fm(e),n.t4=null==(a=t.data)?void 0:a.alphaMode,n.t4){n.next=9;break}return n.next=8,Yi();case 8:n.t4=n.sent;case 9:return n.t5=n.t4,n.t6={resolution:n.t3,alphaMode:n.t5},n.t7=(0,n.t1)(n.t2,n.t6),n.t8=t.data,o=(0,n.t0)(n.t7,n.t8),s=document.createElement("video"),u={preload:!1!==o.autoLoad?"auto":void 0,"webkit-playsinline":!1!==o.playsinline?"":void 0,playsinline:!1!==o.playsinline?"":void 0,muted:!0===o.muted?"":void 0,loop:!0===o.loop?"":void 0,autoplay:!1!==o.autoPlay?"":void 0},Object.keys(u).forEach(function(e){var t=u[e];void 0!==t&&s.setAttribute(e,t)}),!0===o.muted&&(s.muted=!0),sg(s,e,o.crossorigin),l=document.createElement("source"),e.startsWith("data:")?c=e.slice(5,e.indexOf(";")):e.startsWith("blob:")||(h=e.split("?")[0].slice(e.lastIndexOf(".")+1).toLowerCase(),c=aa.MIME_TYPES[h]||"video/".concat(h)),l.src=e,c&&(l.type=c),n.abrupt("return",new Promise(function(n){var i=function(){var a=v(f().mark(function a(){var u;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(u=new aa(ig(ng({},o),{resource:s})),s.removeEventListener("canplay",i),!t.data.preload){a.next=5;break}return a.next=5,ug(s);case 5:n(pm(u,r,e));case 6:case"end":return a.stop()}},a)}));return function(){return a.apply(this,arguments)}}();s.addEventListener("canplay",i),s.appendChild(l)}));case 24:case"end":return n.stop()}},n)}))()},unload:function(e){e.destroy(!0)}},hg=exports.resolveTextureUrl={extension:{type:Z.ResolveParser,name:"resolveTexture"},test:qm.test,parse:function(e){var t,r;return{resolution:parseFloat(null!=(r=null==(t=Rn.RETINA_PREFIX.exec(e))?void 0:t[1])?r:"1"),format:e.split(".").pop(),src:e}}},dg=exports.resolveJsonUrl={extension:{type:Z.ResolveParser,priority:-2,name:"resolveJson"},test:function(e){return Rn.RETINA_PREFIX.test(e)&&e.endsWith(".json")},parse:hg.parse},fg=exports.AssetsClass=function(){return B(function e(){C(this,e),this._detections=[],this._initialized=!1,this.resolver=new Rn,this.loader=new Xv,this.cache=sa,this._backgroundLoader=new yv(this.loader),this._backgroundLoader.active=!0,this.reset()},[{key:"init",value:function(){var e=v(f().mark(function e(){var t,r,n,i,a,o,s,u,l=arguments;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:{},!this._initialized){e.next=4;break}return Gt("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?"),e.abrupt("return");case 4:if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),!t.manifest){e.next=15;break}if("string"!=typeof(a=t.manifest)){e.next=14;break}return e.next=13,this.load(a);case 13:a=e.sent;case 14:this.resolver.addManifest(a);case 15:return o=null!=(n=null==(r=t.texturePreference)?void 0:r.resolution)?n:1,s="number"==typeof o?[o]:o,e.next=19,this._detectFormats({preferredFormats:null==(i=t.texturePreference)?void 0:i.format,skipDetections:t.skipDetections,detections:this._detections});case 19:u=e.sent,this.resolver.prefer({params:{format:u,resolution:s}}),t.preferences&&this.setPreferences(t.preferences);case 22:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(e){this.resolver.add(e)}},{key:"load",value:function(){var e=v(f().mark(function e(t,r){var n,i,a,o,s=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._initialized){e.next=3;break}return e.next=3,this.init();case 3:return n=bn(t),i=_n(t).map(function(e){if("string"!=typeof e){var t=s.resolver.getAlias(e);return t.some(function(e){return!s.resolver.hasKey(e)})&&s.add(e),Array.isArray(t)?t[0]:t}return s.resolver.hasKey(e)||s.add({alias:e,src:e}),e}),a=this.resolver.resolve(i),e.next=8,this._mapLoadToResolve(a,r);case 8:return o=e.sent,e.abrupt("return",n?o[i[0]]:o);case 10:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"addBundle",value:function(e,t){this.resolver.addBundle(e,t)}},{key:"loadBundle",value:function(){var e=v(f().mark(function e(t,r){var n,i,a,o,s,u,l,c,h=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._initialized){e.next=3;break}return e.next=3,this.init();case 3:return n=!1,"string"==typeof t&&(n=!0,t=[t]),i=this.resolver.resolveBundle(t),a={},o=Object.keys(i),s=0,u=0,l=function(){null==r||r(++s/u)},c=o.map(function(e){var t=i[e];return u+=Object.keys(t).length,h._mapLoadToResolve(t,l).then(function(t){a[e]=t})}),e.next=14,Promise.all(c);case 14:return e.abrupt("return",n?a[t[0]]:a);case 15:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"backgroundLoad",value:function(){var e=v(f().mark(function e(t){var r;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._initialized){e.next=3;break}return e.next=3,this.init();case 3:"string"==typeof t&&(t=[t]),r=this.resolver.resolve(t),this._backgroundLoader.add(Object.values(r));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"backgroundLoadBundle",value:function(){var e=v(f().mark(function e(t){var r,n=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._initialized){e.next=3;break}return e.next=3,this.init();case 3:"string"==typeof t&&(t=[t]),r=this.resolver.resolveBundle(t),Object.values(r).forEach(function(e){n._backgroundLoader.add(Object.values(e))});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}},{key:"get",value:function(e){if("string"==typeof e)return sa.get(e);for(var t={},r=0;r<e.length;r++)t[r]=sa.get(e[r]);return t}},{key:"_mapLoadToResolve",value:function(){var e=v(f().mark(function e(t,r){var n,i,a;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=m(new Set(Object.values(t))),this._backgroundLoader.active=!1,e.next=4,this.loader.load(n,r);case 4:return i=e.sent,this._backgroundLoader.active=!0,a={},n.forEach(function(e){var t=i[e.src],r=[e.src];e.alias&&r.push.apply(r,m(e.alias)),r.forEach(function(e){a[e]=t}),sa.set(r,t)}),e.abrupt("return",a);case 9:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"unload",value:function(){var e=v(f().mark(function e(t){var r,n;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._initialized){e.next=3;break}return e.next=3,this.init();case 3:return r=_n(t).map(function(e){return"string"!=typeof e?e.src:e}),n=this.resolver.resolve(r),e.next=7,this._unloadFromResolved(n);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unloadBundle",value:function(){var e=v(f().mark(function e(t){var r,n,i=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._initialized){e.next=3;break}return e.next=3,this.init();case 3:return t=_n(t),r=this.resolver.resolveBundle(t),n=Object.keys(r).map(function(e){return i._unloadFromResolved(r[e])}),e.next=8,Promise.all(n);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_unloadFromResolved",value:function(){var e=v(f().mark(function e(t){var r;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Object.values(t)).forEach(function(e){sa.remove(e.src)}),e.next=4,this.loader.unload(r);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_detectFormats",value:function(){var e=v(f().mark(function e(t){var r,n,i,a;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=[],t.preferredFormats&&(r=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]),n=U(t.detections),e.prev=3,n.s();case 5:if((i=n.n()).done){e.next=24;break}if(a=i.value,e.t0=t.skipDetections,e.t0){e.next=12;break}return e.next=11,a.test();case 11:e.t0=e.sent;case 12:if(!e.t0){e.next=18;break}return e.next=15,a.add(r);case 15:r=e.sent,e.next=22;break;case 18:if(t.skipDetections){e.next=22;break}return e.next=21,a.remove(r);case 21:r=e.sent;case 22:e.next=5;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(3),n.e(e.t1);case 29:return e.prev=29,n.f(),e.finish(29);case 32:return r=r.filter(function(e,t){return r.indexOf(e)===t}),e.abrupt("return",r);case 34:case"end":return e.stop()}},e,null,[[3,26,29,32]])}));return function(t){return e.apply(this,arguments)}}()},{key:"detections",get:function(){return this._detections}},{key:"setPreferences",value:function(e){this.loader.parsers.forEach(function(t){t.config&&Object.keys(t.config).filter(function(t){return t in e}).forEach(function(r){t.config[r]=e[r]})})}}])}(),pg=exports.Assets=new fg;$.handleByList(Z.LoadParser,pg.loader.parsers).handleByList(Z.ResolveParser,pg.resolver.parsers).handleByList(Z.CacheParser,pg.cache.parsers).handleByList(Z.DetectionParser,pg.detections),$.add(xv,Ev,Sv,Ov,Rv,Pv,Mv,Wv,qv,dm,km,qm,cg,_v,gv,hg,dg);var vg={loader:Z.LoadParser,resolver:Z.ResolveParser,cache:Z.CacheParser,detection:Z.DetectionParser};$.handle(Z.Asset,function(e){var t=e.ref;Object.entries(vg).filter(function(e){var r=R(e,1)[0];return!!t[r]}).forEach(function(e){var r,n=R(e,2),i=n[0],a=n[1];return $.add(Object.assign(t[i],{extension:null!=(r=t[i].extension)?r:a}))})},function(e){var t=e.ref;Object.keys(vg).filter(function(e){return!!t[e]}).forEach(function(e){return $.remove(t[e])})});var mg,gg,_g,yg=exports.detectBasis={extension:{type:Z.DetectionParser,priority:3},test:function(){var e=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jp();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",!0);case 4:if(!Hp()){e.next=6;break}return e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),add:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[].concat(m(t),["basis"]));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.filter(function(e){return"basis"!==e}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},xg=exports.CompressedSource=function(e){function t(e){var r;return C(this,t),(r=x(this,t,[e])).uploadMethodId="compressed",r.resource=e.resource,r.mipLevelCount=r.resource.length,r}return E(t,ui),B(t)}();function bg(){if(mg)return mg;var e=document.createElement("canvas").getContext("webgl");return e?mg=[].concat(m(e.getExtension("EXT_texture_compression_bptc")?["bc6h-rgb-ufloat","bc6h-rgb-float","bc7-rgba-unorm","bc7-rgba-unorm-srgb"]:[]),m(e.getExtension("WEBGL_compressed_texture_s3tc")?["bc1-rgba-unorm","bc2-rgba-unorm","bc3-rgba-unorm"]:[]),m(e.getExtension("WEBGL_compressed_texture_s3tc_srgb")?["bc1-rgba-unorm-srgb","bc2-rgba-unorm-srgb","bc3-rgba-unorm-srgb"]:[]),m(e.getExtension("EXT_texture_compression_rgtc")?["bc4-r-unorm","bc4-r-snorm","bc5-rg-unorm","bc5-rg-snorm"]:[]),m(e.getExtension("WEBGL_compressed_texture_etc")?["etc2-rgb8unorm","etc2-rgb8unorm-srgb","etc2-rgba8unorm","etc2-rgba8unorm-srgb","etc2-rgb8a1unorm","etc2-rgb8a1unorm-srgb","eac-r11unorm","eac-rg11unorm"]:[]),m(e.getExtension("WEBGL_compressed_texture_astc")?["astc-4x4-unorm","astc-4x4-unorm-srgb","astc-5x4-unorm","astc-5x4-unorm-srgb","astc-5x5-unorm","astc-5x5-unorm-srgb","astc-6x5-unorm","astc-6x5-unorm-srgb","astc-6x6-unorm","astc-6x6-unorm-srgb","astc-8x5-unorm","astc-8x5-unorm-srgb","astc-8x6-unorm","astc-8x6-unorm-srgb","astc-8x8-unorm","astc-8x8-unorm-srgb","astc-10x5-unorm","astc-10x5-unorm-srgb","astc-10x6-unorm","astc-10x6-unorm-srgb","astc-10x8-unorm","astc-10x8-unorm-srgb","astc-10x10-unorm","astc-10x10-unorm-srgb","astc-12x10-unorm","astc-12x10-unorm-srgb","astc-12x12-unorm","astc-12x12-unorm-srgb"]:[])):[]}function Tg(){return Sg.apply(this,arguments)}function Sg(){return(Sg=v(f().mark(function e(){var t;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!gg){e.next=2;break}return e.abrupt("return",gg);case 2:return e.next=4,hn.get().getNavigator().gpu.requestAdapter();case 4:return t=e.sent,gg=[].concat(m(t.features.has("texture-compression-bc")?["bc1-rgba-unorm","bc1-rgba-unorm-srgb","bc2-rgba-unorm","bc2-rgba-unorm-srgb","bc3-rgba-unorm","bc3-rgba-unorm-srgb","bc4-r-unorm","bc4-r-snorm","bc5-rg-unorm","bc5-rg-snorm","bc6h-rgb-ufloat","bc6h-rgb-float","bc7-rgba-unorm","bc7-rgba-unorm-srgb"]:[]),m(t.features.has("texture-compression-etc2")?["etc2-rgb8unorm","etc2-rgb8unorm-srgb","etc2-rgb8a1unorm","etc2-rgb8a1unorm-srgb","etc2-rgba8unorm","etc2-rgba8unorm-srgb","eac-r11unorm","eac-r11snorm","eac-rg11unorm","eac-rg11snorm"]:[]),m(t.features.has("texture-compression-astc")?["astc-4x4-unorm","astc-4x4-unorm-srgb","astc-5x4-unorm","astc-5x4-unorm-srgb","astc-5x5-unorm","astc-5x5-unorm-srgb","astc-6x5-unorm","astc-6x5-unorm-srgb","astc-6x6-unorm","astc-6x6-unorm-srgb","astc-8x5-unorm","astc-8x5-unorm-srgb","astc-8x6-unorm","astc-8x6-unorm-srgb","astc-8x8-unorm","astc-8x8-unorm-srgb","astc-10x5-unorm","astc-10x5-unorm-srgb","astc-10x6-unorm","astc-10x6-unorm-srgb","astc-10x8-unorm","astc-10x8-unorm-srgb","astc-10x10-unorm","astc-10x10-unorm-srgb","astc-12x10-unorm","astc-12x10-unorm-srgb","astc-12x12-unorm","astc-12x12-unorm-srgb"]:[])),e.abrupt("return",gg);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kg(){return Eg.apply(this,arguments)}function Eg(){return(Eg=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===_g){e.next=2;break}return e.abrupt("return",_g);case 2:return e.next=4,v(f().mark(function e(){var t,r,n,i;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jp();case 2:if(t=e.sent,r=Hp(),!t||!r){e.next=12;break}return e.next=7,Tg();case 7:return n=e.sent,i=bg(),e.abrupt("return",n.filter(function(e){return i.includes(e)}));case 12:if(!t){e.next=18;break}return e.next=15,Tg();case 15:return e.abrupt("return",e.sent);case 18:if(!r){e.next=20;break}return e.abrupt("return",bg());case 20:return e.abrupt("return",[]);case 21:case"end":return e.stop()}},e)}))();case 4:return _g=e.sent,e.abrupt("return",_g);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ag,wg=exports.nonCompressedFormats=["r8unorm","r8snorm","r8uint","r8sint","r16uint","r16sint","r16float","rg8unorm","rg8snorm","rg8uint","rg8sint","r32uint","r32sint","r32float","rg16uint","rg16sint","rg16float","rgba8unorm","rgba8unorm-srgb","rgba8snorm","rgba8uint","rgba8sint","bgra8unorm","bgra8unorm-srgb","rgb9e5ufloat","rgb10a2unorm","rg11b10ufloat","rg32uint","rg32sint","rg32float","rgba16uint","rgba16sint","rgba16float","rgba32uint","rgba32sint","rgba32float","stencil8","depth16unorm","depth24plus","depth24plus-stencil8","depth32float","depth32float-stencil8"];function Rg(){return Pg.apply(this,arguments)}function Pg(){return(Pg=v(f().mark(function e(){var t;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===Ag){e.next=2;break}return e.abrupt("return",Ag);case 2:return e.next=4,kg();case 4:return t=e.sent,Ag=[].concat(wg,m(t)),e.abrupt("return",Ag);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Mg='(function () {\n    \'use strict\';\n\n    function createLevelBuffers(basisTexture, basisTranscoderFormat) {\n      const images = basisTexture.getNumImages();\n      const levels = basisTexture.getNumLevels(0);\n      const success = basisTexture.startTranscoding();\n      if (!success) {\n        throw new Error("startTranscoding failed");\n      }\n      const levelBuffers = [];\n      for (let levelIndex = 0; levelIndex < levels; ++levelIndex) {\n        for (let sliceIndex = 0; sliceIndex < images; ++sliceIndex) {\n          const transcodeSize = basisTexture.getImageTranscodedSizeInBytes(sliceIndex, levelIndex, basisTranscoderFormat);\n          const levelBuffer = new Uint8Array(transcodeSize);\n          const success2 = basisTexture.transcodeImage(levelBuffer, sliceIndex, levelIndex, basisTranscoderFormat, 1, 0);\n          if (!success2) {\n            throw new Error("transcodeImage failed");\n          }\n          levelBuffers.push(levelBuffer);\n        }\n      }\n      return levelBuffers;\n    }\n\n    const gpuFormatToBasisTranscoderFormatMap = {\n      "bc3-rgba-unorm": 3,\n      // cTFBC3_RGBA\n      "bc7-rgba-unorm": 6,\n      // cTFBC7_RGBA,\n      "etc2-rgba8unorm": 1,\n      // cTFETC2_RGBA,\n      "astc-4x4-unorm": 10,\n      // cTFASTC_4x4_RGBA,\n      // Uncompressed\n      rgba8unorm: 13,\n      // cTFRGBA32,\n      rgba4unorm: 16\n      // cTFRGBA4444,\n    };\n    function gpuFormatToBasisTranscoderFormat(transcoderFormat) {\n      const format = gpuFormatToBasisTranscoderFormatMap[transcoderFormat];\n      if (format) {\n        return format;\n      }\n      throw new Error(`Unsupported transcoderFormat: ${transcoderFormat}`);\n    }\n\n    const settings = {\n      jsUrl: "basis/basis_transcoder.js",\n      wasmUrl: "basis/basis_transcoder.wasm"\n    };\n    let basisTranscoderFormat;\n    let basisTranscodedTextureFormat;\n    let basisPromise;\n    async function getBasis() {\n      if (!basisPromise) {\n        const absoluteJsUrl = new URL(settings.jsUrl, location.origin).href;\n        const absoluteWasmUrl = new URL(settings.wasmUrl, location.origin).href;\n        importScripts(absoluteJsUrl);\n        basisPromise = new Promise((resolve) => {\n          BASIS({\n            locateFile: (_file) => absoluteWasmUrl\n          }).then((module) => {\n            module.initializeBasis();\n            resolve(module.BasisFile);\n          });\n        });\n      }\n      return basisPromise;\n    }\n    async function fetchBasisTexture(url, BasisTexture) {\n      const basisResponse = await fetch(url);\n      if (basisResponse.ok) {\n        const basisArrayBuffer = await basisResponse.arrayBuffer();\n        return new BasisTexture(new Uint8Array(basisArrayBuffer));\n      }\n      throw new Error(`Failed to load Basis texture: ${url}`);\n    }\n    const preferredTranscodedFormat = [\n      "bc7-rgba-unorm",\n      "astc-4x4-unorm",\n      "etc2-rgba8unorm",\n      "bc3-rgba-unorm",\n      "rgba8unorm"\n    ];\n    async function load(url) {\n      const BasisTexture = await getBasis();\n      const basisTexture = await fetchBasisTexture(url, BasisTexture);\n      const levelBuffers = createLevelBuffers(basisTexture, basisTranscoderFormat);\n      return {\n        width: basisTexture.getImageWidth(0, 0),\n        height: basisTexture.getImageHeight(0, 0),\n        format: basisTranscodedTextureFormat,\n        resource: levelBuffers,\n        alphaMode: "no-premultiply-alpha"\n      };\n    }\n    async function init(jsUrl, wasmUrl, supportedTextures) {\n      if (jsUrl)\n        settings.jsUrl = jsUrl;\n      if (wasmUrl)\n        settings.wasmUrl = wasmUrl;\n      basisTranscodedTextureFormat = preferredTranscodedFormat.filter((format) => supportedTextures.includes(format))[0];\n      basisTranscoderFormat = gpuFormatToBasisTranscoderFormat(basisTranscodedTextureFormat);\n      await getBasis();\n    }\n    const messageHandlers = {\n      init: async (data) => {\n        const { jsUrl, wasmUrl, supportedTextures } = data;\n        await init(jsUrl, wasmUrl, supportedTextures);\n      },\n      load: async (data) => {\n        var _a;\n        try {\n          const textureOptions = await load(data.url);\n          return {\n            type: "load",\n            url: data.url,\n            success: true,\n            textureOptions,\n            transferables: (_a = textureOptions.resource) == null ? void 0 : _a.map((arr) => arr.buffer)\n          };\n        } catch (e) {\n          throw e;\n        }\n      }\n    };\n    self.onmessage = async (messageEvent) => {\n      const message = messageEvent.data;\n      const response = await messageHandlers[message.type](message);\n      if (response) {\n        self.postMessage(response, response.transferables);\n      }\n    };\n\n})();\n',Og=null,Cg=B(function e(){C(this,e),Og||(Og=URL.createObjectURL(new Blob([Mg],{type:"application/javascript"}))),this.worker=new Worker(Og)});Cg.revokeObjectURL=function(){Og&&(URL.revokeObjectURL(Og),Og=null)};var Gg,Bg=exports.basisTranscoderUrls={jsUrl:"https://files.pixijs.download/transcoders/basis/basis_transcoder.js",wasmUrl:"https://files.pixijs.download/transcoders/basis/basis_transcoder.wasm"};function Ig(e){Object.assign(Bg,e)}var Fg={};function Dg(e){return Gg||((Gg=(new Cg).worker).onmessage=function(e){var t=e.data,r=t.success,n=t.url,i=t.textureOptions;r||console.warn("Failed to load Basis texture",n),Fg[n](i)},Gg.postMessage({type:"init",jsUrl:Bg.jsUrl,wasmUrl:Bg.wasmUrl,supportedTextures:e})),Gg}function Ug(e,t){var r=Dg(t);return new Promise(function(t){Fg[e]=t,r.postMessage({type:"load",url:e})})}var Lg=exports.loadBasis={extension:{type:Z.LoadParser,priority:un.High,name:"loadBasis"},name:"loadBasis",test:function(e){return jv(e,[".basis"])},load:function(e,t,r){return v(f().mark(function t(){var n,i,a;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Rg();case 2:return n=t.sent,t.next=5,Ug(e,n);case 5:return i=t.sent,a=new xg(i),t.abrupt("return",pm(a,r,e));case 8:case"end":return t.stop()}},t)}))()},unload:function(e){Array.isArray(e)?e.forEach(function(e){return e.destroy(!0)}):e.destroy(!0)}};function Ng(e,t){var r=e.getNumImages(),n=e.getNumLevels(0);if(!e.startTranscoding())throw new Error("startTranscoding failed");for(var i=[],a=0;a<n;++a)for(var o=0;o<r;++o){var s=e.getImageTranscodedSizeInBytes(o,a,t),u=new Uint8Array(s);if(!e.transcodeImage(u,o,a,t,1,0))throw new Error("transcodeImage failed");i.push(u)}return i}var Xg={"bc3-rgba-unorm":3,"bc7-rgba-unorm":6,"etc2-rgba8unorm":1,"astc-4x4-unorm":10,rgba8unorm:13,rgba4unorm:16};function Hg(e){var t=Xg[e];if(t)return t;throw new Error("Unsupported transcoderFormat: ".concat(e))}var jg={MAGIC:0,SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19,PF_FLAGS:20,FOURCC:21,RGB_BITCOUNT:22,R_BIT_MASK:23,G_BIT_MASK:24,B_BIT_MASK:25,A_BIT_MASK:26},zg={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},Vg=exports.DXGI_FORMAT=function(e){return e[e.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",e[e.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",e[e.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",e[e.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",e[e.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",e[e.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",e[e.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",e[e.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",e[e.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",e[e.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",e[e.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",e[e.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",e[e.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",e[e.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",e[e.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",e[e.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",e[e.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",e[e.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",e[e.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",e[e.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",e[e.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",e[e.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",e[e.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",e[e.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",e[e.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",e[e.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",e[e.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",e[e.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",e[e.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",e[e.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",e[e.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",e[e.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",e[e.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",e[e.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",e[e.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",e[e.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",e[e.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",e[e.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",e[e.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",e[e.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",e[e.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",e[e.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",e[e.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",e[e.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",e[e.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",e[e.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",e[e.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",e[e.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",e[e.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",e[e.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",e[e.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",e[e.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",e[e.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",e[e.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",e[e.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",e[e.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",e[e.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",e[e.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",e[e.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",e[e.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",e[e.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",e[e.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",e[e.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",e[e.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",e[e.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",e[e.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",e[e.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",e[e.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",e[e.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",e[e.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",e[e.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",e[e.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",e[e.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",e[e.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",e[e.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",e[e.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",e[e.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",e[e.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",e[e.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",e[e.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",e[e.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",e[e.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",e[e.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",e[e.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",e[e.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",e[e.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",e[e.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",e[e.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",e[e.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",e[e.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",e[e.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",e[e.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",e[e.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",e[e.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",e[e.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",e[e.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",e[e.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",e[e.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",e[e.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",e[e.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",e[e.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",e[e.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",e[e.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",e[e.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",e[e.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",e[e.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",e[e.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",e[e.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",e[e.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",e[e.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",e[e.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",e[e.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",e[e.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",e[e.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",e[e.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",e[e.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",e[e.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",e[e.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",e[e.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",e[e.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",e[e.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",e[e.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT",e}(Vg||{}),Wg=exports.D3D10_RESOURCE_DIMENSION=function(e){return e[e.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",e[e.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",e[e.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D",e}(Wg||{});function Yg(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var Kg=exports.D3DFMT=function(e){return e[e.UNKNOWN=0]="UNKNOWN",e[e.R8G8B8=20]="R8G8B8",e[e.A8R8G8B8=21]="A8R8G8B8",e[e.X8R8G8B8=22]="X8R8G8B8",e[e.R5G6B5=23]="R5G6B5",e[e.X1R5G5B5=24]="X1R5G5B5",e[e.A1R5G5B5=25]="A1R5G5B5",e[e.A4R4G4B4=26]="A4R4G4B4",e[e.R3G3B2=27]="R3G3B2",e[e.A8=28]="A8",e[e.A8R3G3B2=29]="A8R3G3B2",e[e.X4R4G4B4=30]="X4R4G4B4",e[e.A2B10G10R10=31]="A2B10G10R10",e[e.A8B8G8R8=32]="A8B8G8R8",e[e.X8B8G8R8=33]="X8B8G8R8",e[e.G16R16=34]="G16R16",e[e.A2R10G10B10=35]="A2R10G10B10",e[e.A16B16G16R16=36]="A16B16G16R16",e[e.A8P8=40]="A8P8",e[e.P8=41]="P8",e[e.L8=50]="L8",e[e.A8L8=51]="A8L8",e[e.A4L4=52]="A4L4",e[e.V8U8=60]="V8U8",e[e.L6V5U5=61]="L6V5U5",e[e.X8L8V8U8=62]="X8L8V8U8",e[e.Q8W8V8U8=63]="Q8W8V8U8",e[e.V16U16=64]="V16U16",e[e.A2W10V10U10=67]="A2W10V10U10",e[e.Q16W16V16U16=110]="Q16W16V16U16",e[e.R16F=111]="R16F",e[e.G16R16F=112]="G16R16F",e[e.A16B16G16R16F=113]="A16B16G16R16F",e[e.R32F=114]="R32F",e[e.G32R32F=115]="G32R32F",e[e.A32B32G32R32F=116]="A32B32G32R32F",e[e.UYVY=Yg("UYVY")]="UYVY",e[e.R8G8_B8G8=Yg("RGBG")]="R8G8_B8G8",e[e.YUY2=Yg("YUY2")]="YUY2",e[e.D3DFMT_G8R8_G8B8=Yg("GRGB")]="D3DFMT_G8R8_G8B8",e[e.DXT1=Yg("DXT1")]="DXT1",e[e.DXT2=Yg("DXT2")]="DXT2",e[e.DXT3=Yg("DXT3")]="DXT3",e[e.DXT4=Yg("DXT4")]="DXT4",e[e.DXT5=Yg("DXT5")]="DXT5",e[e.ATI1=Yg("ATI1")]="ATI1",e[e.AT1N=Yg("AT1N")]="AT1N",e[e.ATI2=Yg("ATI2")]="ATI2",e[e.AT2N=Yg("AT2N")]="AT2N",e[e.BC4U=Yg("BC4U")]="BC4U",e[e.BC4S=Yg("BC4S")]="BC4S",e[e.BC5U=Yg("BC5U")]="BC5U",e[e.BC5S=Yg("BC5S")]="BC5S",e[e.DX10=Yg("DX10")]="DX10",e}(Kg||{}),qg=exports.FOURCC_TO_TEXTURE_FORMAT=(l(l(l(l(l(l(l(l(l(l(t={},Kg.DXT1,"bc1-rgba-unorm"),Kg.DXT2,"bc2-rgba-unorm"),Kg.DXT3,"bc2-rgba-unorm"),Kg.DXT4,"bc3-rgba-unorm"),Kg.DXT5,"bc3-rgba-unorm"),Kg.ATI1,"bc4-r-unorm"),Kg.BC4U,"bc4-r-unorm"),Kg.BC4S,"bc4-r-snorm"),Kg.ATI2,"bc5-rg-unorm"),Kg.BC5U,"bc5-rg-unorm"),l(l(l(l(l(l(l(l(l(t,Kg.BC5S,"bc5-rg-snorm"),36,"rgba16uint"),110,"rgba16sint"),111,"r16float"),112,"rg16float"),113,"rgba16float"),114,"r32float"),115,"rg32float"),116,"rgba32float")),Zg=exports.DXGI_TO_TEXTURE_FORMAT=(l(l(l(l(l(l(l(l(l(l(r={},70,"bc1-rgba-unorm"),71,"bc1-rgba-unorm"),72,"bc1-rgba-unorm-srgb"),73,"bc2-rgba-unorm"),74,"bc2-rgba-unorm"),75,"bc2-rgba-unorm-srgb"),76,"bc3-rgba-unorm"),77,"bc3-rgba-unorm"),78,"bc3-rgba-unorm-srgb"),79,"bc4-r-unorm"),l(l(l(l(l(l(l(l(l(l(r,80,"bc4-r-unorm"),81,"bc4-r-snorm"),82,"bc5-rg-unorm"),83,"bc5-rg-unorm"),84,"bc5-rg-snorm"),94,"bc6h-rgb-ufloat"),95,"bc6h-rgb-ufloat"),96,"bc6h-rgb-float"),97,"bc7-rgba-unorm"),98,"bc7-rgba-unorm"),l(l(l(l(l(l(l(l(l(l(r,99,"bc7-rgba-unorm-srgb"),28,"rgba8unorm"),29,"rgba8unorm-srgb"),87,"bgra8unorm"),91,"bgra8unorm-srgb"),41,"r32float"),49,"rg8unorm"),56,"r16uint"),61,"r8unorm"),24,"rgb10a2unorm"),l(l(l(l(l(l(l(r,11,"rgba16uint"),13,"rgba16sint"),10,"rgba16float"),54,"r16float"),34,"rg16float"),16,"rg32float"),2,"rgba32float")),Qg=exports.DDS={MAGIC_VALUE:542327876,MAGIC_SIZE:4,HEADER_SIZE:124,HEADER_DX10_SIZE:20,PIXEL_FORMAT_FLAGS:{ALPHAPIXELS:1,ALPHA:2,FOURCC:4,RGB:64,RGBA:65,YUV:512,LUMINANCE:131072,LUMINANCEA:131073},RESOURCE_MISC_TEXTURECUBE:4,HEADER_FIELDS:jg,HEADER_DX10_FIELDS:zg,DXGI_FORMAT:Vg,D3D10_RESOURCE_DIMENSION:Wg,D3DFMT:Kg},Jg=exports.TEXTURE_FORMAT_BLOCK_SIZE={"bc1-rgba-unorm":8,"bc1-rgba-unorm-srgb":8,"bc2-rgba-unorm":16,"bc2-rgba-unorm-srgb":16,"bc3-rgba-unorm":16,"bc3-rgba-unorm-srgb":16,"bc4-r-unorm":8,"bc4-r-snorm":8,"bc5-rg-unorm":16,"bc5-rg-snorm":16,"bc6h-rgb-ufloat":16,"bc6h-rgb-float":16,"bc7-rgba-unorm":16,"bc7-rgba-unorm-srgb":16};function $g(e,t){var r=t_(e),n=r.format,i=r.fourCC,a=r.width,o=r.height,s=r.dataOffset,u=r.mipmapCount;if(!t.includes(n))throw new Error("Unsupported texture format: ".concat(i," ").concat(n,", supported: ").concat(t));return u<=1?{format:n,width:a,height:o,resource:[new Uint8Array(e,s)],alphaMode:"no-premultiply-alpha"}:{format:n,width:a,height:o,resource:e_(n,a,o,s,u,e),alphaMode:"no-premultiply-alpha"}}function e_(e,t,r,n,i,a){for(var o=[],s=Jg[e],u=t,l=r,c=n,h=0;h<i;++h){var d=s?Math.max(4,u)/4*Math.max(4,l)/4*s:u*l*4,f=new Uint8Array(a,c,d);o.push(f),c+=d,u=Math.max(u>>1,1),l=Math.max(l>>1,1)}return o}function t_(e){var t=new Uint32Array(e,0,Qg.HEADER_SIZE/Uint32Array.BYTES_PER_ELEMENT);if(t[Qg.HEADER_FIELDS.MAGIC]!==Qg.MAGIC_VALUE)throw new Error("Invalid magic number in DDS header");var r=t[Qg.HEADER_FIELDS.HEIGHT],n=t[Qg.HEADER_FIELDS.WIDTH],i=Math.max(1,t[Qg.HEADER_FIELDS.MIPMAP_COUNT]),a=t[Qg.HEADER_FIELDS.PF_FLAGS],o=t[Qg.HEADER_FIELDS.FOURCC];return{format:r_(t,a,o,e),fourCC:o,width:n,height:r,dataOffset:Qg.MAGIC_SIZE+Qg.HEADER_SIZE+(o===Qg.D3DFMT.DX10?Qg.HEADER_DX10_SIZE:0),mipmapCount:i}}function r_(e,t,r,n){if(t&Qg.PIXEL_FORMAT_FLAGS.FOURCC){if(r===Qg.D3DFMT.DX10){var i=new Uint32Array(n,Qg.MAGIC_SIZE+Qg.HEADER_SIZE,Qg.HEADER_DX10_SIZE/Uint32Array.BYTES_PER_ELEMENT);if(i[Qg.HEADER_DX10_FIELDS.MISC_FLAG]===Qg.RESOURCE_MISC_TEXTURECUBE)throw new Error("DDSParser does not support cubemap textures");if(i[Qg.HEADER_DX10_FIELDS.RESOURCE_DIMENSION]===Qg.D3D10_RESOURCE_DIMENSION.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSParser does not supported 3D texture data");var a=i[Qg.HEADER_DX10_FIELDS.DXGI_FORMAT];if(a in Zg)return Zg[a];throw new Error("DDSParser cannot parse texture data with DXGI format ".concat(a))}if(r in qg)return qg[r];throw new Error("DDSParser cannot parse texture data with fourCC format ".concat(r))}if(t&Qg.PIXEL_FORMAT_FLAGS.RGB||t&Qg.PIXEL_FORMAT_FLAGS.RGBA)return n_(e);if(t&Qg.PIXEL_FORMAT_FLAGS.YUV)throw new Error("DDSParser does not supported YUV uncompressed texture data.");if(t&Qg.PIXEL_FORMAT_FLAGS.LUMINANCE||t&Qg.PIXEL_FORMAT_FLAGS.LUMINANCEA)throw new Error("DDSParser does not support single-channel (lumninance) texture data!");if(t&Qg.PIXEL_FORMAT_FLAGS.ALPHA||t&Qg.PIXEL_FORMAT_FLAGS.ALPHAPIXELS)throw new Error("DDSParser does not support single-channel (alpha) texture data!");throw new Error("DDSParser failed to load a texture file due to an unknown reason!")}function n_(e){var t=e[Qg.HEADER_FIELDS.RGB_BITCOUNT],r=e[Qg.HEADER_FIELDS.R_BIT_MASK],n=e[Qg.HEADER_FIELDS.G_BIT_MASK],i=e[Qg.HEADER_FIELDS.B_BIT_MASK],a=e[Qg.HEADER_FIELDS.A_BIT_MASK];switch(t){case 32:if(255===r&&65280===n&&16711680===i&&4278190080===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_R8G8B8A8_UNORM];if(16711680===r&&65280===n&&255===i&&4278190080===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_B8G8R8A8_UNORM];if(1072693248===r&&1047552===n&&1023===i&&3221225472===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_R10G10B10A2_UNORM];if(65535===r&&4294901760===n&&0===i&&0===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_R16G16_UNORM];if(4294967295===r&&0===n&&0===i&&0===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_R32_FLOAT];break;case 24:break;case 16:if(31744===r&&992===n&&31===i&&32768===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_B5G5R5A1_UNORM];if(63488===r&&2016===n&&31===i&&0===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_B5G6R5_UNORM];if(3840===r&&240===n&&15===i&&61440===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_B4G4R4A4_UNORM];if(255===r&&0===n&&0===i&&65280===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_R8G8_UNORM];if(65535===r&&0===n&&0===i&&0===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_R16_UNORM];break;case 8:if(255===r&&0===n&&0===i&&0===a)return Zg[Qg.DXGI_FORMAT.DXGI_FORMAT_R8_UNORM]}throw new Error("DDSParser does not support uncompressed texture with configuration:\n                bitCount = ".concat(t,", rBitMask = ").concat(r,", gBitMask = ").concat(n,", aBitMask = ").concat(a))}var i_=exports.loadDDS={extension:{type:Z.LoadParser,priority:un.High,name:"loadDDS"},name:"loadDDS",test:function(e){return jv(e,[".dds"])},load:function(e,t,r){return v(f().mark(function t(){var n,i,a,o,s;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Rg();case 2:return n=t.sent,t.next=5,fetch(e);case 5:return i=t.sent,t.next=8,i.arrayBuffer();case 8:return a=t.sent,o=$g(a,n),s=new xg(o),t.abrupt("return",pm(s,r,e));case 12:case"end":return t.stop()}},t)}))()},unload:function(e){Array.isArray(e)?e.forEach(function(e){return e.destroy(!0)}):e.destroy(!0)}},a_=exports.GL_INTERNAL_FORMAT=function(e){return e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGBA=6408]="RGBA",e[e.RGBA8UI=36220]="RGBA8UI",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.RGBA8I=36238]="RGBA8I",e[e.RGBA8=32856]="RGBA8",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e}(a_||{}),o_=function(e){return e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e}(o_||{}),s_=function(e){return e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e}(s_||{}),u_=(l(l(l(l(l(l(l(l(l(l(n={},33776,"bc1-rgba-unorm"),33777,"bc1-rgba-unorm"),33778,"bc2-rgba-unorm"),33779,"bc3-rgba-unorm"),35916,"bc1-rgba-unorm-srgb"),35917,"bc1-rgba-unorm-srgb"),35918,"bc2-rgba-unorm-srgb"),35919,"bc3-rgba-unorm-srgb"),36283,"bc4-r-unorm"),36284,"bc4-r-snorm"),l(l(l(l(l(l(l(l(l(l(n,36285,"bc5-rg-unorm"),36286,"bc5-rg-snorm"),37488,"eac-r11unorm"),37490,"eac-rg11snorm"),37492,"etc2-rgb8unorm"),37496,"etc2-rgba8unorm"),37493,"etc2-rgb8unorm-srgb"),37497,"etc2-rgba8unorm-srgb"),37494,"etc2-rgb8a1unorm"),37495,"etc2-rgb8a1unorm-srgb"),l(l(l(l(l(l(l(l(l(l(n,37808,"astc-4x4-unorm"),37840,"astc-4x4-unorm-srgb"),37809,"astc-5x4-unorm"),37841,"astc-5x4-unorm-srgb"),37810,"astc-5x5-unorm"),37842,"astc-5x5-unorm-srgb"),37811,"astc-6x5-unorm"),37843,"astc-6x5-unorm-srgb"),37812,"astc-6x6-unorm"),37844,"astc-6x6-unorm-srgb"),l(l(l(l(l(l(l(l(l(l(n,37813,"astc-8x5-unorm"),37845,"astc-8x5-unorm-srgb"),37814,"astc-8x6-unorm"),37846,"astc-8x6-unorm-srgb"),37815,"astc-8x8-unorm"),37847,"astc-8x8-unorm-srgb"),37816,"astc-10x5-unorm"),37848,"astc-10x5-unorm-srgb"),37817,"astc-10x6-unorm"),37849,"astc-10x6-unorm-srgb"),l(l(l(l(l(l(l(l(l(l(n,37818,"astc-10x8-unorm"),37850,"astc-10x8-unorm-srgb"),37819,"astc-10x10-unorm"),37851,"astc-10x10-unorm-srgb"),37820,"astc-12x10-unorm"),37852,"astc-12x10-unorm-srgb"),37821,"astc-12x12-unorm"),37853,"astc-12x12-unorm-srgb"),36492,"bc7-rgba-unorm"),36493,"bc7-rgba-unorm-srgb"),l(l(l(l(l(l(l(n,36494,"bc6h-rgb-float"),36495,"bc6h-rgb-ufloat"),35907,"rgba8unorm-srgb"),36759,"rgba8snorm"),36220,"rgba8uint"),36238,"rgba8sint"),6408,"rgba8unorm")),l_=[171,75,84,88,32,49,49,187,13,10,26,10],c_={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},h_=64,d_=67305985,f_=l(l(l(l(l(l({},5121,1),5123,2),5124,4),5125,4),5126,4),36193,8),p_=l(l(l(l(l(l(l({},6408,4),6407,3),33319,2),6403,1),6409,1),6410,2),6406,1),v_=l(l(l({},32819,2),32820,2),33635,2),m_=(l(l(l(l(l(l(l(l(l(l(i={},33776,.5),33777,.5),33778,1),33779,1),35916,.5),35917,.5),35918,1),35919,1),36283,.5),36284,.5),l(l(l(l(l(l(l(l(l(l(i,36285,1),36286,1),37488,.5),37489,.5),37490,1),37491,1),37492,.5),37496,1),37493,.5),37497,1),l(l(l(l(l(l(l(l(l(l(i,37494,.5),37495,.5),37808,1),37840,1),37809,.8),37841,.8),37810,.64),37842,.64),37811,.53375),37843,.53375),l(l(l(l(l(l(l(l(l(l(i,37812,.445),37844,.445),37813,.4),37845,.4),37814,.33375),37846,.33375),37815,.25),37847,.25),37816,.32),37848,.32),l(l(l(l(l(l(l(l(l(l(i,37817,.26625),37849,.26625),37818,.2),37850,.2),37819,.16),37851,.16),37820,.13375),37852,.13375),37821,.11125),37853,.11125),l(l(l(l(i,36492,1),36493,1),36494,1),36495,1)),g_=exports.KTX={FILE_HEADER_SIZE:h_,FILE_IDENTIFIER:l_,FORMATS_TO_COMPONENTS:p_,INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:m_,INTERNAL_FORMAT_TO_TEXTURE_FORMATS:u_,FIELDS:c_,TYPES_TO_BYTES_PER_COMPONENT:f_,TYPES_TO_BYTES_PER_PIXEL:v_,ENDIANNESS:d_};function __(e,t){var r=new DataView(e);if(!T_(r))throw new Error("Invalid KTX identifier in header");var n=b_(r),i=n.littleEndian,a=n.glType,o=n.glFormat,s=n.glInternalFormat,u=n.pixelWidth,l=n.pixelHeight,c=n.numberOfMipmapLevels,h=n.offset,d=g_.INTERNAL_FORMAT_TO_TEXTURE_FORMATS[s];if(!d)throw new Error("Unknown texture format ".concat(s));if(!t.includes(d))throw new Error("Unsupported texture format: ".concat(d,", supportedFormats: ").concat(t));return{format:d,width:u,height:l,resource:y_(r,a,x_(a,o,s),u,l,h,c,i),alphaMode:"no-premultiply-alpha"}}function y_(e,t,r,n,i,a,o,s){var u=n+3&-4,l=i+3&-4,c=n*i;0===t&&(c=u*l);for(var h=c*r,d=n,f=i,p=a,v=new Array(o),m=0;m<o;m++){var g=e.getUint32(p,s),_=p+4;v[m]=new Uint8Array(e.buffer,_,h),_+=h,p=(p+=g+4)%4!=0?p+4-p%4:p,h=((d=d>>1||1)+4-1&-4)*((f=f>>1||1)+4-1&-4)*r}return v}function x_(e,t,r){var n=g_.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[r];if(0!==e&&(n=g_.TYPES_TO_BYTES_PER_COMPONENT[e]?g_.TYPES_TO_BYTES_PER_COMPONENT[e]*g_.FORMATS_TO_COMPONENTS[t]:g_.TYPES_TO_BYTES_PER_PIXEL[e]),void 0===n)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");return n}function b_(e){var t=e.getUint32(g_.FIELDS.ENDIANNESS,!0)===g_.ENDIANNESS,r=e.getUint32(g_.FIELDS.GL_TYPE,t),n=e.getUint32(g_.FIELDS.GL_FORMAT,t),i=e.getUint32(g_.FIELDS.GL_INTERNAL_FORMAT,t),a=e.getUint32(g_.FIELDS.PIXEL_WIDTH,t),o=e.getUint32(g_.FIELDS.PIXEL_HEIGHT,t)||1,s=e.getUint32(g_.FIELDS.PIXEL_DEPTH,t)||1,u=e.getUint32(g_.FIELDS.NUMBER_OF_ARRAY_ELEMENTS,t)||1,l=e.getUint32(g_.FIELDS.NUMBER_OF_FACES,t),c=e.getUint32(g_.FIELDS.NUMBER_OF_MIPMAP_LEVELS,t),h=e.getUint32(g_.FIELDS.BYTES_OF_KEY_VALUE_DATA,t);if(0===o||1!==s)throw new Error("Only 2D textures are supported");if(1!==l)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==u)throw new Error("WebGL does not support array textures");return{littleEndian:t,glType:r,glFormat:n,glInternalFormat:i,pixelWidth:a,pixelHeight:o,numberOfMipmapLevels:c,offset:g_.FILE_HEADER_SIZE+h}}function T_(e){for(var t=0;t<g_.FILE_IDENTIFIER.length;t++)if(e.getUint8(t)!==g_.FILE_IDENTIFIER[t])return!1;return!0}var S_=exports.loadKTX={extension:{type:Z.LoadParser,priority:un.High,name:"loadKTX"},name:"loadKTX",test:function(e){return jv(e,".ktx")},load:function(e,t,r){return v(f().mark(function t(){var n,i,a,o,s;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Rg();case 2:return n=t.sent,t.next=5,fetch(e);case 5:return i=t.sent,t.next=8,i.arrayBuffer();case 8:return a=t.sent,o=__(a,n),s=new xg(o),t.abrupt("return",pm(s,r,e));case 12:case"end":return t.stop()}},t)}))()},unload:function(e){Array.isArray(e)?e.forEach(function(e){return e.destroy(!0)}):e.destroy(!0)}},k_='(function () {\n    \'use strict\';\n\n    const converters = {\n      rgb8unorm: {\n        convertedFormat: "rgba8unorm",\n        convertFunction: convertRGBtoRGBA\n      },\n      "rgb8unorm-srgb": {\n        convertedFormat: "rgba8unorm-srgb",\n        convertFunction: convertRGBtoRGBA\n      }\n    };\n    function convertFormatIfRequired(textureOptions) {\n      const format = textureOptions.format;\n      if (converters[format]) {\n        const convertFunction = converters[format].convertFunction;\n        const levelBuffers = textureOptions.resource;\n        for (let i = 0; i < levelBuffers.length; i++) {\n          levelBuffers[i] = convertFunction(levelBuffers[i]);\n        }\n        textureOptions.format = converters[format].convertedFormat;\n      }\n    }\n    function convertRGBtoRGBA(levelBuffer) {\n      const pixelCount = levelBuffer.byteLength / 3;\n      const levelBufferWithAlpha = new Uint32Array(pixelCount);\n      for (let i = 0; i < pixelCount; ++i) {\n        levelBufferWithAlpha[i] = levelBuffer[i * 3] + (levelBuffer[i * 3 + 1] << 8) + (levelBuffer[i * 3 + 2] << 16) + 4278190080;\n      }\n      return new Uint8Array(levelBufferWithAlpha.buffer);\n    }\n\n    function createLevelBuffersFromKTX(ktxTexture) {\n      const levelBuffers = [];\n      for (let i = 0; i < ktxTexture.numLevels; i++) {\n        const imageData = ktxTexture.getImageData(i, 0, 0);\n        const levelBuffer = new Uint8Array(imageData.byteLength);\n        levelBuffer.set(imageData);\n        levelBuffers.push(levelBuffer);\n      }\n      return levelBuffers;\n    }\n\n    const glFormatToGPUFormatMap = {\n      6408: "rgba8unorm",\n      32856: "bgra8unorm",\n      //\n      32857: "rgb10a2unorm",\n      33189: "depth16unorm",\n      33190: "depth24plus",\n      33321: "r8unorm",\n      33323: "rg8unorm",\n      33325: "r16float",\n      33326: "r32float",\n      33327: "rg16float",\n      33328: "rg32float",\n      33329: "r8sint",\n      33330: "r8uint",\n      33331: "r16sint",\n      33332: "r16uint",\n      33333: "r32sint",\n      33334: "r32uint",\n      33335: "rg8sint",\n      33336: "rg8uint",\n      33337: "rg16sint",\n      33338: "rg16uint",\n      33339: "rg32sint",\n      33340: "rg32uint",\n      33778: "bc2-rgba-unorm",\n      33779: "bc3-rgba-unorm",\n      34836: "rgba32float",\n      34842: "rgba16float",\n      35056: "depth24plus-stencil8",\n      35898: "rg11b10ufloat",\n      35901: "rgb9e5ufloat",\n      35907: "rgba8unorm-srgb",\n      // bgra8unorm-srgb\n      36012: "depth32float",\n      36013: "depth32float-stencil8",\n      36168: "stencil8",\n      36208: "rgba32uint",\n      36214: "rgba16uint",\n      36220: "rgba8uint",\n      36226: "rgba32sint",\n      36232: "rgba16sint",\n      36238: "rgba8sint",\n      36492: "bc7-rgba-unorm",\n      36756: "r8snorm",\n      36757: "rg8snorm",\n      36759: "rgba8snorm",\n      37496: "etc2-rgba8unorm",\n      37808: "astc-4x4-unorm"\n    };\n    function glFormatToGPUFormat(glInternalFormat) {\n      const format = glFormatToGPUFormatMap[glInternalFormat];\n      if (format) {\n        return format;\n      }\n      throw new Error(`Unsupported glInternalFormat: ${glInternalFormat}`);\n    }\n\n    const vkFormatToGPUFormatMap = {\n      23: "rgb8unorm",\n      // VK_FORMAT_R8G8B8_UNORM\n      37: "rgba8unorm",\n      // VK_FORMAT_R8G8B8A8_UNORM\n      43: "rgba8unorm-srgb"\n      // VK_FORMAT_R8G8B8A8_SRGB\n      // TODO add more!\n    };\n    function vkFormatToGPUFormat(vkFormat) {\n      const format = vkFormatToGPUFormatMap[vkFormat];\n      if (format) {\n        return format;\n      }\n      throw new Error(`Unsupported VkFormat: ${vkFormat}`);\n    }\n\n    function getTextureFormatFromKTXTexture(ktxTexture) {\n      if (ktxTexture.classId === 2) {\n        return vkFormatToGPUFormat(ktxTexture.vkFormat);\n      }\n      return glFormatToGPUFormat(ktxTexture.glInternalformat);\n    }\n\n    const gpuFormatToBasisTranscoderFormatMap = {\n      "bc3-rgba-unorm": "BC3_RGBA",\n      "bc7-rgba-unorm": "BC7_M5_RGBA",\n      "etc2-rgba8unorm": "ETC2_RGBA",\n      "astc-4x4-unorm": "ASTC_4x4_RGBA",\n      // Uncompressed\n      rgba8unorm: "RGBA32",\n      rg11b10ufloat: "R11F_G11F_B10F"\n    };\n    function gpuFormatToKTXBasisTranscoderFormat(transcoderFormat) {\n      const format = gpuFormatToBasisTranscoderFormatMap[transcoderFormat];\n      if (format) {\n        return format;\n      }\n      throw new Error(`Unsupported transcoderFormat: ${transcoderFormat}`);\n    }\n\n    const settings = {\n      jsUrl: "",\n      wasmUrl: ""\n    };\n    let basisTranscoderFormat;\n    let basisTranscodedTextureFormat;\n    let ktxPromise;\n    async function getKTX() {\n      if (!ktxPromise) {\n        const absoluteJsUrl = new URL(settings.jsUrl, location.origin).href;\n        const absoluteWasmUrl = new URL(settings.wasmUrl, location.origin).href;\n        importScripts(absoluteJsUrl);\n        ktxPromise = new Promise((resolve) => {\n          LIBKTX({\n            locateFile: (_file) => absoluteWasmUrl\n          }).then((libktx) => {\n            resolve(libktx);\n          });\n        });\n      }\n      return ktxPromise;\n    }\n    async function fetchKTXTexture(url, ktx) {\n      const ktx2Response = await fetch(url);\n      if (ktx2Response.ok) {\n        const ktx2ArrayBuffer = await ktx2Response.arrayBuffer();\n        return new ktx.ktxTexture(new Uint8Array(ktx2ArrayBuffer));\n      }\n      throw new Error(`Failed to load KTX(2) texture: ${url}`);\n    }\n    const preferredTranscodedFormat = [\n      "bc7-rgba-unorm",\n      "astc-4x4-unorm",\n      "etc2-rgba8unorm",\n      "bc3-rgba-unorm",\n      "rgba8unorm"\n    ];\n    async function load(url) {\n      const ktx = await getKTX();\n      const ktxTexture = await fetchKTXTexture(url, ktx);\n      let format;\n      if (ktxTexture.needsTranscoding) {\n        format = basisTranscodedTextureFormat;\n        const transcodeFormat = ktx.TranscodeTarget[basisTranscoderFormat];\n        const result = ktxTexture.transcodeBasis(transcodeFormat, 0);\n        if (result !== ktx.ErrorCode.SUCCESS) {\n          throw new Error("Unable to transcode basis texture.");\n        }\n      } else {\n        format = getTextureFormatFromKTXTexture(ktxTexture);\n      }\n      const levelBuffers = createLevelBuffersFromKTX(ktxTexture);\n      const textureOptions = {\n        width: ktxTexture.baseWidth,\n        height: ktxTexture.baseHeight,\n        format,\n        mipLevelCount: ktxTexture.numLevels,\n        resource: levelBuffers,\n        alphaMode: "no-premultiply-alpha"\n      };\n      convertFormatIfRequired(textureOptions);\n      return textureOptions;\n    }\n    async function init(jsUrl, wasmUrl, supportedTextures) {\n      if (jsUrl)\n        settings.jsUrl = jsUrl;\n      if (wasmUrl)\n        settings.wasmUrl = wasmUrl;\n      basisTranscodedTextureFormat = preferredTranscodedFormat.filter((format) => supportedTextures.includes(format))[0];\n      basisTranscoderFormat = gpuFormatToKTXBasisTranscoderFormat(basisTranscodedTextureFormat);\n      await getKTX();\n    }\n    const messageHandlers = {\n      init: async (data) => {\n        const { jsUrl, wasmUrl, supportedTextures } = data;\n        await init(jsUrl, wasmUrl, supportedTextures);\n      },\n      load: async (data) => {\n        var _a;\n        try {\n          const textureOptions = await load(data.url);\n          return {\n            type: "load",\n            url: data.url,\n            success: true,\n            textureOptions,\n            transferables: (_a = textureOptions.resource) == null ? void 0 : _a.map((arr) => arr.buffer)\n          };\n        } catch (e) {\n          throw e;\n        }\n      }\n    };\n    self.onmessage = async (messageEvent) => {\n      var _a;\n      const message = messageEvent.data;\n      const response = await ((_a = messageHandlers[message.type]) == null ? void 0 : _a.call(messageHandlers, message));\n      if (response) {\n        self.postMessage(response, response.transferables);\n      }\n    };\n\n})();\n',E_=null,A_=B(function e(){C(this,e),E_||(E_=URL.createObjectURL(new Blob([k_],{type:"application/javascript"}))),this.worker=new Worker(E_)});A_.revokeObjectURL=function(){E_&&(URL.revokeObjectURL(E_),E_=null)};var w_,R_=exports.ktxTranscoderUrls={jsUrl:"https://files.pixijs.download/transcoders/ktx/libktx.js",wasmUrl:"https://files.pixijs.download/transcoders/ktx/libktx.wasm"};function P_(e){Object.assign(R_,e)}var M_={};function O_(e){return w_||((w_=(new A_).worker).onmessage=function(e){var t=e.data,r=t.success,n=t.url,i=t.textureOptions;r||console.warn("Failed to load KTX texture",n),M_[n](i)},w_.postMessage({type:"init",jsUrl:R_.jsUrl,wasmUrl:R_.wasmUrl,supportedTextures:e})),w_}function C_(e,t){var r=O_(t);return new Promise(function(t){M_[e]=t,r.postMessage({type:"load",url:e})})}var G_=exports.loadKTX2={extension:{type:Z.LoadParser,priority:un.High,name:"loadKTX2"},name:"loadKTX2",test:function(e){return jv(e,".ktx2")},load:function(e,t,r){return v(f().mark(function t(){var n,i,a;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Rg();case 2:return n=t.sent,t.next=5,C_(e,n);case 5:return i=t.sent,a=new xg(i),t.abrupt("return",pm(a,r,e));case 8:case"end":return t.stop()}},t)}))()},unload:function(e){return v(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:Array.isArray(e)?e.forEach(function(e){return e.destroy(!0)}):e.destroy(!0);case 1:case"end":return t.stop()}},t)}))()}},B_={rgb8unorm:{convertedFormat:"rgba8unorm",convertFunction:F_},"rgb8unorm-srgb":{convertedFormat:"rgba8unorm-srgb",convertFunction:F_}};function I_(e){var t=e.format;if(B_[t]){for(var r=B_[t].convertFunction,n=e.resource,i=0;i<n.length;i++)n[i]=r(n[i]);e.format=B_[t].convertedFormat}}function F_(e){for(var t=e.byteLength/3,r=new Uint32Array(t),n=0;n<t;++n)r[n]=e[3*n]+(e[3*n+1]<<8)+(e[3*n+2]<<16)+4278190080;return new Uint8Array(r.buffer)}function D_(e){for(var t=[],r=0;r<e.numLevels;r++){var n=e.getImageData(r,0,0),i=new Uint8Array(n.byteLength);i.set(n),t.push(i)}return t}var U_={6408:"rgba8unorm",32856:"bgra8unorm",32857:"rgb10a2unorm",33189:"depth16unorm",33190:"depth24plus",33321:"r8unorm",33323:"rg8unorm",33325:"r16float",33326:"r32float",33327:"rg16float",33328:"rg32float",33329:"r8sint",33330:"r8uint",33331:"r16sint",33332:"r16uint",33333:"r32sint",33334:"r32uint",33335:"rg8sint",33336:"rg8uint",33337:"rg16sint",33338:"rg16uint",33339:"rg32sint",33340:"rg32uint",33778:"bc2-rgba-unorm",33779:"bc3-rgba-unorm",34836:"rgba32float",34842:"rgba16float",35056:"depth24plus-stencil8",35898:"rg11b10ufloat",35901:"rgb9e5ufloat",35907:"rgba8unorm-srgb",36012:"depth32float",36013:"depth32float-stencil8",36168:"stencil8",36208:"rgba32uint",36214:"rgba16uint",36220:"rgba8uint",36226:"rgba32sint",36232:"rgba16sint",36238:"rgba8sint",36492:"bc7-rgba-unorm",36756:"r8snorm",36757:"rg8snorm",36759:"rgba8snorm",37496:"etc2-rgba8unorm",37808:"astc-4x4-unorm"};function L_(e){var t=U_[e];if(t)return t;throw new Error("Unsupported glInternalFormat: ".concat(e))}var N_={23:"rgb8unorm",37:"rgba8unorm",43:"rgba8unorm-srgb"};function X_(e){var t=N_[e];if(t)return t;throw new Error("Unsupported VkFormat: ".concat(e))}function H_(e){return 2===e.classId?X_(e.vkFormat):L_(e.glInternalformat)}var j_={"bc3-rgba-unorm":"BC3_RGBA","bc7-rgba-unorm":"BC7_M5_RGBA","etc2-rgba8unorm":"ETC2_RGBA","astc-4x4-unorm":"ASTC_4x4_RGBA",rgba8unorm:"RGBA32",rg11b10ufloat:"R11F_G11F_B10F"};function z_(e){var t=j_[e];if(t)return t;throw new Error("Unsupported transcoderFormat: ".concat(e))}var V_,W_=exports.validFormats=["basis","bc7","bc6h","astc","etc2","bc5","bc4","bc3","bc2","bc1","eac"],Y_=exports.resolveCompressedTextureUrl={extension:Z.ResolveParser,test:function(e){return jv(e,[".ktx",".ktx2",".dds"])},parse:function(e){var t,r,n,i=e.split(".");if(i.length>2){var a=i[i.length-2];W_.includes(a)&&(n=a)}else n=i[i.length-1];return{resolution:parseFloat(null!=(r=null==(t=Rn.RETINA_PREFIX.exec(e))?void 0:t[1])?r:"1"),format:n,src:e}}},K_=exports.detectCompressed={extension:{type:Z.DetectionParser,priority:2},test:function(){var e=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jp();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",!0);case 4:if(!Hp()){e.next=6;break}return e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),add:function(){var e=v(f().mark(function e(t){var r;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kg();case 2:return r=e.sent,V_=q_(r),e.abrupt("return",[].concat(m(V_),m(t)));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=v(f().mark(function e(t){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!V_){e.next=2;break}return e.abrupt("return",t.filter(function(e){return!(e in V_)}));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()};function q_(e){var t=["basis"],r={};return e.forEach(function(e){var n=e.split("-")[0];n&&!r[n]&&(r[n]=!0,t.push(n))}),t.sort(function(e,t){var r=W_.indexOf(e),n=W_.indexOf(t);return-1===r?1:-1===n?-1:r-n}),t}var Z_=new Et,Q_=function(){return B(function e(){C(this,e)},[{key:"cull",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._cullRecursive(e,t,r)}},{key:"_cullRecursive",value:function(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.cullable&&e.measurable&&e.includeInBuild){var i=null!=(r=e.cullArea)?r:Rt(e,n,Z_);e.culled=i.x>=t.x+t.width||i.y>=t.y+t.height||i.x+i.width<=t.x||i.y+i.height<=t.y}else e.culled=!1;if(e.cullableChildren&&!e.culled&&e.renderable&&e.measurable&&e.includeInBuild)for(var a=0;a<e.children.length;a++)this._cullRecursive(e.children[a],t,n)}}])}();Q_.shared=new Q_;var J_=exports.Culler=Q_,$_=exports.CullerPlugin=function(){return B(function e(){C(this,e)},null,[{key:"init",value:function(){var e=this;this._renderRef=this.render.bind(this),this.render=function(){J_.shared.cull(e.stage,e.renderer.screen),e.renderer.render({container:e.stage})}}},{key:"destroy",value:function(){this.render=this._renderRef}}])}();$_.extension={priority:10,type:Z.Application,name:"culler"};var ey=exports.browserExt={extension:{type:Z.Environment,name:"browser",priority:-1},test:function(){return!0},load:function(){var e=v(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(function(){return Tp});case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},ty=Object.defineProperty,ry=Object.getOwnPropertySymbols,ny=Object.prototype.hasOwnProperty,iy=Object.prototype.propertyIsEnumerable,ay=function(e,t,r){return t in e?ty(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},oy=function(e,t){for(var r in t||(t={}))ny.call(t,r)&&ay(e,r,t[r]);if(ry){var n,i=U(ry(t));try{for(i.s();!(n=i.n()).done;){r=n.value;iy.call(t,r)&&ay(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},sy=function(e,t){var r={};for(var n in e)ny.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&ry){var i,a=U(ry(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&iy.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},uy=function(e){function t(e){var r;return C(this,t),(r=x(this,t,[e=oy(oy({},t.defaultOptions),e)])).enabled=!0,r._state=Al.for2d(),r.blendMode=e.blendMode,r.padding=e.padding,"boolean"==typeof e.antialias?r.antialias=e.antialias?"on":"off":r.antialias=e.antialias,r.resolution=e.resolution,r.blendRequired=e.blendRequired,r.addResource("uTexture",0,1),r}return E(t,Vs),B(t,[{key:"apply",value:function(e,t,r,n){e.applyFilter(this,t,r,n)}},{key:"blendMode",get:function(){return this._state.blendMode},set:function(e){this._state.blendMode=e}}],[{key:"from",value:function(e){var r,n,i=e,a=i.gpu,o=i.gl,s=sy(i,["gpu","gl"]);return a&&(r=Go.from(a)),o&&(n=To.from(o)),new t(oy({gpuProgram:r,glProgram:n},s))}}])}();uy.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1};var ly=exports.Filter=uy,cy=exports.blendTemplateFrag="\nin vec2 vTextureCoord;\nin vec4 vColor;\n\nout vec4 finalColor;\n\nuniform float uBlend;\n\nuniform sampler2D uTexture;\nuniform sampler2D uBackTexture;\n\n{FUNCTIONS}\n\nvoid main()\n{ \n    vec4 back = texture(uBackTexture, vTextureCoord);\n    vec4 front = texture(uTexture, vTextureCoord);\n    float blendedAlpha = front.a + back.a * (1.0 - front.a);\n    \n    {MAIN}\n}\n",hy=exports.blendTemplateVert="in vec2 aPosition;\nout vec2 vTextureCoord;\nout vec2 backgroundUv;\n\nuniform vec4 uInputSize;\nuniform vec4 uOutputFrame;\nuniform vec4 uOutputTexture;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n    \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",dy=exports.blendTemplateWgsl="\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\nstruct BlendUniforms {\n  uBlend:f32,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n@group(0) @binding(3) var uBackTexture: texture_2d<f32>;\n\n@group(1) @binding(0) var<uniform> blendUniforms : BlendUniforms;\n\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n  \n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition)\n  );\n}\n\n{FUNCTIONS}\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>\n) -> @location(0) vec4<f32> {\n\n\n   var back =  textureSample(uBackTexture, uSampler, uv);\n   var front = textureSample(uTexture, uSampler, uv);\n   var blendedAlpha = front.a + back.a * (1.0 - front.a);\n   \n   var out = vec4<f32>(0.0,0.0,0.0,0.0);\n\n   {MAIN}\n\n   return out;\n}",fy=Object.defineProperty,py=Object.getOwnPropertySymbols,vy=Object.prototype.hasOwnProperty,my=Object.prototype.propertyIsEnumerable,gy=function(e,t,r){return t in e?fy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},_y=function(e,t){for(var r in t||(t={}))vy.call(t,r)&&gy(e,r,t[r]);if(py){var n,i=U(py(t));try{for(i.s();!(n=i.n()).done;){r=n.value;my.call(t,r)&&gy(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},yy=exports.BlendModeFilter=function(e){function t(e){C(this,t);var r=e.gpu,n=xy(_y({source:dy},r)),i=Go.from({vertex:{source:n,entryPoint:"mainVertex"},fragment:{source:n,entryPoint:"mainFragment"}}),a=e.gl,o=xy(_y({source:cy},a));return x(this,t,[{gpuProgram:i,glProgram:To.from({vertex:hy,fragment:o}),blendRequired:!0,resources:{blendUniforms:new Bs({uBlend:{value:1,type:"f32"}}),uBackTexture:bi.EMPTY}}])}return E(t,ly),B(t)}();function xy(e){var t=e.source,r=e.functions,n=e.main;return t.replace("{FUNCTIONS}",r).replace("{MAIN}",n)}var by=exports.hslgl="\n\tfloat getLuminosity(vec3 c) {\n\t\treturn 0.3 * c.r + 0.59 * c.g + 0.11 * c.b;\n\t}\n\n\tvec3 setLuminosity(vec3 c, float lum) {\n\t\tfloat modLum = lum - getLuminosity(c);\n\t\tvec3 color = c.rgb + vec3(modLum);\n\n\t\t// clip back into legal range\n\t\tmodLum = getLuminosity(color);\n\t\tvec3 modLumVec = vec3(modLum);\n\n\t\tfloat cMin = min(color.r, min(color.g, color.b));\n\t\tfloat cMax = max(color.r, max(color.g, color.b));\n\n\t\tif(cMin < 0.0) {\n\t\t\tcolor = mix(modLumVec, color, modLum / (modLum - cMin));\n\t\t}\n\n\t\tif(cMax > 1.0) {\n\t\t\tcolor = mix(modLumVec, color, (1.0 - modLum) / (cMax - modLum));\n\t\t}\n\n\t\treturn color;\n\t}\n\n\tfloat getSaturation(vec3 c) {\n\t\treturn max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));\n\t}\n\n\tvec3 setSaturationMinMidMax(vec3 cSorted, float s) {\n\t\tvec3 colorSorted = cSorted;\n\n\t\tif(colorSorted.z > colorSorted.x) {\n\t\t\tcolorSorted.y = (((colorSorted.y - colorSorted.x) * s) / (colorSorted.z - colorSorted.x));\n\t\t\tcolorSorted.z = s;\n\t\t}\n\t\telse {\n\t\t\tcolorSorted.y = 0.0;\n\t\t\tcolorSorted.z = 0.0;\n\t\t}\n\n\t\tcolorSorted.x = 0.0;\n\n\t\treturn colorSorted;\n\t}\n\n\tvec3 setSaturation(vec3 c, float s) {\n\t\tvec3 color = c;\n\n\t\tif(color.r <= color.g && color.r <= color.b) {\n\t\t\tif(color.g <= color.b) {\n\t\t\t\tcolor = setSaturationMinMidMax(color.rgb, s).rgb;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcolor = setSaturationMinMidMax(color.rbg, s).rbg;\n\t\t\t}\n\t\t}\n\t\telse if(color.g <= color.r && color.g <= color.b) {\n\t\t\tif(color.r <= color.b) {\n\t\t\t\tcolor = setSaturationMinMidMax(color.grb, s).grb;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcolor = setSaturationMinMidMax(color.gbr, s).gbr;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// Using bgr for both fixes part of hue\n\t\t\tif(color.r <= color.g) {\n\t\t\t\tcolor = setSaturationMinMidMax(color.brg, s).brg;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcolor = setSaturationMinMidMax(color.bgr, s).bgr;\n\t\t\t}\n\t\t}\n\n\t\treturn color;\n\t}\n    ",Ty=exports.hslgpu="\n\tfn getLuminosity(c: vec3<f32>) -> f32\n\t{\n\t\treturn 0.3*c.r + 0.59*c.g + 0.11*c.b;\n\t}\n\n\tfn setLuminosity(c: vec3<f32>, lum: f32) -> vec3<f32>\n\t{\n\t\tvar modLum: f32 = lum - getLuminosity(c);\n\t\tvar color: vec3<f32> = c.rgb + modLum;\n\n\t\t// clip back into legal range\n\t\tmodLum = getLuminosity(color);\n\t\tlet modLumVec = vec3<f32>(modLum);\n\n\t\tlet cMin: f32 = min(color.r, min(color.g, color.b));\n\t\tlet cMax: f32 = max(color.r, max(color.g, color.b));\n\n\t\tif(cMin < 0.0)\n\t\t{\n\t\t\tcolor = mix(modLumVec, color, modLum / (modLum - cMin));\n\t\t}\n\n\t\tif(cMax > 1.0)\n\t\t{\n\t\t\tcolor = mix(modLumVec, color, (1 - modLum) / (cMax - modLum));\n\t\t}\n\n\t\treturn color;\n\t}\n\n\tfn getSaturation(c: vec3<f32>) -> f32\n\t{\n\t\treturn max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));\n\t}\n\n\tfn setSaturationMinMidMax(cSorted: vec3<f32>, s: f32) -> vec3<f32>\n\t{\n\t\tvar colorSorted = cSorted;\n\n\t\tif(colorSorted.z > colorSorted.x)\n\t\t{\n\t\t\tcolorSorted.y = (((colorSorted.y - colorSorted.x) * s) / (colorSorted.z - colorSorted.x));\n\t\t\tcolorSorted.z = s;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcolorSorted.y = 0;\n\t\t\tcolorSorted.z = 0;\n\t\t}\n\n\t\tcolorSorted.x = 0;\n\n\t\treturn colorSorted;\n\t}\n\n\tfn setSaturation(c: vec3<f32>, s: f32) -> vec3<f32>\n\t{\n\t\tvar color = c;\n\n\t\tif (color.r <= color.g && color.r <= color.b)\n\t\t{\n\t\t\tif (color.g <= color.b)\n\t\t\t{\n\t\t\t\tcolor = vec3<f32>(setSaturationMinMidMax(color.rgb, s)).rgb;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcolor = vec3<f32>(setSaturationMinMidMax(color.rbg, s)).rbg;\n\t\t\t}\n\t\t}\n\t\telse if (color.g <= color.r && color.g <= color.b)\n\t\t{\n\t\t\tif (color.r <= color.b)\n\t\t\t{\n\t\t\t\tcolor = vec3<f32>(setSaturationMinMidMax(color.grb, s)).grb;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcolor = vec3<f32>(setSaturationMinMidMax(color.gbr, s)).gbr;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// Using bgr for both fixes part of hue\n\t\t\tif (color.r <= color.g)\n\t\t\t{\n\t\t\t\tcolor = vec3<f32>(setSaturationMinMidMax(color.brg, s)).brg;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcolor  = vec3<f32>(setSaturationMinMidMax(color.bgr, s)).bgr;\n\t\t\t}\n\t\t}\n\n\t\treturn color;\n\t}\n\t",Sy=exports.defaultFilterVert="in vec2 aPosition;\nout vec2 vTextureCoord;\n\nuniform vec4 uInputSize;\nuniform vec4 uOutputFrame;\nuniform vec4 uOutputTexture;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n    \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",ky=exports.alphaFrag="\nin vec2 vTextureCoord;\n\nout vec4 finalColor;\n\nuniform float uAlpha;\nuniform sampler2D uTexture;\n\nvoid main()\n{\n    finalColor =  texture(uTexture, vTextureCoord) * uAlpha;\n}\n",Ey=exports.alphaWgsl="struct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\nstruct AlphaUniforms {\n  uAlpha:f32,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n\n@group(1) @binding(0) var<uniform> alphaUniforms : AlphaUniforms;\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getSize() -> vec2<f32>\n{\n  return gfu.uGlobalFrame.zw;\n}\n  \n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition)\n  );\n}\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n \n    var sample = textureSample(uTexture, uSampler, uv);\n    \n    return sample * alphaUniforms.uAlpha;\n}",Ay=Object.defineProperty,wy=Object.defineProperties,Ry=Object.getOwnPropertyDescriptors,Py=Object.getOwnPropertySymbols,My=Object.prototype.hasOwnProperty,Oy=Object.prototype.propertyIsEnumerable,Cy=function(e,t,r){return t in e?Ay(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Gy=function(e,t){for(var r in t||(t={}))My.call(t,r)&&Cy(e,r,t[r]);if(Py){var n,i=U(Py(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Oy.call(t,r)&&Cy(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},By=function(e,t){return wy(e,Ry(t))},Iy=function(e,t){var r={};for(var n in e)My.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Py){var i,a=U(Py(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&Oy.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},Fy=function(e){function t(e){C(this,t),e=Gy(Gy({},t.defaultOptions),e);var r=Go.from({vertex:{source:Ey,entryPoint:"mainVertex"},fragment:{source:Ey,entryPoint:"mainFragment"}}),n=To.from({vertex:Sy,fragment:ky,name:"alpha-filter"}),i=e,a=i.alpha,o=Iy(i,["alpha"]),s=new Bs({uAlpha:{value:a,type:"f32"}});return x(this,t,[By(Gy({},o),{gpuProgram:r,glProgram:n,resources:{alphaUniforms:s}})])}return E(t,ly),B(t,[{key:"alpha",get:function(){return this.resources.alphaUniforms.uniforms.uAlpha},set:function(e){this.resources.alphaUniforms.uniforms.uAlpha=e}}])}();Fy.defaultOptions={alpha:1};var Dy=exports.AlphaFilter=Fy,Uy=exports.GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Ly=["in vec2 vBlurTexCoords[%size%];","uniform sampler2D uTexture;","out vec4 finalColor;","void main(void)","{","    finalColor = vec4(0.0);","    %blur%","}"].join("\n");function Ny(e){for(var t,r=Uy[e],n=r.length,i=Ly,a="",o=0;o<e;o++){var s="finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o.toString());t=o,o>=n&&(t=e-o-1),a+=s=s.replace("%value%",r[t].toString()),a+="\n"}return i=(i=i.replace("%blur%",a)).replace("%size%",e.toString())}var Xy="\n    in vec2 aPosition;\n\n    uniform float uStrength;\n\n    out vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 uInputSize;\n    uniform vec4 uOutputFrame;\n    uniform vec4 uOutputTexture;\n\n    vec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n    \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\n    vec2 filterTextureCoord( void )\n    {\n        return aPosition * (uOutputFrame.zw * uInputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        float pixelStrength = uInputSize.%dimension% * uStrength;\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }";function Hy(e,t){var r,n=Math.ceil(e/2),i=Xy,a="";r=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";for(var o=0;o<e;o++){var s=r.replace("%index%",o.toString());a+=s=s.replace("%sampleIndex%","".concat(o-(n-1),".0")),a+="\n"}return i=(i=(i=i.replace("%blur%",a)).replace("%size%",e.toString())).replace("%dimension%",t?"z":"w")}function jy(e,t){var r=Hy(t,e),n=Ny(t);return To.from({vertex:r,fragment:n,name:"blur-".concat(e?"horizontal":"vertical","-pass-filter")})}var zy=exports.blurTemplateWgsl="\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\nstruct BlurUniforms {\n  uStrength:f32,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n\n@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;\n\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    %blur-struct%\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getSize() -> vec2<f32>\n{\n  return gfu.uGlobalFrame.zw;\n}\n\n\n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n\n  let filteredCord = filterTextureCoord(aPosition);\n\n  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;\n\n  return VSOutput(\n   filterVertexPosition(aPosition),\n    %blur-vertex-out%\n  );\n}\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  %blur-fragment-in%\n) -> @location(0) vec4<f32> {\n\n    var   finalColor = vec4(0.0);\n\n    %blur-sampling%\n\n    return finalColor;\n}";function Vy(e,t){for(var r=Uy[t],n=r.length,i=[],a=[],o=[],s=0;s<t;s++){i[s]="@location(".concat(s,") offset").concat(s,": vec2<f32>,"),a[s]=e?"filteredCord + vec2(".concat(s-n+1," * pixelStrength, 0.0),"):"filteredCord + vec2(0.0, ".concat(s-n+1," * pixelStrength),");var u=r[s<n?s:t-s-1].toString();o[s]="finalColor += textureSample(uTexture, uSampler, offset".concat(s,") * ").concat(u,";")}var l=i.join("\n"),c=a.join("\n"),h=o.join("\n"),d=zy.replace("%blur-struct%",l).replace("%blur-vertex-out%",c).replace("%blur-fragment-in%",l).replace("%blur-sampling%",h).replace("%dimension%",e?"z":"w");return Go.from({vertex:{source:d,entryPoint:"mainVertex"},fragment:{source:d,entryPoint:"mainFragment"}})}var Wy=Object.defineProperty,Yy=Object.getOwnPropertySymbols,Ky=Object.prototype.hasOwnProperty,qy=Object.prototype.propertyIsEnumerable,Zy=function(e,t,r){return t in e?Wy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Qy=function(e,t){for(var r in t||(t={}))Ky.call(t,r)&&Zy(e,r,t[r]);if(Yy){var n,i=U(Yy(t));try{for(i.s();!(n=i.n()).done;){r=n.value;qy.call(t,r)&&Zy(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Jy=function(e){function t(e){var r;C(this,t);var n=jy((e=Qy(Qy({},t.defaultOptions),e)).horizontal,e.kernelSize),i=Vy(e.horizontal,e.kernelSize);return(r=x(this,t,[Qy({glProgram:n,gpuProgram:i,resources:{blurUniforms:{uStrength:{value:0,type:"f32"}}}},e)])).horizontal=e.horizontal,r._quality=0,r.quality=e.quality,r.blur=e.strength,r._uniforms=r.resources.blurUniforms.uniforms,r}return E(t,ly),B(t,[{key:"apply",value:function(e,t,r,n){if(this._uniforms.uStrength=this.strength/this.passes,1===this.passes)e.applyFilter(this,t,r,n);else{var i=Yl.getSameSizeTexture(t),a=t,o=i;this._state.blend=!1;for(var s=e.renderer.type===Ds.WEBGPU,u=0;u<this.passes-1;u++){e.applyFilter(this,a,o,0===u||s);var l=o;o=a,a=l}this._state.blend=!0,e.applyFilter(this,a,r,n),Yl.returnTexture(i)}}},{key:"blur",get:function(){return this.strength},set:function(e){this.padding=1+2*Math.abs(e),this.strength=e}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e}}])}();Jy.defaultOptions={strength:8,quality:4,kernelSize:5};var $y=exports.BlurFilterPass=Jy,ex=Object.defineProperty,tx=Object.defineProperties,rx=Object.getOwnPropertyDescriptors,nx=Object.getOwnPropertySymbols,ix=Object.prototype.hasOwnProperty,ax=Object.prototype.propertyIsEnumerable,ox=function(e,t,r){return t in e?ex(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},sx=function(e,t){for(var r in t||(t={}))ix.call(t,r)&&ox(e,r,t[r]);if(nx){var n,i=U(nx(t));try{for(i.s();!(n=i.n()).done;){r=n.value;ax.call(t,r)&&ox(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},ux=function(e,t){return tx(e,rx(t))},lx=function(e,t){var r={};for(var n in e)ix.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&nx){var i,a=U(nx(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&ax.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},cx=exports.BlurFilter=function(e){function t(){var e,r;C(this,t);var n=null!=(r=arguments.length<=0?void 0:arguments[0])?r:{};"number"==typeof n&&(ht(lt,"BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),n={strength:n},void 0!==(arguments.length<=1?void 0:arguments[1])&&(n.quality=arguments.length<=1?void 0:arguments[1]),void 0!==(arguments.length<=2?void 0:arguments[2])&&(n.resolution=(arguments.length<=2?void 0:arguments[2])||"inherit"),void 0!==(arguments.length<=3?void 0:arguments[3])&&(n.kernelSize=arguments.length<=3?void 0:arguments[3]));var i=n=sx(sx({},$y.defaultOptions),n),a=i.strength,o=i.strengthX,s=i.strengthY,u=i.quality,l=lx(i,["strength","strengthX","strengthY","quality"]);return(e=x(this,t,[ux(sx({},l),{compatibleRenderers:Ds.BOTH,resources:{}})]))._repeatEdgePixels=!1,e.blurXFilter=new $y(sx({horizontal:!0},n)),e.blurYFilter=new $y(sx({horizontal:!1},n)),e.quality=u,e.strengthX=null!=o?o:a,e.strengthY=null!=s?s:a,e.repeatEdgePixels=!1,e}return E(t,ly),B(t,[{key:"apply",value:function(e,t,r,n){var i=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(i&&a){var o=Yl.getSameSizeTexture(t);this.blurXFilter.blendMode="normal",this.blurXFilter.apply(e,t,o,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,o,r,n),Yl.returnTexture(o)}else a?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,t,r,n)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(e,t,r,n))}},{key:"updatePadding",value:function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))}},{key:"strength",get:function(){if(this.strengthX!==this.strengthY)throw new Error("BlurFilter's strengthX and strengthY are different");return this.strengthX},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e}},{key:"strengthX",get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.updatePadding()}},{key:"strengthY",get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.updatePadding()}},{key:"blur",get:function(){return ht("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength},set:function(e){ht("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength=e}},{key:"blurX",get:function(){return ht("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX},set:function(e){ht("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX=e}},{key:"blurY",get:function(){return ht("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY},set:function(e){ht("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY=e}},{key:"repeatEdgePixels",get:function(){return this._repeatEdgePixels},set:function(e){this._repeatEdgePixels=e,this.updatePadding()}}])}();cx.defaultOptions={strength:8,quality:4,kernelSize:5};var hx=exports.colorMatrixFilterFrag="\nin vec2 vTextureCoord;\nin vec4 vColor;\n\nout vec4 finalColor;\n\nuniform float uColorMatrix[20];\nuniform float uAlpha;\n\nuniform sampler2D uTexture;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture(uTexture, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * 0.2);\n    float diff = (randomValue - 0.5) *  0.5;\n\n    if (uAlpha == 0.0) {\n        finalColor = color;\n        return;\n    }\n\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    vec4 result;\n\n    result.r = (uColorMatrix[0] * color.r);\n        result.r += (uColorMatrix[1] * color.g);\n        result.r += (uColorMatrix[2] * color.b);\n        result.r += (uColorMatrix[3] * color.a);\n        result.r += uColorMatrix[4];\n\n    result.g = (uColorMatrix[5] * color.r);\n        result.g += (uColorMatrix[6] * color.g);\n        result.g += (uColorMatrix[7] * color.b);\n        result.g += (uColorMatrix[8] * color.a);\n        result.g += uColorMatrix[9];\n\n    result.b = (uColorMatrix[10] * color.r);\n       result.b += (uColorMatrix[11] * color.g);\n       result.b += (uColorMatrix[12] * color.b);\n       result.b += (uColorMatrix[13] * color.a);\n       result.b += uColorMatrix[14];\n\n    result.a = (uColorMatrix[15] * color.r);\n       result.a += (uColorMatrix[16] * color.g);\n       result.a += (uColorMatrix[17] * color.b);\n       result.a += (uColorMatrix[18] * color.a);\n       result.a += uColorMatrix[19];\n\n    vec3 rgb = mix(color.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    finalColor = vec4(rgb, result.a);\n}\n",dx=exports.colorMatrixFilterWgsl="struct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\nstruct ColorMatrixUniforms {\n  uColorMatrix:array<vec4<f32>, 5>,\n  uAlpha:f32,\n};\n\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n@group(1) @binding(0) var<uniform> colorMatrixUniforms : ColorMatrixUniforms;\n\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>,\n  };\n  \nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition),\n  );\n}\n\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n) -> @location(0) vec4<f32> {\n\n\n  var c = textureSample(uTexture, uSampler, uv);\n  \n  if (colorMatrixUniforms.uAlpha == 0.0) {\n    return c;\n  }\n\n \n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.r /= c.a;\n      c.g /= c.a;\n      c.b /= c.a;\n    }\n\n    var cm = colorMatrixUniforms.uColorMatrix;\n\n\n    var result = vec4<f32>(0.);\n\n    result.r = (cm[0][0] * c.r);\n    result.r += (cm[0][1] * c.g);\n    result.r += (cm[0][2] * c.b);\n    result.r += (cm[0][3] * c.a);\n    result.r += cm[1][0];\n\n    result.g = (cm[1][1] * c.r);\n    result.g += (cm[1][2] * c.g);\n    result.g += (cm[1][3] * c.b);\n    result.g += (cm[2][0] * c.a);\n    result.g += cm[2][1];\n\n    result.b = (cm[2][2] * c.r);\n    result.b += (cm[2][3] * c.g);\n    result.b += (cm[3][0] * c.b);\n    result.b += (cm[3][1] * c.a);\n    result.b += cm[3][2];\n\n    result.a = (cm[3][3] * c.r);\n    result.a += (cm[4][0] * c.g);\n    result.a += (cm[4][1] * c.b);\n    result.a += (cm[4][2] * c.a);\n    result.a += cm[4][3];\n\n    var rgb = mix(c.rgb, result.rgb, colorMatrixUniforms.uAlpha);\n\n    rgb.r *= result.a;\n    rgb.g *= result.a;\n    rgb.b *= result.a;\n\n    return vec4(rgb, result.a);\n}",fx=Object.defineProperty,px=Object.defineProperties,vx=Object.getOwnPropertyDescriptors,mx=Object.getOwnPropertySymbols,gx=Object.prototype.hasOwnProperty,_x=Object.prototype.propertyIsEnumerable,yx=function(e,t,r){return t in e?fx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},xx=function(e,t){for(var r in t||(t={}))gx.call(t,r)&&yx(e,r,t[r]);if(mx){var n,i=U(mx(t));try{for(i.s();!(n=i.n()).done;){r=n.value;_x.call(t,r)&&yx(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},bx=function(e,t){return px(e,vx(t))},Tx=exports.ColorMatrixFilter=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};C(this,t);var n=new Bs({uColorMatrix:{value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],type:"f32",size:20},uAlpha:{value:1,type:"f32"}}),i=Go.from({vertex:{source:dx,entryPoint:"mainVertex"},fragment:{source:dx,entryPoint:"mainFragment"}}),a=To.from({vertex:Sy,fragment:hx,name:"color-matrix-filter"});return(e=x(this,t,[bx(xx({},r),{gpuProgram:i,glProgram:a,resources:{colorMatrixUniforms:n}})])).alpha=1,e}return E(t,ly),B(t,[{key:"_loadMatrix",value:function(e){var t=e;arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(this._multiply(t,this.matrix,e),t=this._colorMatrix(t)),this.resources.colorMatrixUniforms.uniforms.uColorMatrix=t,this.resources.colorMatrixUniforms.update()}},{key:"_multiply",value:function(e,t,r){return e[0]=t[0]*r[0]+t[1]*r[5]+t[2]*r[10]+t[3]*r[15],e[1]=t[0]*r[1]+t[1]*r[6]+t[2]*r[11]+t[3]*r[16],e[2]=t[0]*r[2]+t[1]*r[7]+t[2]*r[12]+t[3]*r[17],e[3]=t[0]*r[3]+t[1]*r[8]+t[2]*r[13]+t[3]*r[18],e[4]=t[0]*r[4]+t[1]*r[9]+t[2]*r[14]+t[3]*r[19]+t[4],e[5]=t[5]*r[0]+t[6]*r[5]+t[7]*r[10]+t[8]*r[15],e[6]=t[5]*r[1]+t[6]*r[6]+t[7]*r[11]+t[8]*r[16],e[7]=t[5]*r[2]+t[6]*r[7]+t[7]*r[12]+t[8]*r[17],e[8]=t[5]*r[3]+t[6]*r[8]+t[7]*r[13]+t[8]*r[18],e[9]=t[5]*r[4]+t[6]*r[9]+t[7]*r[14]+t[8]*r[19]+t[9],e[10]=t[10]*r[0]+t[11]*r[5]+t[12]*r[10]+t[13]*r[15],e[11]=t[10]*r[1]+t[11]*r[6]+t[12]*r[11]+t[13]*r[16],e[12]=t[10]*r[2]+t[11]*r[7]+t[12]*r[12]+t[13]*r[17],e[13]=t[10]*r[3]+t[11]*r[8]+t[12]*r[13]+t[13]*r[18],e[14]=t[10]*r[4]+t[11]*r[9]+t[12]*r[14]+t[13]*r[19]+t[14],e[15]=t[15]*r[0]+t[16]*r[5]+t[17]*r[10]+t[18]*r[15],e[16]=t[15]*r[1]+t[16]*r[6]+t[17]*r[11]+t[18]*r[16],e[17]=t[15]*r[2]+t[16]*r[7]+t[17]*r[12]+t[18]*r[17],e[18]=t[15]*r[3]+t[16]*r[8]+t[17]*r[13]+t[18]*r[18],e[19]=t[15]*r[4]+t[16]*r[9]+t[17]*r[14]+t[18]*r[19]+t[19],e}},{key:"_colorMatrix",value:function(e){var t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}},{key:"brightness",value:function(e,t){var r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)}},{key:"tint",value:function(e,t){var r=R(Ke.shared.setValue(e).toArray(),3),n=[r[0],0,0,0,0,0,r[1],0,0,0,0,0,r[2],0,0,0,0,0,1,0];this._loadMatrix(n,t)}},{key:"greyscale",value:function(e,t){var r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)}},{key:"grayscale",value:function(e,t){this.greyscale(e,t)}},{key:"blackAndWhite",value:function(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)}},{key:"hue",value:function(e,t){e=(e||0)/180*Math.PI;var r=Math.cos(e),n=Math.sin(e),i=1/3,a=(0,Math.sqrt)(i),o=[r+(1-r)*i,i*(1-r)-a*n,i*(1-r)+a*n,0,0,i*(1-r)+a*n,r+i*(1-r),i*(1-r)-a*n,0,0,i*(1-r)-a*n,i*(1-r)+a*n,r+i*(1-r),0,0,0,0,0,1,0];this._loadMatrix(o,t)}},{key:"contrast",value:function(e,t){var r=(e||0)+1,n=-.5*(r-1),i=[r,0,0,0,n,0,r,0,0,n,0,0,r,0,n,0,0,0,1,0];this._loadMatrix(i,t)}},{key:"saturate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,r=2*e/3+1,n=-.5*(r-1),i=[r,n,n,0,0,n,r,n,0,0,n,n,r,0,0,0,0,0,1,0];this._loadMatrix(i,t)}},{key:"desaturate",value:function(){this.saturate(-1)}},{key:"negative",value:function(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)}},{key:"sepia",value:function(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)}},{key:"technicolor",value:function(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)}},{key:"polaroid",value:function(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)}},{key:"toBGR",value:function(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)}},{key:"kodachrome",value:function(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)}},{key:"browni",value:function(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)}},{key:"vintage",value:function(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)}},{key:"colorTone",value:function(e,t,r,n,i){e=e||.2,t=t||.15,r=r||16770432,n=n||3375104;var a=Ke.shared,o=R(a.setValue(r).toArray(),3),s=o[0],u=o[1],l=o[2],c=R(a.setValue(n).toArray(),3),h=c[0],d=c[1],f=c[2],p=[.3,.59,.11,0,0,s,u,l,e,0,h,d,f,t,0,s-h,u-d,l-f,0,0];this._loadMatrix(p,i)}},{key:"night",value:function(e,t){var r=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,t)}},{key:"predator",value:function(e,t){var r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,t)}},{key:"lsd",value:function(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)}},{key:"reset",value:function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}},{key:"matrix",get:function(){return this.resources.colorMatrixUniforms.uniforms.uColorMatrix},set:function(e){this.resources.colorMatrixUniforms.uniforms.uColorMatrix=e}},{key:"alpha",get:function(){return this.resources.colorMatrixUniforms.uniforms.uAlpha},set:function(e){this.resources.colorMatrixUniforms.uniforms.uAlpha=e}}])}(),Sx=exports.displacementFrag="\nin vec2 vTextureCoord;\nin vec2 vFilterUv;\n\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform sampler2D uMapTexture;\n\nuniform vec4 uInputClamp;\nuniform highp vec4 uInputSize;\nuniform mat2 uRotation;\nuniform vec2 uScale;\n\nvoid main()\n{\n    vec4 map = texture(uMapTexture, vFilterUv);\n    \n    vec2 offset = uInputSize.zw * (uRotation * (map.xy - 0.5)) * uScale; \n\n    finalColor = texture(uTexture, clamp(vTextureCoord + offset, uInputClamp.xy, uInputClamp.zw));\n}\n",kx=exports.displacementVert="in vec2 aPosition;\nout vec2 vTextureCoord;\nout vec2 vFilterUv;\n\n\nuniform vec4 uInputSize;\nuniform vec4 uOutputFrame;\nuniform vec4 uOutputTexture;\n\nuniform mat3 uFilterMatrix;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n    \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\n}\n\nvec2 getFilterCoord( void )\n{\n  return ( uFilterMatrix * vec3( filterTextureCoord(), 1.0)  ).xy;\n}\n\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n    vFilterUv = getFilterCoord();\n}\n",Ex=exports.displacementWgsl="\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\nstruct DisplacementUniforms {\n  uFilterMatrix:mat3x3<f32>,\n  uScale:vec2<f32>,\n  uRotation:mat2x2<f32>\n};\n\n\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n\n@group(1) @binding(0) var<uniform> filterUniforms : DisplacementUniforms;\n@group(1) @binding(1) var uMapTexture: texture_2d<f32>;\n@group(1) @binding(2) var uMapSampler : sampler;\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>,\n    @location(1) filterUv : vec2<f32>,\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;\n}\n\nfn getSize() -> vec2<f32>\n{\n\n  \n  return gfu.uGlobalFrame.zw;\n}\n  \n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition),\n   getFilterCoord(aPosition)\n  );\n}\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @location(1) filterUv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n\n    var map = textureSample(uMapTexture, uMapSampler, filterUv);\n\n    var offset =  gfu.uInputSize.zw * (filterUniforms.uRotation * (map.xy - 0.5)) * filterUniforms.uScale; \n   \n    return textureSample(uTexture, uSampler, clamp(uv + offset, gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n}",Ax=Object.defineProperty,wx=Object.defineProperties,Rx=Object.getOwnPropertyDescriptors,Px=Object.getOwnPropertySymbols,Mx=Object.prototype.hasOwnProperty,Ox=Object.prototype.propertyIsEnumerable,Cx=function(e,t,r){return t in e?Ax(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Gx=function(e,t){for(var r in t||(t={}))Mx.call(t,r)&&Cx(e,r,t[r]);if(Px){var n,i=U(Px(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Ox.call(t,r)&&Cx(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Bx=function(e,t){return wx(e,Rx(t))},Ix=function(e,t){var r={};for(var n in e)Mx.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Px){var i,a=U(Px(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&Ox.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},Fx=exports.DisplacementFilter=function(e){function t(){var e;C(this,t);var r=arguments.length<=0?void 0:arguments[0];r instanceof Fi&&((arguments.length<=1?void 0:arguments[1])&&ht(lt,"DisplacementFilter now uses options object instead of params. {sprite, scale}"),r={sprite:r,scale:arguments.length<=1?void 0:arguments[1]});var n=r,i=n.sprite,a=n.scale,o=Ix(n,["sprite","scale"]),s=null!=a?a:20;"number"==typeof s&&(s=new $e(s,s));var u=new Bs({uFilterMatrix:{value:new tt,type:"mat3x3<f32>"},uScale:{value:s,type:"vec2<f32>"},uRotation:{value:new Float32Array([0,0,0,0]),type:"mat2x2<f32>"}}),l=To.from({vertex:kx,fragment:Sx,name:"displacement-filter"}),c=Go.from({vertex:{source:Ex,entryPoint:"mainVertex"},fragment:{source:Ex,entryPoint:"mainFragment"}}),h=i.texture.source;return(e=x(this,t,[Bx(Gx({},o),{gpuProgram:c,glProgram:l,resources:{filterUniforms:u,uMapTexture:h,uMapSampler:h.style}})]))._sprite=r.sprite,e._sprite.renderable=!1,e}return E(t,ly),B(t,[{key:"apply",value:function(e,t,r,n){var i=this.resources.filterUniforms.uniforms;e.calculateSpriteMatrix(i.uFilterMatrix,this._sprite);var a=this._sprite.worldTransform,o=Math.sqrt(a.a*a.a+a.b*a.b),s=Math.sqrt(a.c*a.c+a.d*a.d);0!==o&&0!==s&&(i.uRotation[0]=a.a/o,i.uRotation[1]=a.b/o,i.uRotation[2]=a.c/s,i.uRotation[3]=a.d/s),this.resources.uMapTexture=this._sprite.texture.source,e.applyFilter(this,t,r,n)}},{key:"scale",get:function(){return this.resources.filterUniforms.uniforms.uScale}}])}(),Dx=exports.noiseFrag="\nin vec2 vTextureCoord;\nin vec4 vColor;\n\nout vec4 finalColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uTexture;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture(uTexture, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) *  uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    finalColor = color;\n}\n",Ux=exports.noiseWgsl="\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\nstruct NoiseUniforms {\n  uNoise:f32,\n  uSeed:f32,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n\n@group(1) @binding(0) var<uniform> noiseUniforms : NoiseUniforms;\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getSize() -> vec2<f32>\n{\n  return gfu.uGlobalFrame.zw;\n}\n  \n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition)\n  );\n}\n\nfn rand(co:vec2<f32>) -> f32\n{\n  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\n\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n\n    var pixelPosition =  globalTextureCoord(position.xy);// / (getSize());//-  gfu.uOutputFrame.xy);\n  \n    \n    var sample = textureSample(uTexture, uSampler, uv);\n    var randomValue =  rand(pixelPosition.xy * noiseUniforms.uSeed);\n    var diff = (randomValue - 0.5) * noiseUniforms.uNoise;\n  \n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (sample.a > 0.0) {\n      sample.r /= sample.a;\n      sample.g /= sample.a;\n      sample.b /= sample.a;\n    }\n\n    sample.r += diff;\n    sample.g += diff;\n    sample.b += diff;\n\n    // Premultiply alpha again.\n    sample.r *= sample.a;\n    sample.g *= sample.a;\n    sample.b *= sample.a;\n    \n    return sample;\n}",Lx=Object.defineProperty,Nx=Object.defineProperties,Xx=Object.getOwnPropertyDescriptors,Hx=Object.getOwnPropertySymbols,jx=Object.prototype.hasOwnProperty,zx=Object.prototype.propertyIsEnumerable,Vx=function(e,t,r){return t in e?Lx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Wx=function(e,t){for(var r in t||(t={}))jx.call(t,r)&&Vx(e,r,t[r]);if(Hx){var n,i=U(Hx(t));try{for(i.s();!(n=i.n()).done;){r=n.value;zx.call(t,r)&&Vx(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Yx=function(e,t){return Nx(e,Xx(t))},Kx=function(e,t){var r={};for(var n in e)jx.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Hx){var i,a=U(Hx(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&zx.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},qx=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};C(this,t),r=Wx(Wx({},t.defaultOptions),r);var n=Go.from({vertex:{source:Ux,entryPoint:"mainVertex"},fragment:{source:Ux,entryPoint:"mainFragment"}}),i=To.from({vertex:Sy,fragment:Dx,name:"noise-filter"}),a=r,o=a.noise,s=a.seed,u=Kx(a,["noise","seed"]);return(e=x(this,t,[Yx(Wx({},u),{gpuProgram:n,glProgram:i,resources:{noiseUniforms:new Bs({uNoise:{value:1,type:"f32"},uSeed:{value:1,type:"f32"}})}})])).noise=o,e.seed=null!=s?s:Math.random(),e}return E(t,ly),B(t,[{key:"noise",get:function(){return this.resources.noiseUniforms.uniforms.uNoise},set:function(e){this.resources.noiseUniforms.uniforms.uNoise=e}},{key:"seed",get:function(){return this.resources.noiseUniforms.uniforms.uSeed},set:function(e){this.resources.noiseUniforms.uniforms.uSeed=e}}])}();qx.defaultOptions={noise:.5};var Zx=exports.NoiseFilter=qx,Qx=exports.maskFrag="in vec2 vMaskCoord;\nin vec2 vTextureCoord;\n\nuniform sampler2D uTexture;\nuniform sampler2D uMaskTexture;\n\nuniform float uAlpha;\nuniform vec4 uMaskClamp;\n\nout vec4 finalColor;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(uMaskClamp.x, vMaskCoord.x) +\n        step(uMaskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, uMaskClamp.z) +\n        step(vMaskCoord.y, uMaskClamp.w));\n\n    // TODO look into why this is needed\n    float npmAlpha = uAlpha; \n    vec4 original = texture(uTexture, vTextureCoord);\n    vec4 masky = texture(uMaskTexture, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * uAlpha * clip);\n\n    finalColor = original;\n}\n",Jx=exports.maskVert="in vec2 aPosition;\n\nout vec2 vTextureCoord;\nout vec2 vMaskCoord;\n\n\nuniform vec4 uInputSize;\nuniform vec4 uOutputFrame;\nuniform vec4 uOutputTexture;\nuniform mat3 uFilterMatrix;\n\nvec4 filterVertexPosition(  vec2 aPosition )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n       \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(  vec2 aPosition )\n{\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\n}\n\nvec2 getFilterCoord( vec2 aPosition )\n{\n    return  ( uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;\n}   \n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition(aPosition);\n    vTextureCoord = filterTextureCoord(aPosition);\n    vMaskCoord = getFilterCoord(aPosition);\n}\n",$x=exports.maskWgsl="struct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,  \n};\n\nstruct MaskUniforms {\n  uFilterMatrix:mat3x3<f32>,\n  uMaskClamp:vec4<f32>,\n  uAlpha:f32,\n};\n\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n\n@group(1) @binding(0) var<uniform> filterUniforms : MaskUniforms;\n@group(1) @binding(1) var uMaskTexture: texture_2d<f32>;\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>,\n    @location(1) filterUv : vec2<f32>,\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;\n}\n\nfn getSize() -> vec2<f32>\n{\n\n  \n  return gfu.uGlobalFrame.zw;\n}\n  \n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition),\n   getFilterCoord(aPosition)\n  );\n}\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @location(1) filterUv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n\n    var maskClamp = filterUniforms.uMaskClamp;\n\n     var clip = step(3.5,\n        step(maskClamp.x, filterUv.x) +\n        step(maskClamp.y, filterUv.y) +\n        step(filterUv.x, maskClamp.z) +\n        step(filterUv.y, maskClamp.w));\n\n    var mask = textureSample(uMaskTexture, uSampler, filterUv);\n    var source = textureSample(uTexture, uSampler, uv);\n    \n    var npmAlpha = 0.0;\n\n    var alphaMul = 1.0 - npmAlpha * (1.0 - mask.a);\n\n    var a = (alphaMul * mask.r) * clip;\n\n    return vec4(source.rgb, source.a) * a;\n}",eb=Object.defineProperty,tb=Object.defineProperties,rb=Object.getOwnPropertyDescriptors,nb=Object.getOwnPropertySymbols,ib=Object.prototype.hasOwnProperty,ab=Object.prototype.propertyIsEnumerable,ob=function(e,t,r){return t in e?eb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},sb=function(e,t){for(var r in t||(t={}))ib.call(t,r)&&ob(e,r,t[r]);if(nb){var n,i=U(nb(t));try{for(i.s();!(n=i.n()).done;){r=n.value;ab.call(t,r)&&ob(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},ub=function(e,t){return tb(e,rb(t))},lb=function(e,t){var r={};for(var n in e)ib.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&nb){var i,a=U(nb(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&ab.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},cb=exports.MaskFilter=function(e){function t(e){var r;C(this,t);var n=e,i=n.sprite,a=lb(n,["sprite"]),o=new xi(i.texture),s=new Bs({uFilterMatrix:{value:new tt,type:"mat3x3<f32>"},uMaskClamp:{value:o.uClampFrame,type:"vec4<f32>"},uAlpha:{value:1,type:"f32"}}),u=Go.from({vertex:{source:$x,entryPoint:"mainVertex"},fragment:{source:$x,entryPoint:"mainFragment"}}),l=To.from({vertex:Jx,fragment:Qx,name:"mask-filter"});return(r=x(this,t,[ub(sb({},a),{gpuProgram:u,glProgram:l,resources:{filterUniforms:s,uMaskTexture:i.texture.source}})])).sprite=i,r._textureMatrix=o,r}return E(t,ly),B(t,[{key:"apply",value:function(e,t,r,n){this._textureMatrix.texture=this.sprite.texture,e.calculateSpriteMatrix(this.resources.filterUniforms.uniforms.uFilterMatrix,this.sprite).prepend(this._textureMatrix.mapCoord),this.resources.uMaskTexture=this.sprite.texture.source,e.applyFilter(this,t,r,n)}}])}(),hb=exports.hslWgsl="fn getLuminosity(c: vec3<f32>) -> f32 {\n  return 0.3 * c.r + 0.59 * c.g + 0.11 * c.b;\n}\n\nfn setLuminosity(c: vec3<f32>, lum: f32) -> vec3<f32> {\n  let d: f32 = lum - getLuminosity(c);\n  let newColor: vec3<f32> = c.rgb + vec3<f32>(d, d, d);\n\n  // clip back into legal range\n  let newLum: f32 = getLuminosity(newColor);\n  let cMin: f32 = min(newColor.r, min(newColor.g, newColor.b));\n  let cMax: f32 = max(newColor.r, max(newColor.g, newColor.b));\n\n  let t1: f32 = newLum / (newLum - cMin);\n  let t2: f32 = (1.0 - newLum) / (cMax - newLum);\n\n  let finalColor = mix(vec3<f32>(newLum, newLum, newLum), newColor, select(select(1.0, t2, cMax > 1.0), t1, cMin < 0.0));\n\n  return finalColor;\n}\n\nfn getSaturation(c: vec3<f32>) -> f32 {\n  return max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));\n}\n\n// Set saturation if color components are sorted in ascending order.\nfn setSaturationMinMidMax(cSorted: vec3<f32>, s: f32) -> vec3<f32> {\n  var result: vec3<f32>;\n  if (cSorted.z > cSorted.x) {\n    let newY = (((cSorted.y - cSorted.x) * s) / (cSorted.z - cSorted.x));\n    result = vec3<f32>(0.0, newY, s);\n  } else {\n    result = vec3<f32>(0.0, 0.0, 0.0);\n  }\n  return vec3<f32>(result.x, result.y, result.z);\n}\n\nfn setSaturation(c: vec3<f32>, s: f32) -> vec3<f32> {\n    var result: vec3<f32> = c;\n\n    if (c.r <= c.g && c.r <= c.b) {\n        if (c.g <= c.b) {\n            result = setSaturationMinMidMax(result, s);\n        } else {\n            var temp: vec3<f32> = vec3<f32>(result.r, result.b, result.g);\n            temp = setSaturationMinMidMax(temp, s);\n            result = vec3<f32>(temp.r, temp.b, temp.g);\n        }\n    } else if (c.g <= c.r && c.g <= c.b) {\n        if (c.r <= c.b) {\n            var temp: vec3<f32> = vec3<f32>(result.g, result.r, result.b);\n            temp = setSaturationMinMidMax(temp, s);\n            result = vec3<f32>(temp.g, temp.r, temp.b);\n        } else {\n            var temp: vec3<f32> = vec3<f32>(result.g, result.b, result.r);\n            temp = setSaturationMinMidMax(temp, s);\n            result = vec3<f32>(temp.g, temp.b, temp.r);\n        }\n    } else {\n        if (c.r <= c.g) {\n            var temp: vec3<f32> = vec3<f32>(result.b, result.r, result.g);\n            temp = setSaturationMinMidMax(temp, s);\n            result = vec3<f32>(temp.b, temp.r, temp.g);\n        } else {\n            var temp: vec3<f32> = vec3<f32>(result.b, result.g, result.r);\n            temp = setSaturationMinMidMax(temp, s);\n            result = vec3<f32>(temp.b, temp.g, temp.r);\n        }\n    }\n\n    return result;\n}";function db(e,t,r,n,i,a,o,s){var u=o-r,l=s-n,c=i-r,h=a-n,d=e-r,f=t-n,p=u*u+l*l,v=u*c+l*h,m=u*d+l*f,g=c*c+h*h,_=c*d+h*f,y=1/(p*g-v*v),x=(g*m-v*_)*y,b=(p*_-v*m)*y;return x>=0&&b>=0&&x+b<1}var fb=exports.Triangle=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;C(this,e),this.type="triangle",this.x=t,this.y=r,this.x2=n,this.y2=i,this.x3=a,this.y3=o}return B(e,[{key:"contains",value:function(e,t){var r=(this.x-this.x3)*(t-this.y3)-(this.y-this.y3)*(e-this.x3),n=(this.x2-this.x)*(t-this.y)-(this.y2-this.y)*(e-this.x);if(r<0!=n<0&&0!==r&&0!==n)return!1;var i=(this.x3-this.x2)*(t-this.y2)-(this.y3-this.y2)*(e-this.x2);return 0===i||i<0==r+n<=0}},{key:"strokeContains",value:function(e,t,r){var n=r/2,i=n*n,a=this.x,o=this.x2,s=this.x3,u=this.y,l=this.y2,c=this.y3;return hc(e,t,a,u,o,c)<=i||hc(e,t,o,l,s,c)<=i||hc(e,t,s,c,a,u)<=i}},{key:"clone",value:function(){return new e(this.x,this.y,this.x2,this.y2,this.x3,this.y3)}},{key:"copyFrom",value:function(e){return this.x=e.x,this.y=e.y,this.x2=e.x2,this.y2=e.y2,this.x3=e.x3,this.y3=e.y3,this}},{key:"copyTo",value:function(e){return e.copyFrom(this),e}},{key:"getBounds",value:function(e){e=e||new St;var t=Math.min(this.x,this.x2,this.x3),r=Math.max(this.x,this.x2,this.x3),n=Math.min(this.y,this.y2,this.y3),i=Math.max(this.y,this.y2,this.y3);return e.x=t,e.y=n,e.width=r-t,e.height=i-n,e}}])}(),pb=function(){return B(function e(t){var r=this;C(this,e),this._tick=function(){r.timeout=setTimeout(r._processQueue,0)},this._processQueue=function(){for(var t=r.queue,n=0;t.length&&n<e.uploadsPerFrame;){var i=t.shift();r.uploadQueueItem(i),n++}t.length?Lr.system.addOnce(r._tick,r,Fr.UTILITY):r._resolve()},this.renderer=t,this.queue=[],this.resolves=[]},[{key:"getQueue",value:function(){return m(this.queue)}},{key:"add",value:function(e){var t,r=U(Array.isArray(e)?e:[e]);try{for(r.s();!(t=r.n()).done;){var n=t.value;n instanceof tr?this._addContainer(n):this.resolveQueueItem(n,this.queue)}}catch(i){r.e(i)}finally{r.f()}return this}},{key:"_addContainer",value:function(e){this.resolveQueueItem(e,this.queue);var t,r=U(e.children);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._addContainer(n)}}catch(i){r.e(i)}finally{r.f()}}},{key:"upload",value:function(e){var t=this;return e&&this.add(e),new Promise(function(e){t.queue.length?(t.resolves.push(e),t.dedupeQueue(),Lr.system.addOnce(t._tick,t,Fr.UTILITY)):e()})}},{key:"dedupeQueue",value:function(){for(var e=Object.create(null),t=0,r=0;r<this.queue.length;r++){var n=this.queue[r];e[n.uid]||(e[n.uid]=!0,this.queue[t++]=n)}this.queue.length=t}},{key:"_resolve",value:function(){var e=this.resolves,t=e.slice(0);e.length=0;var r,n=U(t);try{for(n.s();!(r=n.n()).done;){(0,r.value)()}}catch(i){n.e(i)}finally{n.f()}}}])}();pb.uploadsPerFrame=4;var vb=exports.PrepareBase=pb,mb=Object.defineProperty,gb=Object.getOwnPropertySymbols,_b=Object.prototype.hasOwnProperty,yb=Object.prototype.propertyIsEnumerable,xb=function(e,t,r){return t in e?mb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},bb=function(e,t){for(var r in t||(t={}))_b.call(t,r)&&xb(e,r,t[r]);if(gb){var n,i=U(gb(t));try{for(i.s();!(n=i.n()).done;){r=n.value;yb.call(t,r)&&xb(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Tb=function(e,t){var r={};for(var n in e)_b.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&gb){var i,a=U(gb(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&yb.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},Sb=exports.Mesh=function(e){function t(){var e,r;C(this,t);var n=arguments.length<=0?void 0:arguments[0];n instanceof Qa&&(ht(lt,"Mesh: use new Mesh({ geometry, shader }) instead"),n={geometry:n,shader:arguments.length<=1?void 0:arguments[1]},(arguments.length<=3?void 0:arguments[3])&&(ht(lt,"Mesh: drawMode argument has been removed, use geometry.topology instead"),n.geometry.topology=arguments.length<=3?void 0:arguments[3]));var i=n,a=i.geometry,o=i.shader,s=i.texture,u=i.roundPixels,l=i.state,c=Tb(i,["geometry","shader","texture","roundPixels","state"]);return(e=x(this,t,[bb({label:"Mesh"},c)])).renderPipeId="mesh",e._shader=null,e.allowChildren=!1,e.shader=null!=o?o:null,e.texture=null!=(r=null!=s?s:null==o?void 0:o.texture)?r:bi.WHITE,e.state=null!=l?l:Al.for2d(),e._geometry=a,e._geometry.on("update",e.onViewUpdate,e),e.roundPixels=null!=u&&u,e}return E(t,Ri),B(t,[{key:"material",get:function(){return ht(lt,"mesh.material property has been removed, use mesh.shader instead"),this._shader}},{key:"shader",get:function(){return this._shader},set:function(e){this._shader!==e&&(this._shader=e,this.onViewUpdate())}},{key:"geometry",get:function(){return this._geometry},set:function(e){var t;this._geometry!==e&&(null==(t=this._geometry)||t.off("update",this.onViewUpdate,this),e.on("update",this.onViewUpdate,this),this._geometry=e,this.onViewUpdate())}},{key:"texture",get:function(){return this._texture},set:function(e){e||(e=bi.EMPTY);var t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this.shader&&(this.shader.texture=e),this._texture=e,this.onViewUpdate())}},{key:"batched",get:function(){return!this._shader&&(0==(12&this.state.data)&&(this._geometry instanceof Pf&&("auto"===this._geometry.batchMode?this._geometry.positions.length/2<=100:"batch"===this._geometry.batchMode)))}},{key:"bounds",get:function(){return this._geometry.bounds}},{key:"addBounds",value:function(e){e.addBounds(this.geometry.bounds)}},{key:"containsPoint",value:function(e){var t=e.x,r=e.y;if(!this.bounds.containsPoint(t,r))return!1;var n=this.geometry.getBuffer("aPosition").data,i="triangle-strip"===this.geometry.topology?3:1;if(this.geometry.getIndex())for(var a=this.geometry.getIndex().data,o=a.length,s=0;s+2<o;s+=i){var u=2*a[s],l=2*a[s+1],c=2*a[s+2];if(db(t,r,n[u],n[u+1],n[l],n[l+1],n[c],n[c+1]))return!0}else for(var h=n.length/2,d=0;d+2<h;d+=i){var f=2*d,p=2*(d+1),v=2*(d+2);if(db(t,r,n[f],n[f+1],n[p],n[p+1],n[v],n[v+1]))return!0}return!1}},{key:"onViewUpdate",value:function(){if(this._didViewChangeTick++,!this.didViewUpdate){this.didViewUpdate=!0;var e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}}},{key:"destroy",value:function(e){var r;if(c(t,"destroy",this,3)([e]),"boolean"==typeof e?e:null==e?void 0:e.texture){var n="boolean"==typeof e?e:null==e?void 0:e.textureSource;this._texture.destroy(n)}null==(r=this._geometry)||r.off("update",this.onViewUpdate,this),this._texture=null,this._geometry=null,this._shader=null}}])}(),kb=Object.defineProperty,Eb=Object.defineProperties,Ab=Object.getOwnPropertyDescriptors,wb=Object.getOwnPropertySymbols,Rb=Object.prototype.hasOwnProperty,Pb=Object.prototype.propertyIsEnumerable,Mb=function(e,t,r){return t in e?kb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Ob=function(e,t){for(var r in t||(t={}))Rb.call(t,r)&&Mb(e,r,t[r]);if(wb){var n,i=U(wb(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Pb.call(t,r)&&Mb(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Cb=function(e,t){return Eb(e,Ab(t))},Gb=function(e,t){var r={};for(var n in e)Rb.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&wb){var i,a=U(wb(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&Pb.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},Bb=exports.AnimatedSprite=function(e){function t(){var e;C(this,t);var r=arguments.length<=0?void 0:arguments[0];Array.isArray(arguments.length<=0?void 0:arguments[0])&&(r={textures:arguments.length<=0?void 0:arguments[0],autoUpdate:arguments.length<=1?void 0:arguments[1]});var n=r,i=n.textures,a=n.autoUpdate,o=Gb(n,["textures","autoUpdate"]),s=R(i,1)[0];return(e=x(this,t,[Cb(Ob({},o),{texture:s instanceof bi?s:s.texture})]))._textures=null,e._durations=null,e._autoUpdate=null==a||a,e._isConnectedToTicker=!1,e.animationSpeed=1,e.loop=!0,e.updateAnchor=!1,e.onComplete=null,e.onFrameChange=null,e.onLoop=null,e._currentTime=0,e._playing=!1,e._previousFrame=null,e.textures=i,e}return E(t,Fi),B(t,[{key:"stop",value:function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Lr.shared.remove(this.update,this),this._isConnectedToTicker=!1))}},{key:"play",value:function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Lr.shared.add(this.update,this,Fr.HIGH),this._isConnectedToTicker=!0))}},{key:"gotoAndStop",value:function(e){this.stop(),this.currentFrame=e}},{key:"gotoAndPlay",value:function(e){this.currentFrame=e,this.play()}},{key:"update",value:function(e){if(this._playing){var t=e.deltaTime,r=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=r/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var a=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*a,this._currentTime+=a;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=r;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this._updateTexture())}}},{key:"_updateTexture",value:function(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this.texture=this._textures[e],this.updateAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}},{key:"destroy",value:function(){this.stop(),c(t,"destroy",this,3)([]),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}},{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(e){if(e[0]instanceof bi)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}},{key:"currentFrame",get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},set:function(e){if(e<0||e>this.totalFrames-1)throw new Error("[AnimatedSprite]: Invalid frame index value ".concat(e,", expected to be between 0 and totalFrames ").concat(this.totalFrames,"."));var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this._updateTexture()}},{key:"playing",get:function(){return this._playing}},{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Lr.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Lr.shared.add(this.update,this),this._isConnectedToTicker=!0))}}],[{key:"fromFrames",value:function(e){for(var r=[],n=0;n<e.length;++n)r.push(bi.from(e[n]));return new t(r)}},{key:"fromImages",value:function(e){for(var r=[],n=0;n<e.length;++n)r.push(bi.from(e[n]));return new t(r)}}])}(),Ib=exports.Transform=function(){return B(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.matrix,n=t.observer;C(this,e),this.dirty=!0,this._matrix=null!=r?r:new tt,this.observer=n,this.position=new it(this,0,0),this.scale=new it(this,1,1),this.pivot=new it(this,0,0),this.skew=new it(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1},[{key:"matrix",get:function(){var e=this._matrix;return this.dirty?(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this.dirty=!1,e):e}},{key:"_onUpdate",value:function(e){var t;this.dirty=!0,e===this.skew&&this.updateSkew(),null==(t=this.observer)||t._onUpdate(this)}},{key:"updateSkew",value:function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}},{key:"toString",value:function(){return"[pixi.js/math:Transform position=(".concat(this.position.x,", ").concat(this.position.y,") rotation=").concat(this.rotation," scale=(").concat(this.scale.x,", ").concat(this.scale.y,") skew=(").concat(this.skew.x,", ").concat(this.skew.y,") ]")}},{key:"setFromMatrix",value:function(e){e.decompose(this),this.dirty=!0}},{key:"rotation",get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this.skew))}}])}(),Fb=Object.defineProperty,Db=Object.getOwnPropertySymbols,Ub=Object.prototype.hasOwnProperty,Lb=Object.prototype.propertyIsEnumerable,Nb=function(e,t,r){return t in e?Fb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Xb=function(e,t){for(var r in t||(t={}))Ub.call(t,r)&&Nb(e,r,t[r]);if(Db){var n,i=U(Db(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Lb.call(t,r)&&Nb(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Hb=function(e,t){var r={};for(var n in e)Ub.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Db){var i,a=U(Db(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&Lb.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},jb=function(e){function t(){var e;C(this,t);var r=(arguments.length<=0?void 0:arguments[0])||{};r instanceof bi&&(r={texture:r}),arguments.length>1&&(ht(lt,"use new TilingSprite({ texture, width:100, height:100 }) instead"),r.width=arguments.length<=1?void 0:arguments[1],r.height=arguments.length<=2?void 0:arguments[2]);var n=null!=(r=Xb(Xb({},t.defaultOptions),r))?r:{},i=n.texture,a=n.anchor,o=n.tilePosition,s=n.tileScale,u=n.tileRotation,l=n.width,c=n.height,h=n.applyAnchorToTexture,d=n.roundPixels,f=Hb(n,["texture","anchor","tilePosition","tileScale","tileRotation","width","height","applyAnchorToTexture","roundPixels"]);return(e=x(this,t,[Xb({label:"TilingSprite"},f)])).renderPipeId="tilingSprite",e.batched=!0,e.allowChildren=!1,e._anchor=new it({_onUpdate:function(){e.onViewUpdate()}}),e._applyAnchorToTexture=h,e.texture=i,e._width=null!=l?l:i.width,e._height=null!=c?c:i.height,e._tileTransform=new Ib({observer:{_onUpdate:function(){return e.onViewUpdate()}}}),a&&(e.anchor=a),e.tilePosition=o,e.tileScale=s,e.tileRotation=u,e.roundPixels=null!=d&&d,e}return E(t,Ri),B(t,[{key:"clampMargin",get:function(){return this._texture.textureMatrix.clampMargin},set:function(e){this._texture.textureMatrix.clampMargin=e}},{key:"anchor",get:function(){return this._anchor},set:function(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)}},{key:"tilePosition",get:function(){return this._tileTransform.position},set:function(e){this._tileTransform.position.copyFrom(e)}},{key:"tileScale",get:function(){return this._tileTransform.scale},set:function(e){"number"==typeof e?this._tileTransform.scale.set(e):this._tileTransform.scale.copyFrom(e)}},{key:"tileRotation",get:function(){return this._tileTransform.rotation},set:function(e){this._tileTransform.rotation=e}},{key:"tileTransform",get:function(){return this._tileTransform}},{key:"bounds",get:function(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}},{key:"texture",get:function(){return this._texture},set:function(e){e||(e=bi.EMPTY);var t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this.onViewUpdate())}},{key:"width",get:function(){return this._width},set:function(e){this._width=e,this.onViewUpdate()}},{key:"height",get:function(){return this._height},set:function(e){this._height=e,this.onViewUpdate()}},{key:"setSize",value:function(e,t){var r;"object"===D(e)&&(t=null!=(r=e.height)?r:e.width,e=e.width),this._width=e,this._height=null!=t?t:e,this.onViewUpdate()}},{key:"getSize",value:function(e){return e||(e={}),e.width=this._width,e.height=this._height,e}},{key:"_updateBounds",value:function(){var e=this._bounds,t=this._anchor,r=this._width,n=this._height;e.maxX=-t._x*r,e.minX=e.maxX+r,e.maxY=-t._y*n,e.minY=e.maxY+n}},{key:"addBounds",value:function(e){var t=this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}},{key:"containsPoint",value:function(e){var t=this._width,r=this._height,n=-t*this._anchor._x,i=0;return e.x>=n&&e.x<=n+t&&(i=-r*this._anchor._y,e.y>=i&&e.y<=i+r)}},{key:"onViewUpdate",value:function(){if(this._boundsDirty=!0,this._didTilingSpriteUpdate=!0,this._didViewChangeTick++,!this.didViewUpdate){this.didViewUpdate=!0;var e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(c(t,"destroy",this,3)([e]),this._anchor=null,this._tileTransform=null,this._bounds=null,"boolean"==typeof e?e:null==e?void 0:e.texture){var r="boolean"==typeof e?e:null==e?void 0:e.textureSource;this._texture.destroy(r)}this._texture=null}}],[{key:"from",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new t(Xb("string"==typeof e?{texture:sa.get(e)}:{texture:e},r))}}])}();jb.defaultOptions={texture:bi.EMPTY,anchor:{x:0,y:0},tilePosition:{x:0,y:0},tileScale:{x:1,y:1},tileRotation:0,applyAnchorToTexture:!1};var zb=exports.TilingSprite=jb,Vb=Object.defineProperty,Wb=Object.getOwnPropertySymbols,Yb=Object.prototype.hasOwnProperty,Kb=Object.prototype.propertyIsEnumerable,qb=function(e,t,r){return t in e?Vb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Zb=function(e,t){for(var r in t||(t={}))Yb.call(t,r)&&qb(e,r,t[r]);if(Wb){var n,i=U(Wb(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Kb.call(t,r)&&qb(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Qb=function(e,t){var r={};for(var n in e)Yb.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&Wb){var i,a=U(Wb(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&Kb.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},Jb=exports.AbstractText=function(e){function t(e,r){var n;C(this,t);var i=e,a=i.text,o=i.resolution,s=i.style,u=i.anchor,l=i.width,c=i.height,h=i.roundPixels,d=Qb(i,["text","resolution","style","anchor","width","height","roundPixels"]);return(n=x(this,t,[Zb({},d)])).batched=!0,n._resolution=null,n._autoResolution=!0,n._didTextUpdate=!0,n._styleClass=r,n.text=null!=a?a:"",n.style=s,n.resolution=null!=o?o:null,n.allowChildren=!1,n._anchor=new it({_onUpdate:function(){n.onViewUpdate()}}),u&&(n.anchor=u),n.roundPixels=null!=h&&h,void 0!==l&&(n.width=l),void 0!==c&&(n.height=c),n}return E(t,Ri),B(t,[{key:"anchor",get:function(){return this._anchor},set:function(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)}},{key:"text",get:function(){return this._text},set:function(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}},{key:"resolution",get:function(){return this._resolution},set:function(e){this._autoResolution=null===e,this._resolution=e,this.onViewUpdate()}},{key:"style",get:function(){return this._style},set:function(e){var t;e=e||{},null==(t=this._style)||t.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}},{key:"bounds",get:function(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}},{key:"width",get:function(){return Math.abs(this.scale.x)*this.bounds.width},set:function(e){this._setWidth(e,this.bounds.width)}},{key:"height",get:function(){return Math.abs(this.scale.y)*this.bounds.height},set:function(e){this._setHeight(e,this.bounds.height)}},{key:"getSize",value:function(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}},{key:"setSize",value:function(e,t){var r;"object"===D(e)?(t=null!=(r=e.height)?r:e.width,e=e.width):null!=t||(t=e),void 0!==e&&this._setWidth(e,this.bounds.width),void 0!==t&&this._setHeight(t,this.bounds.height)}},{key:"addBounds",value:function(e){var t=this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}},{key:"containsPoint",value:function(e){var t=this.bounds.width,r=this.bounds.height,n=-t*this.anchor.x,i=0;return e.x>=n&&e.x<=n+t&&(i=-r*this.anchor.y,e.y>=i&&e.y<=i+r)}},{key:"onViewUpdate",value:function(){if(this._didViewChangeTick++,this._boundsDirty=!0,!this.didViewUpdate){this.didViewUpdate=!0,this._didTextUpdate=!0;var e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}}},{key:"_getKey",value:function(){return"".concat(this.text,":").concat(this._style.styleKey,":").concat(this._resolution)}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c(t,"destroy",this,3)([e]),this.owner=null,this._bounds=null,this._anchor=null,("boolean"==typeof e?e:null==e?void 0:e.style)&&this._style.destroy(e),this._style=null,this._text=null}}])}();function $b(e,t){var r,n=null!=(r=e[0])?r:{};return("string"==typeof n||e[1])&&(ht(lt,"use new ".concat(t,'({ text: "hi!", style }) instead')),n={text:n,style:e[1]}),n}var eT=exports.Text=function(e){function t(){var e;C(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=x(this,t,[$b(n,"Text"),zh])).renderPipeId="text",e}return E(t,Jb),B(t,[{key:"_updateBounds",value:function(){var e=this._bounds,t=this._anchor,r=Jh.measureText(this._text,this._style),n=r.width,i=r.height;e.minX=-t._x*n,e.maxX=e.minX+n,e.minY=-t._y*i,e.maxY=e.minY+i}}])}(),tT=exports.PrepareQueue=function(e){function t(){return C(this,t),x(this,t,arguments)}return E(t,vb),B(t,[{key:"resolveQueueItem",value:function(e,t){return e instanceof tr?this.resolveContainerQueueItem(e,t):e instanceof ui||e instanceof bi?t.push(e.source):e instanceof Rh&&t.push(e),null}},{key:"resolveContainerQueueItem",value:function(e,t){e instanceof Fi||e instanceof zb||e instanceof Sb?t.push(e.texture.source):e instanceof eT?t.push(e):e instanceof cd?t.push(e.context):e instanceof Bb&&e.textures.forEach(function(e){e.source?t.push(e.source):t.push(e.texture.source)})}},{key:"resolveGraphicsContextQueueItem",value:function(e){this.renderer.graphicsContext.getContextRenderData(e);var t,r=U(e.instructions);try{for(r.s();!(t=r.n()).done;){var n=t.value;if("texture"===n.action)return n.data.image.source;if("fill"===n.action)return n.data.style.texture.source}}catch(i){r.e(i)}finally{r.f()}return null}}])}(),rT=exports.BitmapText=function(e){function t(){var e,r;C(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var o=$b(i,"BitmapText");return null!=o.style||(o.style=o.style||{}),null!=(r=o.style).fill||(r.fill=16777215),(e=x(this,t,[o,zh])).renderPipeId="bitmapText",e}return E(t,Jb),B(t,[{key:"_updateBounds",value:function(){var e=this._bounds,t=this._anchor,r=Ud.measureText(this.text,this._style),n=r.scale,i=r.offsetY*n,a=r.width*n,o=r.height*n,s=this._style._stroke;s&&(a+=s.width,o+=s.width),e.minX=-t._x*a,e.maxX=e.minX+a,e.minY=-t._y*(o+i),e.maxY=e.minY+o}}])}(),nT=exports.HTMLText=function(e){function t(){var e;C(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=x(this,t,[$b(n,"HtmlText"),af])).renderPipeId="htmlText",e}return E(t,Jb),B(t,[{key:"_updateBounds",value:function(){var e=this._bounds,t=this._anchor,r=_f(this.text,this._style),n=r.width,i=r.height;e.minX=-t._x*n,e.maxX=e.minX+n,e.minY=-t._y*i,e.maxY=e.minY+i}}])}(),iT=exports.PrepareUpload=function(e){function t(){return C(this,t),x(this,t,arguments)}return E(t,tT),B(t,[{key:"uploadQueueItem",value:function(e){e instanceof ui?this.uploadTextureSource(e):e instanceof eT?this.uploadText(e):e instanceof nT?this.uploadHTMLText(e):e instanceof rT?this.uploadBitmapText(e):e instanceof Rh&&this.uploadGraphicsContext(e)}},{key:"uploadTextureSource",value:function(e){this.renderer.texture.initSource(e)}},{key:"uploadText",value:function(e){this.renderer.renderPipes.text.initGpuText(e)}},{key:"uploadBitmapText",value:function(e){this.renderer.renderPipes.bitmapText.initGpuText(e)}},{key:"uploadHTMLText",value:function(e){this.renderer.renderPipes.htmlText.initGpuText(e)}},{key:"uploadGraphicsContext",value:function(e){this.renderer.graphicsContext.getContextRenderData(e);var t,r=U(e.instructions);try{for(r.s();!(t=r.n()).done;){var n=t.value;if("texture"===n.action){var i=n.data.image;this.uploadTextureSource(i.source)}else if("fill"===n.action){var a=n.data.style.texture;this.uploadTextureSource(a.source)}}}catch(o){r.e(o)}finally{r.f()}return null}}])}(),aT=exports.PrepareSystem=function(e){function t(){return C(this,t),x(this,t,arguments)}return E(t,iT),B(t,[{key:"destroy",value:function(){clearTimeout(this.timeout),this.renderer=null,this.queue=null,this.resolves=null}}])}();aT.extension={type:[Z.WebGLSystem,Z.WebGPUSystem],name:"prepare"};var oT=exports.GlBatchAdaptor=function(){return B(function e(){C(this,e),this._didUpload=!1,this._tempState=Al.for2d()},[{key:"init",value:function(e){e.renderer.runners.contextChange.add(this)}},{key:"contextChange",value:function(){this._didUpload=!1}},{key:"start",value:function(e,t,r){var n=e.renderer;n.shader.bind(r,this._didUpload),n.shader.updateUniformGroup(n.globalUniforms.uniformGroup),n.geometry.bind(t,r.glProgram)}},{key:"execute",value:function(e,t){var r=e.renderer;this._didUpload=!0,this._tempState.blendMode=t.blendMode,r.state.set(this._tempState);for(var n=t.textures.textures,i=0;i<t.textures.count;i++)r.texture.bind(n[i],i);r.geometry.draw("triangle-list",t.size,t.start)}}])}();function sT(e){for(var t=[],r=0,n=0;n<e;n++)t[r]={texture:{sampleType:"float",viewDimension:"2d",multisampled:!1},binding:r,visibility:GPUShaderStage.FRAGMENT},t[++r]={sampler:{type:"filtering"},binding:r,visibility:GPUShaderStage.FRAGMENT},r++;return t}function uT(e){for(var t={},r=0,n=0;n<e;n++)t["textureSource".concat(n+1)]=r++,t["textureSampler".concat(n+1)]=r++;return t}oT.extension={type:[Z.WebGLPipesAdaptor],name:"batch"};var lT=Al.for2d(),cT=exports.GpuBatchAdaptor=function(){return B(function e(){C(this,e)},[{key:"start",value:function(e,t,r){var n=e.renderer,i=n.encoder,a=r.gpuProgram;this._shader=r,this._geometry=t,i.setGeometry(t,a),lT.blendMode="normal",n.pipeline.getPipeline(t,a,lT);var o=n.globalUniforms.bindGroup;i.resetBindGroup(1),i.setBindGroup(0,o,a)}},{key:"execute",value:function(e,t){var r=this._shader.gpuProgram,n=e.renderer,i=n.encoder;if(!t.bindGroup){var a=t.textures;t.bindGroup=Ta(a.textures,a.count)}lT.blendMode=t.blendMode;var o=n.bindGroup.getBindGroup(t.bindGroup,r,1),s=n.pipeline.getPipeline(this._geometry,r,lT);t.bindGroup._touch(n.textureGC.count),i.setPipeline(s),i.renderPassEncoder.setBindGroup(1,o),i.renderPassEncoder.drawIndexed(t.size,1,t.start)}}])}();cT.extension={type:[Z.WebGPUPipesAdaptor],name:"batch"};var hT=function(){function e(t,r){var n,i;C(this,e),this.state=Al.for2d(),this._batchersByInstructionSet=Object.create(null),this._activeBatches=Object.create(null),this.renderer=t,this._adaptor=r,null==(i=(n=this._adaptor).init)||i.call(n,this)}return B(e,[{key:"buildStart",value:function(e){var t=this._batchersByInstructionSet[e.uid];for(var r in t||(t=this._batchersByInstructionSet[e.uid]=Object.create(null)).default||(t.default=new qs),this._activeBatches=t,this._activeBatch=this._activeBatches.default,this._activeBatches)this._activeBatches[r].begin()}},{key:"addToBatch",value:function(t,r){if(this._activeBatch.name!==t.batcherName){this._activeBatch.break(r);var n=this._activeBatches[t.batcherName];n||(n=this._activeBatches[t.batcherName]=e.getBatcher(t.batcherName)).begin(),this._activeBatch=n}this._activeBatch.add(t)}},{key:"break",value:function(e){this._activeBatch.break(e)}},{key:"buildEnd",value:function(e){this._activeBatch.break(e);var t=this._activeBatches;for(var r in t){var n=t[r],i=n.geometry;i.indexBuffer.setDataWithSize(n.indexBuffer,n.indexSize,!0),i.buffers[0].setDataWithSize(n.attributeBuffer.float32View,n.attributeSize,!1)}}},{key:"upload",value:function(e){var t=this._batchersByInstructionSet[e.uid];for(var r in t){var n=t[r],i=n.geometry;n.dirty&&(n.dirty=!1,i.buffers[0].update(4*n.attributeSize))}}},{key:"execute",value:function(e){if("startBatch"===e.action){var t=e.batcher,r=t.geometry,n=t.shader;this._adaptor.start(this,r,n)}this._adaptor.execute(this,e)}},{key:"destroy",value:function(){for(var e in this.state=null,this.renderer=null,this._adaptor=null,this._activeBatches)this._activeBatches[e].destroy();this._activeBatches=null}}],[{key:"getBatcher",value:function(e){return new this._availableBatchers[e]}}])}();hT.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"batch"},hT._availableBatchers=Object.create(null);var dT=exports.BatcherPipe=hT;function fT(e){var t=e.split(/([\n{}])/g).map(function(e){return e.trim()}).filter(function(e){return e.length}),r="";return t.map(function(e){var t=r+e;return"{"===e?r+="    ":"}"===e&&(t=(r=r.substr(0,r.length-4))+e),t}).join("\n")}$.handleByMap(Z.Batcher,dT._availableBatchers),$.add(qs);var pT=exports.textureBit={name:"texture-bit",vertex:{header:"\n\n        struct TextureUniforms {\n            uTextureMatrix:mat3x3<f32>,\n        }\n\n        @group(2) @binding(2) var<uniform> textureUniforms : TextureUniforms;\n        ",main:"\n            uv = (textureUniforms.uTextureMatrix * vec3(uv, 1.0)).xy;\n        "},fragment:{header:"\n            @group(2) @binding(0) var uTexture: texture_2d<f32>;\n            @group(2) @binding(1) var uSampler: sampler;\n\n         \n        ",main:"\n            outColor = textureSample(uTexture, uSampler, vUV);\n        "}},vT=exports.textureBitGl={name:"texture-bit",vertex:{header:"\n            uniform mat3 uTextureMatrix;\n        ",main:"\n            uv = (uTextureMatrix * vec3(uv, 1.0)).xy;\n        "},fragment:{header:"\n        uniform sampler2D uTexture;\n\n         \n        ",main:"\n            outColor = texture(uTexture, vUV);\n        "}};function mT(e,t){var r=e.root,n=e.instructionSet;n.reset();var i=t.renderPipes?t:t.batch.renderer,a=i.renderPipes;a.batch.buildStart(n),a.blendMode.buildStart(),a.colorMask.buildStart(),r.sortableChildren&&r.sortChildren(),yT(r,n,i,!0),a.batch.buildEnd(n),a.blendMode.buildEnd(n)}function gT(e,t,r){var n=r.renderPipes?r:r.batch.renderer;e.globalDisplayStatus<7||!e.includeInBuild||(e.sortableChildren&&e.sortChildren(),e.isSimple?_T(e,t,n):yT(e,t,n,!1))}function _T(e,t,r){if(e.renderPipeId){var n=r.renderPipes,i=r.renderableGC;n.blendMode.setBlendMode(e,e.groupBlendMode,t),e.didViewUpdate=!1,n[e.renderPipeId].addRenderable(e,t),i.addRenderable(e,t)}if(!e.renderGroup)for(var a=e.children,o=a.length,s=0;s<o;s++)gT(a[s],t,r)}function yT(e,t,r,n){var i=r.renderPipes,a=r.renderableGC;if(!n&&e.renderGroup)i.renderGroup.addRenderGroup(e.renderGroup,t);else{for(var o=0;o<e.effects.length;o++){var s=e.effects[o];i[s.pipe].push(s,e,t)}var u=e.renderPipeId;if(u)i.blendMode.setBlendMode(e,e.groupBlendMode,t),e.didViewUpdate=!1,i[u].addRenderable(e,t),a.addRenderable(e,t);var l=e.children;if(l.length)for(var c=0;c<l.length;c++)gT(l[c],t,r);for(var h=e.effects.length-1;h>=0;h--){var d=e.effects[h];i[d.pipe].pop(d,e,t)}}}var xT=new Et,bT=function(e){function t(){var e;return C(this,t),(e=x(this,t)).filters=[new cb({sprite:new Fi(bi.EMPTY),resolution:"inherit",antialias:"inherit"})],e}return E(t,gt),B(t,[{key:"sprite",get:function(){return this.filters[0].sprite},set:function(e){this.filters[0].sprite=e}}])}(),TT=exports.AlphaMaskPipe=function(){return B(function e(t){C(this,e),this._activeMaskStage=[],this._renderer=t},[{key:"push",value:function(e,t,r){var n=this._renderer;if(n.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"pushMaskBegin",mask:e,canBundle:!1,maskedContainer:t}),e.renderMaskToTexture){var i=e.mask;i.includeInBuild=!0,gT(i,r,n),i.includeInBuild=!1}n.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"pushMaskEnd",mask:e,maskedContainer:t,canBundle:!1})}},{key:"pop",value:function(e,t,r){this._renderer.renderPipes.batch.break(r),r.add({renderPipeId:"alphaMask",action:"popMaskEnd",mask:e,canBundle:!1})}},{key:"execute",value:function(e){var t=this._renderer,r=e.mask.renderMaskToTexture;if("pushMaskBegin"===e.action){var n=pt.get(bT);if(r){e.mask.mask.measurable=!0;var i=Rt(e.mask.mask,!0,xT);e.mask.mask.measurable=!1,i.ceil();var a=t.renderTarget.renderTarget.colorTexture.source,o=Yl.getOptimalTexture(i.width,i.height,a._resolution,a.antialias);t.renderTarget.push(o,!0),t.globalUniforms.push({offset:i,worldColor:4294967295});var s=n.sprite;s.texture=o,s.worldTransform.tx=i.minX,s.worldTransform.ty=i.minY,this._activeMaskStage.push({filterEffect:n,maskedContainer:e.maskedContainer,filterTexture:o})}else n.sprite=e.mask.mask,this._activeMaskStage.push({filterEffect:n,maskedContainer:e.maskedContainer})}else if("pushMaskEnd"===e.action){var u=this._activeMaskStage[this._activeMaskStage.length-1];r&&(t.type===Ds.WEBGL&&t.renderTarget.finishRenderPass(),t.renderTarget.pop(),t.globalUniforms.pop()),t.filter.push({renderPipeId:"filter",action:"pushFilter",container:u.maskedContainer,filterEffect:u.filterEffect,canBundle:!1})}else if("popMaskEnd"===e.action){t.filter.pop();var l=this._activeMaskStage.pop();r&&Yl.returnTexture(l.filterTexture),pt.return(l.filterEffect)}}},{key:"destroy",value:function(){this._renderer=null,this._activeMaskStage=null}}])}();TT.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"alphaMask"};var ST=exports.ColorMaskPipe=function(){return B(function e(t){C(this,e),this._colorStack=[],this._colorStackIndex=0,this._currentColor=0,this._renderer=t},[{key:"buildStart",value:function(){this._colorStack[0]=15,this._colorStackIndex=1,this._currentColor=15}},{key:"push",value:function(e,t,r){this._renderer.renderPipes.batch.break(r);var n=this._colorStack;n[this._colorStackIndex]=n[this._colorStackIndex-1]&e.mask;var i=this._colorStack[this._colorStackIndex];i!==this._currentColor&&(this._currentColor=i,r.add({renderPipeId:"colorMask",colorMask:i,canBundle:!1})),this._colorStackIndex++}},{key:"pop",value:function(e,t,r){this._renderer.renderPipes.batch.break(r);var n=this._colorStack;this._colorStackIndex--;var i=n[this._colorStackIndex-1];i!==this._currentColor&&(this._currentColor=i,r.add({renderPipeId:"colorMask",colorMask:i,canBundle:!1}))}},{key:"execute",value:function(e){this._renderer.colorMask.setMask(e.colorMask)}},{key:"destroy",value:function(){this._colorStack=null}}])}();ST.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"colorMask"};var kT=exports.ScissorMask=function(){return B(function e(t){C(this,e),this.priority=0,this.pipe="scissorMask",this.mask=t,this.mask.renderable=!1,this.mask.measurable=!1},[{key:"addBounds",value:function(e,t){Ui(this.mask,e,t)}},{key:"addLocalBounds",value:function(e,t){Li(this.mask,e,t)}},{key:"containsPoint",value:function(e,t){return t(this.mask,e)}},{key:"reset",value:function(){this.mask.measurable=!0,this.mask=null}},{key:"destroy",value:function(){this.reset()}}])}(),ET=exports.StencilMaskPipe=function(){return B(function e(t){C(this,e),this._maskStackHash={},this._maskHash=new WeakMap,this._renderer=t},[{key:"push",value:function(e,t,r){var n,i=e,a=this._renderer;a.renderPipes.batch.break(r),a.renderPipes.blendMode.setBlendMode(i.mask,"none",r),r.add({renderPipeId:"stencilMask",action:"pushMaskBegin",mask:e,canBundle:!1});var o=i.mask;o.includeInBuild=!0,this._maskHash.has(i)||this._maskHash.set(i,{instructionsStart:0,instructionsLength:0});var s=this._maskHash.get(i);s.instructionsStart=r.instructionSize,gT(o,r,a),o.includeInBuild=!1,a.renderPipes.batch.break(r),r.add({renderPipeId:"stencilMask",action:"pushMaskEnd",mask:e,canBundle:!1});var u=r.instructionSize-s.instructionsStart-1;s.instructionsLength=u;var l=a.renderTarget.renderTarget.uid;null!=(n=this._maskStackHash)[l]||(n[l]=0)}},{key:"pop",value:function(e,t,r){var n=e,i=this._renderer;i.renderPipes.batch.break(r),i.renderPipes.blendMode.setBlendMode(n.mask,"none",r),r.add({renderPipeId:"stencilMask",action:"popMaskBegin",canBundle:!1});for(var a=this._maskHash.get(e),o=0;o<a.instructionsLength;o++)r.instructions[r.instructionSize++]=r.instructions[a.instructionsStart++];r.add({renderPipeId:"stencilMask",action:"popMaskEnd",canBundle:!1})}},{key:"execute",value:function(e){var t,r,n=this._renderer,i=n.renderTarget.renderTarget.uid,a=null!=(r=(t=this._maskStackHash)[i])?r:t[i]=0;"pushMaskBegin"===e.action?(n.renderTarget.ensureDepthStencil(),n.stencil.setStencilMode(Ra.RENDERING_MASK_ADD,a),a++,n.colorMask.setMask(0)):"pushMaskEnd"===e.action?(n.stencil.setStencilMode(Ra.MASK_ACTIVE,a),n.colorMask.setMask(15)):"popMaskBegin"===e.action?(n.colorMask.setMask(0),0!==a?n.stencil.setStencilMode(Ra.RENDERING_MASK_REMOVE,a):(n.renderTarget.clear(null,Pp.STENCIL),n.stencil.setStencilMode(Ra.DISABLED,a)),a--):"popMaskEnd"===e.action&&(n.stencil.setStencilMode(Ra.MASK_ACTIVE,a),n.colorMask.setMask(15)),this._maskStackHash[i]=a}},{key:"destroy",value:function(){this._renderer=null,this._maskStackHash=null,this._maskHash=null}}])}();ET.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"stencilMask"};var AT=exports.BUFFER_TYPE=function(e){return e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e}(AT||{}),wT=exports.GlBuffer=B(function e(t,r){C(this,e),this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.type=r}),RT=exports.GlBufferSystem=function(){return B(function e(t){C(this,e),this._gpuBuffers=Object.create(null),this._boundBufferBases=Object.create(null),this._renderer=t},[{key:"destroy",value:function(){this._renderer=null,this._gl=null,this._gpuBuffers=null,this._boundBufferBases=null}},{key:"contextChange",value:function(){this._gpuBuffers=Object.create(null),this._gl=this._renderer.gl}},{key:"getGlBuffer",value:function(e){return this._gpuBuffers[e.uid]||this.createGLBuffer(e)}},{key:"bind",value:function(e){var t=this._gl,r=this.getGlBuffer(e);t.bindBuffer(r.type,r.buffer)}},{key:"bindBufferBase",value:function(e,t){var r=this._gl;if(this._boundBufferBases[t]!==e){var n=this.getGlBuffer(e);this._boundBufferBases[t]=e,r.bindBufferBase(r.UNIFORM_BUFFER,t,n.buffer)}}},{key:"bindBufferRange",value:function(e,t,r){var n=this._gl;r=r||0;var i=this.getGlBuffer(e);n.bindBufferRange(n.UNIFORM_BUFFER,t||0,i.buffer,256*r,256)}},{key:"updateBuffer",value:function(e){var t=this._gl,r=this.getGlBuffer(e);if(e._updateID===r.updateID)return r;r.updateID=e._updateID,t.bindBuffer(r.type,r.buffer);var n=e.data;if(r.byteLength>=e.data.byteLength)t.bufferSubData(r.type,0,n,0,e._updateSize/n.BYTES_PER_ELEMENT);else{var i=e.descriptor.usage&Va.STATIC?t.STATIC_DRAW:t.DYNAMIC_DRAW;r.byteLength=n.byteLength,t.bufferData(r.type,n,i)}return r}},{key:"destroyAll",value:function(){var e=this._gl;for(var t in this._gpuBuffers)e.deleteBuffer(this._gpuBuffers[t].buffer);this._gpuBuffers=Object.create(null)}},{key:"onBufferDestroy",value:function(e,t){var r=this._gpuBuffers[e.uid],n=this._gl;t||n.deleteBuffer(r.buffer),this._gpuBuffers[e.uid]=null}},{key:"createGLBuffer",value:function(e){var t=this._gl,r=AT.ARRAY_BUFFER;e.descriptor.usage&Va.INDEX?r=AT.ELEMENT_ARRAY_BUFFER:e.descriptor.usage&Va.UNIFORM&&(r=AT.UNIFORM_BUFFER);var n=new wT(t.createBuffer(),r);return this._gpuBuffers[e.uid]=n,e.on("destroy",this.onBufferDestroy,this),n}}])}();RT.extension={type:[Z.WebGLSystem],name:"buffer"};var PT=Object.defineProperty,MT=Object.defineProperties,OT=Object.getOwnPropertyDescriptors,CT=Object.getOwnPropertySymbols,GT=Object.prototype.hasOwnProperty,BT=Object.prototype.propertyIsEnumerable,IT=function(e,t,r){return t in e?PT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},FT=function(e,t){for(var r in t||(t={}))GT.call(t,r)&&IT(e,r,t[r]);if(CT){var n,i=U(CT(t));try{for(i.s();!(n=i.n()).done;){r=n.value;BT.call(t,r)&&IT(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},DT=function(e,t){return MT(e,OT(t))},UT=function(){function e(t){C(this,e),this.supports={uint32Indices:!0,uniformBufferObject:!0,vertexArrayObject:!0,srgbTextures:!0,nonPowOf2wrapping:!0,msaa:!0,nonPowOf2mipmaps:!0},this._renderer=t,this.extensions=Object.create(null),this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}return B(e,[{key:"isLost",get:function(){return!this.gl||this.gl.isContextLost()}},{key:"contextChange",value:function(e){this.gl=e,this._renderer.gl=e}},{key:"init",value:function(t){var r,n;t=FT(FT({},e.defaultOptions),t);var i=this.multiView=t.multiView;if(t.context&&i&&(Gt("Renderer created with both a context and multiview enabled. Disabling multiView as both cannot work together."),i=!1),this.canvas=i?hn.get().createCanvas(this._renderer.canvas.width,this._renderer.canvas.height):this._renderer.view.canvas,t.context)this.initFromContext(t.context);else{var a=this._renderer.background.alpha<1,o=null==(r=t.premultipliedAlpha)||r,s=t.antialias&&!this._renderer.backBuffer.useBackBuffer;this.createContext(t.preferWebGLVersion,{alpha:a,premultipliedAlpha:o,antialias:s,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:null!=(n=t.powerPreference)?n:"default"})}}},{key:"ensureCanvasSize",value:function(e){if(this.multiView){var t=this.canvas;(t.width<e.width||t.height<e.height)&&(t.width=Math.max(e.width,e.width),t.height=Math.max(e.height,e.height))}else e!==this.canvas&&Gt("multiView is disabled, but targetCanvas is not the main canvas")}},{key:"initFromContext",value:function(e){this.gl=e,this.webGLVersion=e instanceof hn.get().getWebGLRenderingContext()?1:2,this.getExtensions(),this.validateContext(e),this._renderer.runners.contextChange.emit(e);var t=this._renderer.view.canvas;t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}},{key:"createContext",value:function(e,t){var r,n=this.canvas;if(2===e&&(r=n.getContext("webgl2",t)),!r&&!(r=n.getContext("webgl",t)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");this.gl=r,this.initFromContext(this.gl)}},{key:"getExtensions",value:function(){var e=this.gl,t={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc"),rgtc:e.getExtension("EXT_texture_compression_rgtc"),loseContext:e.getExtension("WEBGL_lose_context")};if(1===this.webGLVersion)this.extensions=DT(FT({},t),{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear"),vertexAttribDivisorANGLE:e.getExtension("ANGLE_instanced_arrays"),srgb:e.getExtension("EXT_sRGB")});else{this.extensions=DT(FT({},t),{colorBufferFloat:e.getExtension("EXT_color_buffer_float")});var r=e.getExtension("WEBGL_provoking_vertex");r&&r.provokingVertexWEBGL(r.FIRST_VERTEX_CONVENTION_WEBGL)}}},{key:"handleContextLost",value:function(e){var t=this;e.preventDefault(),this._contextLossForced&&(this._contextLossForced=!1,setTimeout(function(){var e;t.gl.isContextLost()&&(null==(e=t.extensions.loseContext)||e.restoreContext())},0))}},{key:"handleContextRestored",value:function(){this._renderer.runners.contextChange.emit(this.gl)}},{key:"destroy",value:function(){var e,t=this._renderer.view.canvas;this._renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),null==(e=this.extensions.loseContext)||e.loseContext()}},{key:"forceContextLoss",value:function(){var e;null==(e=this.extensions.loseContext)||e.loseContext(),this._contextLossForced=!0}},{key:"validateContext",value:function(e){var t=e.getContextAttributes();t&&!t.stencil&&Gt("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var r=this.supports,n=2===this.webGLVersion,i=this.extensions;r.uint32Indices=n||!!i.uint32ElementIndex,r.uniformBufferObject=n,r.vertexArrayObject=n||!!i.vertexArrayObject,r.srgbTextures=n||!!i.srgb,r.nonPowOf2wrapping=n,r.nonPowOf2mipmaps=n,r.msaa=n,r.uint32Indices||Gt("Provided WebGL context does not support 32 index buffer, large scenes may not render correctly")}}])}();UT.extension={type:[Z.WebGLSystem],name:"context"},UT.defaultOptions={context:null,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:void 0,preferWebGLVersion:2,multiView:!1};var LT=exports.GlContextSystem=UT;function NT(e,t){for(var r in e.attributes){var n=e.attributes[r],i=t[r];i?(null!=n.format||(n.format=i.format),null!=n.offset||(n.offset=i.offset),null!=n.instance||(n.instance=i.instance)):Gt("Attribute ".concat(r," is not present in the shader, but is present in the geometry. Unable to infer attribute details."))}XT(e)}function XT(e){var t=e.buffers,r=e.attributes,n={},i={};for(var a in t){var o=t[a];n[o.uid]=0,i[o.uid]=0}for(var s in r){var u=r[s];n[u.buffer.uid]+=ko(u.format).stride}for(var l in r){var c=r[l];null!=c.stride||(c.stride=n[c.buffer.uid]),null!=c.start||(c.start=i[c.buffer.uid]),i[c.buffer.uid]+=ko(c.format).stride}}var HT=exports.GL_FORMATS=function(e){return e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e}(HT||{}),jT=exports.GL_TARGETS=function(e){return e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e}(jT||{}),zT=exports.GL_WRAP_MODES=function(e){return e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e}(zT||{}),VT=exports.GL_TYPES=function(e){return e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e}(VT||{}),WT={uint8x2:VT.UNSIGNED_BYTE,uint8x4:VT.UNSIGNED_BYTE,sint8x2:VT.BYTE,sint8x4:VT.BYTE,unorm8x2:VT.UNSIGNED_BYTE,unorm8x4:VT.UNSIGNED_BYTE,snorm8x2:VT.BYTE,snorm8x4:VT.BYTE,uint16x2:VT.UNSIGNED_SHORT,uint16x4:VT.UNSIGNED_SHORT,sint16x2:VT.SHORT,sint16x4:VT.SHORT,unorm16x2:VT.UNSIGNED_SHORT,unorm16x4:VT.UNSIGNED_SHORT,snorm16x2:VT.SHORT,snorm16x4:VT.SHORT,float16x2:VT.HALF_FLOAT,float16x4:VT.HALF_FLOAT,float32:VT.FLOAT,float32x2:VT.FLOAT,float32x3:VT.FLOAT,float32x4:VT.FLOAT,uint32:VT.UNSIGNED_INT,uint32x2:VT.UNSIGNED_INT,uint32x3:VT.UNSIGNED_INT,uint32x4:VT.UNSIGNED_INT,sint32:VT.INT,sint32x2:VT.INT,sint32x3:VT.INT,sint32x4:VT.INT};function YT(e){var t;return null!=(t=WT[e])?t:WT.float32}var KT={"point-list":0,"line-list":1,"line-strip":3,"triangle-list":4,"triangle-strip":5},qT=exports.GlGeometrySystem=function(){return B(function e(t){C(this,e),this._geometryVaoHash=Object.create(null),this._renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0},[{key:"contextChange",value:function(){var e=this.gl=this._renderer.gl;if(!this._renderer.context.supports.vertexArrayObject)throw new Error("[PixiJS] Vertex Array Objects are not supported on this device");var t=this._renderer.context.extensions.vertexArrayObject;t&&(e.createVertexArray=function(){return t.createVertexArrayOES()},e.bindVertexArray=function(e){return t.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return t.deleteVertexArrayOES(e)});var r=this._renderer.context.extensions.vertexAttribDivisorANGLE;r&&(e.drawArraysInstanced=function(e,t,n,i){r.drawArraysInstancedANGLE(e,t,n,i)},e.drawElementsInstanced=function(e,t,n,i,a){r.drawElementsInstancedANGLE(e,t,n,i,a)},e.vertexAttribDivisor=function(e,t){return r.vertexAttribDivisorANGLE(e,t)}),this._activeGeometry=null,this._activeVao=null,this._geometryVaoHash=Object.create(null)}},{key:"bind",value:function(e,t){var r=this.gl;this._activeGeometry=e;var n=this.getVao(e,t);this._activeVao!==n&&(this._activeVao=n,r.bindVertexArray(n)),this.updateBuffers()}},{key:"reset",value:function(){this.unbind()}},{key:"updateBuffers",value:function(){for(var e=this._activeGeometry,t=this._renderer.buffer,r=0;r<e.buffers.length;r++){var n=e.buffers[r];t.updateBuffer(n)}}},{key:"checkCompatibility",value:function(e,t){var r=e.attributes,n=t._attributeData;for(var i in n)if(!r[i])throw new Error('shader and geometry incompatible, geometry missing the "'.concat(i,'" attribute'))}},{key:"getSignature",value:function(e,t){var r=e.attributes,n=t._attributeData,i=["g",e.uid];for(var a in r)n[a]&&i.push(a,n[a].location);return i.join("-")}},{key:"getVao",value:function(e,t){var r;return(null==(r=this._geometryVaoHash[e.uid])?void 0:r[t._key])||this.initGeometryVao(e,t)}},{key:"initGeometryVao",value:function(e,t){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var r=this._renderer.gl,n=this._renderer.buffer;this._renderer.shader._getProgramData(t),this.checkCompatibility(e,t);var i=this.getSignature(e,t);this._geometryVaoHash[e.uid]||(this._geometryVaoHash[e.uid]=Object.create(null),e.on("destroy",this.onGeometryDestroy,this));var a=this._geometryVaoHash[e.uid],o=a[i];if(o)return a[t._key]=o,o;NT(e,t._attributeData);var s=e.buffers;o=r.createVertexArray(),r.bindVertexArray(o);for(var u=0;u<s.length;u++){var l=s[u];n.bind(l)}return this.activateVao(e,t),a[t._key]=o,a[i]=o,r.bindVertexArray(null),o}},{key:"onGeometryDestroy",value:function(e,t){var r=this._geometryVaoHash[e.uid],n=this.gl;if(r){if(t)for(var i in r)this._activeVao!==r[i]&&this.unbind(),n.deleteVertexArray(r[i]);this._geometryVaoHash[e.uid]=null}}},{key:"destroyAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.gl;for(var r in this._geometryVaoHash){if(e)for(var n in this._geometryVaoHash[r]){var i=this._geometryVaoHash[r];this._activeVao!==i&&this.unbind(),t.deleteVertexArray(i[n])}this._geometryVaoHash[r]=null}}},{key:"activateVao",value:function(e,t){var r,n,i=this._renderer.gl,a=this._renderer.buffer,o=e.attributes;e.indexBuffer&&a.bind(e.indexBuffer);var s=null;for(var u in o){var l=o[u],c=l.buffer,h=a.getGlBuffer(c),d=t._attributeData[u];if(d){s!==h&&(a.bind(c),s=h);var f=d.location;i.enableVertexAttribArray(f);var p=ko(l.format),v=YT(l.format);if("int"===(null==(r=d.format)?void 0:r.substring(1,4))?i.vertexAttribIPointer(f,p.size,v,l.stride,l.offset):i.vertexAttribPointer(f,p.size,v,p.normalised,l.stride,l.offset),l.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");var m=null!=(n=l.divisor)?n:1;i.vertexAttribDivisor(f,m)}}}}},{key:"draw",value:function(e,t,r,n){var i=this._renderer.gl,a=this._activeGeometry,o=KT[a.topology||e];if(n||(n=a.instanceCount),a.indexBuffer){var s=a.indexBuffer.data.BYTES_PER_ELEMENT,u=2===s?i.UNSIGNED_SHORT:i.UNSIGNED_INT;n>1?i.drawElementsInstanced(o,t||a.indexBuffer.data.length,u,(r||0)*s,n):i.drawElements(o,t||a.indexBuffer.data.length,u,(r||0)*s)}else n>1?i.drawArraysInstanced(o,r||0,t||a.getSize(),n):i.drawArrays(o,r||0,t||a.getSize());return this}},{key:"unbind",value:function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}},{key:"destroy",value:function(){this._renderer=null,this.gl=null,this._activeVao=null,this._activeGeometry=null}}])}();qT.extension={type:[Z.WebGLSystem],name:"geometry"};var ZT=Object.defineProperty,QT=Object.getOwnPropertySymbols,JT=Object.prototype.hasOwnProperty,$T=Object.prototype.propertyIsEnumerable,eS=function(e,t,r){return t in e?ZT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},tS=function(e,t){for(var r in t||(t={}))JT.call(t,r)&&eS(e,r,t[r]);if(QT){var n,i=U(QT(t));try{for(i.s();!(n=i.n()).done;){r=n.value;$T.call(t,r)&&eS(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},rS=new Qa({attributes:{aPosition:[-1,-1,3,-1,-1,3]}}),nS=function(){function e(t){C(this,e),this.useBackBuffer=!1,this._useBackBufferThisRender=!1,this._renderer=t}return B(e,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=tS(tS({},e.defaultOptions),t),n=r.useBackBuffer,i=r.antialias;this.useBackBuffer=n,this._antialias=i,this._renderer.context.supports.msaa||(Gt("antialiasing, is not supported on when using the back buffer"),this._antialias=!1),this._state=Al.for2d();var a=new To({vertex:"\n                attribute vec2 aPosition;\n                out vec2 vUv;\n\n                void main() {\n                    gl_Position = vec4(aPosition, 0.0, 1.0);\n\n                    vUv = (aPosition + 1.0) / 2.0;\n\n                    // flip dem UVs\n                    vUv.y = 1.0 - vUv.y;\n                }",fragment:"\n                in vec2 vUv;\n                out vec4 finalColor;\n\n                uniform sampler2D uTexture;\n\n                void main() {\n                    finalColor = texture(uTexture, vUv);\n                }",name:"big-triangle"});this._bigTriangleShader=new Vs({glProgram:a,resources:{uTexture:bi.WHITE.source}})}},{key:"renderStart",value:function(e){var t=this._renderer.renderTarget.getRenderTarget(e.target);if(this._useBackBufferThisRender=this.useBackBuffer&&!!t.isRoot,this._useBackBufferThisRender){var r=this._renderer.renderTarget.getRenderTarget(e.target);this._targetTexture=r.colorTexture,e.target=this._getBackBufferTexture(r.colorTexture)}}},{key:"renderEnd",value:function(){this._presentBackBuffer()}},{key:"_presentBackBuffer",value:function(){var e=this._renderer;e.renderTarget.finishRenderPass(),this._useBackBufferThisRender&&(e.renderTarget.bind(this._targetTexture,!1),this._bigTriangleShader.resources.uTexture=this._backBufferTexture.source,e.encoder.draw({geometry:rS,shader:this._bigTriangleShader,state:this._state}))}},{key:"_getBackBufferTexture",value:function(e){return this._backBufferTexture=this._backBufferTexture||new bi({source:new ui({width:e.width,height:e.height,resolution:e._resolution,antialias:this._antialias})}),this._backBufferTexture.source.resize(e.width,e.height,e._resolution),this._backBufferTexture}},{key:"destroy",value:function(){this._backBufferTexture&&(this._backBufferTexture.destroy(),this._backBufferTexture=null)}}])}();nS.extension={type:[Z.WebGLSystem],name:"backBuffer",priority:1},nS.defaultOptions={useBackBuffer:!1};var iS=exports.GlBackBufferSystem=nS,aS=exports.GlColorMaskSystem=function(){return B(function e(t){C(this,e),this._colorMaskCache=15,this._renderer=t},[{key:"setMask",value:function(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.gl.colorMask(!!(8&e),!!(4&e),!!(2&e),!!(1&e)))}}])}();aS.extension={type:[Z.WebGLSystem],name:"colorMask"};var oS=exports.GlEncoderSystem=function(){return B(function e(t){C(this,e),this.commandFinished=Promise.resolve(),this._renderer=t},[{key:"setGeometry",value:function(e,t){this._renderer.geometry.bind(e,t.glProgram)}},{key:"finishRenderPass",value:function(){}},{key:"draw",value:function(e){var t=this._renderer,r=e.geometry,n=e.shader,i=e.state,a=e.skipSync,o=e.topology,s=e.size,u=e.start,l=e.instanceCount;t.shader.bind(n,a),t.geometry.bind(r,t.shader._activeProgram),i&&t.state.set(i),t.geometry.draw(o,s,u,null!=l?l:r.instanceCount)}},{key:"destroy",value:function(){this._renderer=null}}])}();oS.extension={type:[Z.WebGLSystem],name:"encoder"};var sS=exports.GlRenderTarget=B(function e(){C(this,e),this.width=-1,this.height=-1,this.msaa=!1,this.msaaRenderBuffer=[]}),uS=exports.GpuStencilModesToPixi=[];uS[Ra.NONE]=void 0,uS[Ra.DISABLED]={stencilWriteMask:0,stencilReadMask:0},uS[Ra.RENDERING_MASK_ADD]={stencilFront:{compare:"equal",passOp:"increment-clamp"},stencilBack:{compare:"equal",passOp:"increment-clamp"}},uS[Ra.RENDERING_MASK_REMOVE]={stencilFront:{compare:"equal",passOp:"decrement-clamp"},stencilBack:{compare:"equal",passOp:"decrement-clamp"}},uS[Ra.MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:"equal",passOp:"keep"},stencilBack:{compare:"equal",passOp:"keep"}};var lS=exports.GlStencilSystem=function(){return B(function e(t){C(this,e),this._stencilCache={enabled:!1,stencilReference:0,stencilMode:Ra.NONE},this._renderTargetStencilState=Object.create(null),t.renderTarget.onRenderTargetChange.add(this)},[{key:"contextChange",value:function(e){this._gl=e,this._comparisonFuncMapping={always:e.ALWAYS,never:e.NEVER,equal:e.EQUAL,"not-equal":e.NOTEQUAL,less:e.LESS,"less-equal":e.LEQUAL,greater:e.GREATER,"greater-equal":e.GEQUAL},this._stencilOpsMapping={keep:e.KEEP,zero:e.ZERO,replace:e.REPLACE,invert:e.INVERT,"increment-clamp":e.INCR,"decrement-clamp":e.DECR,"increment-wrap":e.INCR_WRAP,"decrement-wrap":e.DECR_WRAP},this._stencilCache.enabled=!1,this._stencilCache.stencilMode=Ra.NONE,this._stencilCache.stencilReference=0}},{key:"onRenderTargetChange",value:function(e){if(this._activeRenderTarget!==e){this._activeRenderTarget=e;var t=this._renderTargetStencilState[e.uid];t||(t=this._renderTargetStencilState[e.uid]={stencilMode:Ra.DISABLED,stencilReference:0}),this.setStencilMode(t.stencilMode,t.stencilReference)}}},{key:"setStencilMode",value:function(e,t){var r=this._renderTargetStencilState[this._activeRenderTarget.uid],n=this._gl,i=uS[e],a=this._stencilCache;r.stencilMode=e,r.stencilReference=t,e!==Ra.DISABLED?(this._stencilCache.enabled||(this._stencilCache.enabled=!0,n.enable(n.STENCIL_TEST)),e===a.stencilMode&&a.stencilReference===t||(a.stencilMode=e,a.stencilReference=t,n.stencilFunc(this._comparisonFuncMapping[i.stencilBack.compare],t,255),n.stencilOp(n.KEEP,n.KEEP,this._stencilOpsMapping[i.stencilBack.passOp]))):this._stencilCache.enabled&&(this._stencilCache.enabled=!1,n.disable(n.STENCIL_TEST))}}])}();lS.extension={type:[Z.WebGLSystem],name:"stencil"};var cS=exports.UboSystem=function(){return B(function e(t){C(this,e),this._syncFunctionHash=Object.create(null),this._adaptor=t,this._systemCheck()},[{key:"_systemCheck",value:function(){if(!Rp())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}},{key:"ensureUniformGroup",value:function(e){var t=this.getUniformGroupData(e);e.buffer||(e.buffer=new Wa({data:new Float32Array(t.layout.size/4),usage:Va.UNIFORM|Va.COPY_DST}))}},{key:"getUniformGroupData",value:function(e){return this._syncFunctionHash[e._signature]||this._initUniformGroup(e)}},{key:"_initUniformGroup",value:function(e){var t=e._signature,r=this._syncFunctionHash[t];if(!r){var n=Object.keys(e.uniformStructures).map(function(t){return e.uniformStructures[t]}),i=this._adaptor.createUboElements(n),a=this._generateUboSync(i.uboElements);r=this._syncFunctionHash[t]={layout:i,syncFunction:a}}return this._syncFunctionHash[t]}},{key:"_generateUboSync",value:function(e){return this._adaptor.generateUboSync(e)}},{key:"syncUniformGroup",value:function(e,t,r){var n=this.getUniformGroupData(e);return e.buffer||(e.buffer=new Wa({data:new Float32Array(n.layout.size/4),usage:Va.UNIFORM|Va.COPY_DST})),t||(t=e.buffer.data),r||(r=0),n.syncFunction(e.uniforms,t,r),!0}},{key:"updateUniformGroup",value:function(e){if(e.isStatic&&!e._dirtyId)return!1;e._dirtyId=0;var t=this.syncUniformGroup(e);return e.buffer.update(),t}},{key:"destroy",value:function(){this._syncFunctionHash=null}}])}(),hS=exports.WGSL_TO_STD40_SIZE={f32:4,"vec2<f32>":8,"vec3<f32>":12,"vec4<f32>":16,"mat2x2<f32>":32,"mat3x3<f32>":48,"mat4x4<f32>":64};function dS(e){for(var t=e.map(function(e){return{data:e,offset:0,size:0}}),r=0,n=0,i=0,a=0;a<t.length;a++){var o=t[a];if(!(r=hS[o.data.type]))throw new Error("Unknown type ".concat(o.data.type));if(o.data.size>1&&(r=Math.max(r,16)*o.data.size),o.size=r,n%r!=0&&n<16){var s=n%r%16;n+=s,i+=s}n+r>16?(i=16*Math.ceil(i/16),o.offset=i,i+=r,n=r):(o.offset=i,n+=r,i+=r)}return{uboElements:t,size:i=16*Math.ceil(i/16)}}var fS=exports.uniformParsers=[{type:"mat3x3<f32>",test:function(e){return void 0!==e.value.a},ubo:"\n            var matrix = uv[name].toArray(true);\n            data[offset] = matrix[0];\n            data[offset + 1] = matrix[1];\n            data[offset + 2] = matrix[2];\n            data[offset + 4] = matrix[3];\n            data[offset + 5] = matrix[4];\n            data[offset + 6] = matrix[5];\n            data[offset + 8] = matrix[6];\n            data[offset + 9] = matrix[7];\n            data[offset + 10] = matrix[8];\n        ",uniform:"\n            gl.uniformMatrix3fv(ud[name].location, false, uv[name].toArray(true));\n        "},{type:"vec4<f32>",test:function(e){return"vec4<f32>"===e.type&&1===e.size&&void 0!==e.value.width},ubo:"\n            v = uv[name];\n            data[offset] = v.x;\n            data[offset + 1] = v.y;\n            data[offset + 2] = v.width;\n            data[offset + 3] = v.height;\n        ",uniform:"\n            cv = ud[name].value;\n            v = uv[name];\n            if (cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height) {\n                cv[0] = v.x;\n                cv[1] = v.y;\n                cv[2] = v.width;\n                cv[3] = v.height;\n                gl.uniform4f(ud[name].location, v.x, v.y, v.width, v.height);\n            }\n        "},{type:"vec2<f32>",test:function(e){return"vec2<f32>"===e.type&&1===e.size&&void 0!==e.value.x},ubo:"\n            v = uv[name];\n            data[offset] = v.x;\n            data[offset + 1] = v.y;\n        ",uniform:"\n            cv = ud[name].value;\n            v = uv[name];\n            if (cv[0] !== v.x || cv[1] !== v.y) {\n                cv[0] = v.x;\n                cv[1] = v.y;\n                gl.uniform2f(ud[name].location, v.x, v.y);\n            }\n        "},{type:"vec4<f32>",test:function(e){return"vec4<f32>"===e.type&&1===e.size&&void 0!==e.value.red},ubo:"\n            v = uv[name];\n            data[offset] = v.red;\n            data[offset + 1] = v.green;\n            data[offset + 2] = v.blue;\n            data[offset + 3] = v.alpha;\n        ",uniform:"\n            cv = ud[name].value;\n            v = uv[name];\n            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha) {\n                cv[0] = v.red;\n                cv[1] = v.green;\n                cv[2] = v.blue;\n                cv[3] = v.alpha;\n                gl.uniform4f(ud[name].location, v.red, v.green, v.blue, v.alpha);\n            }\n        "},{type:"vec3<f32>",test:function(e){return"vec3<f32>"===e.type&&1===e.size&&void 0!==e.value.red},ubo:"\n            v = uv[name];\n            data[offset] = v.red;\n            data[offset + 1] = v.green;\n            data[offset + 2] = v.blue;\n        ",uniform:"\n            cv = ud[name].value;\n            v = uv[name];\n            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue) {\n                cv[0] = v.red;\n                cv[1] = v.green;\n                cv[2] = v.blue;\n                gl.uniform3f(ud[name].location, v.red, v.green, v.blue);\n            }\n        "}];function pS(e,t,r,n){for(var i=["\n        var v = null;\n        var v2 = null;\n        var t = 0;\n        var index = 0;\n        var name = null;\n        var arrayOffset = null;\n    "],a=0,o=0;o<e.length;o++){for(var s=e[o],u=s.data.name,l=!1,c=0,h=0;h<fS.length;h++){if(fS[h].test(s.data)){c=s.offset/4,i.push('name = "'.concat(u,'";'),"offset += ".concat(c-a,";"),fS[h][t]||fS[h].ubo),l=!0;break}}if(!l)if(s.data.size>1)c=s.offset/4,i.push(r(s,c-a));else{var d=n[s.data.type];c=s.offset/4,i.push("\n                    v = uv.".concat(u,";\n                    offset += ").concat(c-a,";\n                    ").concat(d,";\n                "))}a=c}var f=i.join("\n");return new Function("uv","data","offset",f)}var vS=Object.defineProperty,mS=Object.defineProperties,gS=Object.getOwnPropertyDescriptors,_S=Object.getOwnPropertySymbols,yS=Object.prototype.hasOwnProperty,xS=Object.prototype.propertyIsEnumerable,bS=function(e,t,r){return t in e?vS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},TS=function(e,t){for(var r in t||(t={}))yS.call(t,r)&&bS(e,r,t[r]);if(_S){var n,i=U(_S(t));try{for(i.s();!(n=i.n()).done;){r=n.value;xS.call(t,r)&&bS(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},SS=function(e,t){return mS(e,gS(t))};function kS(e,t){return"\n        for (let i = 0; i < ".concat(e*t,"; i++) {\n            data[offset + (((i / ").concat(e,")|0) * 4) + (i % ").concat(e,")] = v[i];\n        }\n    ")}var ES=exports.uboSyncFunctionsSTD40={f32:"\n        data[offset] = v;",i32:"\n        data[offset] = v;","vec2<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];","vec3<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];\n        data[offset + 2] = v[2];","vec4<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];\n        data[offset + 2] = v[2];\n        data[offset + 3] = v[3];","mat2x2<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];\n        data[offset + 4] = v[2];\n        data[offset + 5] = v[3];","mat3x3<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];\n        data[offset + 2] = v[2];\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];","mat4x4<f32>":"\n        for (let i = 0; i < 16; i++) {\n            data[offset + i] = v[i];\n        }","mat3x2<f32>":kS(3,2),"mat4x2<f32>":kS(4,2),"mat2x3<f32>":kS(2,3),"mat4x3<f32>":kS(4,3),"mat2x4<f32>":kS(2,4),"mat3x4<f32>":kS(3,4)},AS=exports.uboSyncFunctionsWGSL=SS(TS({},ES),{"mat2x2<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];\n        data[offset + 2] = v[2];\n        data[offset + 3] = v[3];\n    "});function wS(e,t){var r=Math.max(hS[e.data.type]/16,1),n=e.data.value.length/e.data.size,i=(4-n%4)%4;return"\n        v = uv.".concat(e.data.name,";\n        offset += ").concat(t,";\n\n        arrayOffset = offset;\n\n        t = 0;\n\n        for(var i=0; i < ").concat(e.data.size*r,"; i++)\n        {\n            for(var j = 0; j < ").concat(n,"; j++)\n            {\n                data[arrayOffset++] = v[t++];\n            }\n            ").concat(0!==i?"arrayOffset += ".concat(i,";"):"","\n        }\n    ")}function RS(e){return pS(e,"uboStd40",wS,ES)}var PS=exports.GlUboSystem=function(e){function t(){return C(this,t),x(this,t,[{createUboElements:dS,generateUboSync:RS}])}return E(t,cS),B(t)}();PS.extension={type:[Z.WebGLSystem],name:"ubo"};var MS=exports.GlRenderTargetAdaptor=function(){return B(function e(){C(this,e),this._clearColorCache=[0,0,0,0],this._viewPortCache=new St},[{key:"init",value:function(e,t){this._renderer=e,this._renderTargetSystem=t,e.runners.contextChange.add(this)}},{key:"contextChange",value:function(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new St}},{key:"copyToTexture",value:function(e,t,r,n,i){var a=this._renderTargetSystem,o=this._renderer,s=a.getGpuRenderTarget(e),u=o.gl;return this.finishRenderPass(e),u.bindFramebuffer(u.FRAMEBUFFER,s.resolveTargetFramebuffer),o.texture.bind(t,0),u.copyTexSubImage2D(u.TEXTURE_2D,0,i.x,i.y,r.x,r.y,n.width,n.height),t}},{key:"startRenderPass",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=this._renderTargetSystem,o=e.colorTexture,s=a.getGpuRenderTarget(e),u=i.y;e.isRoot&&(u=o.pixelHeight-i.height),e.colorTextures.forEach(function(e){t._renderer.texture.unbind(e)});var l=this._renderer.gl;l.bindFramebuffer(l.FRAMEBUFFER,s.framebuffer);var c=this._viewPortCache;c.x===i.x&&c.y===u&&c.width===i.width&&c.height===i.height||(c.x=i.x,c.y=u,c.width=i.width,c.height=i.height,l.viewport(i.x,u,i.width,i.height)),s.depthStencilRenderBuffer||!e.stencil&&!e.depth||this._initStencil(s),this.clear(e,r,n)}},{key:"finishRenderPass",value:function(e){var t=this._renderTargetSystem.getGpuRenderTarget(e);if(t.msaa){var r=this._renderer.gl;r.bindFramebuffer(r.FRAMEBUFFER,t.resolveTargetFramebuffer),r.bindFramebuffer(r.READ_FRAMEBUFFER,t.framebuffer),r.blitFramebuffer(0,0,t.width,t.height,0,0,t.width,t.height,r.COLOR_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,t.framebuffer)}}},{key:"initGpuRenderTarget",value:function(e){var t=this._renderer.gl,r=new sS,n=e.colorTexture;return zi.test(n.resource)?(this._renderer.context.ensureCanvasSize(e.colorTexture.resource),r.framebuffer=null,r):(this._initColor(e,r),t.bindFramebuffer(t.FRAMEBUFFER,null),r)}},{key:"destroyGpuRenderTarget",value:function(e){var t=this._renderer.gl;e.framebuffer&&(t.deleteFramebuffer(e.framebuffer),e.framebuffer=null),e.resolveTargetFramebuffer&&(t.deleteFramebuffer(e.resolveTargetFramebuffer),e.resolveTargetFramebuffer=null),e.depthStencilRenderBuffer&&(t.deleteRenderbuffer(e.depthStencilRenderBuffer),e.depthStencilRenderBuffer=null),e.msaaRenderBuffer.forEach(function(e){t.deleteRenderbuffer(e)}),e.msaaRenderBuffer=null}},{key:"clear",value:function(e,t,r){if(t){var n=this._renderTargetSystem;"boolean"==typeof t&&(t=t?Pp.ALL:Pp.NONE);var i=this._renderer.gl;if(t&Pp.COLOR){null!=r||(r=n.defaultClearColor);var a=this._clearColorCache,o=r;a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]&&a[3]===o[3]||(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],i.clearColor(o[0],o[1],o[2],o[3]))}i.clear(t)}}},{key:"resizeGpuRenderTarget",value:function(e){if(!e.isRoot){var t=this._renderTargetSystem.getGpuRenderTarget(e);this._resizeColor(e,t),(e.stencil||e.depth)&&this._resizeStencil(t)}}},{key:"_initColor",value:function(e,t){var r=this._renderer,n=r.gl,i=n.createFramebuffer();if(t.resolveTargetFramebuffer=i,n.bindFramebuffer(n.FRAMEBUFFER,i),t.width=e.colorTexture.source.pixelWidth,t.height=e.colorTexture.source.pixelHeight,e.colorTextures.forEach(function(e,i){var a=e.source;a.antialias&&(r.context.supports.msaa?t.msaa=!0:Gt("[RenderTexture] Antialiasing on textures is not supported in WebGL1")),r.texture.bindSource(a,0);var o=r.texture.getGlSource(a).texture;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+i,3553,o,0)}),t.msaa){var a=n.createFramebuffer();t.framebuffer=a,n.bindFramebuffer(n.FRAMEBUFFER,a),e.colorTextures.forEach(function(e,r){var i=n.createRenderbuffer();t.msaaRenderBuffer[r]=i})}else t.framebuffer=i;this._resizeColor(e,t)}},{key:"_resizeColor",value:function(e,t){var r=e.colorTexture.source;if(t.width=r.pixelWidth,t.height=r.pixelHeight,e.colorTextures.forEach(function(e,t){0!==t&&e.source.resize(r.width,r.height,r._resolution)}),t.msaa){var n=this._renderer,i=n.gl,a=t.framebuffer;i.bindFramebuffer(i.FRAMEBUFFER,a),e.colorTextures.forEach(function(e,r){var a=e.source;n.texture.bindSource(a,0);var o=n.texture.getGlSource(a).internalFormat,s=t.msaaRenderBuffer[r];i.bindRenderbuffer(i.RENDERBUFFER,s),i.renderbufferStorageMultisample(i.RENDERBUFFER,4,o,a.pixelWidth,a.pixelHeight),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+r,i.RENDERBUFFER,s)})}}},{key:"_initStencil",value:function(e){if(null!==e.framebuffer){var t=this._renderer.gl,r=t.createRenderbuffer();e.depthStencilRenderBuffer=r,t.bindRenderbuffer(t.RENDERBUFFER,r),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r),this._resizeStencil(e)}}},{key:"_resizeStencil",value:function(e){var t=this._renderer.gl;t.bindRenderbuffer(t.RENDERBUFFER,e.depthStencilRenderBuffer),e.msaa?t.renderbufferStorageMultisample(t.RENDERBUFFER,4,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,2===this._renderer.context.webGLVersion?t.DEPTH24_STENCIL8:t.DEPTH_STENCIL,e.width,e.height)}},{key:"postrender",value:function(e){if(this._renderer.context.multiView&&zi.test(e.colorTexture.resource)){var t=this._renderer.context.canvas,r=e.colorTexture;r.context2D.drawImage(t,0,r.pixelHeight-t.height)}}}])}();function OS(e,t,r,n,i,a){var o=a?1:-1;return e.identity(),e.a=1/n*2,e.d=o*(1/i*2),e.tx=-1-t*e.a,e.ty=-o-r*e.d,e}var CS=Object.defineProperty,GS=Object.getOwnPropertySymbols,BS=Object.prototype.hasOwnProperty,IS=Object.prototype.propertyIsEnumerable,FS=function(e,t,r){return t in e?CS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},DS=function(e,t){for(var r in t||(t={}))BS.call(t,r)&&FS(e,r,t[r]);if(GS){var n,i=U(GS(t));try{for(i.s();!(n=i.n()).done;){r=n.value;IS.call(t,r)&&FS(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},US=new Map;function LS(e,t){if(!US.has(e)){var r=new bi({source:new zi(DS({resource:e},t))}),n=function(){US.get(e)===r&&US.delete(e)};r.once("destroy",n),r.source.once("destroy",n),US.set(e,r)}return US.get(e)}function NS(e){return US.has(e)}function XS(e){var t=e.colorTexture.source.resource;return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement&&document.body.contains(t)}var HS=Object.defineProperty,jS=Object.getOwnPropertySymbols,zS=Object.prototype.hasOwnProperty,VS=Object.prototype.propertyIsEnumerable,WS=function(e,t,r){return t in e?HS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},YS=function(e,t){for(var r in t||(t={}))zS.call(t,r)&&WS(e,r,t[r]);if(jS){var n,i=U(jS(t));try{for(i.s();!(n=i.n()).done;){r=n.value;VS.call(t,r)&&WS(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},KS=function(){return B(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(C(this,e),this.uid=ot("renderTarget"),this.colorTextures=[],this.dirtyId=0,this.isRoot=!1,this._size=new Float32Array(2),this._managedColorTextures=!1,t=YS(YS({},e.defaultOptions),t),this.stencil=t.stencil,this.depth=t.depth,this.isRoot=t.isRoot,"number"==typeof t.colorTextures){this._managedColorTextures=!0;for(var r=0;r<t.colorTextures;r++)this.colorTextures.push(new ui({width:t.width,height:t.height,resolution:t.resolution,antialias:t.antialias}))}else{this.colorTextures=m(t.colorTextures.map(function(e){return e.source}));var n=this.colorTexture.source;this.resize(n.width,n.height,n._resolution)}this.colorTexture.source.on("resize",this.onSourceResize,this),(t.depthStencilTexture||this.stencil)&&(t.depthStencilTexture instanceof bi||t.depthStencilTexture instanceof ui?this.depthStencilTexture=t.depthStencilTexture.source:this.ensureDepthStencilTexture())},[{key:"size",get:function(){var e=this._size;return e[0]=this.pixelWidth,e[1]=this.pixelHeight,e}},{key:"width",get:function(){return this.colorTexture.source.width}},{key:"height",get:function(){return this.colorTexture.source.height}},{key:"pixelWidth",get:function(){return this.colorTexture.source.pixelWidth}},{key:"pixelHeight",get:function(){return this.colorTexture.source.pixelHeight}},{key:"resolution",get:function(){return this.colorTexture.source._resolution}},{key:"colorTexture",get:function(){return this.colorTextures[0]}},{key:"onSourceResize",value:function(e){this.resize(e.width,e.height,e._resolution,!0)}},{key:"ensureDepthStencilTexture",value:function(){this.depthStencilTexture||(this.depthStencilTexture=new ui({width:this.width,height:this.height,resolution:this.resolution,format:"depth24plus-stencil8",autoGenerateMipmaps:!1,antialias:!1,mipLevelCount:1}))}},{key:"resize",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.resolution,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.dirtyId++,this.colorTextures.forEach(function(i,a){n&&0===a||i.source.resize(e,t,r)}),this.depthStencilTexture&&this.depthStencilTexture.source.resize(e,t,r)}},{key:"destroy",value:function(){this.colorTexture.source.off("resize",this.onSourceResize,this),this._managedColorTextures&&this.colorTextures.forEach(function(e){e.destroy()}),this.depthStencilTexture&&(this.depthStencilTexture.destroy(),delete this.depthStencilTexture)}}])}();KS.defaultOptions={width:0,height:0,resolution:1,colorTextures:1,stencil:!1,depth:!1,antialias:!1,isRoot:!1};var qS=exports.RenderTarget=KS,ZS=exports.RenderTargetSystem=function(){return B(function e(t){C(this,e),this.rootViewPort=new St,this.viewport=new St,this.onRenderTargetChange=new Mp("onRenderTargetChange"),this.projectionMatrix=new tt,this.defaultClearColor=[0,0,0,0],this._renderSurfaceToRenderTargetHash=new Map,this._gpuRenderTargetHash=Object.create(null),this._renderTargetStack=[],this._renderer=t},[{key:"finishRenderPass",value:function(){this.adaptor.finishRenderPass(this.renderTarget)}},{key:"renderStart",value:function(e){var t=e.target,r=e.clear,n=e.clearColor,i=e.frame;this._renderTargetStack.length=0,this.push(t,r,n,i),this.rootViewPort.copyFrom(this.viewport),this.rootRenderTarget=this.renderTarget,this.renderingToScreen=XS(this.rootRenderTarget)}},{key:"postrender",value:function(){var e,t;null==(t=(e=this.adaptor).postrender)||t.call(e,this.rootRenderTarget)}},{key:"bind",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=this.getRenderTarget(e),a=this.renderTarget!==i;this.renderTarget=i,this.renderSurface=e;var o=this.getGpuRenderTarget(i);i.pixelWidth===o.width&&i.pixelHeight===o.height||(this.adaptor.resizeGpuRenderTarget(i),o.width=i.pixelWidth,o.height=i.pixelHeight);var s=i.colorTexture,u=this.viewport,l=s.pixelWidth,c=s.pixelHeight;if(!n&&e instanceof bi&&(n=e.frame),n){var h=s._resolution;u.x=n.x*h+.5|0,u.y=n.y*h+.5|0,u.width=n.width*h+.5|0,u.height=n.height*h+.5|0}else u.x=0,u.y=0,u.width=l,u.height=c;return OS(this.projectionMatrix,0,0,u.width/s.resolution,u.height/s.resolution,!i.isRoot),this.adaptor.startRenderPass(i,t,r,u),a&&this.onRenderTargetChange.emit(i),i}},{key:"clear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pp.ALL,r=arguments.length>2?arguments[2]:void 0;t&&(e&&(e=this.getRenderTarget(e)),this.adaptor.clear(e||this.renderTarget,t,r,this.viewport))}},{key:"contextChange",value:function(){this._gpuRenderTargetHash=Object.create(null)}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pp.ALL,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=this.bind(e,t,r,n);return this._renderTargetStack.push({renderTarget:i,frame:n}),i}},{key:"pop",value:function(){this._renderTargetStack.pop();var e=this._renderTargetStack[this._renderTargetStack.length-1];this.bind(e.renderTarget,!1,null,e.frame)}},{key:"getRenderTarget",value:function(e){var t;return e.isTexture&&(e=e.source),null!=(t=this._renderSurfaceToRenderTargetHash.get(e))?t:this._initRenderTarget(e)}},{key:"copyToTexture",value:function(e,t,r,n,i){r.x<0&&(n.width+=r.x,i.x-=r.x,r.x=0),r.y<0&&(n.height+=r.y,i.y-=r.y,r.y=0);var a=e.pixelWidth,o=e.pixelHeight;return n.width=Math.min(n.width,a-r.x),n.height=Math.min(n.height,o-r.y),this.adaptor.copyToTexture(e,t,r,n,i)}},{key:"ensureDepthStencil",value:function(){this.renderTarget.stencil||(this.renderTarget.stencil=!0,this.adaptor.startRenderPass(this.renderTarget,!1,null,this.viewport))}},{key:"destroy",value:function(){this._renderer=null,this._renderSurfaceToRenderTargetHash.forEach(function(e,t){e!==t&&e.destroy()}),this._renderSurfaceToRenderTargetHash.clear(),this._gpuRenderTargetHash=Object.create(null)}},{key:"_initRenderTarget",value:function(e){var t=this,r=null;return zi.test(e)&&(e=LS(e).source),e instanceof qS?r=e:e instanceof ui&&(r=new qS({colorTextures:[e]}),zi.test(e.source.resource)&&(r.isRoot=!0),e.once("destroy",function(){r.destroy(),t._renderSurfaceToRenderTargetHash.delete(e);var n=t._gpuRenderTargetHash[r.uid];n&&(t._gpuRenderTargetHash[r.uid]=null,t.adaptor.destroyGpuRenderTarget(n))})),this._renderSurfaceToRenderTargetHash.set(e,r),r}},{key:"getGpuRenderTarget",value:function(e){return this._gpuRenderTargetHash[e.uid]||(this._gpuRenderTargetHash[e.uid]=this.adaptor.initGpuRenderTarget(e))}}])}(),QS=exports.GlRenderTargetSystem=function(e){function t(e){var r;return C(this,t),(r=x(this,t,[e])).adaptor=new MS,r.adaptor.init(e,r),r}return E(t,ZS),B(t)}();QS.extension={type:[Z.WebGLSystem],name:"renderTarget"};var JS=exports.BufferResource=function(e){function t(e){var r,n=e.buffer,i=e.offset,a=e.size;return C(this,t),(r=x(this,t)).uid=ot("buffer"),r._resourceType="bufferResource",r._touched=0,r._resourceId=ot("resource"),r._bufferResource=!0,r.destroyed=!1,r.buffer=n,r.offset=0|i,r.size=a,r.buffer.on("change",r.onBufferChange,r),r}return E(t,ue),B(t,[{key:"onBufferChange",value:function(){this._resourceId=ot("resource"),this.emit("change",this)}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.destroyed=!0,e&&this.buffer.destroy(),this.emit("change",this),this.buffer=null}}])}();function $S(e,t){var r=[],n=["\n        var g = s.groups;\n        var sS = r.shader;\n        var p = s.glProgram;\n        var ugS = r.uniformGroup;\n        var resources;\n    "],i=!1,a=0,o=0,s=t._getProgramData(e.glProgram);for(var u in e.groups){var l=e.groups[u];for(var c in r.push("\n            resources = g[".concat(u,"].resources;\n        ")),l.resources){var h=l.resources[c];if(h instanceof Bs)h.ubo?r.push("\n                        sS.bindUniformBlock(\n                            resources[".concat(c,"],\n                            sS._uniformBindMap[").concat(u,"[").concat(c,"],\n                            ").concat(a++,"\n                        );\n                    ")):r.push("\n                        ugS.updateUniformGroup(resources[".concat(c,"], p, sD);\n                    "));else if(h instanceof JS)r.push("\n                    sS.bindUniformBlock(\n                        resources[".concat(c,"],\n                        sS._uniformBindMap[").concat(u,"[").concat(c,"],\n                        ").concat(a++,"\n                    );\n                "));else if(h instanceof ui){var d=e._uniformBindMap[u][c],f=s.uniformData[d];f&&(i||(i=!0,n.push("\n                        var tS = r.texture;\n                        ")),t._gl.uniform1i(f.location,o),r.push("\n                        tS.bind(resources[".concat(c,"], ").concat(o,");\n                    ")),o++)}}}var p=[].concat(n,r).join("\n");return new Function("r","s","sD",p)}var ek=exports.IGLUniformData=B(function e(){C(this,e)}),tk=exports.GlProgramData=function(){return B(function e(t,r){C(this,e),this.program=t,this.uniformData=r,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBlockBindings={}},[{key:"destroy",value:function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBlockBindings=null,this.program=null}}])}();function rk(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}function nk(e){for(var t=new Array(e),r=0;r<t.length;r++)t[r]=!1;return t}function ik(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return nk(2*t);case"bvec3":return nk(3*t);case"bvec4":return nk(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var ak=null,ok={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"},sk={float:"float32",vec2:"float32x2",vec3:"float32x3",vec4:"float32x4",int:"sint32",ivec2:"sint32x2",ivec3:"sint32x3",ivec4:"sint32x4",uint:"uint32",uvec2:"uint32x2",uvec3:"uint32x3",uvec4:"uint32x4",bool:"uint32",bvec2:"uint32x2",bvec3:"uint32x3",bvec4:"uint32x4"};function uk(e,t){if(!ak){var r=Object.keys(ok);ak={};for(var n=0;n<r.length;++n){var i=r[n];ak[e[i]]=ok[i]}}return ak[t]}function lk(e,t){var r=uk(e,t);return sk[r]||"float32"}function ck(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),a=0;a<i;a++){var o=t.getActiveAttrib(e,a);if(!o.name.startsWith("gl_")){var s=lk(t,o.type);n[o.name]={location:0,format:s,stride:ko(s).stride,offset:0,instance:!1,start:0}}}var u=Object.keys(n);if(r){u.sort(function(e,t){return e>t?1:-1});for(var l=0;l<u.length;l++)n[u[l]].location=l,t.bindAttribLocation(e,l,u[l]);t.linkProgram(e)}else for(var c=0;c<u.length;c++)n[u[c]].location=t.getAttribLocation(e,u[c]);return n}function hk(e,t){if(!t.ACTIVE_UNIFORM_BLOCKS)return{};for(var r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORM_BLOCKS),i=0;i<n;i++){var a=t.getActiveUniformBlockName(e,i),o=t.getUniformBlockIndex(e,a),s=t.getActiveUniformBlockParameter(e,i,t.UNIFORM_BLOCK_DATA_SIZE);r[a]={name:a,index:o,size:s}}return r}function dk(e,t){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<n;i++){var a=t.getActiveUniform(e,i),o=a.name.replace(/\[.*?\]$/,""),s=!!a.name.match(/\[.*?\]$/),u=uk(t,a.type);r[o]={name:o,index:i,type:u,size:a.size,isArray:s,value:ik(u,a.size)}}return r}function fk(e,t){var r,n=e.getShaderSource(t).split("\n").map(function(e,t){return"".concat(t,": ").concat(e)}),i=e.getShaderInfoLog(t),a=i.split("\n"),o={},s=a.map(function(e){return parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(e){return!(!e||o[e])&&(o[e]=!0,!0)}),u=[""];s.forEach(function(e){n[e-1]="%c".concat(n[e-1],"%c"),u.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var l=n.join("\n");u[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),(r=console).warn.apply(r,u),console.groupEnd()}function pk(e,t,r,n){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||fk(e,r),e.getShaderParameter(n,e.COMPILE_STATUS)||fk(e,n),console.error("PixiJS Error: Could not initialize shader."),""!==e.getProgramInfoLog(t)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}function vk(e,t){var r=rk(e,e.VERTEX_SHADER,t.vertex),n=rk(e,e.FRAGMENT_SHADER,t.fragment),i=e.createProgram();e.attachShader(i,r),e.attachShader(i,n);var a=t.transformFeedbackVaryings;a&&("function"!=typeof e.transformFeedbackVaryings?Gt("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(i,a.names,"separate"===a.bufferMode?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||pk(e,i,r,n),t._attributeData=ck(i,e,!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertex)),t._uniformData=dk(i,e),t._uniformBlockData=hk(i,e),e.deleteShader(r),e.deleteShader(n);var o={};for(var s in t._uniformData){var u=t._uniformData[s];o[s]={location:e.getUniformLocation(i,s),value:ik(u.type,u.size)}}return new tk(i,o)}var mk={textureCount:0,blockIndex:0},gk=exports.GlShaderSystem=function(){return B(function e(t){C(this,e),this._activeProgram=null,this._programDataHash=Object.create(null),this._nextIndex=0,this._boundUniformsIdsToIndexHash=Object.create(null),this._boundIndexToUniformsHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._renderer=t},[{key:"contextChange",value:function(e){this._gl=e,this._maxBindings=e.MAX_UNIFORM_BUFFER_BINDINGS?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0,this._programDataHash=Object.create(null),this._boundUniformsIdsToIndexHash=Object.create(null),this._boundIndexToUniformsHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._activeProgram=null,this.maxTextures=xa()}},{key:"bind",value:function(e,t){if(this._setProgram(e.glProgram),!t){mk.textureCount=0,mk.blockIndex=0;var r=this._shaderSyncFunctions[e.glProgram._key];r||(r=this._shaderSyncFunctions[e.glProgram._key]=this._generateShaderSync(e,this)),r(this._renderer,e,mk)}}},{key:"updateUniformGroup",value:function(e){this._renderer.uniformGroup.updateUniformGroup(e,this._activeProgram,mk)}},{key:"bindUniformBlock",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this._renderer.buffer,i=this._getProgramData(this._activeProgram),a=e._bufferResource;a&&this._renderer.ubo.updateUniformGroup(e),n.updateBuffer(e.buffer);var o=this._boundUniformsIdsToIndexHash[e.uid];if(void 0===o){var s=this._nextIndex++%this._maxBindings,u=this._boundIndexToUniformsHash[s];u&&(this._boundUniformsIdsToIndexHash[u.uid]=void 0),o=this._boundUniformsIdsToIndexHash[e.uid]=s,this._boundIndexToUniformsHash[s]=e,a?n.bindBufferRange(e.buffer,s,e.offset):n.bindBufferBase(e.buffer,s)}var l=this._gl,c=this._activeProgram._uniformBlockData[t].index;i.uniformBlockBindings[r]!==o&&(i.uniformBlockBindings[r]=o,l.uniformBlockBinding(i.program,c,o))}},{key:"_setProgram",value:function(e){if(this._activeProgram!==e){this._activeProgram=e;var t=this._getProgramData(e);this._gl.useProgram(t.program)}}},{key:"_getProgramData",value:function(e){return this._programDataHash[e._key]||this._createProgramData(e)}},{key:"_createProgramData",value:function(e){var t=e._key;return this._programDataHash[t]=vk(this._gl,e),this._programDataHash[t]}},{key:"destroy",value:function(){for(var e=0,t=Object.keys(this._programDataHash);e<t.length;e++){var r=t[e];this._programDataHash[r].destroy(),this._programDataHash[r]=null}this._programDataHash=null,this._boundUniformsIdsToIndexHash=null}},{key:"_generateShaderSync",value:function(e,t){return $S(e,t)}}])}();gk.extension={type:[Z.WebGLSystem],name:"shader"};var _k=exports.UNIFORM_TO_SINGLE_SETTERS={f32:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1f(location, v);\n        }","vec2<f32>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2f(location, v[0], v[1]);\n        }","vec3<f32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3f(location, v[0], v[1], v[2]);\n        }","vec4<f32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n        }",i32:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1i(location, v);\n        }","vec2<i32>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2i(location, v[0], v[1]);\n        }","vec3<i32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3i(location, v[0], v[1], v[2]);\n        }","vec4<i32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n        }",u32:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1ui(location, v);\n        }","vec2<u32>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2ui(location, v[0], v[1]);\n        }","vec3<u32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3ui(location, v[0], v[1], v[2]);\n        }","vec4<u32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n        }",bool:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1i(location, v);\n        }","vec2<bool>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2i(location, v[0], v[1]);\n        }","vec3<bool>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3i(location, v[0], v[1], v[2]);\n        }","vec4<bool>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n        }","mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);"},yk=exports.UNIFORM_TO_ARRAY_SETTERS={f32:"gl.uniform1fv(location, v);","vec2<f32>":"gl.uniform2fv(location, v);","vec3<f32>":"gl.uniform3fv(location, v);","vec4<f32>":"gl.uniform4fv(location, v);","mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);",i32:"gl.uniform1iv(location, v);","vec2<i32>":"gl.uniform2iv(location, v);","vec3<i32>":"gl.uniform3iv(location, v);","vec4<i32>":"gl.uniform4iv(location, v);",u32:"gl.uniform1iv(location, v);","vec2<u32>":"gl.uniform2iv(location, v);","vec3<u32>":"gl.uniform3iv(location, v);","vec4<u32>":"gl.uniform4iv(location, v);",bool:"gl.uniform1iv(location, v);","vec2<bool>":"gl.uniform2iv(location, v);","vec3<bool>":"gl.uniform3iv(location, v);","vec4<bool>":"gl.uniform4iv(location, v);"};function xk(e,t){var r=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n        var name = null;\n    "];for(var n in e.uniforms)if(t[n]){for(var i=e.uniformStructures[n],a=!1,o=0;o<fS.length;o++){var s=fS[o];if(i.type===s.type&&s.test(i)){r.push('name = "'.concat(n,'";'),fS[o].uniform),a=!0;break}}if(!a){var u=(1===i.size?_k:yk)[i.type].replace("location",'ud["'.concat(n,'"].location'));r.push('\n            cu = ud["'.concat(n,'"];\n            cv = cu.value;\n            v = uv["').concat(n,'"];\n            ').concat(u,";"))}}else e.uniforms[n]instanceof Bs?e.uniforms[n].ubo?r.push("\n                        renderer.shader.bindUniformBlock(uv.".concat(n,', "').concat(n,'");\n                    ')):r.push("\n                        renderer.shader.updateUniformGroup(uv.".concat(n,");\n                    ")):e.uniforms[n]instanceof JS&&r.push("\n                        renderer.shader.bindBufferResource(uv.".concat(n,', "').concat(n,'");\n                    '));return new Function("ud","uv","renderer","syncData",r.join("\n"))}var bk=exports.GlUniformGroupSystem=function(){return B(function e(t){C(this,e),this._cache={},this._uniformGroupSyncHash={},this._renderer=t,this.gl=null,this._cache={}},[{key:"contextChange",value:function(e){this.gl=e}},{key:"updateUniformGroup",value:function(e,t,r){var n=this._renderer.shader._getProgramData(t);e.isStatic&&e._dirtyId===n.uniformDirtyGroups[e.uid]||(n.uniformDirtyGroups[e.uid]=e._dirtyId,this._getUniformSyncFunction(e,t)(n.uniformData,e.uniforms,this._renderer,r))}},{key:"_getUniformSyncFunction",value:function(e,t){var r;return(null==(r=this._uniformGroupSyncHash[e._signature])?void 0:r[t._key])||this._createUniformSyncFunction(e,t)}},{key:"_createUniformSyncFunction",value:function(e,t){var r=this._uniformGroupSyncHash[e._signature]||(this._uniformGroupSyncHash[e._signature]={}),n=this._getSignature(e,t._uniformData,"u");return this._cache[n]||(this._cache[n]=this._generateUniformsSync(e,t._uniformData)),r[t._key]=this._cache[n],r[t._key]}},{key:"_generateUniformsSync",value:function(e,t){return xk(e,t)}},{key:"_getSignature",value:function(e,t,r){var n=e.uniforms,i=["".concat(r,"-")];for(var a in n)i.push(a),t[a]&&i.push(t[a].type);return i.join("-")}},{key:"destroy",value:function(){this._renderer=null,this._cache=null}}])}();function Tk(e){return e=e.replaceAll("texture2D","texture").replaceAll("gl_FragColor","finalColor").replaceAll("varying","in"),e="\n        out vec4 finalColor;\n    ".concat(e,"\n    ")}bk.extension={type:[Z.WebGLSystem],name:"uniformGroup"};var Sk={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function kk(e){return Sk[e]}function Ek(e){var t={};if(t.normal=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t.add=[e.ONE,e.ONE],t.multiply=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t.screen=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t.none=[0,0],t["normal-npm"]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t["add-npm"]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t["screen-npm"]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t.erase=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],!(e instanceof hn.get().getWebGLRenderingContext()))t.min=[e.ONE,e.ONE,e.ONE,e.ONE,e.MIN,e.MIN],t.max=[e.ONE,e.ONE,e.ONE,e.ONE,e.MAX,e.MAX];else{var r=e.getExtension("EXT_blend_minmax");r&&(t.min=[e.ONE,e.ONE,e.ONE,e.ONE,r.MIN_EXT,r.MIN_EXT],t.max=[e.ONE,e.ONE,e.ONE,e.ONE,r.MAX_EXT,r.MAX_EXT])}return t}var Ak=0,wk=1,Rk=2,Pk=3,Mk=4,Ok=5,Ck=function(){function e(){C(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode="none",this._blendEq=!1,this.map=[],this.map[Ak]=this.setBlend,this.map[wk]=this.setOffset,this.map[Rk]=this.setCullFace,this.map[Pk]=this.setDepthTest,this.map[Mk]=this.setFrontFace,this.map[Ok]=this.setDepthMask,this.checks=[],this.defaultState=Al.for2d()}return B(e,[{key:"contextChange",value:function(e){this.gl=e,this.blendModesMap=Ek(e),this.reset()}},{key:"set",value:function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,r=0;t;)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(var n=0;n<this.checks.length;n++)this.checks[n](this,e)}},{key:"forceState",value:function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(var r=0;r<this.checks.length;r++)this.checks[r](this,e);this.stateId=e.data}},{key:"setBlend",value:function(t){this._updateCheck(e._checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}},{key:"setOffset",value:function(t){this._updateCheck(e._checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}},{key:"setDepthTest",value:function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}},{key:"setDepthMask",value:function(e){this.gl.depthMask(e)}},{key:"setCullFace",value:function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}},{key:"setFrontFace",value:function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}},{key:"setBlendMode",value:function(e){if(this.blendModesMap[e]||(e="normal"),e!==this.blendMode){this.blendMode=e;var t=this.blendModesMap[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}}},{key:"setPolygonOffset",value:function(e,t){this.gl.polygonOffset(e,t)}},{key:"reset",value:function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode="",this.setBlendMode("normal")}},{key:"_updateCheck",value:function(e,t){var r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):t||-1===r||this.checks.splice(r,1)}},{key:"destroy",value:function(){this.gl=null,this.checks.length=0}}],[{key:"_checkBlendMode",value:function(e,t){e.setBlendMode(t.blendMode)}},{key:"_checkPolygonOffset",value:function(e,t){e.setPolygonOffset(1,t.polygonOffset)}}])}();Ck.extension={type:[Z.WebGLSystem],name:"state"};var Gk=exports.GlStateSystem=Ck,Bk=exports.GlTexture=B(function e(t){C(this,e),this.target=jT.TEXTURE_2D,this.texture=t,this.width=-1,this.height=-1,this.type=VT.UNSIGNED_BYTE,this.internalFormat=HT.RGBA,this.format=HT.RGBA,this.samplerType=0}),Ik=exports.glUploadBufferImageResource={id:"buffer",upload:function(e,t,r){t.width===e.width||t.height===e.height?r.texSubImage2D(r.TEXTURE_2D,0,0,0,e.width,e.height,t.format,t.type,e.resource):r.texImage2D(t.target,0,t.internalFormat,e.width,e.height,0,t.format,t.type,e.resource),t.width=e.width,t.height=e.height}},Fk={"bc1-rgba-unorm":!0,"bc1-rgba-unorm-srgb":!0,"bc2-rgba-unorm":!0,"bc2-rgba-unorm-srgb":!0,"bc3-rgba-unorm":!0,"bc3-rgba-unorm-srgb":!0,"bc4-r-unorm":!0,"bc4-r-snorm":!0,"bc5-rg-unorm":!0,"bc5-rg-snorm":!0,"bc6h-rgb-ufloat":!0,"bc6h-rgb-float":!0,"bc7-rgba-unorm":!0,"bc7-rgba-unorm-srgb":!0,"etc2-rgb8unorm":!0,"etc2-rgb8unorm-srgb":!0,"etc2-rgb8a1unorm":!0,"etc2-rgb8a1unorm-srgb":!0,"etc2-rgba8unorm":!0,"etc2-rgba8unorm-srgb":!0,"eac-r11unorm":!0,"eac-r11snorm":!0,"eac-rg11unorm":!0,"eac-rg11snorm":!0,"astc-4x4-unorm":!0,"astc-4x4-unorm-srgb":!0,"astc-5x4-unorm":!0,"astc-5x4-unorm-srgb":!0,"astc-5x5-unorm":!0,"astc-5x5-unorm-srgb":!0,"astc-6x5-unorm":!0,"astc-6x5-unorm-srgb":!0,"astc-6x6-unorm":!0,"astc-6x6-unorm-srgb":!0,"astc-8x5-unorm":!0,"astc-8x5-unorm-srgb":!0,"astc-8x6-unorm":!0,"astc-8x6-unorm-srgb":!0,"astc-8x8-unorm":!0,"astc-8x8-unorm-srgb":!0,"astc-10x5-unorm":!0,"astc-10x5-unorm-srgb":!0,"astc-10x6-unorm":!0,"astc-10x6-unorm-srgb":!0,"astc-10x8-unorm":!0,"astc-10x8-unorm-srgb":!0,"astc-10x10-unorm":!0,"astc-10x10-unorm-srgb":!0,"astc-12x10-unorm":!0,"astc-12x10-unorm-srgb":!0,"astc-12x12-unorm":!0,"astc-12x12-unorm-srgb":!0},Dk=exports.glUploadCompressedTextureResource={id:"compressed",upload:function(e,t,r){r.pixelStorei(r.UNPACK_ALIGNMENT,4);for(var n=e.pixelWidth,i=e.pixelHeight,a=!!Fk[e.format],o=0;o<e.resource.length;o++){var s=e.resource[o];a?r.compressedTexImage2D(r.TEXTURE_2D,o,t.internalFormat,n,i,0,s):r.texImage2D(r.TEXTURE_2D,o,t.internalFormat,n,i,0,t.format,t.type,s),n=Math.max(n>>1,1),i=Math.max(i>>1,1)}}},Uk=exports.glUploadImageResource={id:"image",upload:function(e,t,r,n){var i="premultiply-alpha-on-upload"===e.alphaMode;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i);var a=t.width,o=t.height,s=e.pixelWidth,u=e.pixelHeight,l=e.resourceWidth,c=e.resourceHeight;l<s||c<u?(a===s&&o===u||r.texImage2D(t.target,0,t.internalFormat,s,u,0,t.format,t.type,null),2===n?r.texSubImage2D(r.TEXTURE_2D,0,0,0,l,c,t.format,t.type,e.resource):r.texSubImage2D(r.TEXTURE_2D,0,0,0,t.format,t.type,e.resource)):a===s||o===u?r.texSubImage2D(r.TEXTURE_2D,0,0,0,t.format,t.type,e.resource):2===n?r.texImage2D(t.target,0,t.internalFormat,s,u,0,t.format,t.type,e.resource):r.texImage2D(t.target,0,t.internalFormat,t.format,t.type,e.resource),t.width=s,t.height=u}},Lk=exports.glUploadVideoResource={id:"video",upload:function(e,t,r,n){e.isValid?Uk.upload(e,t,r,n):r.texImage2D(t.target,0,t.internalFormat,1,1,0,t.format,t.type,null)}},Nk=exports.scaleModeToGlFilter={linear:9729,nearest:9728},Xk=exports.mipmapScaleModeToGlFilter={linear:{linear:9987,nearest:9985},nearest:{linear:9986,nearest:9984}},Hk=exports.wrapModeToGlAddress={"clamp-to-edge":33071,repeat:10497,"mirror-repeat":33648},jk=exports.compareModeToGlCompare={never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519};function zk(e,t,r,n,i,a,o,s){var u=a;if(!s||"repeat"!==e.addressModeU||"repeat"!==e.addressModeV||"repeat"!==e.addressModeW){var l=Hk[o?"clamp-to-edge":e.addressModeU],c=Hk[o?"clamp-to-edge":e.addressModeV],h=Hk[o?"clamp-to-edge":e.addressModeW];t[i](u,t.TEXTURE_WRAP_S,l),t[i](u,t.TEXTURE_WRAP_T,c),t.TEXTURE_WRAP_R&&t[i](u,t.TEXTURE_WRAP_R,h)}if(s&&"linear"===e.magFilter||t[i](u,t.TEXTURE_MAG_FILTER,Nk[e.magFilter]),r){if(!s||"linear"!==e.mipmapFilter){var d=Xk[e.minFilter][e.mipmapFilter];t[i](u,t.TEXTURE_MIN_FILTER,d)}}else t[i](u,t.TEXTURE_MIN_FILTER,Nk[e.minFilter]);if(n&&e.maxAnisotropy>1){var f=Math.min(e.maxAnisotropy,t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));t[i](u,n.TEXTURE_MAX_ANISOTROPY_EXT,f)}e.compare&&t[i](u,t.TEXTURE_COMPARE_FUNC,jk[e.compare])}function Vk(e){return{r8unorm:e.RED,r8snorm:e.RED,r8uint:e.RED,r8sint:e.RED,r16uint:e.RED,r16sint:e.RED,r16float:e.RED,rg8unorm:e.RG,rg8snorm:e.RG,rg8uint:e.RG,rg8sint:e.RG,r32uint:e.RED,r32sint:e.RED,r32float:e.RED,rg16uint:e.RG,rg16sint:e.RG,rg16float:e.RG,rgba8unorm:e.RGBA,"rgba8unorm-srgb":e.RGBA,rgba8snorm:e.RGBA,rgba8uint:e.RGBA,rgba8sint:e.RGBA,bgra8unorm:e.RGBA,"bgra8unorm-srgb":e.RGBA,rgb9e5ufloat:e.RGB,rgb10a2unorm:e.RGBA,rg11b10ufloat:e.RGB,rg32uint:e.RG,rg32sint:e.RG,rg32float:e.RG,rgba16uint:e.RGBA,rgba16sint:e.RGBA,rgba16float:e.RGBA,rgba32uint:e.RGBA,rgba32sint:e.RGBA,rgba32float:e.RGBA,stencil8:e.STENCIL_INDEX8,depth16unorm:e.DEPTH_COMPONENT,depth24plus:e.DEPTH_COMPONENT,"depth24plus-stencil8":e.DEPTH_STENCIL,depth32float:e.DEPTH_COMPONENT,"depth32float-stencil8":e.DEPTH_STENCIL}}var Wk=Object.defineProperty,Yk=Object.defineProperties,Kk=Object.getOwnPropertyDescriptors,qk=Object.getOwnPropertySymbols,Zk=Object.prototype.hasOwnProperty,Qk=Object.prototype.propertyIsEnumerable,Jk=function(e,t,r){return t in e?Wk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},$k=function(e,t){for(var r in t||(t={}))Zk.call(t,r)&&Jk(e,r,t[r]);if(qk){var n,i=U(qk(t));try{for(i.s();!(n=i.n()).done;){r=n.value;Qk.call(t,r)&&Jk(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},eE=function(e,t){return Yk(e,Kk(t))};function tE(e,t){var r={},n=e.RGBA;return e instanceof hn.get().getWebGLRenderingContext()?t.srgb&&(r={"rgba8unorm-srgb":t.srgb.SRGB8_ALPHA8_EXT,"bgra8unorm-srgb":t.srgb.SRGB8_ALPHA8_EXT}):(r={"rgba8unorm-srgb":e.SRGB8_ALPHA8,"bgra8unorm-srgb":e.SRGB8_ALPHA8},n=e.RGBA8),$k($k($k($k($k($k(eE($k({r8unorm:e.R8,r8snorm:e.R8_SNORM,r8uint:e.R8UI,r8sint:e.R8I,r16uint:e.R16UI,r16sint:e.R16I,r16float:e.R16F,rg8unorm:e.RG8,rg8snorm:e.RG8_SNORM,rg8uint:e.RG8UI,rg8sint:e.RG8I,r32uint:e.R32UI,r32sint:e.R32I,r32float:e.R32F,rg16uint:e.RG16UI,rg16sint:e.RG16I,rg16float:e.RG16F,rgba8unorm:e.RGBA},r),{rgba8snorm:e.RGBA8_SNORM,rgba8uint:e.RGBA8UI,rgba8sint:e.RGBA8I,bgra8unorm:n,rgb9e5ufloat:e.RGB9_E5,rgb10a2unorm:e.RGB10_A2,rg11b10ufloat:e.R11F_G11F_B10F,rg32uint:e.RG32UI,rg32sint:e.RG32I,rg32float:e.RG32F,rgba16uint:e.RGBA16UI,rgba16sint:e.RGBA16I,rgba16float:e.RGBA16F,rgba32uint:e.RGBA32UI,rgba32sint:e.RGBA32I,rgba32float:e.RGBA32F,stencil8:e.STENCIL_INDEX8,depth16unorm:e.DEPTH_COMPONENT16,depth24plus:e.DEPTH_COMPONENT24,"depth24plus-stencil8":e.DEPTH24_STENCIL8,depth32float:e.DEPTH_COMPONENT32F,"depth32float-stencil8":e.DEPTH32F_STENCIL8}),t.s3tc?{"bc1-rgba-unorm":t.s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT,"bc2-rgba-unorm":t.s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT,"bc3-rgba-unorm":t.s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT}:{}),t.s3tc_sRGB?{"bc1-rgba-unorm-srgb":t.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,"bc2-rgba-unorm-srgb":t.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,"bc3-rgba-unorm-srgb":t.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}:{}),t.rgtc?{"bc4-r-unorm":t.rgtc.COMPRESSED_RED_RGTC1_EXT,"bc4-r-snorm":t.rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT,"bc5-rg-unorm":t.rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT,"bc5-rg-snorm":t.rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}:{}),t.bptc?{"bc6h-rgb-float":t.bptc.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,"bc6h-rgb-ufloat":t.bptc.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,"bc7-rgba-unorm":t.bptc.COMPRESSED_RGBA_BPTC_UNORM_EXT,"bc7-rgba-unorm-srgb":t.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT}:{}),t.etc?{"etc2-rgb8unorm":t.etc.COMPRESSED_RGB8_ETC2,"etc2-rgb8unorm-srgb":t.etc.COMPRESSED_SRGB8_ETC2,"etc2-rgb8a1unorm":t.etc.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgb8a1unorm-srgb":t.etc.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgba8unorm":t.etc.COMPRESSED_RGBA8_ETC2_EAC,"etc2-rgba8unorm-srgb":t.etc.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,"eac-r11unorm":t.etc.COMPRESSED_R11_EAC,"eac-rg11unorm":t.etc.COMPRESSED_SIGNED_RG11_EAC}:{}),t.astc?{"astc-4x4-unorm":t.astc.COMPRESSED_RGBA_ASTC_4x4_KHR,"astc-4x4-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,"astc-5x4-unorm":t.astc.COMPRESSED_RGBA_ASTC_5x4_KHR,"astc-5x4-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR,"astc-5x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_5x5_KHR,"astc-5x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,"astc-6x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_6x5_KHR,"astc-6x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,"astc-6x6-unorm":t.astc.COMPRESSED_RGBA_ASTC_6x6_KHR,"astc-6x6-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,"astc-8x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_8x5_KHR,"astc-8x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,"astc-8x6-unorm":t.astc.COMPRESSED_RGBA_ASTC_8x6_KHR,"astc-8x6-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,"astc-8x8-unorm":t.astc.COMPRESSED_RGBA_ASTC_8x8_KHR,"astc-8x8-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,"astc-10x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x5_KHR,"astc-10x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,"astc-10x6-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x6_KHR,"astc-10x6-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,"astc-10x8-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x8_KHR,"astc-10x8-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,"astc-10x10-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x10_KHR,"astc-10x10-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,"astc-12x10-unorm":t.astc.COMPRESSED_RGBA_ASTC_12x10_KHR,"astc-12x10-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,"astc-12x12-unorm":t.astc.COMPRESSED_RGBA_ASTC_12x12_KHR,"astc-12x12-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR}:{})}function rE(e){return{r8unorm:e.UNSIGNED_BYTE,r8snorm:e.BYTE,r8uint:e.UNSIGNED_BYTE,r8sint:e.BYTE,r16uint:e.UNSIGNED_SHORT,r16sint:e.SHORT,r16float:e.HALF_FLOAT,rg8unorm:e.UNSIGNED_BYTE,rg8snorm:e.BYTE,rg8uint:e.UNSIGNED_BYTE,rg8sint:e.BYTE,r32uint:e.UNSIGNED_INT,r32sint:e.INT,r32float:e.FLOAT,rg16uint:e.UNSIGNED_SHORT,rg16sint:e.SHORT,rg16float:e.HALF_FLOAT,rgba8unorm:e.UNSIGNED_BYTE,"rgba8unorm-srgb":e.UNSIGNED_BYTE,rgba8snorm:e.BYTE,rgba8uint:e.UNSIGNED_BYTE,rgba8sint:e.BYTE,bgra8unorm:e.UNSIGNED_BYTE,"bgra8unorm-srgb":e.UNSIGNED_BYTE,rgb9e5ufloat:e.UNSIGNED_INT_5_9_9_9_REV,rgb10a2unorm:e.UNSIGNED_INT_2_10_10_10_REV,rg11b10ufloat:e.UNSIGNED_INT_10F_11F_11F_REV,rg32uint:e.UNSIGNED_INT,rg32sint:e.INT,rg32float:e.FLOAT,rgba16uint:e.UNSIGNED_SHORT,rgba16sint:e.SHORT,rgba16float:e.HALF_FLOAT,rgba32uint:e.UNSIGNED_INT,rgba32sint:e.INT,rgba32float:e.FLOAT,stencil8:e.UNSIGNED_BYTE,depth16unorm:e.UNSIGNED_SHORT,depth24plus:e.UNSIGNED_INT,"depth24plus-stencil8":e.UNSIGNED_INT_24_8,depth32float:e.FLOAT,"depth32float-stencil8":e.FLOAT_32_UNSIGNED_INT_24_8_REV}}function nE(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));for(var t=e.length,r=0;r<t;r+=4){var n=e[r+3];if(0!==n){var i=255.001/n;e[r]=e[r]*i+.5,e[r+1]=e[r+1]*i+.5,e[r+2]=e[r+2]*i+.5}}}var iE=4,aE=exports.GlTextureSystem=function(){return B(function e(t){C(this,e),this.managedTextures=[],this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundTextures=[],this._activeTextureLocation=-1,this._boundSamplers=Object.create(null),this._uploads={image:Uk,buffer:Ik,video:Lk,compressed:Dk},this._useSeparateSamplers=!1,this._renderer=t},[{key:"contextChange",value:function(e){this._gl=e,this._mapFormatToInternalFormat||(this._mapFormatToInternalFormat=tE(e,this._renderer.context.extensions),this._mapFormatToType=rE(e),this._mapFormatToFormat=Vk(e)),this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundSamplers=Object.create(null);for(var t=0;t<16;t++)this.bind(bi.EMPTY,t)}},{key:"initSource",value:function(e){this.bind(e)}},{key:"bind",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.source;e?(this.bindSource(r,t),this._useSeparateSamplers&&this._bindSampler(r.style,t)):(this.bindSource(null,t),this._useSeparateSamplers&&this._bindSampler(null,t))}},{key:"bindSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this._gl;if(e._touched=this._renderer.textureGC.count,this._boundTextures[t]!==e){this._boundTextures[t]=e,this._activateLocation(t),e=e||bi.EMPTY.source;var n=this.getGlSource(e);r.bindTexture(n.target,n.texture)}}},{key:"_bindSampler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this._gl;if(!e)return this._boundSamplers[t]=null,void r.bindSampler(t,null);var n=this._getGlSampler(e);this._boundSamplers[t]!==n&&(this._boundSamplers[t]=n,r.bindSampler(t,n))}},{key:"unbind",value:function(e){for(var t=e.source,r=this._boundTextures,n=this._gl,i=0;i<r.length;i++)if(r[i]===t){this._activateLocation(i);var a=this.getGlSource(t);n.bindTexture(a.target,null),r[i]=null}}},{key:"_activateLocation",value:function(e){this._activeTextureLocation!==e&&(this._activeTextureLocation=e,this._gl.activeTexture(this._gl.TEXTURE0+e))}},{key:"_initSource",value:function(e){var t=this._gl,r=new Bk(t.createTexture());if(r.type=this._mapFormatToType[e.format],r.internalFormat=this._mapFormatToInternalFormat[e.format],r.format=this._mapFormatToFormat[e.format],e.autoGenerateMipmaps&&(this._renderer.context.supports.nonPowOf2mipmaps||e.isPowerOfTwo)){var n=Math.max(e.width,e.height);e.mipLevelCount=Math.floor(Math.log2(n))+1}return this._glTextures[e.uid]=r,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceUpdate,this),e.on("styleChange",this.onStyleChange,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),this.updateStyle(e,!1),r}},{key:"onStyleChange",value:function(e){this.updateStyle(e,!1)}},{key:"updateStyle",value:function(e,t){var r=this._gl,n=this.getGlSource(e);r.bindTexture(r.TEXTURE_2D,n.texture),this._boundTextures[this._activeTextureLocation]=e,zk(e.style,r,e.mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"texParameteri",r.TEXTURE_2D,!this._renderer.context.supports.nonPowOf2wrapping&&!e.isPowerOfTwo,t)}},{key:"onSourceUnload",value:function(e){var t=this._glTextures[e.uid];t&&(this.unbind(e),this._glTextures[e.uid]=null,this._gl.deleteTexture(t.texture))}},{key:"onSourceUpdate",value:function(e){var t=this._gl,r=this.getGlSource(e);t.bindTexture(t.TEXTURE_2D,r.texture),this._boundTextures[this._activeTextureLocation]=e,this._uploads[e.uploadMethodId]?this._uploads[e.uploadMethodId].upload(e,r,t,this._renderer.context.webGLVersion):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.pixelWidth,e.pixelHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e,!1)}},{key:"onUpdateMipmaps",value:function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.bindSource(e,0);var t=this.getGlSource(e);this._gl.generateMipmap(t.target)}},{key:"onSourceDestroy",value:function(e){e.off("destroy",this.onSourceDestroy,this),e.off("update",this.onSourceUpdate,this),e.off("resize",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("styleChange",this.onStyleChange,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}},{key:"_initSampler",value:function(e){var t=this._gl,r=this._gl.createSampler();return this._glSamplers[e._resourceId]=r,zk(e,t,this._boundTextures[this._activeTextureLocation].mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"samplerParameteri",r,!1,!0),this._glSamplers[e._resourceId]}},{key:"_getGlSampler",value:function(e){return this._glSamplers[e._resourceId]||this._initSampler(e)}},{key:"getGlSource",value:function(e){return this._glTextures[e.uid]||this._initSource(e)}},{key:"generateCanvas",value:function(e){var t=this.getPixels(e),r=t.pixels,n=t.width,i=t.height,a=hn.get().createCanvas();a.width=n,a.height=i;var o=a.getContext("2d");if(o){var s=o.createImageData(n,i);s.data.set(r),o.putImageData(s,0,0)}return a}},{key:"getPixels",value:function(e){var t=e.source.resolution,r=e.frame,n=Math.max(Math.round(r.width*t),1),i=Math.max(Math.round(r.height*t),1),a=new Uint8Array(iE*n*i),o=this._renderer,s=o.renderTarget.getRenderTarget(e),u=o.renderTarget.getGpuRenderTarget(s),l=o.gl;return l.bindFramebuffer(l.FRAMEBUFFER,u.resolveTargetFramebuffer),l.readPixels(Math.round(r.x*t),Math.round(r.y*t),n,i,l.RGBA,l.UNSIGNED_BYTE,a),{pixels:new Uint8ClampedArray(a.buffer),width:n,height:i}}},{key:"destroy",value:function(){var e=this;this.managedTextures.slice().forEach(function(t){return e.onSourceDestroy(t)}),this.managedTextures=null,this._renderer=null}}])}();aE.extension={type:[Z.WebGLSystem],name:"texture"};var oE=exports.GlGraphicsAdaptor=function(){return B(function e(){C(this,e)},[{key:"init",value:function(){var e=new Bs({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new tt,type:"mat3x3<f32>"},uRound:{value:0,type:"f32"}}),t=xa(),r=ds({name:"graphics",bits:[ps,bs(t),Xf,Ss]});this.shader=new Vs({glProgram:r,resources:{localUniforms:e,batchSamplers:Fs(t)}})}},{key:"execute",value:function(e,t){var r=t.context,n=r.customShader||this.shader,i=e.renderer,a=i.graphicsContext.getContextRenderData(r),o=a.batcher,s=a.instructions;n.groups[0]=i.globalUniforms.bindGroup,i.state.set(e.state),i.shader.bind(n),i.geometry.bind(o.geometry,n.glProgram);for(var u=s.instructions,l=0;l<s.instructionSize;l++){var c=u[l];if(c.size){for(var h=0;h<c.textures.count;h++)i.texture.bind(c.textures.textures[h],h);i.geometry.draw("triangle-list",c.size,c.start)}}}},{key:"destroy",value:function(){this.shader.destroy(!0),this.shader=null}}])}();oE.extension={type:[Z.WebGLPipesAdaptor],name:"graphics"};var sE=exports.GlMeshAdaptor=function(){return B(function e(){C(this,e)},[{key:"init",value:function(){var e=ds({name:"mesh",bits:[Xf,vT,Ss]});this._shader=new Vs({glProgram:e,resources:{uTexture:bi.EMPTY.source,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new tt}}}})}},{key:"execute",value:function(e,t){var r=e.renderer,n=t._shader;if(n){if(!n.glProgram)return void Gt("Mesh shader has no glProgram",t.shader)}else{n=this._shader;var i=t.texture,a=i.source;n.resources.uTexture=a,n.resources.uSampler=a.style,n.resources.textureUniforms.uniforms.uTextureMatrix=i.textureMatrix.mapCoord}n.groups[100]=r.globalUniforms.bindGroup,n.groups[101]=e.localUniformsBindGroup,r.encoder.draw({geometry:t._geometry,shader:n,state:t.state})}},{key:"destroy",value:function(){this._shader.destroy(!0),this._shader=null}}])}();sE.extension={type:[Z.WebGLPipesAdaptor],name:"mesh"};var uE=exports.CustomRenderPipe=function(){return B(function e(t){C(this,e),this._renderer=t},[{key:"addRenderable",value:function(e,t){this._renderer.renderPipes.batch.break(t),t.add(e)}},{key:"execute",value:function(e){e.isRenderable&&e.render(this._renderer)}},{key:"destroy",value:function(){this._renderer=null}}])}();function lE(e,t){for(var r=e.instructionSet,n=r.instructions,i=0;i<r.instructionSize;i++){var a=n[i];t[a.renderPipeId].execute(a)}}uE.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"customRender"};var cE=exports.RenderGroupPipe=function(){return B(function e(t){C(this,e),this._renderer=t},[{key:"addRenderGroup",value:function(e,t){this._renderer.renderPipes.batch.break(t),t.add(e)}},{key:"execute",value:function(e){e.isRenderable&&(this._renderer.globalUniforms.push({worldTransformMatrix:e.worldTransform,worldColor:e.worldColorAlpha}),lE(e,this._renderer.renderPipes),this._renderer.globalUniforms.pop())}},{key:"destroy",value:function(){this._renderer=null}}])}();function hE(e,t){t||(t=0);for(var r=t;r<e.length&&e[r];r++)e[r]=null}function dE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.push(e);for(var r=0;r<e.renderGroupChildren.length;r++)dE(e.renderGroupChildren[r],t);return t}function fE(e,t,r){var n=e>>16&255,i=e>>8&255,a=255&e;return(n+((t>>16&255)-n)*r<<16)+(i+((t>>8&255)-i)*r<<8)+(a+((255&t)-a)*r)}cE.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"renderGroup"};var pE=16777215;function vE(e,t){return e===pE||t===pE?e+t-pE:fE(e,t,.5)}function mE(e,t,r){var n=t*((r>>24&255)/255)*255,i=((255&e)<<16)+(65280&e)+(e>>16&255),a=16777215&r;return(i===pE||a===pE?i+a-pE:fE(i,a,.5))+(n<<24)}var gE=new tr,_E=$t|Qt|Jt;function yE(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];xE(e);var r=e.childrenToUpdate,n=e.updateTick++;for(var i in r){for(var a=Number(i),o=r[i],s=o.list,u=o.index,l=0;l<u;l++){var c=s[l];c.parentRenderGroup===e&&c.relativeRenderGroupDepth===a&&bE(c,n,0)}hE(s,u),o.index=0}if(t)for(var h=0;h<e.renderGroupChildren.length;h++)yE(e.renderGroupChildren[h],t)}function xE(e){var t,r=e.root;if(e.renderGroupParent){var n=e.renderGroupParent;e.worldTransform.appendFrom(r.relativeGroupTransform,n.worldTransform),e.worldColor=vE(r.groupColor,n.worldColor),t=r.groupAlpha*n.worldAlpha}else e.worldTransform.copyFrom(r.localTransform),e.worldColor=r.localColor,t=r.localAlpha;t=t<0?0:t>1?1:t,e.worldAlpha=t,e.worldColorAlpha=e.worldColor+((255*t|0)<<24)}function bE(e,t,r){if(t!==e.updateTick){e.updateTick=t,e.didChange=!1;var n=e.localTransform;e.updateLocalTransform();var i=e.parent;if(i&&!i.renderGroup?(r|=e._updateFlags,e.relativeGroupTransform.appendFrom(n,i.relativeGroupTransform),r&_E&&TE(e,i,r)):(r=e._updateFlags,e.relativeGroupTransform.copyFrom(n),r&_E&&TE(e,gE,r)),!e.renderGroup){for(var a=e.children,o=a.length,s=0;s<o;s++)bE(a[s],t,r);var u=e.parentRenderGroup;e.renderPipeId&&!u.structureDidChange&&u.updateRenderable(e)}}}function TE(e,t,r){if(r&Qt){e.groupColor=vE(e.localColor,t.groupColor);var n=e.localAlpha*t.groupAlpha;n=n<0?0:n>1?1:n,e.groupAlpha=n,e.groupColorAlpha=e.groupColor+((255*n|0)<<24)}r&Jt&&(e.groupBlendMode="inherit"===e.localBlendMode?t.groupBlendMode:e.localBlendMode),r&$t&&(e.globalDisplayStatus=e.localDisplayStatus&t.globalDisplayStatus),e._updateFlags=0}function SE(e,t){for(var r=e.childrenRenderablesToUpdate,n=r.list,i=r.index,a=!1,o=0;o<i;o++){var s=n[o];if(a=t[s.renderPipeId].validateRenderable(s))break}return e.structureDidChange=a,a}var kE=new tt,EE=exports.RenderGroupSystem=function(){return B(function e(t){C(this,e),this._renderer=t},[{key:"render",value:function(e){var t=e.container,r=e.transform;t.isRenderGroup=!0;var n=t.parent,i=t.renderGroup.renderGroupParent;t.parent=null,t.renderGroup.renderGroupParent=null;var a=this._renderer,o=dE(t.renderGroup,[]),s=kE;r&&(s=s.copyFrom(t.renderGroup.localTransform),t.renderGroup.localTransform.copyFrom(r));for(var u=a.renderPipes,l=0;l<o.length;l++){var c=o[l];c.runOnRender(),c.instructionSet.renderPipes=u,c.structureDidChange?hE(c.childrenRenderablesToUpdate.list,0):SE(c,u),yE(c),c.structureDidChange?(c.structureDidChange=!1,mT(c,a)):AE(c),c.childrenRenderablesToUpdate.index=0,a.renderPipes.batch.upload(c.instructionSet)}a.globalUniforms.start({worldTransformMatrix:r?t.renderGroup.localTransform:t.renderGroup.worldTransform,worldColor:t.renderGroup.worldColorAlpha}),lE(t.renderGroup,u),u.uniformBatch&&u.uniformBatch.renderEnd(),r&&t.renderGroup.localTransform.copyFrom(s),t.parent=n,t.renderGroup.renderGroupParent=i}},{key:"destroy",value:function(){this._renderer=null}}])}();function AE(e){for(var t=e.childrenRenderablesToUpdate,r=t.list,n=t.index,i=0;i<n;i++){var a=r[i];a.didViewUpdate&&e.updateRenderable(a)}hE(r,n)}EE.extension={type:[Z.WebGLSystem,Z.WebGPUSystem,Z.CanvasSystem],name:"renderGroup"};var wE=exports.SpritePipe=function(){return B(function e(t){C(this,e),this._gpuSpriteHash=Object.create(null),this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=t},[{key:"addRenderable",value:function(e,t){var r=this._getGpuSprite(e);e._didSpriteUpdate&&this._updateBatchableSprite(e,r),this._renderer.renderPipes.batch.addToBatch(r,t)}},{key:"updateRenderable",value:function(e){var t=this._gpuSpriteHash[e.uid];e._didSpriteUpdate&&this._updateBatchableSprite(e,t),t._batcher.updateElement(t)}},{key:"validateRenderable",value:function(e){var t=e._texture,r=this._getGpuSprite(e);return r.texture._source!==t._source&&!r._batcher.checkAndUpdateTexture(r,t)}},{key:"destroyRenderable",value:function(e){var t=this._gpuSpriteHash[e.uid];pt.return(t),this._gpuSpriteHash[e.uid]=null,e.off("destroyed",this._destroyRenderableBound)}},{key:"_updateBatchableSprite",value:function(e,t){e._didSpriteUpdate=!1,t.bounds=e.bounds,t.texture=e._texture}},{key:"_getGpuSprite",value:function(e){return this._gpuSpriteHash[e.uid]||this._initGPUSprite(e)}},{key:"_initGPUSprite",value:function(e){var t=pt.get(Cl);return t.renderable=e,t.transform=e.groupTransform,t.texture=e._texture,t.bounds=e.bounds,t.roundPixels=this._renderer._roundPixels|e._roundPixels,this._gpuSpriteHash[e.uid]=t,e._didSpriteUpdate=!1,e.on("destroyed",this._destroyRenderableBound),t}},{key:"destroy",value:function(){for(var e in this._gpuSpriteHash)pt.return(this._gpuSpriteHash[e]);this._gpuSpriteHash=null,this._renderer=null}}])}();wE.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"sprite"};var RE=Object.defineProperty,PE=Object.getOwnPropertySymbols,ME=Object.prototype.hasOwnProperty,OE=Object.prototype.propertyIsEnumerable,CE=function(e,t,r){return t in e?RE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},GE=function(e,t){for(var r in t||(t={}))ME.call(t,r)&&CE(e,r,t[r]);if(PE){var n,i=U(PE(t));try{for(i.s();!(n=i.n()).done;){r=n.value;OE.call(t,r)&&CE(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},BE=function(){function e(){C(this,e),this.clearBeforeRender=!0,this._backgroundColor=new Ke(0),this.color=this._backgroundColor,this.alpha=1}return B(e,[{key:"init",value:function(t){t=GE(GE({},e.defaultOptions),t),this.clearBeforeRender=t.clearBeforeRender,this.color=t.background||t.backgroundColor||this._backgroundColor,this.alpha=t.backgroundAlpha,this._backgroundColor.setAlpha(t.backgroundAlpha)}},{key:"color",get:function(){return this._backgroundColor},set:function(e){this._backgroundColor.setValue(e)}},{key:"alpha",get:function(){return this._backgroundColor.alpha},set:function(e){this._backgroundColor.setAlpha(e)}},{key:"colorRgba",get:function(){return this._backgroundColor.toArray()}},{key:"destroy",value:function(){}}])}();BE.extension={type:[Z.WebGLSystem,Z.WebGPUSystem,Z.CanvasSystem],name:"background",priority:0},BE.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};var IE=exports.BackgroundSystem=BE,FE={};$.handle(Z.BlendMode,function(e){if(!e.name)throw new Error("BlendMode extension must have a name property");FE[e.name]=e.ref},function(e){delete FE[e.name]});var DE=exports.BlendModePipe=function(){return B(function e(t){C(this,e),this._isAdvanced=!1,this._filterHash=Object.create(null),this._renderer=t},[{key:"setBlendMode",value:function(e,t,r){this._activeBlendMode!==t?(this._activeBlendMode=t,this._isAdvanced&&this._endAdvancedBlendMode(r),this._isAdvanced=!!FE[t],this._isAdvanced&&(this._beginAdvancedBlendMode(r),this._renderableList.push(e))):this._isAdvanced&&this._renderableList.push(e)}},{key:"_beginAdvancedBlendMode",value:function(e){this._renderer.renderPipes.batch.break(e);var t=this._activeBlendMode;if(FE[t]){var r=this._filterHash[t];r||((r=this._filterHash[t]=new gt).filters=[new FE[t]]);var n={renderPipeId:"filter",action:"pushFilter",renderables:[],filterEffect:r,canBundle:!1};this._renderableList=n.renderables,e.add(n)}else Gt("Unable to assign BlendMode: '".concat(t,"'. You may want to include: import 'pixi.js/advanced-blend-modes'"))}},{key:"_endAdvancedBlendMode",value:function(e){this._renderableList=null,this._renderer.renderPipes.batch.break(e),e.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}},{key:"buildStart",value:function(){this._isAdvanced=!1}},{key:"buildEnd",value:function(e){this._isAdvanced&&this._endAdvancedBlendMode(e)}},{key:"destroy",value:function(){for(var e in this._renderer=null,this._renderableList=null,this._filterHash)this._filterHash[e].destroy();this._filterHash=null}}])}();DE.extension={type:[Z.WebGLPipes,Z.WebGPUPipes,Z.CanvasPipes],name:"blendMode"};var UE=Object.defineProperty,LE=Object.getOwnPropertySymbols,NE=Object.prototype.hasOwnProperty,XE=Object.prototype.propertyIsEnumerable,HE=function(e,t,r){return t in e?UE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},jE=function(e,t){for(var r in t||(t={}))NE.call(t,r)&&HE(e,r,t[r]);if(LE){var n,i=U(LE(t));try{for(i.s();!(n=i.n()).done;){r=n.value;XE.call(t,r)&&HE(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},zE={png:"image/png",jpg:"image/jpeg",webp:"image/webp"},VE=function(){function e(t){C(this,e),this._renderer=t}return B(e,[{key:"_normalizeOptions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e instanceof tr||e instanceof bi?jE({target:e},t):jE(jE({},t),e)}},{key:"image",value:function(){var e=v(f().mark(function e(t){var r;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Image,e.next=3,this.base64(t);case 3:return r.src=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"base64",value:function(){var t=v(f().mark(function t(r){var n,i,a,o,s;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this._normalizeOptions(r,e.defaultImageOptions),i=(n=r).format,a=n.quality,void 0===(o=this.canvas(r)).toBlob){t.next=5;break}return t.abrupt("return",new Promise(function(e,t){o.toBlob(function(r){if(r){var n=new FileReader;n.onload=function(){return e(n.result)},n.onerror=t,n.readAsDataURL(r)}else t(new Error("ICanvas.toBlob failed!"))},zE[i],a)}));case 5:if(void 0===o.toDataURL){t.next=7;break}return t.abrupt("return",o.toDataURL(zE[i],a));case 7:if(void 0===o.convertToBlob){t.next=12;break}return t.next=10,o.convertToBlob({type:zE[i],quality:a});case 10:return s=t.sent,t.abrupt("return",new Promise(function(e,t){var r=new FileReader;r.onload=function(){return e(r.result)},r.onerror=t,r.readAsDataURL(s)}));case 12:throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented");case 13:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"canvas",value:function(e){var t=(e=this._normalizeOptions(e)).target,r=this._renderer;if(t instanceof bi)return r.texture.generateCanvas(t);var n=r.textureGenerator.generateTexture(e),i=r.texture.generateCanvas(n);return n.destroy(),i}},{key:"pixels",value:function(e){var t=(e=this._normalizeOptions(e)).target,r=this._renderer,n=t instanceof bi?t:r.textureGenerator.generateTexture(e),i=r.texture.getPixels(n);return t instanceof tr&&n.destroy(),i}},{key:"texture",value:function(e){return(e=this._normalizeOptions(e)).target instanceof bi?e.target:this._renderer.textureGenerator.generateTexture(e)}},{key:"download",value:function(e){var t;e=this._normalizeOptions(e);var r=this.canvas(e),n=document.createElement("a");n.download=null!=(t=e.filename)?t:"image.png",n.href=r.toDataURL("image/png"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"log",value:function(e){var t,r=null!=(t=e.width)?t:200;e=this._normalizeOptions(e);var n=this.canvas(e),i=n.toDataURL();console.log("[Pixi Texture] ".concat(n.width,"px ").concat(n.height,"px"));var a=["font-size: 1px;","padding: ".concat(r,"px ",300,"px;"),"background: url(".concat(i,") no-repeat;"),"background-size: contain;"].join(" ");console.log("%c ",a)}},{key:"destroy",value:function(){this._renderer=null}}])}();VE.extension={type:[Z.WebGLSystem,Z.WebGPUSystem],name:"extract"},VE.defaultImageOptions={format:"png",quality:1};var WE=exports.ExtractSystem=VE,YE=exports.RenderTexture=function(e){function t(){return C(this,t),x(this,t,arguments)}return E(t,bi),B(t,[{key:"resize",value:function(e,t,r){return this.source.resize(e,t,r),this}}],[{key:"create",value:function(e){return new t({source:new ui(e)})}}])}(),KE=Object.defineProperty,qE=Object.defineProperties,ZE=Object.getOwnPropertyDescriptors,QE=Object.getOwnPropertySymbols,JE=Object.prototype.hasOwnProperty,$E=Object.prototype.propertyIsEnumerable,eA=function(e,t,r){return t in e?KE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},tA=function(e,t){for(var r in t||(t={}))JE.call(t,r)&&eA(e,r,t[r]);if(QE){var n,i=U(QE(t));try{for(i.s();!(n=i.n()).done;){r=n.value;$E.call(t,r)&&eA(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},rA=function(e,t){return qE(e,ZE(t))},nA=new St,iA=new Et,aA=[0,0,0,0],oA=exports.GenerateTextureSystem=function(){return B(function e(t){C(this,e),this._renderer=t},[{key:"generateTexture",value:function(e){var t;e instanceof tr&&(e={target:e,frame:void 0,textureSourceOptions:{},resolution:void 0});var r=e.resolution||this._renderer.resolution,n=e.antialias||this._renderer.view.antialias,i=e.target,a=e.clearColor;a?a=Array.isArray(a)&&4===a.length?a:Ke.shared.setValue(a).toArray():a=aA;var o=(null==(t=e.frame)?void 0:t.copyTo(nA))||Bt(i,iA).rectangle;o.width=0|Math.max(o.width,1/r),o.height=0|Math.max(o.height,1/r);var s=YE.create(rA(tA({},e.textureSourceOptions),{width:o.width,height:o.height,resolution:r,antialias:n})),u=tt.shared.translate(-o.x,-o.y);return this._renderer.render({container:i,transform:u,target:s,clearColor:a}),s.source.updateMipmaps(),s}},{key:"destroy",value:function(){this._renderer=null}}])}();oA.extension={type:[Z.WebGLSystem,Z.WebGPUSystem],name:"textureGenerator"};var sA=exports.GlobalUniformSystem=function(){return B(function e(t){C(this,e),this._stackIndex=0,this._globalUniformDataStack=[],this._uniformsPool=[],this._activeUniforms=[],this._bindGroupPool=[],this._activeBindGroups=[],this._renderer=t},[{key:"reset",value:function(){this._stackIndex=0;for(var e=0;e<this._activeUniforms.length;e++)this._uniformsPool.push(this._activeUniforms[e]);for(var t=0;t<this._activeBindGroups.length;t++)this._bindGroupPool.push(this._activeBindGroups[t]);this._activeUniforms.length=0,this._activeBindGroups.length=0}},{key:"start",value:function(e){this.reset(),this.push(e)}},{key:"bind",value:function(e){var t=e.size,r=e.projectionMatrix,n=e.worldTransformMatrix,i=e.worldColor,a=e.offset,o=this._renderer.renderTarget.renderTarget,s=this._stackIndex?this._globalUniformDataStack[this._stackIndex-1]:{projectionData:o,worldTransformMatrix:new tt,worldColor:4294967295,offset:new $e},u={projectionMatrix:r||this._renderer.renderTarget.projectionMatrix,resolution:t||o.size,worldTransformMatrix:n||s.worldTransformMatrix,worldColor:i||s.worldColor,offset:a||s.offset,bindGroup:null},l=this._uniformsPool.pop()||this._createUniforms();this._activeUniforms.push(l);var c,h=l.uniforms;h.uProjectionMatrix=u.projectionMatrix,h.uResolution=u.resolution,h.uWorldTransformMatrix.copyFrom(u.worldTransformMatrix),h.uWorldTransformMatrix.tx-=u.offset.x,h.uWorldTransformMatrix.ty-=u.offset.y,Rl(u.worldColor,h.uWorldColorAlpha,0),l.update(),this._renderer.renderPipes.uniformBatch?c=this._renderer.renderPipes.uniformBatch.getUniformBindGroup(l,!1):(c=this._bindGroupPool.pop()||new pa,this._activeBindGroups.push(c),c.setResource(l,0)),u.bindGroup=c,this._currentGlobalUniformData=u}},{key:"push",value:function(e){this.bind(e),this._globalUniformDataStack[this._stackIndex++]=this._currentGlobalUniformData}},{key:"pop",value:function(){this._currentGlobalUniformData=this._globalUniformDataStack[--this._stackIndex-1],this._renderer.type===Ds.WEBGL&&this._currentGlobalUniformData.bindGroup.resources[0].update()}},{key:"bindGroup",get:function(){return this._currentGlobalUniformData.bindGroup}},{key:"uniformGroup",get:function(){return this._currentGlobalUniformData.bindGroup.resources[0]}},{key:"_createUniforms",value:function(){return new Bs({uProjectionMatrix:{value:new tt,type:"mat3x3<f32>"},uWorldTransformMatrix:{value:new tt,type:"mat3x3<f32>"},uWorldColorAlpha:{value:new Float32Array(4),type:"vec4<f32>"},uResolution:{value:[0,0],type:"vec2<f32>"}},{isStatic:!0})}},{key:"destroy",value:function(){this._renderer=null}}])}();sA.extension={type:[Z.WebGLSystem,Z.WebGPUSystem,Z.CanvasSystem],name:"globalUniforms"};var uA=1,lA=exports.SchedulerSystem=function(){return B(function e(){C(this,e),this._tasks=[]},[{key:"init",value:function(){Lr.system.add(this._update,this)}},{key:"repeat",value:function(e,t){var r=uA++;return this._tasks.push({func:e,duration:t,start:performance.now(),last:performance.now(),repeat:!0,id:r}),r}},{key:"cancel",value:function(e){for(var t=0;t<this._tasks.length;t++)if(this._tasks[t].id===e)return void this._tasks.splice(t,1)}},{key:"_update",value:function(){for(var e=performance.now(),t=0;t<this._tasks.length;t++){var r=this._tasks[t];if(e-r.last>=r.duration){var n=e-r.start;r.func(n),r.last=e}}}},{key:"destroy",value:function(){Lr.system.remove(this._update,this),this._tasks.length=0}}])}();lA.extension={type:[Z.WebGLSystem,Z.WebGPUSystem,Z.CanvasSystem],name:"scheduler",priority:0};var cA=!1;function hA(e){if(!cA){if(hn.get().getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){var t,r=["%c  %c  %c  %c  %c PixiJS %c v".concat(tv," (").concat(e,") http://www.pixijs.com/\n\n"),"background: #E72264; padding:5px 0;","background: #6CA2EA; padding:5px 0;","background: #B5D33D; padding:5px 0;","background: #FED23F; padding:5px 0;","color: #FFFFFF; background: #E72264; padding:5px 0;","color: #E72264; background: #FFFFFF; padding:5px 0;"];(t=globalThis.console).log.apply(t,r)}else globalThis.console&&globalThis.console.log("PixiJS ".concat(tv," - ").concat(e," - http://www.pixijs.com/"));cA=!0}}var dA=exports.HelloSystem=function(){return B(function e(t){C(this,e),this._renderer=t},[{key:"init",value:function(e){if(e.hello){var t=this._renderer.name;this._renderer.type===Ds.WEBGL&&(t+=" ".concat(this._renderer.context.webGLVersion)),hA(t)}}}])}();dA.extension={type:[Z.WebGLSystem,Z.WebGPUSystem,Z.CanvasSystem],name:"hello",priority:-2},dA.defaultOptions={hello:!1};var fA=Object.defineProperty,pA=Object.getOwnPropertySymbols,vA=Object.prototype.hasOwnProperty,mA=Object.prototype.propertyIsEnumerable,gA=function(e,t,r){return t in e?fA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},_A=function(e,t){for(var r in t||(t={}))vA.call(t,r)&&gA(e,r,t[r]);if(pA){var n,i=U(pA(t));try{for(i.s();!(n=i.n()).done;){r=n.value;mA.call(t,r)&&gA(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},yA=function(){function e(t){C(this,e),this._managedRenderables=[],this._renderer=t}return B(e,[{key:"init",value:function(t){t=_A(_A({},e.defaultOptions),t),this.maxUnusedTime=t.renderableGCMaxUnusedTime,this._frequency=t.renderableGCFrequency,this.enabled=t.renderableGCActive}},{key:"enabled",get:function(){return!!this._handler},set:function(e){var t=this;this.enabled!==e&&(e?this._handler=this._renderer.scheduler.repeat(function(){return t.run()},this._frequency):this._renderer.scheduler.cancel(this._handler))}},{key:"prerender",value:function(){this._now=performance.now()}},{key:"addRenderable",value:function(e,t){this.enabled&&(e._lastUsed=this._now,-1===e._lastInstructionTick&&(this._managedRenderables.push(e),e.once("destroyed",this._removeRenderable,this)),e._lastInstructionTick=t.tick)}},{key:"run",value:function(){for(var e,t,r,n=performance.now(),i=this._managedRenderables,a=this._renderer.renderPipes,o=0,s=0;s<i.length;s++){var u=i[s];if(null!==u){var l=null!=(e=u.renderGroup)?e:u.parentRenderGroup,c=null!=(r=null==(t=null==l?void 0:l.instructionSet)?void 0:t.tick)?r:-1;if(u._lastInstructionTick!==c&&n-u._lastUsed>this.maxUnusedTime){if(!u.destroyed)a[u.renderPipeId].destroyRenderable(u);u._lastInstructionTick=-1,o++,u.off("destroyed",this._removeRenderable,this)}else i[s-o]=u}else o++}i.length=i.length-o}},{key:"destroy",value:function(){this.enabled=!1,this._renderer=null,this._managedRenderables.length=0}},{key:"_removeRenderable",value:function(e){var t=this._managedRenderables.indexOf(e);t>=0&&(e.off("destroyed",this._removeRenderable,this),this._managedRenderables[t]=null)}}])}();yA.extension={type:[Z.WebGLSystem,Z.WebGPUSystem],name:"renderableGC"},yA.defaultOptions={renderableGCActive:!0,renderableGCMaxUnusedTime:6e4,renderableGCFrequency:3e4};var xA=exports.RenderableGCSystem=yA,bA=Object.defineProperty,TA=Object.getOwnPropertySymbols,SA=Object.prototype.hasOwnProperty,kA=Object.prototype.propertyIsEnumerable,EA=function(e,t,r){return t in e?bA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},AA=function(e,t){for(var r in t||(t={}))SA.call(t,r)&&EA(e,r,t[r]);if(TA){var n,i=U(TA(t));try{for(i.s();!(n=i.n()).done;){r=n.value;kA.call(t,r)&&EA(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},wA=function(){function e(t){C(this,e),this._renderer=t,this.count=0,this.checkCount=0}return B(e,[{key:"init",value:function(t){var r;t=AA(AA({},e.defaultOptions),t),this.checkCountMax=t.textureGCCheckCountMax,this.maxIdle=null!=(r=t.textureGCAMaxIdle)?r:t.textureGCMaxIdle,this.active=t.textureGCActive}},{key:"postrender",value:function(){this._renderer.renderingToScreen&&(this.count++,this.active&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}},{key:"run",value:function(){for(var e=this._renderer.texture.managedTextures,t=0;t<e.length;t++){var r=e[t];r.autoGarbageCollect&&r.resource&&r._touched>-1&&this.count-r._touched>this.maxIdle&&(r._touched=-1,r.unload())}}},{key:"destroy",value:function(){this._renderer=null}}])}();wA.extension={type:[Z.WebGLSystem,Z.WebGPUSystem],name:"textureGC"},wA.defaultOptions={textureGCActive:!0,textureGCAMaxIdle:null,textureGCMaxIdle:3600,textureGCCheckCountMax:600};var RA=exports.TextureGCSystem=wA,PA=Object.defineProperty,MA=Object.getOwnPropertySymbols,OA=Object.prototype.hasOwnProperty,CA=Object.prototype.propertyIsEnumerable,GA=function(e,t,r){return t in e?PA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},BA=function(e,t){for(var r in t||(t={}))OA.call(t,r)&&GA(e,r,t[r]);if(MA){var n,i=U(MA(t));try{for(i.s();!(n=i.n()).done;){r=n.value;CA.call(t,r)&&GA(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},IA=function(){function e(){C(this,e)}return B(e,[{key:"autoDensity",get:function(){return this.texture.source.autoDensity},set:function(e){this.texture.source.autoDensity=e}},{key:"resolution",get:function(){return this.texture.source._resolution},set:function(e){this.texture.source.resize(this.texture.source.width,this.texture.source.height,e)}},{key:"init",value:function(t){(t=BA(BA({},e.defaultOptions),t)).view&&(ht(lt,"ViewSystem.view has been renamed to ViewSystem.canvas"),t.canvas=t.view),this.screen=new St(0,0,t.width,t.height),this.canvas=t.canvas||hn.get().createCanvas(),this.antialias=!!t.antialias,this.texture=LS(this.canvas,t),this.renderTarget=new qS({colorTextures:[this.texture],depth:!!t.depth,isRoot:!0}),this.texture.source.transparent=t.backgroundAlpha<1,this.resolution=t.resolution}},{key:"resize",value:function(e,t,r){this.texture.source.resize(e,t,r),this.screen.width=this.texture.frame.width,this.screen.height=this.texture.frame.height}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];("boolean"==typeof e?e:!!(null==e?void 0:e.removeView))&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}])}();IA.extension={type:[Z.WebGLSystem,Z.WebGPUSystem,Z.CanvasSystem],name:"view",priority:0},IA.defaultOptions={width:800,height:600,autoDensity:!1,antialias:!1};var FA=exports.ViewSystem=IA,DA=exports.SharedSystems=[IE,sA,dA,FA,EE,RA,oA,WE,nv,xA,lA],UA=exports.SharedRenderPipes=[DE,dT,wE,cE,TT,ET,ST,uE],LA=[].concat(DA,[PS,iS,LT,RT,aE,QS,qT,bk,gk,oS,Gk,lS,aS]),NA=[].concat(UA),XA=[oT,sE,oE],HA=[],jA=[],zA=[];$.handleByNamedList(Z.WebGLSystem,HA),$.handleByNamedList(Z.WebGLPipes,jA),$.handleByNamedList(Z.WebGLPipesAdaptor,zA),$.add.apply($,m(LA).concat(m(NA),XA));var VA=exports.WebGLRenderer=function(e){function t(){return C(this,t),x(this,t,[{name:"webgl",type:Ds.WEBGL,systems:HA,renderPipes:jA,renderPipeAdaptors:zA}])}return E(t,Xp),B(t)}(),WA={__proto__:null,WebGLRenderer:VA},YA=exports.BindGroupSystem=function(){return B(function e(t){C(this,e),this._hash=Object.create(null),this._renderer=t},[{key:"contextChange",value:function(e){this._gpu=e}},{key:"getBindGroup",value:function(e,t,r){return e._updateKey(),this._hash[e._key]||this._createBindGroup(e,t,r)}},{key:"_createBindGroup",value:function(e,t,r){var n,i=this._gpu.device,a=t.layout[r],o=[],s=this._renderer;for(var u in a){var l=null!=(n=e.resources[u])?n:e.resources[a[u]],c=void 0;if("uniformGroup"===l._resourceType){var h=l;s.ubo.updateUniformGroup(h);var d=h.buffer;c={buffer:s.buffer.getGPUBuffer(d),offset:0,size:d.descriptor.size}}else if("buffer"===l._resourceType){var f=l;c={buffer:s.buffer.getGPUBuffer(f),offset:0,size:f.descriptor.size}}else if("bufferResource"===l._resourceType){var p=l;c={buffer:s.buffer.getGPUBuffer(p.buffer),offset:p.offset,size:p.size}}else if("textureSampler"===l._resourceType){var v=l;c=s.texture.getGpuSampler(v)}else if("textureSource"===l._resourceType){var m=l;c=s.texture.getGpuSource(m).createView({})}o.push({binding:a[u],resource:c})}var g=s.shader.getProgramData(t).bindGroups[r],_=i.createBindGroup({layout:g,entries:o});return this._hash[e._key]=_,_}},{key:"destroy",value:function(){for(var e=0,t=Object.keys(this._hash);e<t.length;e++){var r=t[e];this._hash[r]=null}this._hash=null,this._renderer=null}}])}();YA.extension={type:[Z.WebGPUSystem],name:"bindGroup"};var KA=exports.GpuBufferSystem=function(){return B(function e(){C(this,e),this._gpuBuffers=Object.create(null),this._managedBuffers=[]},[{key:"contextChange",value:function(e){this._gpu=e}},{key:"getGPUBuffer",value:function(e){return this._gpuBuffers[e.uid]||this.createGPUBuffer(e)}},{key:"updateBuffer",value:function(e){var t=this._gpuBuffers[e.uid]||this.createGPUBuffer(e),r=e.data;return e._updateID&&r&&(e._updateID=0,this._gpu.device.queue.writeBuffer(t,0,r.buffer,0,(e._updateSize||r.byteLength)+3&-4)),t}},{key:"destroyAll",value:function(){for(var e in this._gpuBuffers)this._gpuBuffers[e].destroy();this._gpuBuffers={}}},{key:"createGPUBuffer",value:function(e){this._gpuBuffers[e.uid]||(e.on("update",this.updateBuffer,this),e.on("change",this.onBufferChange,this),e.on("destroy",this.onBufferDestroy,this),this._managedBuffers.push(e));var t=this._gpu.device.createBuffer(e.descriptor);return e._updateID=0,e.data&&(Aa(e.data.buffer,t.getMappedRange()),t.unmap()),this._gpuBuffers[e.uid]=t,t}},{key:"onBufferChange",value:function(e){this._gpuBuffers[e.uid].destroy(),e._updateID=0,this._gpuBuffers[e.uid]=this.createGPUBuffer(e)}},{key:"onBufferDestroy",value:function(e){this._managedBuffers.splice(this._managedBuffers.indexOf(e),1),this._destroyBuffer(e)}},{key:"destroy",value:function(){var e=this;this._managedBuffers.forEach(function(t){return e._destroyBuffer(t)}),this._managedBuffers=null,this._gpuBuffers=null}},{key:"_destroyBuffer",value:function(e){this._gpuBuffers[e.uid].destroy(),e.off("update",this.updateBuffer,this),e.off("change",this.onBufferChange,this),e.off("destroy",this.onBufferDestroy,this),this._gpuBuffers[e.uid]=null}}])}();function qA(e,t){var r=e.descriptor.size,n=t.gpu.device,i=new Wa({data:new Float32Array(24e5),usage:Va.MAP_READ|Va.COPY_DST}),a=t.buffer.createGPUBuffer(i),o=n.createCommandEncoder();o.copyBufferToBuffer(t.buffer.getGPUBuffer(e),0,a,0,r),n.queue.submit([o.finish()]),a.mapAsync(GPUMapMode.READ,0,r).then(function(){a.getMappedRange(0,r),a.unmap()})}KA.extension={type:[Z.WebGPUSystem],name:"buffer"};var ZA=exports.UboBatch=function(){return B(function e(t){var r=t.minUniformOffsetAlignment;C(this,e),this._minUniformOffsetAlignment=256,this.byteIndex=0,this._minUniformOffsetAlignment=r,this.data=new Float32Array(65535)},[{key:"clear",value:function(){this.byteIndex=0}},{key:"addEmptyGroup",value:function(e){if(e>this._minUniformOffsetAlignment/4)throw new Error("UniformBufferBatch: array is too large: ".concat(4*e));var t=this.byteIndex,r=t+4*e;if((r=Math.ceil(r/this._minUniformOffsetAlignment)*this._minUniformOffsetAlignment)>4*this.data.length)throw new Error("UniformBufferBatch: ubo batch got too big");return this.byteIndex=r,t}},{key:"addGroup",value:function(e){for(var t=this.addEmptyGroup(e.length),r=0;r<e.length;r++)this.data[t/4+r]=e[r];return t}},{key:"destroy",value:function(){this._buffer.destroy(),this._buffer=null,this.data=null}}])}(),QA=exports.GpuColorMaskSystem=function(){return B(function e(t){C(this,e),this._colorMaskCache=15,this._renderer=t},[{key:"setMask",value:function(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.pipeline.setColorMask(e))}},{key:"destroy",value:function(){this._renderer=null,this._colorMaskCache=null}}])}();QA.extension={type:[Z.WebGPUSystem],name:"colorMask"};var JA=exports.GpuDeviceSystem=function(){return B(function e(t){C(this,e),this._renderer=t},[{key:"init",value:function(){var e=v(f().mark(function e(t){var r=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._initPromise){e.next=2;break}return e.abrupt("return",this._initPromise);case 2:return this._initPromise=this._createDeviceAndAdaptor(t).then(function(e){r.gpu=e,r._renderer.runners.contextChange.emit(r.gpu)}),e.abrupt("return",this._initPromise);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"contextChange",value:function(e){this._renderer.gpu=e}},{key:"_createDeviceAndAdaptor",value:function(){var e=v(f().mark(function e(t){var r,n,i;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.get().getNavigator().gpu.requestAdapter({powerPreference:t.powerPreference,forceFallbackAdapter:t.forceFallbackAdapter});case 2:return r=e.sent,n=["texture-compression-bc","texture-compression-astc","texture-compression-etc2"].filter(function(e){return r.features.has(e)}),e.next=6,r.requestDevice({requiredFeatures:n});case 6:return i=e.sent,e.abrupt("return",{adapter:r,device:i});case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this.gpu=null,this._renderer=null}}])}();JA.extension={type:[Z.WebGPUSystem],name:"device"},JA.defaultOptions={powerPreference:void 0,forceFallbackAdapter:!1};var $A=Object.defineProperty,ew=Object.getOwnPropertySymbols,tw=Object.prototype.hasOwnProperty,rw=Object.prototype.propertyIsEnumerable,nw=function(e,t,r){return t in e?$A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},iw=function(e,t){for(var r in t||(t={}))tw.call(t,r)&&nw(e,r,t[r]);if(ew){var n,i=U(ew(t));try{for(i.s();!(n=i.n()).done;){r=n.value;rw.call(t,r)&&nw(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},aw=exports.GpuEncoderSystem=function(){return B(function e(t){C(this,e),this._boundBindGroup=Object.create(null),this._boundVertexBuffer=Object.create(null),this._renderer=t},[{key:"renderStart",value:function(){var e=this;this.commandFinished=new Promise(function(t){e._resolveCommandFinished=t}),this.commandEncoder=this._renderer.gpu.device.createCommandEncoder()}},{key:"beginRenderPass",value:function(e){this.endRenderPass(),this._clearCache(),this.renderPassEncoder=this.commandEncoder.beginRenderPass(e.descriptor)}},{key:"endRenderPass",value:function(){this.renderPassEncoder&&this.renderPassEncoder.end(),this.renderPassEncoder=null}},{key:"setViewport",value:function(e){this.renderPassEncoder.setViewport(e.x,e.y,e.width,e.height,0,1)}},{key:"setPipelineFromGeometryProgramAndState",value:function(e,t,r,n){var i=this._renderer.pipeline.getPipeline(e,t,r,n);this.setPipeline(i)}},{key:"setPipeline",value:function(e){this._boundPipeline!==e&&(this._boundPipeline=e,this.renderPassEncoder.setPipeline(e))}},{key:"_setVertexBuffer",value:function(e,t){this._boundVertexBuffer[e]!==t&&(this._boundVertexBuffer[e]=t,this.renderPassEncoder.setVertexBuffer(e,this._renderer.buffer.updateBuffer(t)))}},{key:"_setIndexBuffer",value:function(e){if(this._boundIndexBuffer!==e){this._boundIndexBuffer=e;var t=2===e.data.BYTES_PER_ELEMENT?"uint16":"uint32";this.renderPassEncoder.setIndexBuffer(this._renderer.buffer.updateBuffer(e),t)}}},{key:"resetBindGroup",value:function(e){this._boundBindGroup[e]=null}},{key:"setBindGroup",value:function(e,t,r){if(this._boundBindGroup[e]!==t){this._boundBindGroup[e]=t,t._touch(this._renderer.textureGC.count);var n=this._renderer.bindGroup.getBindGroup(t,r,e);this.renderPassEncoder.setBindGroup(e,n)}}},{key:"setGeometry",value:function(e,t){var r=this._renderer.pipeline.getBufferNamesToBind(e,t);for(var n in r)this._setVertexBuffer(n,e.attributes[r[n]].buffer);e.indexBuffer&&this._setIndexBuffer(e.indexBuffer)}},{key:"_setShaderBindGroups",value:function(e,t){for(var r in e.groups){var n=e.groups[r];t||this._syncBindGroup(n),this.setBindGroup(r,n,e.gpuProgram)}}},{key:"_syncBindGroup",value:function(e){for(var t in e.resources){var r=e.resources[t];r.isUniformGroup&&this._renderer.ubo.updateUniformGroup(r)}}},{key:"draw",value:function(e){var t=e.geometry,r=e.shader,n=e.state,i=e.topology,a=e.size,o=e.start,s=e.instanceCount,u=e.skipSync;this.setPipelineFromGeometryProgramAndState(t,r.gpuProgram,n,i),this.setGeometry(t,r.gpuProgram),this._setShaderBindGroups(r,u),t.indexBuffer?this.renderPassEncoder.drawIndexed(a||t.indexBuffer.data.length,s||t.instanceCount,o||0):this.renderPassEncoder.draw(a||t.getSize(),s||t.instanceCount,o||0)}},{key:"finishRenderPass",value:function(){this.renderPassEncoder&&(this.renderPassEncoder.end(),this.renderPassEncoder=null)}},{key:"postrender",value:function(){this.finishRenderPass(),this._gpu.device.queue.submit([this.commandEncoder.finish()]),this._resolveCommandFinished(),this.commandEncoder=null}},{key:"restoreRenderPass",value:function(){var e=this._renderer.renderTarget.adaptor.getDescriptor(this._renderer.renderTarget.renderTarget,!1,[0,0,0,1]);this.renderPassEncoder=this.commandEncoder.beginRenderPass(e);var t=this._boundPipeline,r=iw({},this._boundVertexBuffer),n=this._boundIndexBuffer,i=iw({},this._boundBindGroup);this._clearCache();var a=this._renderer.renderTarget.viewport;for(var o in this.renderPassEncoder.setViewport(a.x,a.y,a.width,a.height,0,1),this.setPipeline(t),r)this._setVertexBuffer(o,r[o]);for(var s in i)this.setBindGroup(s,i[s],null);this._setIndexBuffer(n)}},{key:"_clearCache",value:function(){for(var e=0;e<16;e++)this._boundBindGroup[e]=null,this._boundVertexBuffer[e]=null;this._boundIndexBuffer=null,this._boundPipeline=null}},{key:"destroy",value:function(){this._renderer=null,this._gpu=null,this._boundBindGroup=null,this._boundVertexBuffer=null,this._boundIndexBuffer=null,this._boundPipeline=null}},{key:"contextChange",value:function(e){this._gpu=e}}])}();aw.extension={type:[Z.WebGPUSystem],name:"encoder",priority:1};var ow=exports.GpuStencilSystem=function(){return B(function e(t){C(this,e),this._renderTargetStencilState=Object.create(null),this._renderer=t,t.renderTarget.onRenderTargetChange.add(this)},[{key:"onRenderTargetChange",value:function(e){var t=this._renderTargetStencilState[e.uid];t||(t=this._renderTargetStencilState[e.uid]={stencilMode:Ra.DISABLED,stencilReference:0}),this._activeRenderTarget=e,this.setStencilMode(t.stencilMode,t.stencilReference)}},{key:"setStencilMode",value:function(e,t){var r=this._renderTargetStencilState[this._activeRenderTarget.uid];r.stencilMode=e,r.stencilReference=t;var n=this._renderer;n.pipeline.setStencilMode(e),n.encoder.renderPassEncoder.setStencilReference(t)}},{key:"destroy",value:function(){this._renderer.renderTarget.onRenderTargetChange.remove(this),this._renderer=null,this._activeRenderTarget=null,this._renderTargetStencilState=null}}])}();ow.extension={type:[Z.WebGPUSystem],name:"stencil"};var sw=exports.WGSL_ALIGN_SIZE_DATA={i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},f16:{align:2,size:2},"vec2<i32>":{align:8,size:8},"vec2<u32>":{align:8,size:8},"vec2<f32>":{align:8,size:8},"vec2<f16>":{align:4,size:4},"vec3<i32>":{align:16,size:12},"vec3<u32>":{align:16,size:12},"vec3<f32>":{align:16,size:12},"vec3<f16>":{align:8,size:6},"vec4<i32>":{align:16,size:16},"vec4<u32>":{align:16,size:16},"vec4<f32>":{align:16,size:16},"vec4<f16>":{align:8,size:8},"mat2x2<f32>":{align:8,size:16},"mat2x2<f16>":{align:4,size:8},"mat3x2<f32>":{align:8,size:24},"mat3x2<f16>":{align:4,size:12},"mat4x2<f32>":{align:8,size:32},"mat4x2<f16>":{align:4,size:16},"mat2x3<f32>":{align:16,size:32},"mat2x3<f16>":{align:8,size:16},"mat3x3<f32>":{align:16,size:48},"mat3x3<f16>":{align:8,size:24},"mat4x3<f32>":{align:16,size:64},"mat4x3<f16>":{align:8,size:32},"mat2x4<f32>":{align:16,size:32},"mat2x4<f16>":{align:8,size:16},"mat3x4<f32>":{align:16,size:48},"mat3x4<f16>":{align:8,size:24},"mat4x4<f32>":{align:16,size:64},"mat4x4<f16>":{align:8,size:32}};function uw(e){for(var t=e.map(function(e){return{data:e,offset:0,size:0}}),r=0,n=0;n<t.length;n++){var i=t[n],a=sw[i.data.type].size,o=sw[i.data.type].align;if(!sw[i.data.type])throw new Error("[Pixi.js] WebGPU UniformBuffer: Unknown type ".concat(i.data.type));i.data.size>1&&(a=Math.max(a,o)*i.data.size),r=Math.ceil(r/o)*o,i.size=a,i.offset=r,r+=a}return{uboElements:t,size:r=16*Math.ceil(r/16)}}function lw(e,t){var r=sw[e.data.type],n=r.size,i=(r.align-n)/4;return"\n         v = uv.".concat(e.data.name,";\n         ").concat(0!==t?"offset += ".concat(t,";"):"","\n\n         arrayOffset = offset;\n\n         t = 0;\n\n         for(var i=0; i < ").concat(e.data.size*(n/4),"; i++)\n         {\n             for(var j = 0; j < ").concat(n/4,"; j++)\n             {\n                 data[arrayOffset++] = v[t++];\n             }\n             ").concat(0!==i?"arrayOffset += ".concat(i,";"):"","\n         }\n     ")}function cw(e){return pS(e,"uboWgsl",lw,AS)}var hw=exports.GpuUboSystem=function(e){function t(){return C(this,t),x(this,t,[{createUboElements:uw,generateUboSync:cw}])}return E(t,cS),B(t)}();hw.extension={type:[Z.WebGPUSystem],name:"ubo"};var dw=128,fw=exports.GpuUniformBatchPipe=function(){return B(function e(t){C(this,e),this._bindGroupHash=Object.create(null),this._buffers=[],this._bindGroups=[],this._bufferResources=[],this._renderer=t,this._batchBuffer=new ZA({minUniformOffsetAlignment:dw});for(var r=256/dw,n=0;n<r;n++){var i=Va.UNIFORM|Va.COPY_DST;0===n&&(i|=Va.COPY_SRC),this._buffers.push(new Wa({data:this._batchBuffer.data,usage:i}))}},[{key:"renderEnd",value:function(){this._uploadBindGroups(),this._resetBindGroups()}},{key:"_resetBindGroups",value:function(){for(var e in this._bindGroupHash)this._bindGroupHash[e]=null;this._batchBuffer.clear()}},{key:"getUniformBindGroup",value:function(e,t){if(!t&&this._bindGroupHash[e.uid])return this._bindGroupHash[e.uid];this._renderer.ubo.ensureUniformGroup(e);var r=e.buffer.data,n=this._batchBuffer.addEmptyGroup(r.length);return this._renderer.ubo.syncUniformGroup(e,this._batchBuffer.data,n/4),this._bindGroupHash[e.uid]=this._getBindGroup(n/dw),this._bindGroupHash[e.uid]}},{key:"getUboResource",value:function(e){this._renderer.ubo.updateUniformGroup(e);var t=e.buffer.data,r=this._batchBuffer.addGroup(t);return this._getBufferResource(r/dw)}},{key:"getArrayBindGroup",value:function(e){var t=this._batchBuffer.addGroup(e);return this._getBindGroup(t/dw)}},{key:"getArrayBufferResource",value:function(e){var t=this._batchBuffer.addGroup(e)/dw;return this._getBufferResource(t)}},{key:"_getBufferResource",value:function(e){if(!this._bufferResources[e]){var t=this._buffers[e%2];this._bufferResources[e]=new JS({buffer:t,offset:256*(e/2|0),size:dw})}return this._bufferResources[e]}},{key:"_getBindGroup",value:function(e){if(!this._bindGroups[e]){var t=new pa({0:this._getBufferResource(e)});this._bindGroups[e]=t}return this._bindGroups[e]}},{key:"_uploadBindGroups",value:function(){var e=this._renderer.buffer,t=this._buffers[0];t.update(this._batchBuffer.byteIndex),e.updateBuffer(t);for(var r=this._renderer.gpu.device.createCommandEncoder(),n=1;n<this._buffers.length;n++){var i=this._buffers[n];r.copyBufferToBuffer(e.getGPUBuffer(t),dw,e.getGPUBuffer(i),0,this._batchBuffer.byteIndex)}this._renderer.gpu.device.queue.submit([r.finish()])}},{key:"destroy",value:function(){for(var e=0;e<this._bindGroups.length;e++)this._bindGroups[e].destroy();this._bindGroups=null,this._bindGroupHash=null;for(var t=0;t<this._buffers.length;t++)this._buffers[t].destroy();this._buffers=null;for(var r=0;r<this._bufferResources.length;r++)this._bufferResources[r].destroy();this._bufferResources=null,this._batchBuffer.destroy(),this._bindGroupHash=null,this._renderer=null}}])}();fw.extension={type:[Z.WebGPUPipes],name:"uniformBatch"};var pw=Object.defineProperty,vw=Object.defineProperties,mw=Object.getOwnPropertyDescriptors,gw=Object.getOwnPropertySymbols,_w=Object.prototype.hasOwnProperty,yw=Object.prototype.propertyIsEnumerable,xw=function(e,t,r){return t in e?pw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},bw=function(e,t){for(var r in t||(t={}))_w.call(t,r)&&xw(e,r,t[r]);if(gw){var n,i=U(gw(t));try{for(i.s();!(n=i.n()).done;){r=n.value;yw.call(t,r)&&xw(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},Tw=function(e,t){return vw(e,mw(t))},Sw={"point-list":0,"line-list":1,"line-strip":2,"triangle-list":3,"triangle-strip":4};function kw(e,t,r,n,i){return e<<24|t<<16|r<<10|n<<5|i}function Ew(e,t,r,n){return r<<6|e<<3|n<<1|t}var Aw=exports.PipelineSystem=function(){return B(function e(t){C(this,e),this._moduleCache=Object.create(null),this._bufferLayoutsCache=Object.create(null),this._bindingNamesCache=Object.create(null),this._pipeCache=Object.create(null),this._pipeStateCaches=Object.create(null),this._colorMask=15,this._multisampleCount=1,this._renderer=t},[{key:"contextChange",value:function(e){this._gpu=e,this.setStencilMode(Ra.DISABLED),this._updatePipeHash()}},{key:"setMultisampleCount",value:function(e){this._multisampleCount!==e&&(this._multisampleCount=e,this._updatePipeHash())}},{key:"setRenderTarget",value:function(e){this._multisampleCount=e.msaaSamples,this._depthStencilAttachment=e.descriptor.depthStencilAttachment?1:0,this._updatePipeHash()}},{key:"setColorMask",value:function(e){this._colorMask!==e&&(this._colorMask=e,this._updatePipeHash())}},{key:"setStencilMode",value:function(e){this._stencilMode!==e&&(this._stencilMode=e,this._stencilState=uS[e],this._updatePipeHash())}},{key:"setPipeline",value:function(e,t,r,n){var i=this.getPipeline(e,t,r);n.setPipeline(i)}},{key:"getPipeline",value:function(e,t,r,n){e._layoutKey||(NT(e,t.attributeData),this._generateBufferKey(e)),n=n||e.topology;var i=kw(e._layoutKey,t._layoutKey,r.data,r._blendModeId,Sw[n]);return this._pipeCache[i]?this._pipeCache[i]:(this._pipeCache[i]=this._createPipeline(e,t,r,n),this._pipeCache[i])}},{key:"_createPipeline",value:function(e,t,r,n){var i=this._gpu.device,a=this._createVertexBufferLayouts(e,t),o=this._renderer.state.getColorTargets(r);o[0].writeMask=this._stencilMode===Ra.RENDERING_MASK_ADD?0:this._colorMask;var s=this._renderer.shader.getProgramData(t).pipeline,u={vertex:{module:this._getModule(t.vertex.source),entryPoint:t.vertex.entryPoint,buffers:a},fragment:{module:this._getModule(t.fragment.source),entryPoint:t.fragment.entryPoint,targets:o},primitive:{topology:n,cullMode:r.cullMode},layout:s,multisample:{count:this._multisampleCount},label:"PIXI Pipeline"};return this._depthStencilAttachment&&(u.depthStencil=Tw(bw({},this._stencilState),{format:"depth24plus-stencil8",depthWriteEnabled:r.depthTest,depthCompare:r.depthTest?"less":"always"})),i.createRenderPipeline(u)}},{key:"_getModule",value:function(e){return this._moduleCache[e]||this._createModule(e)}},{key:"_createModule",value:function(e){var t=this._gpu.device;return this._moduleCache[e]=t.createShaderModule({code:e}),this._moduleCache[e]}},{key:"_generateBufferKey",value:function(e){for(var t=[],r=0,n=Object.keys(e.attributes).sort(),i=0;i<n.length;i++){var a=e.attributes[n[i]];t[r++]=a.offset,t[r++]=a.format,t[r++]=a.stride,t[r++]=a.instance}var o=t.join("|");return e._layoutKey=no(o,"geometry"),e._layoutKey}},{key:"_generateAttributeLocationsKey",value:function(e){for(var t=[],r=0,n=Object.keys(e.attributeData).sort(),i=0;i<n.length;i++){var a=e.attributeData[n[i]];t[r++]=a.location}var o=t.join("|");return e._attributeLocationsKey=no(o,"programAttributes"),e._attributeLocationsKey}},{key:"getBufferNamesToBind",value:function(e,t){var r=e._layoutKey<<16|t._attributeLocationsKey;if(this._bindingNamesCache[r])return this._bindingNamesCache[r];for(var n=this._createVertexBufferLayouts(e,t),i=Object.create(null),a=t.attributeData,o=0;o<n.length;o++)for(var s in a)if(a[s].location===o){i[o]=s;break}return this._bindingNamesCache[r]=i,i}},{key:"_createVertexBufferLayouts",value:function(e,t){t._attributeLocationsKey||this._generateAttributeLocationsKey(t);var r=e._layoutKey<<16|t._attributeLocationsKey;if(this._bufferLayoutsCache[r])return this._bufferLayoutsCache[r];var n=[];return e.buffers.forEach(function(r){var i,a={arrayStride:0,stepMode:"vertex",attributes:[]},o=a.attributes;for(var s in t.attributeData){var u=e.attributes[s];1!==(null!=(i=u.divisor)?i:1)&&Gt("Attribute ".concat(s," has an invalid divisor value of '").concat(u.divisor,"'. WebGPU only supports a divisor value of 1")),u.buffer===r&&(a.arrayStride=u.stride,a.stepMode=u.instance?"instance":"vertex",o.push({shaderLocation:t.attributeData[s].location,offset:u.offset,format:u.format}))}o.length&&n.push(a)}),this._bufferLayoutsCache[r]=n,n}},{key:"_updatePipeHash",value:function(){var e=Ew(this._stencilMode,this._multisampleCount,this._colorMask,this._depthStencilAttachment);this._pipeStateCaches[e]||(this._pipeStateCaches[e]=Object.create(null)),this._pipeCache=this._pipeStateCaches[e]}},{key:"destroy",value:function(){this._renderer=null,this._bufferLayoutsCache=null}}])}();Aw.extension={type:[Z.WebGPUSystem],name:"pipeline"};var ww=exports.GpuRenderTarget=B(function e(){C(this,e),this.contexts=[],this.msaaTextures=[],this.msaaSamples=1}),Rw=exports.GpuRenderTargetAdaptor=function(){return B(function e(){C(this,e)},[{key:"init",value:function(e,t){this._renderer=e,this._renderTargetSystem=t}},{key:"copyToTexture",value:function(e,t,r,n,i){var a=this._renderer,o=this._getGpuColorTexture(e),s=a.texture.getGpuSource(t.source);return a.encoder.commandEncoder.copyTextureToTexture({texture:o,origin:r},{texture:s,origin:i},n),t}},{key:"startRenderPass",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=this._renderTargetSystem.getGpuRenderTarget(e),a=this.getDescriptor(e,t,r);i.descriptor=a,this._renderer.pipeline.setRenderTarget(i),this._renderer.encoder.beginRenderPass(i),this._renderer.encoder.setViewport(n)}},{key:"finishRenderPass",value:function(){this._renderer.encoder.endRenderPass()}},{key:"_getGpuColorTexture",value:function(e){var t=this._renderTargetSystem.getGpuRenderTarget(e);return t.contexts[0]?t.contexts[0].getCurrentTexture():this._renderer.texture.getGpuSource(e.colorTextures[0].source)}},{key:"getDescriptor",value:function(e,t,r){var n=this;"boolean"==typeof t&&(t=t?Pp.ALL:Pp.NONE);var i,a=this._renderTargetSystem,o=a.getGpuRenderTarget(e),s=e.colorTextures.map(function(e,i){var s,u,l=o.contexts[i];l?s=l.getCurrentTexture().createView():s=n._renderer.texture.getGpuSource(e).createView({mipLevelCount:1});o.msaaTextures[i]&&(u=s,s=n._renderer.texture.getTextureView(o.msaaTextures[i]));var c=t&Pp.COLOR?"clear":"load";return null!=r||(r=a.defaultClearColor),{view:s,resolveTarget:u,clearValue:r,storeOp:"store",loadOp:c}});if(!e.stencil&&!e.depth||e.depthStencilTexture||(e.ensureDepthStencilTexture(),e.depthStencilTexture.source.sampleCount=o.msaa?4:1),e.depthStencilTexture){var u=t&Pp.STENCIL?"clear":"load",l=t&Pp.DEPTH?"clear":"load";i={view:this._renderer.texture.getGpuSource(e.depthStencilTexture.source).createView(),stencilStoreOp:"store",stencilLoadOp:u,depthClearValue:1,depthLoadOp:l,depthStoreOp:"store"}}return{colorAttachments:s,depthStencilAttachment:i}}},{key:"clear",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(t){var i=this._renderer,a=i.gpu,o=i.encoder,s=a.device;if(null===o.commandEncoder){var u=s.createCommandEncoder(),l=this.getDescriptor(e,t,r),c=u.beginRenderPass(l);c.setViewport(n.x,n.y,n.width,n.height,0,1),c.end();var h=u.finish();s.queue.submit([h])}else this.startRenderPass(e,t,r,n)}}},{key:"initGpuRenderTarget",value:function(e){var t=this;e.isRoot=!0;var r=new ww;return e.colorTextures.forEach(function(e,n){if(zi.test(e.resource)){var i=e.resource.getContext("webgpu"),a=e.transparent?"premultiplied":"opaque";try{i.configure({device:t._renderer.gpu.device,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,format:"bgra8unorm",alphaMode:a})}catch(de){console.error(de)}r.contexts[n]=i}if(r.msaa=e.source.antialias,e.source.antialias){var o=new ui({width:0,height:0,sampleCount:4});r.msaaTextures[n]=o}}),r.msaa&&(r.msaaSamples=4,e.depthStencilTexture&&(e.depthStencilTexture.source.sampleCount=4)),r}},{key:"destroyGpuRenderTarget",value:function(e){e.contexts.forEach(function(e){e.unconfigure()}),e.msaaTextures.forEach(function(e){e.destroy()}),e.msaaTextures.length=0,e.contexts.length=0}},{key:"ensureDepthStencilTexture",value:function(e){var t=this._renderTargetSystem.getGpuRenderTarget(e);e.depthStencilTexture&&t.msaa&&(e.depthStencilTexture.source.sampleCount=4)}},{key:"resizeGpuRenderTarget",value:function(e){var t=this._renderTargetSystem.getGpuRenderTarget(e);t.width=e.width,t.height=e.height,t.msaa&&e.colorTextures.forEach(function(e,r){var n=t.msaaTextures[r];null==n||n.resize(e.source.width,e.source.height,e.source._resolution)})}}])}(),Pw=exports.GpuRenderTargetSystem=function(e){function t(e){var r;return C(this,t),(r=x(this,t,[e])).adaptor=new Rw,r.adaptor.init(e,r),r}return E(t,ZS),B(t)}();Pw.extension={type:[Z.WebGPUSystem],name:"renderTarget"};var Mw=exports.GpuShaderSystem=function(){return B(function e(){C(this,e),this._gpuProgramData=Object.create(null)},[{key:"contextChange",value:function(e){this._gpu=e,this.maxTextures=e.device.limits.maxSampledTexturesPerShaderStage}},{key:"getProgramData",value:function(e){return this._gpuProgramData[e._layoutKey]||this._createGPUProgramData(e)}},{key:"_createGPUProgramData",value:function(e){var t=this._gpu.device,r=e.gpuLayout.map(function(e){return t.createBindGroupLayout({entries:e})}),n={bindGroupLayouts:r};return this._gpuProgramData[e._layoutKey]={bindGroups:r,pipeline:t.createPipelineLayout(n)},this._gpuProgramData[e._layoutKey]}},{key:"destroy",value:function(){this._gpu=null,this._gpuProgramData=null}}])}();Mw.extension={type:[Z.WebGPUSystem],name:"shader"};var Ow=exports.GpuBlendModesToPixi={};Ow.normal={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"}},Ow.add={alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one",operation:"add"}},Ow.multiply={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"dst",dstFactor:"one-minus-src-alpha",operation:"add"}},Ow.screen={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src",operation:"add"}},Ow.overlay={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src",operation:"add"}},Ow.none={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"zero",dstFactor:"zero",operation:"add"}},Ow["normal-npm"]={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"}},Ow["add-npm"]={alpha:{srcFactor:"one",dstFactor:"one",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one",operation:"add"}},Ow["screen-npm"]={alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src",operation:"add"}},Ow.erase={alpha:{srcFactor:"zero",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"zero",dstFactor:"one-minus-src",operation:"add"}},Ow.min={alpha:{srcFactor:"one",dstFactor:"one",operation:"min"},color:{srcFactor:"one",dstFactor:"one",operation:"min"}},Ow.max={alpha:{srcFactor:"one",dstFactor:"one",operation:"max"},color:{srcFactor:"one",dstFactor:"one",operation:"max"}};var Cw=exports.GpuStateSystem=function(){return B(function e(){C(this,e),this.defaultState=new Al,this.defaultState.blend=!0},[{key:"contextChange",value:function(e){this.gpu=e}},{key:"getColorTargets",value:function(e){return[{format:"bgra8unorm",writeMask:0,blend:Ow[e.blendMode]||Ow.normal}]}},{key:"destroy",value:function(){this.gpu=null}}])}();Cw.extension={type:[Z.WebGPUSystem],name:"state"};var Gw=exports.gpuUploadBufferImageResource={type:"image",upload:function(e,t,r){var n=e.resource,i=(0|e.pixelWidth)*(0|e.pixelHeight),a=n.byteLength/i;r.device.queue.writeTexture({texture:t},n,{offset:0,rowsPerImage:e.pixelHeight,bytesPerRow:e.pixelHeight*a},{width:e.pixelWidth,height:e.pixelHeight,depthOrArrayLayers:1})}},Bw=exports.blockDataMap={"bc1-rgba-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"bc2-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc3-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc7-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"etc1-rgb-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"etc2-rgba8unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"astc-4x4-unorm":{blockBytes:16,blockWidth:4,blockHeight:4}},Iw={blockBytes:4,blockWidth:1,blockHeight:1},Fw=exports.gpuUploadCompressedTextureResource={type:"compressed",upload:function(e,t,r){for(var n=e.pixelWidth,i=e.pixelHeight,a=Bw[e.format]||Iw,o=0;o<e.resource.length;o++){var s=e.resource[o],u=Math.ceil(n/a.blockWidth)*a.blockBytes;r.device.queue.writeTexture({texture:t,mipLevel:o},s,{offset:0,bytesPerRow:u},{width:Math.ceil(n/a.blockWidth)*a.blockWidth,height:Math.ceil(i/a.blockHeight)*a.blockHeight,depthOrArrayLayers:1}),n=Math.max(n>>1,1),i=Math.max(i>>1,1)}}},Dw=exports.gpuUploadImageResource={type:"image",upload:function(e,t,r){var n=e.resource;if(n){var i=Math.min(t.width,e.resourceWidth||e.pixelWidth),a=Math.min(t.height,e.resourceHeight||e.pixelHeight),o="premultiply-alpha-on-upload"===e.alphaMode;r.device.queue.copyExternalImageToTexture({source:n},{texture:t,premultipliedAlpha:o},{width:i,height:a})}}},Uw=exports.gpuUploadVideoResource={type:"video",upload:function(e,t,r){Dw.upload(e,t,r)}},Lw=exports.GpuMipmapGenerator=function(){return B(function e(t){C(this,e),this.device=t,this.sampler=t.createSampler({minFilter:"linear"}),this.pipelines={}},[{key:"_getMipmapPipeline",value:function(e){var t=this.pipelines[e];return t||(this.mipmapShaderModule||(this.mipmapShaderModule=this.device.createShaderModule({code:"\n                        var<private> pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(\n                        vec2<f32>(-1.0, -1.0), vec2<f32>(-1.0, 3.0), vec2<f32>(3.0, -1.0));\n\n                        struct VertexOutput {\n                        @builtin(position) position : vec4<f32>,\n                        @location(0) texCoord : vec2<f32>,\n                        };\n\n                        @vertex\n                        fn vertexMain(@builtin(vertex_index) vertexIndex : u32) -> VertexOutput {\n                        var output : VertexOutput;\n                        output.texCoord = pos[vertexIndex] * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5);\n                        output.position = vec4<f32>(pos[vertexIndex], 0.0, 1.0);\n                        return output;\n                        }\n\n                        @group(0) @binding(0) var imgSampler : sampler;\n                        @group(0) @binding(1) var img : texture_2d<f32>;\n\n                        @fragment\n                        fn fragmentMain(@location(0) texCoord : vec2<f32>) -> @location(0) vec4<f32> {\n                        return textureSample(img, imgSampler, texCoord);\n                        }\n                    "})),t=this.device.createRenderPipeline({layout:"auto",vertex:{module:this.mipmapShaderModule,entryPoint:"vertexMain"},fragment:{module:this.mipmapShaderModule,entryPoint:"fragmentMain",targets:[{format:e}]}}),this.pipelines[e]=t),t}},{key:"generateMipmap",value:function(e){var t=this._getMipmapPipeline(e.format);if("3d"===e.dimension||"1d"===e.dimension)throw new Error("Generating mipmaps for non-2d textures is currently unsupported!");var r=e,n=e.depthOrArrayLayers||1,i=e.usage&GPUTextureUsage.RENDER_ATTACHMENT;if(!i){var a={size:{width:Math.ceil(e.width/2),height:Math.ceil(e.height/2),depthOrArrayLayers:n},format:e.format,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC|GPUTextureUsage.RENDER_ATTACHMENT,mipLevelCount:e.mipLevelCount-1};r=this.device.createTexture(a)}for(var o=this.device.createCommandEncoder({}),s=t.getBindGroupLayout(0),u=0;u<n;++u)for(var l=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:"2d",baseArrayLayer:u,arrayLayerCount:1}),c=i?1:0,h=1;h<e.mipLevelCount;++h){var d=r.createView({baseMipLevel:c++,mipLevelCount:1,dimension:"2d",baseArrayLayer:u,arrayLayerCount:1}),f=o.beginRenderPass({colorAttachments:[{view:d,storeOp:"store",loadOp:"clear",clearValue:{r:0,g:0,b:0,a:0}}]}),p=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.sampler},{binding:1,resource:l}]});f.setPipeline(t),f.setBindGroup(0,p),f.draw(3,1,0,0),f.end(),l=d}if(!i)for(var v={width:Math.ceil(e.width/2),height:Math.ceil(e.height/2),depthOrArrayLayers:n},m=1;m<e.mipLevelCount;++m)o.copyTextureToTexture({texture:r,mipLevel:m-1},{texture:e,mipLevel:m},v),v.width=Math.ceil(v.width/2),v.height=Math.ceil(v.height/2);return this.device.queue.submit([o.finish()]),i||r.destroy(),e}}])}(),Nw=exports.GpuTextureSystem=function(){return B(function e(t){C(this,e),this.managedTextures=[],this._gpuSources=Object.create(null),this._gpuSamplers=Object.create(null),this._bindGroupHash=Object.create(null),this._textureViewHash=Object.create(null),this._uploads={image:Dw,buffer:Gw,video:Uw,compressed:Fw},this._renderer=t},[{key:"contextChange",value:function(e){this._gpu=e}},{key:"initSource",value:function(e){if(e.autoGenerateMipmaps){var t=Math.max(e.pixelWidth,e.pixelHeight);e.mipLevelCount=Math.floor(Math.log2(t))+1}var r=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST;"compressed"!==e.uploadMethodId&&(r|=GPUTextureUsage.RENDER_ATTACHMENT,r|=GPUTextureUsage.COPY_SRC);var n=Bw[e.format]||{blockBytes:4,blockWidth:1,blockHeight:1},i=Math.ceil(e.pixelWidth/n.blockWidth)*n.blockWidth,a=Math.ceil(e.pixelHeight/n.blockHeight)*n.blockHeight,o={label:e.label,size:{width:i,height:a},format:e.format,sampleCount:e.sampleCount,mipLevelCount:e.mipLevelCount,dimension:e.dimension,usage:r},s=this._gpu.device.createTexture(o);return this._gpuSources[e.uid]=s,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceResize,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),s}},{key:"onSourceUpdate",value:function(e){var t=this.getGpuSource(e);t&&(this._uploads[e.uploadMethodId]&&this._uploads[e.uploadMethodId].upload(e,t,this._gpu),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e))}},{key:"onSourceUnload",value:function(e){var t=this._gpuSources[e.uid];t&&(this._gpuSources[e.uid]=null,t.destroy())}},{key:"onUpdateMipmaps",value:function(e){this._mipmapGenerator||(this._mipmapGenerator=new Lw(this._gpu.device));var t=this.getGpuSource(e);this._mipmapGenerator.generateMipmap(t)}},{key:"onSourceDestroy",value:function(e){e.off("update",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("destroy",this.onSourceDestroy,this),e.off("resize",this.onSourceResize,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}},{key:"onSourceResize",value:function(e){var t=this._gpuSources[e.uid];t?t.width===e.pixelWidth&&t.height===e.pixelHeight||(this._textureViewHash[e.uid]=null,this._bindGroupHash[e.uid]=null,this.onSourceUnload(e),this.initSource(e)):this.initSource(e)}},{key:"_initSampler",value:function(e){return this._gpuSamplers[e._resourceId]=this._gpu.device.createSampler(e),this._gpuSamplers[e._resourceId]}},{key:"getGpuSampler",value:function(e){return this._gpuSamplers[e._resourceId]||this._initSampler(e)}},{key:"getGpuSource",value:function(e){return this._gpuSources[e.uid]||this.initSource(e)}},{key:"getTextureBindGroup",value:function(e){var t;return null!=(t=this._bindGroupHash[e.uid])?t:this._createTextureBindGroup(e)}},{key:"_createTextureBindGroup",value:function(e){var t=e.source;return this._bindGroupHash[e.uid]=new pa({0:t,1:t.style,2:new Bs({uTextureMatrix:{type:"mat3x3<f32>",value:e.textureMatrix.mapCoord}})}),this._bindGroupHash[e.uid]}},{key:"getTextureView",value:function(e){var t,r=e.source;return null!=(t=this._textureViewHash[r.uid])?t:this._createTextureView(r)}},{key:"_createTextureView",value:function(e){return this._textureViewHash[e.uid]=this.getGpuSource(e).createView(),this._textureViewHash[e.uid]}},{key:"generateCanvas",value:function(e){var t=this._renderer,r=t.gpu.device.createCommandEncoder(),n=hn.get().createCanvas();n.width=e.source.pixelWidth,n.height=e.source.pixelHeight;var i=n.getContext("webgpu");return i.configure({device:t.gpu.device,usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC,format:hn.get().getNavigator().gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),r.copyTextureToTexture({texture:t.texture.getGpuSource(e.source),origin:{x:0,y:0}},{texture:i.getCurrentTexture()},{width:n.width,height:n.height}),t.gpu.device.queue.submit([r.finish()]),n}},{key:"getPixels",value:function(e){var t=this.generateCanvas(e),r=Il.getOptimalCanvasAndContext(t.width,t.height),n=r.context;n.drawImage(t,0,0);var i=t.width,a=t.height,o=n.getImageData(0,0,i,a),s=new Uint8ClampedArray(o.data.buffer);return Il.returnCanvasAndContext(r),{pixels:s,width:i,height:a}}},{key:"destroy",value:function(){var e=this;this.managedTextures.slice().forEach(function(t){return e.onSourceDestroy(t)}),this.managedTextures=null;for(var t=0,r=Object.keys(this._bindGroupHash);t<r.length;t++){var n=r[t],i=Number(n),a=this._bindGroupHash[i];null==a||a.destroy(),this._bindGroupHash[i]=null}this._gpu=null,this._mipmapGenerator=null,this._gpuSources=null,this._bindGroupHash=null,this._textureViewHash=null,this._gpuSamplers=null}}])}();Nw.extension={type:[Z.WebGPUSystem],name:"texture"};var Xw=exports.GpuGraphicsAdaptor=function(){return B(function e(){C(this,e)},[{key:"init",value:function(){var e=new Bs({uTransformMatrix:{value:new tt,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),t=hs({name:"graphics",bits:[fs,_s(xa()),Nf,Ts]});this.shader=new Vs({gpuProgram:t,resources:{localUniforms:e}})}},{key:"execute",value:function(e,t){var r=t.context,n=r.customShader||this.shader,i=e.renderer,a=i.graphicsContext.getContextRenderData(r),o=a.batcher,s=a.instructions,u=i.encoder;u.setPipelineFromGeometryProgramAndState(o.geometry,n.gpuProgram,e.state),u.setGeometry(o.geometry,n.gpuProgram);var l=i.globalUniforms.bindGroup;u.setBindGroup(0,l,n.gpuProgram);var c=i.renderPipes.uniformBatch.getUniformBindGroup(n.resources.localUniforms,!0);u.setBindGroup(2,c,n.gpuProgram);for(var h=s.instructions,d=0;d<s.instructionSize;d++){var f=h[d];if(n.groups[1]=f.bindGroup,!f.gpuBindGroup){var p=f.textures;f.bindGroup=Ta(p.textures,p.count),f.gpuBindGroup=i.bindGroup.getBindGroup(f.bindGroup,n.gpuProgram,1)}u.setBindGroup(1,f.bindGroup,n.gpuProgram),u.renderPassEncoder.drawIndexed(f.size,1,f.start)}}},{key:"destroy",value:function(){this.shader.destroy(!0),this.shader=null}}])}();Xw.extension={type:[Z.WebGPUPipesAdaptor],name:"graphics"};var Hw=exports.GpuMeshAdapter=function(){return B(function e(){C(this,e)},[{key:"init",value:function(){var e=hs({name:"mesh",bits:[Lf,pT,Ts]});this._shader=new Vs({gpuProgram:e,resources:{uTexture:bi.EMPTY._source,uSampler:bi.EMPTY._source.style,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new tt}}}})}},{key:"execute",value:function(e,t){var r=e.renderer,n=t._shader;if(n){if(!n.gpuProgram)return void Gt("Mesh shader has no gpuProgram",t.shader)}else(n=this._shader).groups[2]=r.texture.getTextureBindGroup(t.texture);var i=n.gpuProgram;if(i.autoAssignGlobalUniforms&&(n.groups[0]=r.globalUniforms.bindGroup),i.autoAssignLocalUniforms){var a=e.localUniforms;n.groups[1]=r.renderPipes.uniformBatch.getUniformBindGroup(a,!0)}r.encoder.draw({geometry:t._geometry,shader:n,state:t.state})}},{key:"destroy",value:function(){this._shader.destroy(!0),this._shader=null}}])}();Hw.extension={type:[Z.WebGPUPipesAdaptor],name:"mesh"};var jw=[].concat(DA,[hw,aw,JA,KA,Nw,Pw,Mw,Cw,Aw,QA,ow,YA]),zw=[].concat(UA,[fw]),Vw=[cT,Hw,Xw],Ww=[],Yw=[],Kw=[];$.handleByNamedList(Z.WebGPUSystem,Ww),$.handleByNamedList(Z.WebGPUPipes,Yw),$.handleByNamedList(Z.WebGPUPipesAdaptor,Kw),$.add.apply($,m(jw).concat(m(zw),Vw));var qw=exports.WebGPURenderer=function(e){function t(){return C(this,t),x(this,t,[{name:"webgpu",type:Ds.WEBGPU,systems:Ww,renderPipes:Yw,renderPipeAdaptors:Kw}])}return E(t,Xp),B(t)}(),Zw={__proto__:null,WebGPURenderer:qw},Qw={POINTS:"point-list",LINES:"line-list",LINE_STRIP:"line-strip",TRIANGLES:"triangle-list",TRIANGLE_STRIP:"triangle-strip"},Jw=exports.DRAW_MODES=new Proxy(Qw,{get:function(e,t){return ht(lt,"DRAW_MODES.".concat(t," is deprecated, use '").concat(Qw[t],"' instead")),e[t]}}),$w=new St(0,0,1,1);function eR(e,t,r){r||(r=$w);var n=t.pixelWidth,i=t.pixelHeight;return e.x=r.x*n|0,e.y=r.y*i|0,e.width=r.width*n|0,e.height=r.height*i|0,e}var tR=exports.MSAA_QUALITY=function(e){return e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e}(tR||{}),rR=exports.DEPRECATED_WRAP_MODES=function(e){return e.CLAMP="clamp-to-edge",e.REPEAT="repeat",e.MIRRORED_REPEAT="mirror-repeat",e}(rR||{}),nR=exports.WRAP_MODES=new Proxy(rR,{get:function(e,t){return ht(lt,"DRAW_MODES.".concat(t," is deprecated, use '").concat(rR[t],"' instead")),e[t]}}),iR=exports.DEPRECATED_SCALE_MODES=function(e){return e.NEAREST="nearest",e.LINEAR="linear",e}(iR||{}),aR=exports.SCALE_MODES=new Proxy(iR,{get:function(e,t){return ht(lt,"DRAW_MODES.".concat(t," is deprecated, use '").concat(iR[t],"' instead")),e[t]}}),oR=exports.TextureUvs=function(){return B(function e(){C(this,e),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)},[{key:"set",value:function(e,t,r){var n=t.width,i=t.height;if(r){var a=e.width/2/n,o=e.height/2/i,s=e.x/n+a,u=e.y/i+o;r=Ln.add(r,Ln.NW),this.x0=s+a*Ln.uX(r),this.y0=u+o*Ln.uY(r),r=Ln.add(r,2),this.x1=s+a*Ln.uX(r),this.y1=u+o*Ln.uY(r),r=Ln.add(r,2),this.x2=s+a*Ln.uX(r),this.y2=u+o*Ln.uY(r),r=Ln.add(r,2),this.x3=s+a*Ln.uX(r),this.y3=u+o*Ln.uY(r)}else this.x0=e.x/n,this.y0=e.y/i,this.x1=(e.x+e.width)/n,this.y1=e.y/i,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/i,this.x3=e.x/n,this.y3=(e.y+e.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}},{key:"toString",value:function(){return"[pixi.js/core:TextureUvs x0=".concat(this.x0," y0=").concat(this.y0," x1=").concat(this.x1," y1=").concat(this.y1," x2=").concat(this.x2," y2=").concat(this.y2," x3=").concat(this.x3," y3=").concat(this.y3,"]")}}])}(),sR=0;function uR(){return sR++}function lR(e){var t=e.toString(),r=t.indexOf("{"),n=t.lastIndexOf("}");if(-1===r||-1===n)throw new Error("getFunctionBody: No body found in function definition");return t.slice(r+1,n).trim()}var cR=Object.defineProperty,hR=Object.getOwnPropertySymbols,dR=Object.prototype.hasOwnProperty,fR=Object.prototype.propertyIsEnumerable,pR=function(e,t,r){return t in e?cR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},vR=function(e,t){for(var r in t||(t={}))dR.call(t,r)&&pR(e,r,t[r]);if(hR){var n,i=U(hR(t));try{for(i.s();!(n=i.n()).done;){r=n.value;fR.call(t,r)&&pR(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},mR=function(e,t){var r={};for(var n in e)dR.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&hR){var i,a=U(hR(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&fR.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},gR=exports.RenderContainer=function(e){function t(e){var r,n,i;C(this,t),"function"==typeof e&&(e={render:e});var a=e,o=a.render,s=mR(a,["render"]);return(r=x(this,t,[vR({label:"RenderContainer"},s)])).batched=!1,r._lastUsed=0,r._lastInstructionTick=-1,r.bounds=new Et,r.canBundle=!1,r.renderPipeId="customRender",o&&(r.render=o),r.containsPoint=null!=(n=e.containsPoint)?n:function(){return!1},r.addBounds=null!=(i=e.addBounds)?i:function(){return!1},r}return E(t,tr),B(t,[{key:"render",value:function(e){}}])}();function _R(e,t){var r=t._scale,n=t._pivot,i=t._position,a=r._x,o=r._y,s=n._x,u=n._y;e.a=t._cx*a,e.b=t._sx*a,e.c=t._cy*o,e.d=t._sy*o,e.tx=i._x-(s*e.a+u*e.c),e.ty=i._y-(s*e.b+u*e.d)}function yR(e,t,r){var n=e.a,i=e.b,a=e.c,o=e.d,s=e.tx,u=e.ty,l=t.a,c=t.b,h=t.c,d=t.d;r.a=n*l+i*h,r.b=n*c+i*d,r.c=a*l+o*h,r.d=a*c+o*d,r.tx=s*l+u*h+t.tx,r.ty=s*c+u*d+t.ty}var xR={rectangle:ol,polygon:al,triangle:sl,circle:hu,ellipse:hu,roundedRectangle:hu};function bR(e){e instanceof Vc&&(e={path:e,textureMatrix:null,out:null});var t=[],r=[],n=[],i=e.path.shapePath,a=e.textureMatrix;i.shapePrimitives.forEach(function(e){var i=e.shape,o=e.transform,s=n.length,u=t.length/2,l=[],c=xR[i.type];c.build(i,l),o&&Js(l,o),c.triangulate(l,t,2,u,n,s);var h=r.length/2;a?(o&&a.append(o.clone().invert()),Zs(t,2,u,r,h,2,t.length/2-u,a)):Qs(r,h,2,t.length/2-u)});var o=e.out;return o?(o.positions=new Float32Array(t),o.uvs=new Float32Array(r),o.indices=new Uint32Array(n),o):new Pf({positions:new Float32Array(t),uvs:new Float32Array(r),indices:new Uint32Array(n)})}function TR(e,t,r,n){for(var i=r.buffers[0],a=i.data,o=r.verticesX,s=e/(o-1),u=t/(r.verticesY-1),l=0,c=n[0],h=n[1],d=n[2],f=n[3],p=n[4],v=n[5],m=n[6],g=n[7],_=n[8],y=0;y<a.length;y+=2){var x=l%o*s,b=(l/o|0)*u,T=c*x+h*b+d,S=f*x+p*b+v,k=m*x+g*b+_;a[y]=T/k,a[y+1]=S/k,l++}i.update()}function SR(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8];return e[0]=o*c-s*l,e[1]=i*l-n*c,e[2]=n*s-i*o,e[3]=s*u-a*c,e[4]=r*c-i*u,e[5]=i*a-r*s,e[6]=a*l-o*u,e[7]=n*u-r*l,e[8]=r*o-n*a,e}function kR(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],d=r[0],f=r[1],p=r[2],v=r[3],m=r[4],g=r[5],_=r[6],y=r[7],x=r[8];return e[0]=d*n+f*o+p*l,e[1]=d*i+f*s+p*c,e[2]=d*a+f*u+p*h,e[3]=v*n+m*o+g*l,e[4]=v*i+m*s+g*c,e[5]=v*a+m*u+g*h,e[6]=_*n+y*o+x*l,e[7]=_*i+y*s+x*c,e[8]=_*a+y*u+x*h,e}function ER(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n+t[1]*i+t[2]*a,e[1]=t[3]*n+t[4]*i+t[5]*a,e[2]=t[6]*n+t[7]*i+t[8]*a,e}var AR=[0,0,0,0,0,0,0,0,0],wR=[0,0,0],RR=[0,0,0];function PR(e,t,r,n,i,a,o,s,u){var l=AR;l[0]=t,l[1]=n,l[2]=a,l[3]=r,l[4]=i,l[5]=o,l[6]=1,l[7]=1,l[8]=1;var c=SR(e,l);RR[0]=s,RR[1]=u,RR[2]=1;var h=ER(wR,c,RR),d=e;return e[0]=h[0],e[1]=0,e[2]=0,e[3]=0,e[4]=h[1],e[5]=0,e[6]=0,e[7]=0,e[8]=h[2],kR(e,d,l)}var MR=[0,0,0,0,0,0,0,0,0],OR=[0,0,0,0,0,0,0,0,0];function CR(e,t,r,n,i,a,o,s,u,l,c,h,d,f,p,v,m){var g=PR(MR,t,r,a,o,l,c,f,p),_=PR(OR,n,i,s,u,h,d,v,m);return kR(e,SR(g,g),_)}var GR=exports.PerspectivePlaneGeometry=function(e){function t(e){var r;C(this,t),(r=x(this,t,[e]))._projectionMatrix=[0,0,0,0,0,0,0,0,0];var n=e.width,i=e.height;return r.corners=[0,0,n,0,n,i,0,i],r}return E(t,ip),B(t,[{key:"setCorners",value:function(e,t,r,n,i,a,o,s){var u=this.corners;u[0]=e,u[1]=t,u[2]=r,u[3]=n,u[4]=i,u[5]=a,u[6]=o,u[7]=s,this.updateProjection()}},{key:"updateProjection",value:function(){var e=this.width,t=this.height,r=this.corners;TR(e,t,this,CR(this._projectionMatrix,0,0,r[0],r[1],e,0,r[2],r[3],e,t,r[4],r[5],0,t,r[6],r[7]))}}])}(),BR=Object.defineProperty,IR=Object.defineProperties,FR=Object.getOwnPropertyDescriptors,DR=Object.getOwnPropertySymbols,UR=Object.prototype.hasOwnProperty,LR=Object.prototype.propertyIsEnumerable,NR=function(e,t,r){return t in e?BR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},XR=function(e,t){for(var r in t||(t={}))UR.call(t,r)&&NR(e,r,t[r]);if(DR){var n,i=U(DR(t));try{for(i.s();!(n=i.n()).done;){r=n.value;LR.call(t,r)&&NR(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},HR=function(e,t){return IR(e,FR(t))},jR=function(e,t){var r={};for(var n in e)UR.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&DR){var i,a=U(DR(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&LR.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},zR=function(e){function t(e){var r;C(this,t);var n=e=XR(XR({},t.defaultOptions),e),i=n.texture,a=n.verticesX,o=n.verticesY,s=jR(n,["texture","verticesX","verticesY"]),u=new GR(zn({width:i.width,height:i.height,verticesX:a,verticesY:o}));return(r=x(this,t,[zn(HR(XR({},s),{geometry:u}))]))._texture=i,r.geometry.setCorners(e.x0,e.y0,e.x1,e.y1,e.x2,e.y2,e.x3,e.y3),r}return E(t,Sb),B(t,[{key:"textureUpdated",value:function(){var e=this.geometry;if(e){var t=this.texture,r=t.width,n=t.height;e.width===r&&e.height===n||(e.width=r,e.height=n,e.updateProjection())}}},{key:"texture",get:function(){return this._texture},set:function(e){this._texture!==e&&(o(t,"texture",e,this,1,1),this.textureUpdated())}},{key:"setCorners",value:function(e,t,r,n,i,a,o,s){this.geometry.setCorners(e,t,r,n,i,a,o,s)}}])}();zR.defaultOptions={texture:bi.WHITE,verticesX:10,verticesY:10,x0:0,y0:0,x1:100,y1:0,x2:100,y2:100,x3:0,y3:100};var VR=exports.PerspectiveMesh=zR,WR=Object.defineProperty,YR=Object.defineProperties,KR=Object.getOwnPropertyDescriptors,qR=Object.getOwnPropertySymbols,ZR=Object.prototype.hasOwnProperty,QR=Object.prototype.propertyIsEnumerable,JR=function(e,t,r){return t in e?WR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},$R=function(e,t){for(var r in t||(t={}))ZR.call(t,r)&&JR(e,r,t[r]);if(qR){var n,i=U(qR(t));try{for(i.s();!(n=i.n()).done;){r=n.value;QR.call(t,r)&&JR(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},eP=function(e,t){return YR(e,KR(t))},tP=function(e,t){var r={};for(var n in e)ZR.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&qR){var i,a=U(qR(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&QR.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},rP=exports.MeshPlane=function(e){function t(e){var r;C(this,t);var n=e,i=n.texture,a=n.verticesX,o=n.verticesY,s=tP(n,["texture","verticesX","verticesY"]),u=new ip(zn({width:i.width,height:i.height,verticesX:a,verticesY:o}));return(r=x(this,t,[zn(eP($R({},s),{geometry:u,texture:i}))])).texture=i,r.autoResize=!0,r}return E(t,Sb),B(t,[{key:"textureUpdated",value:function(){var e=this.geometry,t=this.texture,r=t.width,n=t.height;!this.autoResize||e.width===r&&e.height===n||(e.width=r,e.height=n,e.build({}))}},{key:"texture",get:function(){return this._texture},set:function(e){var r;null==(r=this._texture)||r.off("update",this.textureUpdated,this),o(t,"texture",e,this,1,1),e.on("update",this.textureUpdated,this),this.textureUpdated()}},{key:"destroy",value:function(e){this.texture.off("update",this.textureUpdated,this),c(t,"destroy",this,3)([e])}}])}(),nP=Object.defineProperty,iP=Object.getOwnPropertySymbols,aP=Object.prototype.hasOwnProperty,oP=Object.prototype.propertyIsEnumerable,sP=function(e,t,r){return t in e?nP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},uP=function(e,t){for(var r in t||(t={}))aP.call(t,r)&&sP(e,r,t[r]);if(iP){var n,i=U(iP(t));try{for(i.s();!(n=i.n()).done;){r=n.value;oP.call(t,r)&&sP(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},lP=function(e){function t(e){var r;C(this,t);var n=uP(uP({},t.defaultOptions),e),i=n.width,a=n.points,o=n.textureScale;return(r=x(this,t,[{positions:new Float32Array(4*a.length),uvs:new Float32Array(4*a.length),indices:new Uint32Array(6*(a.length-1))}])).points=a,r._width=i,r.textureScale=o,r._build(),r}return E(t,Pf),B(t,[{key:"width",get:function(){return this._width}},{key:"_build",value:function(){var e=this.points;if(e){var t=this.getBuffer("aPosition"),r=this.getBuffer("aUV"),n=this.getIndex();if(!(e.length<1)){t.data.length/4!==e.length&&(t.data=new Float32Array(4*e.length),r.data=new Float32Array(4*e.length),n.data=new Uint16Array(6*(e.length-1)));var i=r.data,a=n.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;for(var o=0,s=e[0],u=this._width*this.textureScale,l=e.length,c=0;c<l;c++){var h=4*c;if(this.textureScale>0){var d=s.x-e[c].x,f=s.y-e[c].y,p=Math.sqrt(d*d+f*f);s=e[c],o+=p/u}else o=c/(l-1);i[h]=o,i[h+1]=0,i[h+2]=o,i[h+3]=1}for(var v=0,m=0;m<l-1;m++){var g=2*m;a[v++]=g,a[v++]=g+1,a[v++]=g+2,a[v++]=g+2,a[v++]=g+1,a[v++]=g+3}r.update(),n.update(),this.updateVertices()}}}},{key:"updateVertices",value:function(){var e=this.points;if(!(e.length<1)){for(var t,r=e[0],n=0,i=0,a=this.buffers[0].data,o=e.length,s=this.textureScale>0?this.textureScale*this._width/2:this._width/2,u=0;u<o;u++){var l=e[u],c=4*u;i=-((t=u<e.length-1?e[u+1]:l).x-r.x),n=t.y-r.y;var h=10*(1-u/(o-1));h>1&&(h=1);var d=Math.sqrt(n*n+i*i);d<1e-6?(n=0,i=0):(n/=d,i/=d,n*=s,i*=s),a[c]=l.x+n,a[c+1]=l.y+i,a[c+2]=l.x-n,a[c+3]=l.y-i,r=l}this.buffers[0].update()}}},{key:"update",value:function(){this.textureScale>0?this._build():this.updateVertices()}}])}();lP.defaultOptions={width:200,points:[],textureScale:0};var cP=exports.RopeGeometry=lP,hP=Object.defineProperty,dP=Object.defineProperties,fP=Object.getOwnPropertyDescriptors,pP=Object.getOwnPropertySymbols,vP=Object.prototype.hasOwnProperty,mP=Object.prototype.propertyIsEnumerable,gP=function(e,t,r){return t in e?hP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},_P=function(e,t){for(var r in t||(t={}))vP.call(t,r)&&gP(e,r,t[r]);if(pP){var n,i=U(pP(t));try{for(i.s();!(n=i.n()).done;){r=n.value;mP.call(t,r)&&gP(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},yP=function(e,t){return dP(e,fP(t))},xP=function(e,t){var r={};for(var n in e)vP.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&pP){var i,a=U(pP(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&mP.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},bP=function(e){function t(e){var r;C(this,t);var n=_P(_P({},t.defaultOptions),e),i=n.texture,a=n.points,o=n.textureScale,s=xP(n,["texture","points","textureScale"]),u=new cP(zn({width:i.height,points:a,textureScale:o}));return o>0&&(i.source.style.addressMode="repeat"),(r=x(this,t,[zn(yP(_P({},s),{texture:i,geometry:u}))])).autoUpdate=!0,r.onRender=r._render,r}return E(t,Sb),B(t,[{key:"_render",value:function(){var e=this.geometry;(this.autoUpdate||e._width!==this.texture.height)&&(e._width=this.texture.height,e.update())}}])}();bP.defaultOptions={textureScale:0};var TP=exports.MeshRope=bP,SP=Object.defineProperty,kP=Object.defineProperties,EP=Object.getOwnPropertyDescriptors,AP=Object.getOwnPropertySymbols,wP=Object.prototype.hasOwnProperty,RP=Object.prototype.propertyIsEnumerable,PP=function(e,t,r){return t in e?SP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},MP=function(e,t){for(var r in t||(t={}))wP.call(t,r)&&PP(e,r,t[r]);if(AP){var n,i=U(AP(t));try{for(i.s();!(n=i.n()).done;){r=n.value;RP.call(t,r)&&PP(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},OP=function(e,t){return kP(e,EP(t))},CP=function(e,t){var r={};for(var n in e)wP.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&AP){var i,a=U(AP(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&RP.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},GP=exports.MeshSimple=function(e){function t(e){var r;C(this,t);var n=e,i=n.texture,a=n.vertices,o=n.uvs,s=n.indices,u=n.topology,l=CP(n,["texture","vertices","uvs","indices","topology"]),c=new Pf(zn({positions:a,uvs:o,indices:s,topology:u}));return(r=x(this,t,[zn(OP(MP({},l),{texture:i,geometry:c}))])).autoUpdate=!0,r.onRender=r._render,r}return E(t,Sb),B(t,[{key:"vertices",get:function(){return this.geometry.getBuffer("aPosition").data},set:function(e){this.geometry.getBuffer("aPosition").data=e}},{key:"_render",value:function(){this.autoUpdate&&this.geometry.getBuffer("aPosition").update()}}])}();function BP(e,t){var r=e.frame,n=r.width,i=r.height;return t.scale(1/n,1/i),t}var IP=Object.defineProperty,FP=Object.getOwnPropertySymbols,DP=Object.prototype.hasOwnProperty,UP=Object.prototype.propertyIsEnumerable,LP=function(e,t,r){return t in e?IP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},NP=function(e,t){for(var r in t||(t={}))DP.call(t,r)&&LP(e,r,t[r]);if(FP){var n,i=U(FP(t));try{for(i.s();!(n=i.n()).done;){r=n.value;UP.call(t,r)&&LP(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},XP=function(e,t){var r={};for(var n in e)DP.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&FP){var i,a=U(FP(e));try{for(a.s();!(i=a.n()).done;){n=i.value;t.indexOf(n)<0&&UP.call(e,n)&&(r[n]=e[n])}}catch(o){a.e(o)}finally{a.f()}}return r},HP=function(e){function t(e){var r,n,i,a,o,s,u,l,c,h,d;C(this,t),e instanceof bi&&(e={texture:e});var f=e,p=f.width,v=f.height,m=f.leftWidth,g=f.rightWidth,_=f.topHeight,y=f.bottomHeight,b=f.texture,T=f.roundPixels,S=XP(f,["width","height","leftWidth","rightWidth","topHeight","bottomHeight","texture","roundPixels"]);return(r=x(this,t,[NP({label:"NineSliceSprite"},S)])).renderPipeId="nineSliceSprite",r.batched=!0,r._didSpriteUpdate=!0,r._leftWidth=null!=(i=null!=m?m:null==(n=null==b?void 0:b.defaultBorders)?void 0:n.left)?i:dp.defaultOptions.leftWidth,r._topHeight=null!=(o=null!=_?_:null==(a=null==b?void 0:b.defaultBorders)?void 0:a.top)?o:dp.defaultOptions.topHeight,r._rightWidth=null!=(u=null!=g?g:null==(s=null==b?void 0:b.defaultBorders)?void 0:s.right)?u:dp.defaultOptions.rightWidth,r._bottomHeight=null!=(c=null!=y?y:null==(l=null==b?void 0:b.defaultBorders)?void 0:l.bottom)?c:dp.defaultOptions.bottomHeight,r.bounds.maxX=r._width=null!=(h=null!=p?p:b.width)?h:dp.defaultOptions.width,r.bounds.maxY=r._height=null!=(d=null!=v?v:b.height)?d:dp.defaultOptions.height,r.allowChildren=!1,r.texture=null!=b?b:t.defaultOptions.texture,r.roundPixels=null!=T&&T,r}return E(t,Ri),B(t,[{key:"bounds",get:function(){return this._bounds}},{key:"width",get:function(){return this._width},set:function(e){this.bounds.maxX=this._width=e,this.onViewUpdate()}},{key:"height",get:function(){return this._height},set:function(e){this.bounds.maxY=this._height=e,this.onViewUpdate()}},{key:"setSize",value:function(e,t){var r;"object"===D(e)&&(t=null!=(r=e.height)?r:e.width,e=e.width),this.bounds.maxX=this._width=e,this.bounds.maxY=this._height=null!=t?t:e,this.onViewUpdate()}},{key:"getSize",value:function(e){return e||(e={}),e.width=this._width,e.height=this._height,e}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(e){this._leftWidth=e,this.onViewUpdate()}},{key:"topHeight",get:function(){return this._topHeight},set:function(e){this._topHeight=e,this.onViewUpdate()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(e){this._rightWidth=e,this.onViewUpdate()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(e){this._bottomHeight=e,this.onViewUpdate()}},{key:"texture",get:function(){return this._texture},set:function(e){e||(e=bi.EMPTY);var t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this.onViewUpdate())}},{key:"originalWidth",get:function(){return this._texture.width}},{key:"originalHeight",get:function(){return this._texture.height}},{key:"onViewUpdate",value:function(){if(this._didViewChangeTick++,this._didSpriteUpdate=!0,!this.didViewUpdate){this.didViewUpdate=!0;var e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}}},{key:"addBounds",value:function(e){var t=this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}},{key:"destroy",value:function(e){if(c(t,"destroy",this,3)([e]),"boolean"==typeof e?e:null==e?void 0:e.texture){var r="boolean"==typeof e?e:null==e?void 0:e.textureSource;this._texture.destroy(r)}this._texture=null}}])}();HP.defaultOptions={texture:bi.EMPTY};var jP=exports.NineSliceSprite=HP,zP=exports.NineSlicePlane=function(e){function t(){C(this,t);var e=arguments.length<=0?void 0:arguments[0];return e instanceof bi&&(ht(lt,"NineSlicePlane now uses the options object {texture, leftWidth, rightWidth, topHeight, bottomHeight}"),e={texture:e,leftWidth:arguments.length<=1?void 0:arguments[1],topHeight:arguments.length<=2?void 0:arguments[2],rightWidth:arguments.length<=3?void 0:arguments[3],bottomHeight:arguments.length<=4?void 0:arguments[4]}),ht(lt,"NineSlicePlane is deprecated. Use NineSliceSprite instead."),x(this,t,[e])}return E(t,jP),B(t)}();function VP(e,t){return t instanceof zh||t instanceof af?t:"html"===e?new af(t):new zh(t)}function WP(e,t){return YP.apply(this,arguments)}function YP(){return(YP=v(f().mark(function e(t,r){var n,i,a,o,s=arguments;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:200,e.next=3,r.extract.base64(t);case 3:return i=e.sent,e.next=6,r.encoder.commandFinished;case 6:a=n,console.log("logging texture ".concat(t.source.width,"px ").concat(t.source.height,"px")),o=["font-size: 1px;","padding: ".concat(a,"px ",300,"px;"),"background: url(".concat(i,") no-repeat;"),"background-size: contain;"].join(" "),console.log("%c ",o);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var KP=Object.defineProperty,qP=Object.defineProperties,ZP=Object.getOwnPropertyDescriptors,QP=Object.getOwnPropertySymbols,JP=Object.prototype.hasOwnProperty,$P=Object.prototype.propertyIsEnumerable,eM=function(e,t,r){return t in e?KP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},tM=function(e,t){for(var r in t||(t={}))JP.call(t,r)&&eM(e,r,t[r]);if(QP){var n,i=U(QP(t));try{for(i.s();!(n=i.n()).done;){r=n.value;$P.call(t,r)&&eM(e,r,t[r])}}catch(a){i.e(a)}finally{i.f()}}return e},rM=function(e,t){return qP(e,ZP(t))},nM=["#000080","#228B22","#8B0000","#4169E1","#008080","#800000","#9400D3","#FF8C00","#556B2F","#8B008B"],iM=0;function aM(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:"#000000"};e.renderGroup&&(r.color=nM[iM++]);for(var n="",i=0;i<t;i++)n+="    ";var a=e.label;!a&&e instanceof Fi&&(a="sprite:".concat(e.texture.label));var o="%c ".concat(n,"|- ").concat(a," (worldX:").concat(e.worldTransform.tx,", relativeRenderX:").concat(e.relativeGroupTransform.tx,", renderX:").concat(e.groupTransform.tx,", localX:").concat(e.x,")");e.renderGroup&&(o+=" (RenderGroup)"),e.filters&&(o+="(*filters)"),console.log(o,"color:".concat(r.color,"; font-weight:bold;")),t++;for(var s=0;s<e.children.length;s++){aM(e.children[s],t,tM({},r))}}function oM(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{index:0,color:"#000000"},n="",i=0;i<t;i++)n+="    ";var a="%c ".concat(n,"- ").concat(r.index,": ").concat(e.root.label," worldX:").concat(e.worldTransform.tx);console.log(a,"color:".concat(r.color,"; font-weight:bold;")),t++;for(var o=0;o<e.renderGroupChildren.length;o++){oM(e.renderGroupChildren[o],t,rM(tM({},r),{index:o}))}}
},{}],"itQ5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.YELLOW_COLOR=exports.CONFIG=exports.BLUE_COLOR=void 0;var o=exports.BLUE_COLOR=1087931,t=exports.YELLOW_COLOR=16514891,e=exports.CONFIG={env:"dev",userId:100,apiUrl:"http://localhost:3000",backgroundColor:o,rollsQuantity:3,rollWidth:160,rollHorizontalMargin:30,rollsContainerBorderColor:t,rollsContainerBorderMargin:10,rowsQuantity:3,symbolSize:150,symbolVerticalMargin:30,headerHeight:75,headerWidth:640,headerContentTop:55,footerHeight:150,spinButton:{width:200,height:75,radius:20,color:t,fontSize:42,textColor:o},betController:{textColor:t,fontSize:24},betButton:{width:35,height:35,radius:10,color:t,fontSize:18,textColor:o,deltaX:45},balance:{fontSize:24,textColor:t,x:137.5},apiResponse:{uid:100,balance:970,last_bet:10,bets:[10,20,50,100],rolls:[[8,3,9],[9,9,4],[5,6,3]]},symbolsQuantity:10,blindZoneAboveRolls:{y:-90,height:170,width:640},blindZoneUnderRolls:{y:600,height:175,width:640},timeMovingSymbolToNextPosition:100,intermediateSymbolsQuantityForSpinByRoll:[10,20,30]};
},{}],"iS0U":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("../../libs/dev/pixi.mjs"),e=require("../config.js");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,u(o.key),o)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t){var e=a(t,"string");return"symbol"==n(e)?e:e+""}function a(t,e){if("object"!=n(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function s(t,e,n){return e=p(e),l(t,f()?Reflect.construct(e,n||[],p(t).constructor):e.apply(t,n))}function l(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(f=function(){return!!t})()}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}function y(t,e){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var h=exports.default=function(n){function r(){var t;return o(this,r),(t=s(this,r)).initChildren(),t}return b(r,t.Container),i(r,[{key:"initChildren",value:function(){this.initText(),this.initButtons()}},{key:"initText",value:function(){this.text=new t.Text({text:"BET:",style:{fontFamily:"Arial",fontSize:e.CONFIG.betController.fontSize,fill:e.CONFIG.betController.textColor,align:"center"}}),this.text.x=15,this.text.anchor.set(.5),this.addChild(this.text)}},{key:"initButtons",value:function(){var n=this;this.buttons=[];for(var o=function(o){var r=new t.Container,i=new t.Graphics;i.roundRect(0,0,e.CONFIG.betButton.width,e.CONFIG.betButton.height,e.CONFIG.betButton.radius),i.fill(e.CONFIG.betButton.color);var u=new t.Text({text:e.CONFIG.apiResponse.bets[o],style:{fontFamily:"Arial",fontSize:e.CONFIG.betButton.fontSize,fill:e.CONFIG.betButton.textColor,align:"center"}});u.x=e.CONFIG.betButton.width/2,u.y=e.CONFIG.betButton.height/2,u.anchor.set(.5),r.addChild(i),r.addChild(u),e.CONFIG.apiResponse.bets[o]===e.CONFIG.apiResponse.last_bet||0===e.CONFIG.apiResponse.last_bet&&0===o?(r.alpha=1,e.CONFIG.apiResponse.last_bet=e.CONFIG.apiResponse.bets[o]):r.alpha=.5,r.eventMode="static",r.cursor="pointer",r.on("pointerdown",function(){n.buttons.forEach(function(t){t.alpha=.5}),r.alpha=1,e.CONFIG.apiResponse.last_bet=e.CONFIG.apiResponse.bets[o]}),r.x=n.text.width+o*e.CONFIG.betButton.deltaX,r.y=-r.height/2,n.addChild(r),n.buttons.push(r)},r=0;r<e.CONFIG.apiResponse.bets.length;r++)o(r)}}])}();
},{"../../libs/dev/pixi.mjs":"vQPm","../config.js":"itQ5"}],"MDzb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("../../libs/dev/pixi.mjs"),e=r(require("./BetController.js")),n=require("../config.js");function r(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,c(r.key),r)}}function u(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(t){var e=a(t,"string");return"symbol"==o(e)?e:e+""}function a(t,e){if("object"!=o(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function f(t,e,n){return e=y(e),s(t,p()?Reflect.construct(e,n||[],y(t).constructor):e.apply(t,n))}function s(t,e){if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return b(t)}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(p=function(){return!!t})()}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}function h(t,e){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var v=exports.default=function(r){function o(){var t;return i(this,o),t=f(this,o),console.log("Header created"),t.initChildren(),t}return d(o,t.Container),u(o,[{key:"initChildren",value:function(){this.initBetController(),this.initBalance()}},{key:"initBetController",value:function(){this.betController=this.addChild(new e.default),this.betController.x=-this.betController.width,this.betController.y=n.CONFIG.headerContentTop}},{key:"initBalance",value:function(){this.balance=new t.Text({text:"BALANCE: "+n.CONFIG.apiResponse.balance,style:{fontFamily:"Arial",fontSize:n.CONFIG.balance.fontSize,fill:n.CONFIG.balance.textColor,align:"center"}}),this.balance.anchor.set(.5),this.balance.x=n.CONFIG.balance.x,this.balance.y=n.CONFIG.headerContentTop,this.addChild(this.balance)}}])}();
},{"../../libs/dev/pixi.mjs":"vQPm","./BetController.js":"iS0U","../config.js":"itQ5"}]},{},["MDzb"], null)
//# sourceMappingURL=/Header.3e80989c.js.map